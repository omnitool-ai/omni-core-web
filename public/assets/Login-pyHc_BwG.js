var Df=Object.defineProperty;var Ff=(t,e,n)=>e in t?Df(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var B=(t,e,n)=>(Ff(t,typeof e!="symbol"?e+"":e,n),n),Bf=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var Wi=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)};var gr=(t,e,n)=>(Bf(t,e,"access private method"),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var sk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Co(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var $f={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Uf={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Hf=/(&amp;|&lt;|&gt;|&quot;|&#39;)/g,zf=/[&<>"']/g;function jf(t){return $f[t]}function Wf(t){return Uf[t]}function ws(t){return t==null?"":String(t).replace(zf,jf)}function _s(t){return t==null?"":String(t).replace(Hf,Wf)}ws.options=_s.options={};var Ac={encode:ws,escape:ws,decode:_s,unescape:_s,version:"1.0.0-browser"};function Oc(t){for(var e=Array.prototype.slice.call(arguments,1),n,r;e.length;){n=e.shift();for(r in n)n.hasOwnProperty(r)&&(Object.prototype.toString.call(t[r])==="[object Object]"?t[r]=Oc(t[r],n[r]):t[r]=n[r])}return t}var qf=Oc,Tc=function(e){return typeof e=="string"?e.toLowerCase():e};function Vf(t){return t.reduce(Jf,{})}function Jf(t,e){return t[e]=!0,t}var Rc=Vf,Gf=Rc,Kf=["background","base","cite","href","longdesc","src","usemap"],Yf={uris:Gf(Kf)},Xf=Rc,Zf=["area","br","col","hr","img","wbr","input","base","basefont","link","meta"],Ic={voids:Xf(Zf)},Qf=Ac,tl=Tc,ed=Ic,td=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,nd=/^<\s*\/\s*([\w:-]+)[^>]*>/,rd=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,id=/^</,sd=/^<\s*\//;function od(){var t=[];return t.lastItem=function(){return t[t.length-1]},t}function ad(t,e){for(var n=od(),r=t,i;t;)s();d();function s(){i=!0,o();var h=t===r;r=t,h&&(t="")}function o(){t.substr(0,4)==="<!--"?l():sd.test(t)?a(nd,d):id.test(t)&&a(td,c),u()}function a(h,p){var f=t.match(h);f&&(t=t.substring(f[0].length),f[0].replace(h,p),i=!1)}function l(){var h=t.indexOf("-->");h>=0&&(e.comment&&e.comment(t.substring(4,h)),t=t.substring(h+3),i=!1)}function u(){if(i){var h,p=t.indexOf("<");p>=0?(h=t.substring(0,p),t=t.substring(p)):(h=t,t=""),e.chars&&e.chars(h)}}function c(h,p,f,m){var g={},w=tl(p),v=ed.voids[w]||!!m;f.replace(rd,b),v||n.push(w),e.start&&e.start(w,g,v);function b(y,_,A,S,I){A===void 0&&S===void 0&&I===void 0?g[_]=void 0:g[_]=Qf.decode(A||S||I||"")}}function d(h,p){var f,m=0,g=tl(p);if(g)for(m=n.length-1;m>=0&&n[m]!==g;m--);if(m>=0){for(f=n.length-1;f>=m;f--)e.end&&e.end(n[f]);n.length=m}}}var ld=ad,cd=Ac,qi=Tc,ud=Yf,hd=Ic;function fd(t,e){var n,r=e||{};return d(),{start:s,end:o,chars:l};function i(h){t.push(h)}function s(h,p,f){var m=qi(h);if(n.ignoring){u(m);return}if((r.allowedTags||[]).indexOf(m)===-1){u(m);return}if(r.filter&&!r.filter({tag:m,attrs:p})){u(m);return}i("<"),i(m),Object.keys(p).forEach(g),i(f?"/>":">");function g(w){var v=p[w],b=(r.allowedClasses||{})[m]||[],y=(r.allowedAttributes||{})[m]||[],_,A=qi(w);A==="class"&&y.indexOf(A)===-1?(v=v.split(" ").filter(S).join(" ").trim(),_=v.length):_=y.indexOf(A)!==-1&&(ud.uris[A]!==!0||a(v)),_&&(i(" "),i(w),typeof v=="string"&&(i('="'),i(cd.encode(v)),i('"')));function S(I){return b&&b.indexOf(I)!==-1}}}function o(h){var p=qi(h),f=(r.allowedTags||[]).indexOf(p)!==-1;f&&n.ignoring===!1?(i("</"),i(p),i(">")):c(p)}function a(h){var p=h[0];if(p==="#"||p==="/")return!0;var f=h.indexOf(":");if(f===-1)return!0;var m=h.indexOf("?");if(m!==-1&&f>m)return!0;var g=h.indexOf("#");if(g!==-1&&f>g)return!0;return r.allowedSchemes.some(w);function w(v){return h.indexOf(v+":")===0}}function l(h){n.ignoring===!1&&i(r.transformText?r.transformText(h):h)}function u(h){hd.voids[h]||(n.ignoring===!1?n={ignoring:h,depth:1}:n.ignoring===h&&n.depth++)}function c(h){n.ignoring===h&&--n.depth<=0&&d()}function d(){n={ignoring:!1,depth:0}}}var dd=fd,pd={allowedAttributes:{a:["href","name","target","title","aria-label"],iframe:["allowfullscreen","frameborder","src"],img:["src","alt","title","aria-label"]},allowedClasses:{},allowedSchemes:["http","https","mailto"],allowedTags:["a","abbr","article","b","blockquote","br","caption","code","del","details","div","em","h1","h2","h3","h4","h5","h6","hr","i","img","ins","kbd","li","main","mark","ol","p","pre","section","span","strike","strong","sub","summary","sup","table","tbody","td","th","thead","tr","u","ul"],filter:null},md=pd,gd=qf,yd=ld,vd=dd,Pc=md;function Nc(t,e,n){var r=[],i=n===!0?e:gd({},Pc,e),s=vd(r,i);return yd(t,s),r.join("")}Nc.defaults=Pc;var wd=Nc;const yr=Co(wd),ft=new WeakMap,Ct=new WeakMap,ot=new WeakMap;var _d={};const qr=Symbol("anyProducer"),nl=Promise.resolve(),Vr=Symbol("listenerAdded"),Jr=Symbol("listenerRemoved");let Gr=!1,Vi=!1;function Xt(t){if(typeof t!="string"&&typeof t!="symbol"&&typeof t!="number")throw new TypeError("`eventName` must be a string, symbol, or number")}function vr(t){if(typeof t!="function")throw new TypeError("listener must be a function")}function Zt(t,e){const n=Ct.get(t);if(n.has(e))return n.get(e)}function Ln(t,e){const n=typeof e=="string"||typeof e=="symbol"||typeof e=="number"?e:qr,r=ot.get(t);if(r.has(n))return r.get(n)}function bd(t,e,n){const r=ot.get(t);if(r.has(e))for(const i of r.get(e))i.enqueue(n);if(r.has(qr)){const i=Promise.all([e,n]);for(const s of r.get(qr))s.enqueue(i)}}function rl(t,e){e=Array.isArray(e)?e:[e];let n=!1,r=()=>{},i=[];const s={enqueue(o){i.push(o),r()},finish(){n=!0,r()}};for(const o of e){let a=Ln(t,o);a||(a=new Set,ot.get(t).set(o,a)),a.add(s)}return{async next(){return i?i.length===0?n?(i=void 0,this.next()):(await new Promise(o=>{r=o}),this.next()):{done:!1,value:await i.shift()}:{done:!0}},async return(o){i=void 0;for(const a of e){const l=Ln(t,a);l&&(l.delete(s),l.size===0&&ot.get(t).delete(a))}return r(),arguments.length>0?{done:!0,value:await o}:{done:!0}},[Symbol.asyncIterator](){return this}}}function il(t){if(t===void 0)return sl;if(!Array.isArray(t))throw new TypeError("`methodNames` must be an array of strings");for(const e of t)if(!sl.includes(e))throw typeof e!="string"?new TypeError("`methodNames` element must be a string"):new Error(`${e} is not Emittery method`);return t}const en=t=>t===Vr||t===Jr;function wr(t,e,n){if(en(e))try{Gr=!0,t.emit(e,n)}finally{Gr=!1}}class gt{static mixin(e,n){return n=il(n),r=>{if(typeof r!="function")throw new TypeError("`target` must be function");for(const o of n)if(r.prototype[o]!==void 0)throw new Error(`The property \`${o}\` already exists on \`target\``);function i(){return Object.defineProperty(this,e,{enumerable:!1,value:new gt}),this[e]}Object.defineProperty(r.prototype,e,{enumerable:!1,get:i});const s=o=>function(...a){return this[e][o](...a)};for(const o of n)Object.defineProperty(r.prototype,o,{enumerable:!1,value:s(o)});return r}}static get isDebugEnabled(){if(typeof _d!="object")return Vi;const{env:e}=globalThis.process??{env:{}};return e.DEBUG==="emittery"||e.DEBUG==="*"||Vi}static set isDebugEnabled(e){Vi=e}constructor(e={}){ft.set(this,new Set),Ct.set(this,new Map),ot.set(this,new Map),ot.get(this).set(qr,new Set),this.debug=e.debug??{},this.debug.enabled===void 0&&(this.debug.enabled=!1),this.debug.logger||(this.debug.logger=(n,r,i,s)=>{try{s=JSON.stringify(s)}catch{s=`Object with the following keys failed to stringify: ${Object.keys(s).join(",")}`}(typeof i=="symbol"||typeof i=="number")&&(i=i.toString());const o=new Date,a=`${o.getHours()}:${o.getMinutes()}:${o.getSeconds()}.${o.getMilliseconds()}`;console.log(`[${a}][emittery:${n}][${r}] Event Name: ${i}
	data: ${s}`)})}logIfDebugEnabled(e,n,r){(gt.isDebugEnabled||this.debug.enabled)&&this.debug.logger(e,this.debug.name,n,r)}on(e,n){vr(n),e=Array.isArray(e)?e:[e];for(const r of e){Xt(r);let i=Zt(this,r);i||(i=new Set,Ct.get(this).set(r,i)),i.add(n),this.logIfDebugEnabled("subscribe",r,void 0),en(r)||wr(this,Vr,{eventName:r,listener:n})}return this.off.bind(this,e,n)}off(e,n){vr(n),e=Array.isArray(e)?e:[e];for(const r of e){Xt(r);const i=Zt(this,r);i&&(i.delete(n),i.size===0&&Ct.get(this).delete(r)),this.logIfDebugEnabled("unsubscribe",r,void 0),en(r)||wr(this,Jr,{eventName:r,listener:n})}}once(e){let n;const r=new Promise(i=>{n=this.on(e,s=>{n(),i(s)})});return r.off=n,r}events(e){e=Array.isArray(e)?e:[e];for(const n of e)Xt(n);return rl(this,e)}async emit(e,n){if(Xt(e),en(e)&&!Gr)throw new TypeError("`eventName` cannot be meta event `listenerAdded` or `listenerRemoved`");this.logIfDebugEnabled("emit",e,n),bd(this,e,n);const r=Zt(this,e)??new Set,i=ft.get(this),s=[...r],o=en(e)?[]:[...i];await nl,await Promise.all([...s.map(async a=>{if(r.has(a))return a(n)}),...o.map(async a=>{if(i.has(a))return a(e,n)})])}async emitSerial(e,n){if(Xt(e),en(e)&&!Gr)throw new TypeError("`eventName` cannot be meta event `listenerAdded` or `listenerRemoved`");this.logIfDebugEnabled("emitSerial",e,n);const r=Zt(this,e)??new Set,i=ft.get(this),s=[...r],o=[...i];await nl;for(const a of s)r.has(a)&&await a(n);for(const a of o)i.has(a)&&await a(e,n)}onAny(e){return vr(e),this.logIfDebugEnabled("subscribeAny",void 0,void 0),ft.get(this).add(e),wr(this,Vr,{listener:e}),this.offAny.bind(this,e)}anyEvent(){return rl(this)}offAny(e){vr(e),this.logIfDebugEnabled("unsubscribeAny",void 0,void 0),wr(this,Jr,{listener:e}),ft.get(this).delete(e)}clearListeners(e){e=Array.isArray(e)?e:[e];for(const n of e)if(this.logIfDebugEnabled("clear",n,void 0),typeof n=="string"||typeof n=="symbol"||typeof n=="number"){const r=Zt(this,n);r&&r.clear();const i=Ln(this,n);if(i){for(const s of i)s.finish();i.clear()}}else{ft.get(this).clear();for(const[r,i]of Ct.get(this).entries())i.clear(),Ct.get(this).delete(r);for(const[r,i]of ot.get(this).entries()){for(const s of i)s.finish();i.clear(),ot.get(this).delete(r)}}}listenerCount(e){var r,i,s;e=Array.isArray(e)?e:[e];let n=0;for(const o of e){if(typeof o=="string"){n+=ft.get(this).size+(((r=Zt(this,o))==null?void 0:r.size)??0)+(((i=Ln(this,o))==null?void 0:i.size)??0)+(((s=Ln(this))==null?void 0:s.size)??0);continue}typeof o<"u"&&Xt(o),n+=ft.get(this).size;for(const a of Ct.get(this).values())n+=a.size;for(const a of ot.get(this).values())n+=a.size}return n}bindMethods(e,n){if(typeof e!="object"||e===null)throw new TypeError("`target` must be an object");n=il(n);for(const r of n){if(e[r]!==void 0)throw new Error(`The property \`${r}\` already exists on \`target\``);Object.defineProperty(e,r,{enumerable:!1,value:this[r].bind(this)})}}}const sl=Object.getOwnPropertyNames(gt.prototype).filter(t=>t!=="constructor");Object.defineProperty(gt,"listenerAdded",{value:Vr,writable:!1,enumerable:!0,configurable:!1});Object.defineProperty(gt,"listenerRemoved",{value:Jr,writable:!1,enumerable:!0,configurable:!1});const Se={silent:Number.NEGATIVE_INFINITY,fatal:0,error:0,warn:1,log:2,info:3,success:3,fail:3,ready:3,start:3,box:3,debug:4,trace:5,verbose:Number.POSITIVE_INFINITY},ol={silent:{level:-1},fatal:{level:Se.fatal},error:{level:Se.error},warn:{level:Se.warn},log:{level:Se.log},info:{level:Se.info},success:{level:Se.success},fail:{level:Se.fail},ready:{level:Se.info},start:{level:Se.info},box:{level:Se.info},debug:{level:Se.debug},trace:{level:Se.trace},verbose:{level:Se.verbose}};function Ji(t){return t!==null&&typeof t=="object"}function bs(t,e,n=".",r){if(!Ji(e))return bs(t,{},n,r);const i=Object.assign({},e);for(const s in t){if(s==="__proto__"||s==="constructor")continue;const o=t[s];o!=null&&(r&&r(i,s,o,n)||(Array.isArray(o)&&Array.isArray(i[s])?i[s]=[...o,...i[s]]:Ji(o)&&Ji(i[s])?i[s]=bs(o,i[s],(n?`${n}.`:"")+s.toString(),r):i[s]=o))}return i}function kd(t){return(...e)=>e.reduce((n,r)=>bs(n,r,"",t),{})}const xd=kd();function Sd(t){return Object.prototype.toString.call(t)==="[object Object]"}function Ed(t){return!(!Sd(t)||!t.message&&!t.args||t.stack)}let Gi=!1;const al=[];class ue{constructor(e={}){const n=e.types||ol;this.options=xd({...e,defaults:{...e.defaults},level:Ki(e.level,n),reporters:[...e.reporters||[]]},{types:ol,throttle:1e3,throttleMin:5,formatOptions:{date:!0,colors:!1,compact:!0}});for(const r in n){const i={type:r,...this.options.defaults,...n[r]};this[r]=this._wrapLogFn(i),this[r].raw=this._wrapLogFn(i,!0)}this.options.mockFn&&this.mockTypes(),this._lastLog={}}get level(){return this.options.level}set level(e){this.options.level=Ki(e,this.options.types,this.options.level)}prompt(e,n){if(!this.options.prompt)throw new Error("prompt is not supported!");return this.options.prompt(e,n)}create(e){const n=new ue({...this.options,...e});return this._mockFn&&n.mockTypes(this._mockFn),n}withDefaults(e){return this.create({...this.options,defaults:{...this.options.defaults,...e}})}withTag(e){return this.withDefaults({tag:this.options.defaults.tag?this.options.defaults.tag+":"+e:e})}addReporter(e){return this.options.reporters.push(e),this}removeReporter(e){if(e){const n=this.options.reporters.indexOf(e);if(n>=0)return this.options.reporters.splice(n,1)}else this.options.reporters.splice(0);return this}setReporters(e){return this.options.reporters=Array.isArray(e)?e:[e],this}wrapAll(){this.wrapConsole(),this.wrapStd()}restoreAll(){this.restoreConsole(),this.restoreStd()}wrapConsole(){for(const e in this.options.types)console["__"+e]||(console["__"+e]=console[e]),console[e]=this[e].raw}restoreConsole(){for(const e in this.options.types)console["__"+e]&&(console[e]=console["__"+e],delete console["__"+e])}wrapStd(){this._wrapStream(this.options.stdout,"log"),this._wrapStream(this.options.stderr,"log")}_wrapStream(e,n){e&&(e.__write||(e.__write=e.write),e.write=r=>{this[n].raw(String(r).trim())})}restoreStd(){this._restoreStream(this.options.stdout),this._restoreStream(this.options.stderr)}_restoreStream(e){e&&e.__write&&(e.write=e.__write,delete e.__write)}pauseLogs(){Gi=!0}resumeLogs(){Gi=!1;const e=al.splice(0);for(const n of e)n[0]._logFn(n[1],n[2])}mockTypes(e){const n=e||this.options.mockFn;if(this._mockFn=n,typeof n=="function")for(const r in this.options.types)this[r]=n(r,this.options.types[r])||this[r],this[r].raw=this[r]}_wrapLogFn(e,n){return(...r)=>{if(Gi){al.push([this,e,r,n]);return}return this._logFn(e,r,n)}}_logFn(e,n,r){if((e.level||0)>this.level)return!1;const i={date:new Date,args:[],...e,level:Ki(e.level,this.options.types)};!r&&n.length===1&&Ed(n[0])?Object.assign(i,n[0]):i.args=[...n],i.message&&(i.args.unshift(i.message),delete i.message),i.additional&&(Array.isArray(i.additional)||(i.additional=i.additional.split(`
`)),i.args.push(`
`+i.additional.join(`
`)),delete i.additional),i.type=typeof i.type=="string"?i.type.toLowerCase():"log",i.tag=typeof i.tag=="string"?i.tag:"";const s=(a=!1)=>{const l=(this._lastLog.count||0)-this.options.throttleMin;if(this._lastLog.object&&l>0){const u=[...this._lastLog.object.args];l>1&&u.push(`(repeated ${l} times)`),this._log({...this._lastLog.object,args:u}),this._lastLog.count=1}a&&(this._lastLog.object=i,this._log(i))};clearTimeout(this._lastLog.timeout);const o=this._lastLog.time&&i.date?i.date.getTime()-this._lastLog.time.getTime():0;if(this._lastLog.time=i.date,o<this.options.throttle)try{const a=JSON.stringify([i.type,i.tag,i.args]),l=this._lastLog.serialized===a;if(this._lastLog.serialized=a,l&&(this._lastLog.count=(this._lastLog.count||0)+1,this._lastLog.count>this.options.throttleMin)){this._lastLog.timeout=setTimeout(s,this.options.throttle);return}}catch{}s(!0)}_log(e){for(const n of this.options.reporters)n.log(e,{options:this.options})}}function Ki(t,e={},n=3){return t===void 0?n:typeof t=="number"?t:e[t]&&e[t].level!==void 0?e[t].level:n}ue.prototype.add=ue.prototype.addReporter;ue.prototype.remove=ue.prototype.removeReporter;ue.prototype.clear=ue.prototype.removeReporter;ue.prototype.withScope=ue.prototype.withTag;ue.prototype.mock=ue.prototype.mockTypes;ue.prototype.pause=ue.prototype.pauseLogs;ue.prototype.resume=ue.prototype.resumeLogs;function Cd(t={}){return new ue(t)}class Ad{constructor(e){this.options={...e},this.defaultColor="#7f8c8d",this.levelColorMap={0:"#c0392b",1:"#f39c12",3:"#00BCD4"},this.typeColorMap={success:"#2ecc71"}}_getLogFn(e){return e<1?console.__error||console.error:e===1?console.__warn||console.warn:console.__log||console.log}log(e){const n=this._getLogFn(e.level),r=e.type==="log"?"":e.type,i=e.tag||"",o=`
      background: ${this.typeColorMap[e.type]||this.levelColorMap[e.level]||this.defaultColor};
      border-radius: 0.5em;
      color: white;
      font-weight: bold;
      padding: 2px 0.5em;
    `,a=`%c${[i,r].filter(Boolean).join(":")}`;typeof e.args[0]=="string"?n(`${a}%c ${e.args[0]}`,o,"",...e.args.slice(1)):n(a,o,...e.args)}}function Od(t={}){return Cd({reporters:t.reporters||[new Ad({})],prompt(n,r={}){return r.type==="confirm"?Promise.resolve(confirm(n)):Promise.resolve(prompt(n))},...t})}const le=Od();var Dn=(t=>(t[t.silent=Number.NEGATIVE_INFINITY]="silent",t[t.always=0]="always",t[t.fatal=0]="fatal",t[t.warning=1]="warning",t[t.normal=2]="normal",t[t.info=3]="info",t[t.debug=4]="debug",t[t.trace=5]="trace",t[t.verbose=Number.POSITIVE_INFINITY]="verbose",t))(Dn||{});const ll=2,tn=class tn{constructor(){if(this._status_priority=le.create({level:Dn.verbose}),this._void=e=>{},this.__log=e=>{le.log(e)},this._log=this._void,tn._instance!==void 0)throw new Error("Log instance duplicate error");le.level=ll,this._customLevel=new Map,tn._instance=this}get level(){return le.level}set level(e){this._status_priority.level=e<0?e:Dn.verbose,this._log=e>=3?this.__log:this._void,le.level=e,e<0&&this._customLevel.forEach(n=>{Dn.silent})}get warn(){return le.warn}get error(){return le.error}get info(){return le.info}get debug(){return le.debug}get verbose(){return le.verbose}get ready(){return le.ready}get success(){return le.success}get trace(){return le.trace}get log(){return this._log}get assert(){return console.assert}status_start(e){this._status_priority.start(e)}status_success(e){this._status_priority.success(e)}status_fail(e){this._status_priority.fail(e)}access(e){this._status_priority.trace(e)}createWithTag(e){return le.withTag(e)}wrapConsoleLogger(){le.wrapConsole()}restoreConsoleLogger(){le.restoreConsole()}setCustomLevel(e,n){this._customLevel.set(e,n)}getCustomLevel(e){return this._customLevel.get(e)??ll}addConsolaReporter(e){le.addReporter(e),this._status_priority.addReporter(e)}removeConsolaReporter(e){le.removeReporter(e),this._status_priority.removeReporter(e)}};tn._instance=new tn;let ks=tn;const Q=ks._instance;function ok(){globalThis&&(globalThis.omnilog=Q)}class mi{constructor(e){this.app=e,this.children=new Map;const n=Q.createWithTag("Services");this.info=n.info,this.success=n.success,this.debug=n.debug,this.verbose=n.verbose,this.warn=n.warn,this.error=n.error}register(e,n,r){throw new Error("Manager register method not implemented")}async load(){var n;for(const[r,i]of this.children)this.verbose(`${r} load`),await((n=i.load)==null?void 0:n.call(i));return!0}async start(){var e;for(const[n,r]of this.children)Q.log(`child ${n} start`),await((e=r.start)==null?void 0:e.call(r));return Q.log("All children started"),!0}async stop(){var e;this.debug("stopping children...");for(const n of Array.from(this.children.values()).reverse())this.verbose(`${n.id} stop`),await((e=n.stop)==null?void 0:e.call(n));return this.success("children stopped"),!0}get(e){return this.children.get(e)}has(e){return this.children.has(e)}}class Mc{constructor(e,n,r){this.id=e,this.manager=n,this.app=n.app,this.config=r;const i=Q.createWithTag(e);this.info=i.info,this.success=i.success,this.debug=i.debug,this.verbose=i.verbose,this.warn=i.warn,this.error=i.error,this.trace=i.trace}async emitGlobalEvent(e,n){this.verbose(`[Global.EMIT] ${this.id} emits event '${e}'`),await this.app.events.emit(e,n)}async emit(e,n){this.verbose(`[SERVICE.EMIT] ${this.id} emits event '${e}'`),await this.app.events.emit(`${this.id}.${e}`,n)}subscribeToServiceEvent(e,n,r){const i=e.id??e;i===this.id&&this.error(`[SERVICE.SUB] ${this.id} subscribed to self event '${n}'`),this.app.services.has(i)||this.error(`[SERVICE.SUB] ${this.id} subscribed to non-existent service event '${n}' on ${i}`),this.info(`[SERVICE.SUB Service] ${this.id} subscribed to service event '${n}' on ${i}.`),this.app.events.on(`${i}.${n}`,r)}subscribeToGlobalEvent(e,n){this.debug(`[GLOBAL.SUB] ${this.id} subscribed to GlobalEvent ${e}`),this.app.events.on(e,n)}unsubscribeFromGlobalEvent(e,n){this.verbose(`[GLOBAL.UNSUBSUB] ${this.id} unsubscribed from GlobalEvent ${e}`),this.app.events.off(e,n)}async registerAPI({method:e,url:n,handler:r,insecure:i,authStrategy:s,schema:o,websocket:a}){if(this.debug("registerAPI",e,n),!n)return this.error("registerAPI: url is required"),!1;if(r==null||typeof r!="function")return this.error("registerAPI: handler is required and must be a function",e,n),!1;await this.emitGlobalEvent("registerAPI",{method:e,url:n,handler:r,insecure:i,authStrategy:s,schema:o,websocket:a})}}class cl extends mi{constructor(e){super(e),Object.defineProperty(this,"integrations",{get:()=>this.children}),this._integrations=[]}register(e,n){this.verbose(`pre-registering ${n.id} integration`),this._integrations.push([e,n])}async load(){var n;for(const[r,i]of this._integrations){this.verbose(`registering integration ${i.id}...`);const s=new r(i.id,this,i);this.children.set(i.id,s),(n=s.create)==null||n.call(s)}this.debug("loading integrations...");const e=await super.load();return this.success("integrations loaded"),e}async start(){return this.debug("starting integrations..."),await super.start(),this.success("integrations started"),!0}}class Td extends mi{constructor(e){super(e),Object.defineProperty(this,"services",{get:()=>this.children})}register(e,n,r){var s;this.debug(`registering ${n.id} service`);let i=new e(n.id,this,n);return r&&typeof r=="function"&&(i=r(i)),this.children.set(n.id,i),(s=i.create)==null||s.call(i),i}async load(){return this.debug("loading services..."),await super.load()?(this.success("services loaded"),!0):(this.error("failed to load services"),!1)}async start(){return this.debug("starting services..."),await super.start(),this.success("services started"),!0}}const Lc=-1,gi=0,Kr=1,Yr=2,Ao=3,Oo=4,To=5,Ro=6,Dc=7,Fc=8,ul=typeof self=="object"?self:globalThis,Rd=(t,e)=>{const n=(i,s)=>(t.set(s,i),i),r=i=>{if(t.has(i))return t.get(i);const[s,o]=e[i];switch(s){case gi:case Lc:return n(o,i);case Kr:{const a=n([],i);for(const l of o)a.push(r(l));return a}case Yr:{const a=n({},i);for(const[l,u]of o)a[r(l)]=r(u);return a}case Ao:return n(new Date(o),i);case Oo:{const{source:a,flags:l}=o;return n(new RegExp(a,l),i)}case To:{const a=n(new Map,i);for(const[l,u]of o)a.set(r(l),r(u));return a}case Ro:{const a=n(new Set,i);for(const l of o)a.add(r(l));return a}case Dc:{const{name:a,message:l}=o;return n(new ul[a](l),i)}case Fc:return n(BigInt(o),i);case"BigInt":return n(Object(BigInt(o)),i)}return n(new ul[s](o),i)};return r},Id=t=>Rd(new Map,t)(0),Qt="",{toString:Pd}={},{keys:Nd}=Object,bn=t=>{const e=typeof t;if(e!=="object"||!t)return[gi,e];const n=Pd.call(t).slice(8,-1);switch(n){case"Array":return[Kr,Qt];case"Object":return[Yr,Qt];case"Date":return[Ao,Qt];case"RegExp":return[Oo,Qt];case"Map":return[To,Qt];case"Set":return[Ro,Qt]}return n.includes("Array")?[Kr,n]:n.includes("Error")?[Dc,n]:[Yr,n]},_r=([t,e])=>t===gi&&(e==="function"||e==="symbol"),Md=(t,e,n,r)=>{const i=(o,a)=>{const l=r.push(o)-1;return n.set(a,l),l},s=o=>{if(n.has(o))return n.get(o);let[a,l]=bn(o);switch(a){case gi:{let c=o;switch(l){case"bigint":a=Fc,c=o.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+l);c=null;break;case"undefined":return i([Lc],o)}return i([a,c],o)}case Kr:{if(l)return i([l,[...o]],o);const c=[],d=i([a,c],o);for(const h of o)c.push(s(h));return d}case Yr:{if(l)switch(l){case"BigInt":return i([l,o.toString()],o);case"Boolean":case"Number":case"String":return i([l,o.valueOf()],o)}if(e&&"toJSON"in o)return s(o.toJSON());const c=[],d=i([a,c],o);for(const h of Nd(o))(t||!_r(bn(o[h])))&&c.push([s(h),s(o[h])]);return d}case Ao:return i([a,o.toISOString()],o);case Oo:{const{source:c,flags:d}=o;return i([a,{source:c,flags:d}],o)}case To:{const c=[],d=i([a,c],o);for(const[h,p]of o)(t||!(_r(bn(h))||_r(bn(p))))&&c.push([s(h),s(p)]);return d}case Ro:{const c=[],d=i([a,c],o);for(const h of o)(t||!_r(bn(h)))&&c.push(s(h));return d}}const{message:u}=o;return i([a,{name:l,message:u}],o)};return s},Ld=(t,{json:e,lossy:n}={})=>{const r=[];return Md(!(e||n),!!e,new Map,r)(t),r};/*! (c) Andrea Giammarchi - ISC */const{parse:Dd,stringify:Fd}=JSON,Bd={json:!0,lossy:!0},$d=t=>Id(Dd(t)),Ud=t=>Fd(Ld(t,Bd));class Bc{constructor(e){this.settings=new Map,this.scope=e}bindStorage(e){this.settings=e}add(e){return this.settings.has(e.key)?(Q.debug(`Setting ${e.key} already exists, doing nothing...`),this):(this.settings.set(e.key,e),this)}get(e){return this.settings.get(e)}update(e,n){const r=this.get(e);r&&(r.value=n,this.settings.set(e,r))}reset(e){const n=this.get(e);n&&(n.value=n.defaultValue,this.settings.set(e,n))}resetAll(){if(this.settings)for(const e of this.settings.values())e.value=e.defaultValue,this.settings.set(e.key,e)}getAll(){return Array.from(this.settings.values())}delete(e){this.settings.delete(e)}}var $c=(t=>(t[t.CREATED=0]="CREATED",t[t.CONFIGURED=1]="CONFIGURED",t[t.LOADED=2]="LOADED",t[t.STARTED=3]="STARTED",t[t.STOPPED=4]="STOPPED",t))($c||{});const Ma=class Ma{constructor(e,n,r){this.state=0,this.id=e,r??(r={integrationsManagerType:cl}),this.config=n,this.version=n.version,this.logger=Q,this.services=new Td(this),this.integrations=new(r.integrationsManagerType||cl)(this);const i=this.logger.createWithTag(e);this.settings=new Bc,this.info=i.info,this.success=i.success,this.debug=i.debug,this.error=i.error,this.verbose=i.verbose,this.warn=i.warn,this.events=new gt(Q.getCustomLevel("emittery")>Dn.silent?{debug:{name:"app.events",enabled:!0}}:void 0)}use(e,n,r,i){if(this.verbose("[APP.USE] use",e.name),r==="service"||e.name.endsWith("Service")){const s=e;this.services.register(s,n,i)}else if(r==="integration"||e.name.endsWith("Integration")){const s=e;this.integrations.register(s,n)}else this.warn(`[APP.USE] Unknown middleware type ${e.name}`);return this}async emit(e,n){this.debug("[APP.EMIT Global] emit",e),await this.events.emit(e,n)}async load(){if(this.state>=2)return Q.warn("Cannot load more than once, ignoring call"),!0;const e=this;if(e.onConfigure!=null&&await e.onConfigure(),this.state=1,!await this.services.load())throw new Error("Failed to load services, see console for details");return await this.integrations.load(),e.onLoad!=null&&await e.onLoad(),await this.emit("loaded",{}),this.success("app loaded"),this.state=2,!0}async start(){if(this.state===3)return Q.warn("Cannot start more than once, ignoring call"),!0;const e=this;return await this.services.start(),await this.integrations.start(),e.onStart!=null&&await e.onStart(),this.success("app started"),this.state=3,await this.emit("started",{}),!0}async stop(){return this.info("app stopping"),await this.integrations.stop(),await this.services.stop(),await this.emit("stopped",{}),this.success("app stopped"),this.state=4,!0}subscribeToGlobalEvent(e,n){this.info(`[APP.SUB Global] ${this.id} subscribed to GlobalEvent ${e}`),this.events.on(e,n)}subscribeToServiceEvent(e,n,r){const i=e.id??e;this.services.has(i)||this.warn(`[SERVICE.SUB Service] ${this.id} subscribed to unknown service '${i}'. This can be ok in some cases, but usually indicates a bug.`),this.info(`[SERVICE.SUB App] ${this.id} subscribed to service event '${n}' on ${i}`),this.events.on(`${i}.${n}`,r)}stringify(e){return Ud(e)}parse(e){return $d(e)}};Ma.STATES=$c;let xs=Ma;class Io extends Mc{constructor(e,n,r){super(e,n,r)}}class Hd extends Mc{constructor(e,n,r){super(e,n,r)}async emit(e,...n){this.verbose(`[Extension.EMIT] ${this.id} emits event '${e}'`),await this.app.emit(`${this.id}.${e}`,n)}get extensionConfig(){return this.config}}class zd extends mi{constructor(e){super(e)}}class yi{get blockIds(){var e;return Array.from(new Set(Object.values(((e=this==null?void 0:this.rete)==null?void 0:e.nodes)??{}).map(n=>n.name))).sort()}constructor(e,n){this.id=e??"",this.setMeta(n),this.setRete(null),this.setAPI(null),this.setUI(null)}setMeta(e){var n,r,i,s,o;return e=JSON.parse(JSON.stringify(e??{})),e=e??{name:"New Recipe",description:"No description.",pictureUrl:"omni.png",author:"Anonymous"},this.meta=e,(n=this.meta).updated??(n.updated=Date.now()),(r=this.meta).created??(r.created=Date.now()),(i=this.meta).tags??(i.tags=[]),(s=this.meta).author||(s.author="Anonymous"),(o=this.meta).help||(o.help=""),this.meta.name=yr(this.meta.name,{allowedTags:[],allowedAttributes:{}}),this.meta.description=yr(this.meta.description,{allowedTags:[],allowedAttributes:{}}),this.meta.author=yr(this.meta.author,{allowedTags:[],allowedAttributes:{}}),this.meta.help=yr(this.meta.help,{allowedTags:[],allowedAttributes:{}}),this}setRete(e){return this.rete=e,this}setAPI(e){return this.api=e??{fields:{}},this}setUI(e){return this.ui=e??{},this}get isBlank(){var e;return(((e=this==null?void 0:this.rete)==null?void 0:e.nodes)??[]).length===0}toJSON(){return{id:this.id,meta:this.meta,rete:this.rete,api:this.api,ui:this.ui,blockIds:this.blockIds}}static fromJSON(e){const n=new yi(e.id);return n.setMeta(e.meta),e.rete.nodes=JSON.parse(JSON.stringify(e.rete.nodes).replace(/omni-extension-replicate:/g,"omni-core-replicate:")),e.rete.nodes=JSON.parse(JSON.stringify(e.rete.nodes).replace(/omni-extension-formio:/g,"omni-core-formio:")),n.setRete(e.rete),n.setAPI(e.api),n.setUI(e.ui),n}}const li=class li extends yi{constructor(e,n,r){super(e,r),this._id=`wf:${e}`,this.owner=n.owner,this.org=n.org}toJSON(){return{...super.toJSON(),_id:this._id,_rev:this._rev,owner:this.owner,org:this.org}}static fromJSON(e){var i;let n=((i=e._id)==null?void 0:i.replace("wf:",""))||e.id;e.id&&e.id.length>16&&n.startsWith(e.id)&&(n=e.id);const r=new li(n,{owner:e.owner||e.meta.owner,org:e.org});return e.rete=JSON.parse(JSON.stringify(e.rete).replace(/omni-extension-replicate:/g,"omni-core-replicate:")),e.rete=JSON.parse(JSON.stringify(e.rete).replace(/omni-extension-formio:/g,"omni-core-formio:")),r.setMeta(e.meta),r.setRete(e.rete),r.setAPI(e.api),r.setUI(e.ui),e._rev&&(r._rev=e._rev),r}};li.modelName="Workflow";let hl=li;function Uc(t,e){return function(){return t.apply(e,arguments)}}const{toString:jd}=Object.prototype,{getPrototypeOf:Po}=Object,vi=(t=>e=>{const n=jd.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Ze=t=>(t=t.toLowerCase(),e=>vi(e)===t),wi=t=>e=>typeof e===t,{isArray:un}=Array,Wn=wi("undefined");function Wd(t){return t!==null&&!Wn(t)&&t.constructor!==null&&!Wn(t.constructor)&&Ie(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const Hc=Ze("ArrayBuffer");function qd(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&Hc(t.buffer),e}const Vd=wi("string"),Ie=wi("function"),zc=wi("number"),_i=t=>t!==null&&typeof t=="object",Jd=t=>t===!0||t===!1,Mr=t=>{if(vi(t)!=="object")return!1;const e=Po(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Gd=Ze("Date"),Kd=Ze("File"),Yd=Ze("Blob"),Xd=Ze("FileList"),Zd=t=>_i(t)&&Ie(t.pipe),Qd=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Ie(t.append)&&((e=vi(t))==="formdata"||e==="object"&&Ie(t.toString)&&t.toString()==="[object FormData]"))},ep=Ze("URLSearchParams"),tp=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Zn(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,i;if(typeof t!="object"&&(t=[t]),un(t))for(r=0,i=t.length;r<i;r++)e.call(null,t[r],r,t);else{const s=n?Object.getOwnPropertyNames(t):Object.keys(t),o=s.length;let a;for(r=0;r<o;r++)a=s[r],e.call(null,t[a],a,t)}}function jc(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,i;for(;r-- >0;)if(i=n[r],e===i.toLowerCase())return i;return null}const Wc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,qc=t=>!Wn(t)&&t!==Wc;function Ss(){const{caseless:t}=qc(this)&&this||{},e={},n=(r,i)=>{const s=t&&jc(e,i)||i;Mr(e[s])&&Mr(r)?e[s]=Ss(e[s],r):Mr(r)?e[s]=Ss({},r):un(r)?e[s]=r.slice():e[s]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Zn(arguments[r],n);return e}const np=(t,e,n,{allOwnKeys:r}={})=>(Zn(e,(i,s)=>{n&&Ie(i)?t[s]=Uc(i,n):t[s]=i},{allOwnKeys:r}),t),rp=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),ip=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},sp=(t,e,n,r)=>{let i,s,o;const a={};if(e=e||{},t==null)return e;do{for(i=Object.getOwnPropertyNames(t),s=i.length;s-- >0;)o=i[s],(!r||r(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=n!==!1&&Po(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},op=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},ap=t=>{if(!t)return null;if(un(t))return t;let e=t.length;if(!zc(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},lp=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&Po(Uint8Array)),cp=(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let i;for(;(i=r.next())&&!i.done;){const s=i.value;e.call(t,s[0],s[1])}},up=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},hp=Ze("HTMLFormElement"),fp=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),fl=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),dp=Ze("RegExp"),Vc=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};Zn(n,(i,s)=>{let o;(o=e(i,s,t))!==!1&&(r[s]=o||i)}),Object.defineProperties(t,r)},pp=t=>{Vc(t,(e,n)=>{if(Ie(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(Ie(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},mp=(t,e)=>{const n={},r=i=>{i.forEach(s=>{n[s]=!0})};return un(t)?r(t):r(String(t).split(e)),n},gp=()=>{},yp=(t,e)=>(t=+t,Number.isFinite(t)?t:e),Yi="abcdefghijklmnopqrstuvwxyz",dl="0123456789",Jc={DIGIT:dl,ALPHA:Yi,ALPHA_DIGIT:Yi+Yi.toUpperCase()+dl},vp=(t=16,e=Jc.ALPHA_DIGIT)=>{let n="";const{length:r}=e;for(;t--;)n+=e[Math.random()*r|0];return n};function wp(t){return!!(t&&Ie(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const _p=t=>{const e=new Array(10),n=(r,i)=>{if(_i(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[i]=r;const s=un(r)?[]:{};return Zn(r,(o,a)=>{const l=n(o,i+1);!Wn(l)&&(s[a]=l)}),e[i]=void 0,s}}return r};return n(t,0)},bp=Ze("AsyncFunction"),kp=t=>t&&(_i(t)||Ie(t))&&Ie(t.then)&&Ie(t.catch),C={isArray:un,isArrayBuffer:Hc,isBuffer:Wd,isFormData:Qd,isArrayBufferView:qd,isString:Vd,isNumber:zc,isBoolean:Jd,isObject:_i,isPlainObject:Mr,isUndefined:Wn,isDate:Gd,isFile:Kd,isBlob:Yd,isRegExp:dp,isFunction:Ie,isStream:Zd,isURLSearchParams:ep,isTypedArray:lp,isFileList:Xd,forEach:Zn,merge:Ss,extend:np,trim:tp,stripBOM:rp,inherits:ip,toFlatObject:sp,kindOf:vi,kindOfTest:Ze,endsWith:op,toArray:ap,forEachEntry:cp,matchAll:up,isHTMLForm:hp,hasOwnProperty:fl,hasOwnProp:fl,reduceDescriptors:Vc,freezeMethods:pp,toObjectSet:mp,toCamelCase:fp,noop:gp,toFiniteNumber:yp,findKey:jc,global:Wc,isContextDefined:qc,ALPHABET:Jc,generateString:vp,isSpecCompliantForm:wp,toJSONObject:_p,isAsyncFn:bp,isThenable:kp};function H(t,e,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i)}C.inherits(H,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:C.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Gc=H.prototype,Kc={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Kc[t]={value:t}});Object.defineProperties(H,Kc);Object.defineProperty(Gc,"isAxiosError",{value:!0});H.from=(t,e,n,r,i,s)=>{const o=Object.create(Gc);return C.toFlatObject(t,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),H.call(o,t.message,e,n,r,i),o.cause=t,o.name=t.name,s&&Object.assign(o,s),o};const xp=null;function Es(t){return C.isPlainObject(t)||C.isArray(t)}function Yc(t){return C.endsWith(t,"[]")?t.slice(0,-2):t}function pl(t,e,n){return t?t.concat(e).map(function(i,s){return i=Yc(i),!n&&s?"["+i+"]":i}).join(n?".":""):e}function Sp(t){return C.isArray(t)&&!t.some(Es)}const Ep=C.toFlatObject(C,{},null,function(e){return/^is[A-Z]/.test(e)});function bi(t,e,n){if(!C.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=C.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,g){return!C.isUndefined(g[m])});const r=n.metaTokens,i=n.visitor||c,s=n.dots,o=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&C.isSpecCompliantForm(e);if(!C.isFunction(i))throw new TypeError("visitor must be a function");function u(f){if(f===null)return"";if(C.isDate(f))return f.toISOString();if(!l&&C.isBlob(f))throw new H("Blob is not supported. Use a Buffer instead.");return C.isArrayBuffer(f)||C.isTypedArray(f)?l&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function c(f,m,g){let w=f;if(f&&!g&&typeof f=="object"){if(C.endsWith(m,"{}"))m=r?m:m.slice(0,-2),f=JSON.stringify(f);else if(C.isArray(f)&&Sp(f)||(C.isFileList(f)||C.endsWith(m,"[]"))&&(w=C.toArray(f)))return m=Yc(m),w.forEach(function(b,y){!(C.isUndefined(b)||b===null)&&e.append(o===!0?pl([m],y,s):o===null?m:m+"[]",u(b))}),!1}return Es(f)?!0:(e.append(pl(g,m,s),u(f)),!1)}const d=[],h=Object.assign(Ep,{defaultVisitor:c,convertValue:u,isVisitable:Es});function p(f,m){if(!C.isUndefined(f)){if(d.indexOf(f)!==-1)throw Error("Circular reference detected in "+m.join("."));d.push(f),C.forEach(f,function(w,v){(!(C.isUndefined(w)||w===null)&&i.call(e,w,C.isString(v)?v.trim():v,m,h))===!0&&p(w,m?m.concat(v):[v])}),d.pop()}}if(!C.isObject(t))throw new TypeError("data must be an object");return p(t),e}function ml(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function No(t,e){this._pairs=[],t&&bi(t,this,e)}const Xc=No.prototype;Xc.append=function(e,n){this._pairs.push([e,n])};Xc.toString=function(e){const n=e?function(r){return e.call(this,r,ml)}:ml;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function Cp(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Zc(t,e,n){if(!e)return t;const r=n&&n.encode||Cp,i=n&&n.serialize;let s;if(i?s=i(e,n):s=C.isURLSearchParams(e)?e.toString():new No(e,n).toString(r),s){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t}class Ap{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){C.forEach(this.handlers,function(r){r!==null&&e(r)})}}const gl=Ap,Qc={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Op=typeof URLSearchParams<"u"?URLSearchParams:No,Tp=typeof FormData<"u"?FormData:null,Rp=typeof Blob<"u"?Blob:null,Ip={isBrowser:!0,classes:{URLSearchParams:Op,FormData:Tp,Blob:Rp},protocols:["http","https","file","blob","url","data"]},eu=typeof window<"u"&&typeof document<"u",Pp=(t=>eu&&["ReactNative","NativeScript","NS"].indexOf(t)<0)(typeof navigator<"u"&&navigator.product),Np=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Mp=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:eu,hasStandardBrowserEnv:Pp,hasStandardBrowserWebWorkerEnv:Np},Symbol.toStringTag,{value:"Module"})),Ge={...Mp,...Ip};function Lp(t,e){return bi(t,new Ge.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,s){return Ge.isNode&&C.isBuffer(n)?(this.append(r,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},e))}function Dp(t){return C.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Fp(t){const e={},n=Object.keys(t);let r;const i=n.length;let s;for(r=0;r<i;r++)s=n[r],e[s]=t[s];return e}function tu(t){function e(n,r,i,s){let o=n[s++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=s>=n.length;return o=!o&&C.isArray(i)?i.length:o,l?(C.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!a):((!i[o]||!C.isObject(i[o]))&&(i[o]=[]),e(n,r,i[o],s)&&C.isArray(i[o])&&(i[o]=Fp(i[o])),!a)}if(C.isFormData(t)&&C.isFunction(t.entries)){const n={};return C.forEachEntry(t,(r,i)=>{e(Dp(r),i,n,0)}),n}return null}function Bp(t,e,n){if(C.isString(t))try{return(e||JSON.parse)(t),C.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const Mo={transitional:Qc,adapter:["xhr","http"],transformRequest:[function(e,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,s=C.isObject(e);if(s&&C.isHTMLForm(e)&&(e=new FormData(e)),C.isFormData(e))return i?JSON.stringify(tu(e)):e;if(C.isArrayBuffer(e)||C.isBuffer(e)||C.isStream(e)||C.isFile(e)||C.isBlob(e))return e;if(C.isArrayBufferView(e))return e.buffer;if(C.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Lp(e,this.formSerializer).toString();if((a=C.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return bi(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||i?(n.setContentType("application/json",!1),Bp(e)):e}],transformResponse:[function(e){const n=this.transitional||Mo.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(e&&C.isString(e)&&(r&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?H.from(a,H.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ge.classes.FormData,Blob:Ge.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};C.forEach(["delete","get","head","post","put","patch"],t=>{Mo.headers[t]={}});const Lo=Mo,$p=C.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Up=t=>{const e={};let n,r,i;return t&&t.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!n||e[n]&&$p[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},yl=Symbol("internals");function kn(t){return t&&String(t).trim().toLowerCase()}function Lr(t){return t===!1||t==null?t:C.isArray(t)?t.map(Lr):String(t)}function Hp(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const zp=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Xi(t,e,n,r,i){if(C.isFunction(r))return r.call(this,e,n);if(i&&(e=n),!!C.isString(e)){if(C.isString(r))return e.indexOf(r)!==-1;if(C.isRegExp(r))return r.test(e)}}function jp(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function Wp(t,e){const n=C.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(i,s,o){return this[r].call(this,e,i,s,o)},configurable:!0})})}class ki{constructor(e){e&&this.set(e)}set(e,n,r){const i=this;function s(a,l,u){const c=kn(l);if(!c)throw new Error("header name must be a non-empty string");const d=C.findKey(i,c);(!d||i[d]===void 0||u===!0||u===void 0&&i[d]!==!1)&&(i[d||l]=Lr(a))}const o=(a,l)=>C.forEach(a,(u,c)=>s(u,c,l));return C.isPlainObject(e)||e instanceof this.constructor?o(e,n):C.isString(e)&&(e=e.trim())&&!zp(e)?o(Up(e),n):e!=null&&s(n,e,r),this}get(e,n){if(e=kn(e),e){const r=C.findKey(this,e);if(r){const i=this[r];if(!n)return i;if(n===!0)return Hp(i);if(C.isFunction(n))return n.call(this,i,r);if(C.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=kn(e),e){const r=C.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||Xi(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let i=!1;function s(o){if(o=kn(o),o){const a=C.findKey(r,o);a&&(!n||Xi(r,r[a],a,n))&&(delete r[a],i=!0)}}return C.isArray(e)?e.forEach(s):s(e),i}clear(e){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const s=n[r];(!e||Xi(this,this[s],s,e,!0))&&(delete this[s],i=!0)}return i}normalize(e){const n=this,r={};return C.forEach(this,(i,s)=>{const o=C.findKey(r,s);if(o){n[o]=Lr(i),delete n[s];return}const a=e?jp(s):String(s).trim();a!==s&&delete n[s],n[a]=Lr(i),r[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return C.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=e&&C.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(i=>r.set(i)),r}static accessor(e){const r=(this[yl]=this[yl]={accessors:{}}).accessors,i=this.prototype;function s(o){const a=kn(o);r[a]||(Wp(i,o),r[a]=!0)}return C.isArray(e)?e.forEach(s):s(e),this}}ki.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);C.reduceDescriptors(ki.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});C.freezeMethods(ki);const at=ki;function Zi(t,e){const n=this||Lo,r=e||n,i=at.from(r.headers);let s=r.data;return C.forEach(t,function(a){s=a.call(n,s,i.normalize(),e?e.status:void 0)}),i.normalize(),s}function nu(t){return!!(t&&t.__CANCEL__)}function Qn(t,e,n){H.call(this,t??"canceled",H.ERR_CANCELED,e,n),this.name="CanceledError"}C.inherits(Qn,H,{__CANCEL__:!0});function qp(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new H("Request failed with status code "+n.status,[H.ERR_BAD_REQUEST,H.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}const Vp=Ge.hasStandardBrowserEnv?{write(t,e,n,r,i,s){const o=[t+"="+encodeURIComponent(e)];C.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),C.isString(r)&&o.push("path="+r),C.isString(i)&&o.push("domain="+i),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Jp(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Gp(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function ru(t,e){return t&&!Jp(e)?Gp(t,e):e}const Kp=Ge.hasStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let r;function i(s){let o=s;return e&&(n.setAttribute("href",o),o=n.href),n.setAttribute("href",o),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=i(window.location.href),function(o){const a=C.isString(o)?i(o):o;return a.protocol===r.protocol&&a.host===r.host}}():function(){return function(){return!0}}();function Yp(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function Xp(t,e){t=t||10;const n=new Array(t),r=new Array(t);let i=0,s=0,o;return e=e!==void 0?e:1e3,function(l){const u=Date.now(),c=r[s];o||(o=u),n[i]=l,r[i]=u;let d=s,h=0;for(;d!==i;)h+=n[d++],d=d%t;if(i=(i+1)%t,i===s&&(s=(s+1)%t),u-o<e)return;const p=c&&u-c;return p?Math.round(h*1e3/p):void 0}}function vl(t,e){let n=0;const r=Xp(50,250);return i=>{const s=i.loaded,o=i.lengthComputable?i.total:void 0,a=s-n,l=r(a),u=s<=o;n=s;const c={loaded:s,total:o,progress:o?s/o:void 0,bytes:a,rate:l||void 0,estimated:l&&o&&u?(o-s)/l:void 0,event:i};c[e?"download":"upload"]=!0,t(c)}}const Zp=typeof XMLHttpRequest<"u",Qp=Zp&&function(t){return new Promise(function(n,r){let i=t.data;const s=at.from(t.headers).normalize();let{responseType:o,withXSRFToken:a}=t,l;function u(){t.cancelToken&&t.cancelToken.unsubscribe(l),t.signal&&t.signal.removeEventListener("abort",l)}let c;if(C.isFormData(i)){if(Ge.hasStandardBrowserEnv||Ge.hasStandardBrowserWebWorkerEnv)s.setContentType(!1);else if((c=s.getContentType())!==!1){const[m,...g]=c?c.split(";").map(w=>w.trim()).filter(Boolean):[];s.setContentType([m||"multipart/form-data",...g].join("; "))}}let d=new XMLHttpRequest;if(t.auth){const m=t.auth.username||"",g=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";s.set("Authorization","Basic "+btoa(m+":"+g))}const h=ru(t.baseURL,t.url);d.open(t.method.toUpperCase(),Zc(h,t.params,t.paramsSerializer),!0),d.timeout=t.timeout;function p(){if(!d)return;const m=at.from("getAllResponseHeaders"in d&&d.getAllResponseHeaders()),w={data:!o||o==="text"||o==="json"?d.responseText:d.response,status:d.status,statusText:d.statusText,headers:m,config:t,request:d};qp(function(b){n(b),u()},function(b){r(b),u()},w),d=null}if("onloadend"in d?d.onloadend=p:d.onreadystatechange=function(){!d||d.readyState!==4||d.status===0&&!(d.responseURL&&d.responseURL.indexOf("file:")===0)||setTimeout(p)},d.onabort=function(){d&&(r(new H("Request aborted",H.ECONNABORTED,t,d)),d=null)},d.onerror=function(){r(new H("Network Error",H.ERR_NETWORK,t,d)),d=null},d.ontimeout=function(){let g=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const w=t.transitional||Qc;t.timeoutErrorMessage&&(g=t.timeoutErrorMessage),r(new H(g,w.clarifyTimeoutError?H.ETIMEDOUT:H.ECONNABORTED,t,d)),d=null},Ge.hasStandardBrowserEnv&&(a&&C.isFunction(a)&&(a=a(t)),a||a!==!1&&Kp(h))){const m=t.xsrfHeaderName&&t.xsrfCookieName&&Vp.read(t.xsrfCookieName);m&&s.set(t.xsrfHeaderName,m)}i===void 0&&s.setContentType(null),"setRequestHeader"in d&&C.forEach(s.toJSON(),function(g,w){d.setRequestHeader(w,g)}),C.isUndefined(t.withCredentials)||(d.withCredentials=!!t.withCredentials),o&&o!=="json"&&(d.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&d.addEventListener("progress",vl(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&d.upload&&d.upload.addEventListener("progress",vl(t.onUploadProgress)),(t.cancelToken||t.signal)&&(l=m=>{d&&(r(!m||m.type?new Qn(null,t,d):m),d.abort(),d=null)},t.cancelToken&&t.cancelToken.subscribe(l),t.signal&&(t.signal.aborted?l():t.signal.addEventListener("abort",l)));const f=Yp(h);if(f&&Ge.protocols.indexOf(f)===-1){r(new H("Unsupported protocol "+f+":",H.ERR_BAD_REQUEST,t));return}d.send(i||null)})},Cs={http:xp,xhr:Qp};C.forEach(Cs,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const wl=t=>`- ${t}`,em=t=>C.isFunction(t)||t===null||t===!1,iu={getAdapter:t=>{t=C.isArray(t)?t:[t];const{length:e}=t;let n,r;const i={};for(let s=0;s<e;s++){n=t[s];let o;if(r=n,!em(n)&&(r=Cs[(o=String(n)).toLowerCase()],r===void 0))throw new H(`Unknown adapter '${o}'`);if(r)break;i[o||"#"+s]=r}if(!r){const s=Object.entries(i).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?s.length>1?`since :
`+s.map(wl).join(`
`):" "+wl(s[0]):"as no adapter specified";throw new H("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:Cs};function Qi(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Qn(null,t)}function _l(t){return Qi(t),t.headers=at.from(t.headers),t.data=Zi.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),iu.getAdapter(t.adapter||Lo.adapter)(t).then(function(r){return Qi(t),r.data=Zi.call(t,t.transformResponse,r),r.headers=at.from(r.headers),r},function(r){return nu(r)||(Qi(t),r&&r.response&&(r.response.data=Zi.call(t,t.transformResponse,r.response),r.response.headers=at.from(r.response.headers))),Promise.reject(r)})}const bl=t=>t instanceof at?t.toJSON():t;function rn(t,e){e=e||{};const n={};function r(u,c,d){return C.isPlainObject(u)&&C.isPlainObject(c)?C.merge.call({caseless:d},u,c):C.isPlainObject(c)?C.merge({},c):C.isArray(c)?c.slice():c}function i(u,c,d){if(C.isUndefined(c)){if(!C.isUndefined(u))return r(void 0,u,d)}else return r(u,c,d)}function s(u,c){if(!C.isUndefined(c))return r(void 0,c)}function o(u,c){if(C.isUndefined(c)){if(!C.isUndefined(u))return r(void 0,u)}else return r(void 0,c)}function a(u,c,d){if(d in e)return r(u,c);if(d in t)return r(void 0,u)}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(u,c)=>i(bl(u),bl(c),!0)};return C.forEach(Object.keys(Object.assign({},t,e)),function(c){const d=l[c]||i,h=d(t[c],e[c],c);C.isUndefined(h)&&d!==a||(n[c]=h)}),n}const su="1.6.7",Do={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Do[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const kl={};Do.transitional=function(e,n,r){function i(s,o){return"[Axios v"+su+"] Transitional option '"+s+"'"+o+(r?". "+r:"")}return(s,o,a)=>{if(e===!1)throw new H(i(o," has been removed"+(n?" in "+n:"")),H.ERR_DEPRECATED);return n&&!kl[o]&&(kl[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(s,o,a):!0}};function tm(t,e,n){if(typeof t!="object")throw new H("options must be an object",H.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let i=r.length;for(;i-- >0;){const s=r[i],o=e[s];if(o){const a=t[s],l=a===void 0||o(a,s,t);if(l!==!0)throw new H("option "+s+" must be "+l,H.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new H("Unknown option "+s,H.ERR_BAD_OPTION)}}const As={assertOptions:tm,validators:Do},dt=As.validators;class Xr{constructor(e){this.defaults=e,this.interceptors={request:new gl,response:new gl}}async request(e,n){try{return await this._request(e,n)}catch(r){if(r instanceof Error){let i;Error.captureStackTrace?Error.captureStackTrace(i={}):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}throw r}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=rn(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:s}=n;r!==void 0&&As.assertOptions(r,{silentJSONParsing:dt.transitional(dt.boolean),forcedJSONParsing:dt.transitional(dt.boolean),clarifyTimeoutError:dt.transitional(dt.boolean)},!1),i!=null&&(C.isFunction(i)?n.paramsSerializer={serialize:i}:As.assertOptions(i,{encode:dt.function,serialize:dt.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=s&&C.merge(s.common,s[n.method]);s&&C.forEach(["delete","get","head","post","put","patch","common"],f=>{delete s[f]}),n.headers=at.concat(o,s);const a=[];let l=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(n)===!1||(l=l&&m.synchronous,a.unshift(m.fulfilled,m.rejected))});const u=[];this.interceptors.response.forEach(function(m){u.push(m.fulfilled,m.rejected)});let c,d=0,h;if(!l){const f=[_l.bind(this),void 0];for(f.unshift.apply(f,a),f.push.apply(f,u),h=f.length,c=Promise.resolve(n);d<h;)c=c.then(f[d++],f[d++]);return c}h=a.length;let p=n;for(d=0;d<h;){const f=a[d++],m=a[d++];try{p=f(p)}catch(g){m.call(this,g);break}}try{c=_l.call(this,p)}catch(f){return Promise.reject(f)}for(d=0,h=u.length;d<h;)c=c.then(u[d++],u[d++]);return c}getUri(e){e=rn(this.defaults,e);const n=ru(e.baseURL,e.url);return Zc(n,e.params,e.paramsSerializer)}}C.forEach(["delete","get","head","options"],function(e){Xr.prototype[e]=function(n,r){return this.request(rn(r||{},{method:e,url:n,data:(r||{}).data}))}});C.forEach(["post","put","patch"],function(e){function n(r){return function(s,o,a){return this.request(rn(a||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}Xr.prototype[e]=n(),Xr.prototype[e+"Form"]=n(!0)});const Dr=Xr;class Fo{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const r=this;this.promise.then(i=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](i);r._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(a=>{r.subscribe(a),s=a}).then(i);return o.cancel=function(){r.unsubscribe(s)},o},e(function(s,o,a){r.reason||(r.reason=new Qn(s,o,a),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}static source(){let e;return{token:new Fo(function(i){e=i}),cancel:e}}}const nm=Fo;function rm(t){return function(n){return t.apply(null,n)}}function im(t){return C.isObject(t)&&t.isAxiosError===!0}const Os={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Os).forEach(([t,e])=>{Os[e]=t});const sm=Os;function ou(t){const e=new Dr(t),n=Uc(Dr.prototype.request,e);return C.extend(n,Dr.prototype,e,{allOwnKeys:!0}),C.extend(n,e,null,{allOwnKeys:!0}),n.create=function(i){return ou(rn(t,i))},n}const ne=ou(Lo);ne.Axios=Dr;ne.CanceledError=Qn;ne.CancelToken=nm;ne.isCancel=nu;ne.VERSION=su;ne.toFormData=bi;ne.AxiosError=H;ne.Cancel=ne.CanceledError;ne.all=function(e){return Promise.all(e)};ne.spread=rm;ne.isAxiosError=im;ne.mergeConfig=rn;ne.AxiosHeaders=at;ne.formToJSON=t=>tu(C.isHTMLForm(t)?new FormData(t):t);ne.getAdapter=iu.getAdapter;ne.HttpStatusCode=sm;ne.default=ne;const Fe=ne;class er{constructor(e){this._rev=void 0,this.id=e,this.createdAt=Date.now(),this.lastUpdated=Date.now()}processAPIResponse(e){e.ok&&(this._id=e.id,this._rev=e.rev)}}const ci=class ci extends er{constructor(e,n){super(e),this._id=`${ci.modelName}:${this.id}`,this.name=n,this.credit=0,this.organisation=null,this.members=[],this.permission=[]}};ci.modelName="Group";let xl=ci;const ui=class ui extends er{constructor(e,n){super(e),this._id=`${ui.modelName}:${this.id}`,this.name=n,this.members=[],this.groups=[]}};ui.modelName="Organisation";let Sl=ui;const hi=class hi extends er{constructor(e,n){super(e),this._id=`user:${this.id}`,this.email=null,this.username=n,this.status="active",this.credit=0,this.organisation=null,this.tier=null,this.password=null,this.salt=null,this.tags=[],this.settings=new Bc(this.id),this.tosAccepted=0}isAdmin(){return Q.warn("User.isAdmin() is deprecated. Use AuthIntegration.isAdmin() instead"),this.tags.some(e=>e==="admin")}static fromJSON(e){const n=new hi(e.id,e.username);return n._id=e._id,n._rev=e._rev,n.id=e.id,n.createdAt=e.createdAt,n.lastUpdated=e.lastUpdated,n.email=e.email,n.username=e.username,n.status=e.status,n.externalId=e.externalId,n.authType=e.authType,n.credit=e.credit,n.organisation=e.organisation,n.tier=e.tier,n.password=e.password,n.salt=e.salt,n.tags=e.tags,n.tosAccepted=e.tosAccepted,n}};hi.modelName="User";let El=hi;const fi=class fi extends er{constructor(e,n){super(e),this._id=`${fi.modelName}:${this.id}`,this.name=n,this.limits=[]}};fi.modelName="Tier";let Cl=fi;const di=class di extends er{constructor(e){super(e),this._id=`${di.modelName}:${this.id}`,this.meta={name:"",description:"",owner:{id:"",type:"",name:""},revoked:!1},this.key="",this.vaultType="local",this.owner="",this.apiNamespace="",this.variableName=""}};di.modelName="APIKey";let Al=di;class ak extends Io{constructor(e,n,r){super(e,n,r||{id:"messaging"}),this.config=r}}var Fr=(t=>(t.CLIENT_TOAST="client:toast",t.CUSTOM_EXTENSION_EVENT="custom_extension_event",t.SHOW_EXTENSION="extension:show",t))(Fr||{}),au=(t=>(t.READY="ready",t.RUNNING="running",t.SUCCESS="success",t.STOPPED="stopped",t.FORCESTOP="forceStop",t.ERROR="error",t))(au||{});class lk{constructor(e){this._activeNode=[],this._activeNodeName="",this.errors=[],this._nodeNameMap={},this.id=e.id,this._state="ready",this._meta=e==null?void 0:e.meta,this._activity=""}get meta(){return this._meta}get activity(){return this._activity}get workflowId(){return this._workflowId}set workflowId(e){this._workflowId=e}get state(){return this._state}set state(e){this._state=e}get activeNode(){return this._activeNode}nodeDescriptionFromId(e){return this._nodeNameMap[e]??`node_${e}`}setNodeName(e,n){this._nodeNameMap[e]=n}}let Ol=class{static isValidUrl(e){let n;try{n=new URL(e)}catch{return!1}return n.protocol==="http:"||n.protocol==="https:"}static async fetchJSON(e,n=!0){return await new Promise((r,i)=>{this.isValidUrl(e)||i(new Error(`Invalid URL: ${e}`)),n&&(e=`/api/v1/mercenaries/fetch?url=${encodeURIComponent(e)}`),fetch(e).then(s=>{s.ok?r(s.json()):i(new Error(`Failed to fetch ${e}: ${s.status} ${s.statusText}`))}).catch(s=>{i(new Error(`Failed to fetch ${e}: ${s}`))})})}};class om extends Hd{constructor(e,n,r){r.singleton=!!r.singleton,super(e,n,r)}get singleton(){return this.extensionConfig.singleton}get winbox(){return this.extensionConfig.winbox}get client(){return this.app}get extensionConfig(){return this.config}get fileIntents(){return this.extensionConfig.fileIntents}get pinned(){return this.extensionConfig.addToSidebar===!0||this.extensionConfig.addToWorkbench===!0&&window.localStorage.getItem(`fav-extension${this.id}`)!==null}set pinned(e){e?window.localStorage.setItem(`fav-extension${this.id}`,"true"):window.localStorage.removeItem(`fav-extension${this.id}`)}async create(){var e;if(this.debug("create()",this.id),(e=this.extensionConfig.scripts)!=null&&e.client)for(const n in this.extensionConfig.scripts.client){const r=this.extensionConfig.scripts.client[n];try{this.info(`Deserializing client extension script, id:"${n}", text:`,r.length>60?r.slice(0,40)+"...":r);const s=(0,eval)("("+JSON.parse(r)+")"),o=s==null?void 0:s();o!=null&&o.exec&&(this.client.registerClientScript(n,o.exec),this.commands??(this.commands={}),this.commands[n]={title:o.title,description:o.description})}catch(i){this.error("Error registering extension script script",r.id,i)}}}}class lu extends zd{constructor(e){super(e)}get extensions(){return this.children}get(e){return this.extensions.get(e)}has(e){return this.extensions.has(e)}all(){return Array.from(this.extensions.values())}async register(e,n,r){var s;this.debug(`registering ${n.id} extensions`);let i=new e(n.id,this,n);return r&&typeof r=="function"&&(i=r(i)),this.children.set(n.id,i),await((s=i.create)==null?void 0:s.call(i)),i}async init(){let e=await fetch("/api/v1/mercenaries/extensions");e=await e.json();for(const n of e){const r=await this.register(om,n);if(r.fileIntents){if(r.fileIntents.show&&Object.keys(r.fileIntents.show).length>0)for(const i in r.fileIntents.show){const s=r.fileIntents.show[i];this.app.sdkHost.registerFileIntent("show",i,{extensionId:r.id,page:s.page,opts:s.opts||{}})}if(r.fileIntents.edit&&Object.keys(r.fileIntents.edit).length>0)for(const i in r.fileIntents.edit){const s=r.fileIntents.edit[i];this.app.sdkHost.registerFileIntent("edit",i,{extensionId:r.id,page:s.page,opts:s.opts||{}})}}}}}class cu extends xs{constructor(e,n){super(e,n),this.scripts=new Map,this.renderers=new Map,this.extensions=new lu(this),this.abortController=new AbortController,this.registerClientScript("help",async r=>{const i=Array.from(this.scripts.keys()).filter(a=>a!=="help").sort().map(a=>({title:"/"+a,id:a,args:[],classes:["btn-xs","rounded","bg-slate-300","text-black","hover:bg-slate-700","hover:text-white","w-32"]})),s=["Welcome to **Omnitool.ai**.","Greetings to **Omnitool.ai**.","Salutations, to **Omnitool.ai**.","Welcome, you have arrived at **Omnitool.ai**.","Hello and welcome to **Omnitool.ai**.","Hey there, welcome to **Omnitool.ai**.","We are pleased to welcome you to **Omnitool.ai**.","Thanks for trying **Omnitool.ai**.","Nice to see you at **Omnitool.ai**.","Good to have you at **Omnitool.ai**.","Pleased to meet you at **Omnitool.ai**.","Glad you're here at **Omnitool.ai**.","Happy to have you at **Omnitool.ai**.","Delighted to see you at **Omnitool.ai**.","Thank you for being here at **Omnitool.ai**.","It's a pleasure to welcome you to **Omnitool.ai**.","You've arrived at the right place, **Omnitool.ai**.","We've been expecting you at **Omnitool.ai**.","You're in good company at **Omnitool.ai**."],o=s[Math.floor(Math.random()*Math.random()*s.length)];return this.sendSystemMessage(o,"text/markdown",{commands:i}),{response:"",hide:!0}})}async init(){try{this.version=await(await fetch("/version")).text(),this.info(`Binding to version ${this.version}...`),this.info("Initializing Extension System..."),await this.extensions.init(),this.success("Extension System successfully initialized.")}catch(e){this.error("Unable to load extensions. Proceeding without.",e)}}registerClientScript(e,n){this.success("registering client script",e),this.scripts.set(e,n)}async sendSystemMessage(e,n="text/markdown",r=[],i=[],s="omni"){this.sendSystemMessages([{message:e,type:n}],r,i,s)}async sendSystemMessages(e,n=[],r=[],i="omni"){const s={type:"chat:system",from:i||"omni",flags:new Set(r)},o={content:e.map(l=>({value:l.message,type:l.type??"text/markdown"})),attachments:n},a={...s,body:o};this.emit("send:message",a)}async runBlock(e){return await this.services.get("command").runServerScript("runBlock",e)}async runScript(e,n,r){r??(r={fromChatWindow:!1});const i=this;if(!e)return{error:{message:"No script specified"}};if(this.debug("executing script",e,n),this.scripts.has(e)){const s=this.scripts.get(e);try{const o=await(s==null?void 0:s(n??[]))||{};if(o.response){const a=o.hide??!1;return r.fromChatWindow||a||await i.sendSystemMessage(o.response),{response:o.response,hide:a,result:o.result}}else return{error:o.error}}catch(o){return this.error("Error running client script",o),{error:{message:o.message}}}}else try{return await this.services.get("command").runServerScript(e,n)}catch(s){return this.error("Error running server script",s),{error:{message:s.message||s}}}}async onStart(){return!0}}class uk extends Io{constructor(e,n,r){super(e,n,r||{id:e})}async login(e,n){const r=this.config;if(!e||!n)return null;try{const i=await Fe.post(r.host+r.authUrl,{username:e,password:n},{withCredentials:!0});return await this.emit("authenticated",i==null?void 0:i.data),i==null?void 0:i.data}catch(i){if(i.response.status===404)throw new Error("Login failed! Unable to connect with authentication service. (Error code 404.)");return this.error("Failed to connect to auth server "+i),null}}async register(e,n){const r=this.config;if(!e||!n)return null;try{const i=await Fe.put(r.host+r.signupUrl,{username:e,password:n},{withCredentials:!0});return await this.emit("authenticated",i==null?void 0:i.data),i==null?void 0:i.data}catch(i){return this.error("Failed to connect to auth server "+i),null}}async logout(){const e=this.config;this.debug("Logout URL ",e.host+e.logoutUrl);try{await Fe.post(e.host+e.logoutUrl,{},{withCredentials:!0}),await this.emit("authenticated",null)}catch(n){this.error("Failed to connect with auth server"+n)}}async getAuthenticatedUser(){const e=this.config;try{const n=await Fe.get(e.host+e.userUrl,{withCredentials:!0});return await this.emit("authenticated",n==null?void 0:n.data),n.data!=null?n==null?void 0:n.data:null}catch(n){return this.error("Failed to connect with auth server"+n),null}}async tryAutoLogin(){const e=this.config;try{const n=await Fe.get(`${e.host}/api/v1/auth/autologin`,{withCredentials:!0});return await this.emit("authenticated",n==null?void 0:n.data),n.data!=null?n==null?void 0:n.data:null}catch(n){return this.error("Failed to connect with auth server"+n),null}}create(){return this.info(`${this.id} create`),!0}async load(){return this.info(`${this.id} load`),!0}async start(){return this.info(`${this.id} start`),!0}async stop(){return this.info(`${this.id} stop`),!0}}var am=(t=>(t[t.User=0]="User",t[t.Omni=1]="Omni",t[t.AsyncJob=2]="AsyncJob",t))(am||{});class Nt{static GetMessageStorageType(e){return e.from!==void 0&&e.from==="omni"?1:e.sender!==void 0&&e.sender==="me"?0:2}static async IsValidImageUrl(e){var n;try{const r=await fetch(e,{method:"HEAD"});return r.ok?((n=r.headers.get("Content-Type"))==null?void 0:n.startsWith("image"))??!1:!1}catch{return!1}}static CreateAsyncJobServerPayload(e,n){return{message:e,sender:"asyncjob",ts:n}}static IsAsyncJobMessage(e){var n,r;try{return((r=(n=e.body)==null?void 0:n.content[0])==null?void 0:r.type)==="omni/job"}catch{return!1}}static GetAsyncJobIdFromMessage(e){try{return e.body.content[0].value}catch{return null}}static ShouldPersist(e){var r;if(this.GetMessageStorageType(e)===0||this.GetMessageStorageType(e)===2)return!0;const n=e;return Nt.HasChatContentProperty(n,"images")?!0:Nt.HasChatContentProperty(n,"commands")?!1:!!(Nt.HasChatContentProperty(n,"text")||((r=e.body)==null?void 0:r.content)!==void 0)}static HasChatContentProperty(e,n){var r;try{return((r=e.body.attachments[n])==null?void 0:r.length)>0}catch{return!1}}}const lm=()=>new Intl.DateTimeFormat("en-US",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(new Date);class cm{constructor(e,n){this._id=e.id,this._opts=n}get id(){return this._id}get opts(){return this._opts}}class ut extends cm{constructor(e,n){super(e,n)}load(){return Promise.resolve()}}class hk extends Io{constructor(e,n,r){super(e,n,r||{id:e}),this._renderers=new Map,this.activeContextId=0,this.state=r.initialState??{},this.workbench=r.workbench,this._pendingAsyncJobUpdates=new Map}async registerRenderer(e){var n;this.info(`registering renderer ${e.id}`),this._renderers.set(e.id,e),await((n=e.load)==null?void 0:n.call(e))}renderMessage(e){return(e==null?void 0:e.length)===0?null:e.map(n=>this.renderContent(n)).join(`
`)}async onChatMessage(e){await this._onChatMessage(e),await this.updateChatServer(e,Date.now())}async _onChatMessage(e){var c,d,h,p,f,m;const n=e.body;if(!n)return;const{from:r,flags:i,workflowId:s}=e,{attachments:o,content:a}=n,l=this.renderMessage(a),u={sender:r||"omni",text:l,whenText:lm(),attachments:0,workflowId:s??((d=(c=this.workbench)==null?void 0:c.activeWorkflow)==null?void 0:d.id),flags:i||new Set};for(const g in o)["sender","text","whenText","attachments"].includes(g)||(o.key&&((p=(h=o==null?void 0:o[g])==null?void 0:h.forEach)==null||p.call(h,w=>{var b;const v=w&&(w.fid??((b=w==null?void 0:w.ticket)==null?void 0:b.fid));v&&(w.url="/fid/"+v)})),u[g]=o[g],u.attachments+=isNaN((f=o[g])==null?void 0:f.length)?0:(m=o[g])==null?void 0:m.length);await this.emitGlobalEvent("chat_message_added",[u]),this.state.messages.push(u)}async updateChatServer(e,n){if(Nt.IsAsyncJobMessage(e)){const r=Nt.GetAsyncJobIdFromMessage(e);r!==null&&this._pendingAsyncJobUpdates.set(r,!0);return}Nt.ShouldPersist(e)&&(this.workbench===null||this.workbench.activeWorkflow===null||(e.workflowId=this.workbench.activeWorkflow.id,await Fe.put(`/api/v1/chat/${this.activeContextId}`,{payload:{msgstore:e,version:0,ts:n}},{withCredentials:!0}).then(r=>{},r=>{Q.error(r.message)})))}async clearChat(){await Fe.delete(`/api/v1/chat/${this.activeContextId}`,{withCredentials:!0}).then(e=>{},e=>{Q.error(e.message)})}async postUpdateChatServerForJobs(e,n,r){this._pendingAsyncJobUpdates.get(n)&&(await this.updateChatServer(e,r),this._pendingAsyncJobUpdates.delete(n))}renderContent(e){const n=this._renderers.get(e.type);return n!=null?n.render(e):`Error: Unknown chat renderer type ${e.type}`}create(){return this.info(`${this.id} create`),!0}async load(){return this.info(`${this.id} load`),!0}async start(){return this.info(`${this.id} start`),!0}async stop(){return this.info(`${this.id} stop`),!0}}const fk=(t,e,n=cu)=>new n(t,e);class qn extends yi{constructor(){super(...arguments);B(this,"_errors",[]);B(this,"_dirty",0);B(this,"_flags",[])}get displayName(){let n=this.meta.name||this.id;return this.isDirty&&(n+="*"),this.readOnly&&(n+=" (read-only)"),this.copyOnWrite&&(n+=" (copy-on-write)"),n}hasFlag(n){if(n!==n.toLowerCase())throw new Error(`ClientWorkflow Flag "${n}" must be lower-case`);return this._flags.includes(n)}setFlag(n,r=!0){if(n!==n.toLowerCase())throw new Error(`ClientWorkflow Flag "${n}" must be lower-case`);if(r){this._flags.includes(n)||this._flags.push(n);return}this._flags=this._flags.filter(i=>i!==n)}clearFlag(n){this.setFlag(n,!1)}get isDirty(){return this._dirty!==0}setDirty(){this._dirty=1}get copyOnWrite(){return this.hasFlag("copyonwrite")}set copyOnWrite(n){this.setFlag("copyonwrite",n)}get readOnly(){return this.hasFlag("readonly")}set readOnly(n){this.setFlag("readonly",n)}static async clone(n){const i=(await Fe.post("/api/v1/workflow/clone",{...n},{withCredentials:!0})).data.workflow;return qn.fromJSON(i)}async syncToServer(){if(this.readOnly)return!1;this.copyOnWrite&&(this.copyOnWrite=!1,this.id="");const n=new Date().getTime();this._dirty=n,this.meta.updated=Date.now();const r=window.Alpine.raw(this.toJSON());try{const i=await Fe({method:this.id?"put":"post",url:"/api/v1/workflow",data:r,withCredentials:!0});if(i.status!==200||!i.data.workflow)return!1;const s=i.data.workflow.id;if(!s)throw new Error("Server did not return a valid recipe Id");this.id&&this.id!==s&&Q.log("server updated our id unexpectedly",this.id,s),this.id=s}catch(i){return Q.log("error writing to server",i),!1}return this._dirty===n&&(this._dirty=0),!0}static fromJSON(n,r=void 0){const i=new qn(n.id);return i.id=n.id,!i.id&&n._id&&(i.id=n._id.replace("wf:","")),i.setMeta(n.meta),i.setRete(n.rete),i.setAPI(n.api),r&&r.length>0?i._flags=r:n._flags&&(i._flags=n._flags),i}toJSON(){const n=super.toJSON();return n._flags=this._flags,n}}var Mt={};const um=t=>[function(e){return t(...arguments)},function(e,n){return t(...arguments)},function(e,n,r){return t(...arguments)},function(e,n,r,i){return t(...arguments)},function(e,n,r,i,s){return t(...arguments)}],uu=(t,...e)=>{if(hm(t),e.length>=t.length)return t(...e);const n=(...s)=>uu(t,...e,...s),r=t.length-e.length-1;return um(n)[r]||n};var hu=uu;function hm(t){if(typeof t!="function")throw Error("fn should be function!")}var fm=t=>{const e={value:t};return(...n)=>{const[r]=n;return n.length?(e.value=r,r):e.value}},Bo={exports:{}};const $o=hu,dm=t=>document.querySelector(`[data-name="${t}"]`),pm=$o((t,e,n)=>t.setAttribute(n,e[n])),mm=$o((t,e,n)=>t[n]=e[n]),gm=$o((t,e)=>!t(e)),Tl=t=>t!=t.toLowerCase();Bo.exports=(t,e={})=>{const{dataName:n,notAppend:r,parent:i=document.body,uniq:s=!0,...o}=e,a=fu(n);if(s&&a)return a;const l=document.createElement(t);return n&&(l.dataset.name=n),Object.keys(o).filter(Tl).map(mm(l,e)),Object.keys(o).filter(gm(Tl)).map(pm(l,e)),r||i.appendChild(l),l};Bo.exports.isElementPresent=fu;function fu(t){if(t)return dm(t)}var ym=Bo.exports;const Uo=hu,Ts=fm,vm=ym,wm=t=>typeof t=="boolean",_m=Uo(Em),bm={ok:"OK"},du={ok:"OK",cancel:"Cancel"},Rl=Ts(100);Mt.alert=(t,e,n)=>{const r=Ho(n)||bm;return xi(t,e,"",r,n)};Mt.prompt=(t,e,n="",r)=>{const i=km(r),s=String(n).replace(/"/g,"&quot;"),o=`<input type="${i}" value="${s}" data-name="js-input">`,a=Ho(r)||du;return xi(t,e,o,a,r)};Mt.confirm=(t,e,n)=>{const r=Ho(n)||du;return xi(t,e,"",r,n)};Mt.progress=(t,e,n)=>{const s=xi(t,e,`
        <progress value="0" data-name="js-progress" class="progress" max="100"></progress>
        <span data-name="js-counter">0%</span>
    `,{cancel:"Abort"},n),{ok:o,dialog:a}=s,l=o();for(const u of Ue(a,["cancel"]))u.focus();return Object.assign(s,{setProgress(u){const[c]=Ue(a,["progress"]),[d]=Ue(a,["counter"]);c.value=u,d.textContent=`${u}%`,u===100&&(Vn(a),l())},remove(){Vn(a)}}),s};function Ho(t={}){const{buttons:e}=t;return e||null}function km(t={}){const{type:e}=t;return e==="password"?"password":"text"}function xm(t,e,n,r){const i=e.replace(/\n/g,"<br>");return`<div class="page">
        <div data-name="js-close" class="close-button"></div>
        <header>${t}</header>
        <div class="content-area">${i}${n}</div>
        <div class="action-area">
            <div class="button-strip">
                ${Sm(r)}
            </div>
        </div>
    </div>`}function Sm(t){const e=Object.keys(t),n=Uo((r,i,s)=>`<button
            tabindex=${s}
            data-name="js-${i.toLowerCase()}">
            ${r[i]}
        </button>`);return e.map(n(t)).join("")}function xi(t,e,n,r,i){const s=Ts(),o=Ts(),a=["cancel","close","ok"],l=new Promise((d,h)=>{const p=i&&wm(i.cancel)&&!i.cancel,f=()=>{},m=()=>h(Error());s(d),o(p?f:m)}),u=xm(t,e,n,r),c=vm("div",{innerHTML:u,className:"smalltalk",style:`z-index: ${Rl(Rl()+1)}`});for(const d of Ue(c,["ok","input"]))d.focus();for(const d of Ue(c,["input"]))d.setSelectionRange(0,n.length);Rm("click",c,a,d=>{pu(d.target,c,s(),o())});for(const d of["click","contextmenu"])c.addEventListener(d,h=>{h.stopPropagation();for(const p of Ue(c,["ok","input"]))p.focus()});return c.addEventListener("keydown",_m(c,s(),o())),Object.assign(l,{dialog:c,ok:s})}function Em(t,e,n,r){const i={ENTER:13,ESC:27,TAB:9,LEFT:37,UP:38,RIGHT:39,DOWN:40},{keyCode:s}=r,o=r.target,l=Ue(t,["ok","cancel","input"]).map(zo);switch(s){case i.ENTER:pu(o,t,e,n),r.preventDefault();break;case i.ESC:Vn(t),n();break;case i.TAB:r.shiftKey&&Il(t,l),Il(t,l),r.preventDefault();break;default:["left","right","up","down"].filter(u=>s===i[u.toUpperCase()]).forEach(()=>{Am(t,l)});break}r.stopPropagation()}function zo(t){return t.getAttribute("data-name").replace("js-","")}const Cm=t=>t==="cancel"?"ok":"cancel";function Am(t,e){const n=document.activeElement,r=zo(n),i=/ok|cancel/.test(r),s=e.length-1;if(r==="input"||!s||!i)return;const o=Cm(r);for(const a of Ue(t,[o]))a.focus()}const Om=(t,e)=>e===t?0:e+1;function Il(t,e){const n=document.activeElement,r=zo(n),i=e.length-1,s=e.indexOf(r),o=Om(i,s),a=e[o];for(const l of Ue(t,[a]))l.focus()}function pu(t,e,n,r){const i=t.getAttribute("data-name").replace("js-","");if(/close|cancel/.test(i)){r(),Vn(e);return}let s=null;for(const o of Ue(e,["input"]))s=o.value;n(s),Vn(e)}const Tm=Uo((t,e)=>t.querySelector(`[data-name="js-${e}"]`));function Ue(t,e){return e.map(Tm(t)).filter(Boolean)}function Rm(t,e,n,r){for(const i of Ue(e,n))i.addEventListener(t,r)}function Vn(t){const{parentElement:e}=t;e&&e.removeChild(t)}class Im{constructor(){B(this,"_activeRecipe",null);B(this,"nicknames",{});B(this,"_activeExtension");B(this,"showFloatingExtension",!1);B(this,"floatingExtensionX",window.screen.width/2);B(this,"floatingExtensionY",window.screen.height/2);B(this,"refreshTS",Date.now());B(this,"isLoading",!1)}get activeExtension(){return this._activeExtension}hideExtension(){this._activeExtension=void 0}showExtension(e,n,r="",i){var f,m,g;i??(i={}),r.length>0&&!r.endsWith(".html")&&(r=r+".html");const s=this.getClient().extensions.get(e);if(!s)return;this._activeExtension=s;const o=(i.displayMode??((f=s==null?void 0:s.extensionConfig)==null?void 0:f.displayMode))||"default";let a="";const l=Date.now();if(typeof n=="string")a=`/extensions/${e}/${r}?${n}&ts=${l}&o=${encodeURIComponent(JSON.stringify({mode:o,hideToolbar:i.hideToolbar}))}`;else if(!n||typeof n=="object"){n??(n={});const w="q="+encodeURIComponent(JSON.stringify(n)),v="o="+encodeURIComponent(JSON.stringify({mode:o,hideToolbar:i.hideToolbar}));a=`/extensions/${e}/${r}?${w}&${v}`,Q.debug("rev",new URLSearchParams(a.toString()).toString())}const u=i.singletonHash??(s.singleton?s.id:void 0),c=Object.assign({},{...s.extensionConfig.winbox||{x:"center",y:"center"},title:s.extensionConfig.title||s.id},i.winbox||{}),d=window.screen.height,h=window.screen.width;typeof c.height=="string"&&(c.height=parseInt(c.height)/100*d),typeof c.width=="string"&&(c.width=parseInt(c.width)/100*h);const p=this.getClient().toggleWindow(a,u,c);p&&((m=p.show)==null||m.call(p)),(g=this.getClient().extensions.get(e))!=null&&g.extensionConfig.minimizeChat&&this.getClient().uiSettings.toggleMinimized(!0)}refreshUI(){this.refreshTS=Date.now()}isSingletonActive(e){return!!this.getClient().getWindow(e)}getClient(){return window.client}getExtensions(){return this.getClient().extensions.all()}get activeWorkflow(){return this._activeRecipe}get activeRecipe(){return this._activeRecipe}set activeRecipe(e){this._activeRecipe=e}get activeRecipeId(){var e;return(e=this._activeRecipe)==null?void 0:e.id}getMetaDataBlock(){return this.activeWorkflow?Object.values(this.activeWorkflow.rete.nodes).find(n=>n.name==="omnitool.recipe_metadata"):void 0}updateMetaFromBlock(){if(!this.activeWorkflow)return;const e=this.getMetaDataBlock();e&&(this.activeWorkflow.meta.name=e.data.title,this.activeWorkflow.meta.description=e.data.description,this.activeWorkflow.meta.author=e.data.author,this.activeWorkflow.meta.help=e.data.help)}setDemoRecipe(e,n){this.getRecipeIdFromNickname(e),this.setNickname(e,n)}async _load(){this.updateNickNames(),this.setDemoRecipe("Bugbear","c0deba5e-417d-49df-96d3-8aeb8fc15402");const e=this.getClient(),n=i=>{for(const s in i)Array.isArray(i[s].connections)&&i[s].connections.length===0&&delete i[s].connections},r=function(i){for(const s in i)["inputs","controls","outputs"].forEach(o=>{Object.prototype.hasOwnProperty.call(i[s],o)&&n(i[s][o])});return i};return e.registerClientScript("explain",async i=>{if(!this.activeWorkflow)return;const s=i[0]||"beginner just learning omnitool and AI",o=await this.activeWorkflow.toJSON(),a=r(o.rete);await e.sendSystemMessage(` Analyzing the recipe to provide an explanation for a ${s}. Please wait...`);const l=o.meta.name,u=o.meta.pictureUrl;let c=`Acting as a smart, thoughtful, humble, and experienced teacher, given a Rete.js workflow, please explain using proper language and analogies for a ${s} what the purpose of the recipe this workflow represents is and how it operates.
Format your explanation using markdown.
Start with a Level 1 heading titled '${l}'.`;u&&(c+=` Add an image tag pointing to '/${u}' below the heading.`),c+=` Break the document into logical sections with Level 2 headings (Overview, Nodes Explanation, Recipe).
When referring to a "Rete Workflow", use the word "Recipe" instead.
When referring to a "Rete Node", use the word "Block" instead.
Explain the most critical and commonly misunderstood blocks in detail.
Do not include JSON notation or mention the JSON directly inside the markdown.
Remember that the user cannot see the node id numbers. The numbers for your use only. When referencing the blocks, use the block name, (or "x-omni-title") instead.
Close with a "Further Exploration" section that contains 1-2 bullet points with interesting aspects for the user to explore when looking to extend the recipe.`;const d=await e.runBlock({block:"omnitool.large_language_model",args:{Instruction:c,Prompt:JSON.stringify(a),Criteria:"Accurate"}});if(!(d!=null&&d.Reply)){await e.sendSystemMessage("Apologies, there was a problem analyzing the recipe.");return}let h=d.Reply;h=h.replace(/node/gi,"Block"),h=h.replace(/workflow/gi,"Recipe"),this.showExtension("omni-core-viewers",{markdown:h},"markdown",{displayMode:"floating"})}),e.registerClientScript("save",async()=>{if(this.canSave)try{return await this.save(),{response:"Recipe saved."}}catch(i){return await this.getClient().sendSystemMessage("Failed to save recipe"+i.message,"text/plain",{},["error"]),{error:"Failed to save"}}}),e.registerClientScript("dump",async()=>{if(this.activeRecipe==null)return;await this.syncToServer();const i=document.createElement("a");return i.style.display="none",i.href=`/api/v1/workflow/download/${this.activeRecipe.id}`,document.body.appendChild(i),i.click(),document.body.removeChild(i),"Recipe Exported"}),e.registerClientScript("load",async i=>{if(this.canSave&&await this.save(),i.length===0)return"Loads a recipe. Usage: /load <url>";const s=i[0];if(!Ol.isValidUrl(s))return"Invalid URL";const o=await Ol.fetchJSON(s);return await this.loadFromJSON(o),`Recipe loaded from  ${s}`}),e.registerClientScript("setname",async i=>{const s=i[0];if(!s)return{response:`**setname**  
Sets a nickname for the current recipe, allowing you to invoke it at any time by using **@nickname** in chat.  
Usage: **/setname** <name> 
`};this.deleteNickname(s);for(let a=0;a<10;a++){const l=this.getNickname();if(!l)break;this.deleteNickname(l)}return this.setNickname(s)?{response:`Recipe nickname set to **${s}**. You can now start this recipe from any chat by using **@${s}** <text>.`}:{response:"Failed to set nickname."}}),e.registerClientScript("unsetname",async i=>{if(i.length>0){const s=i[0];if(this.deleteNickname(s))return{response:"Recipe nickname removed."}}return{response:`**unsetsetname**  
Removes a nickname for a recipe previously set with /setname.  
Usage: **/unsetname** <name> 
`}}),e.registerClientScript("toggleFavorite",async i=>{if(i.length>0){const s=i[0];return window.localStorage.getItem(s)!==null?window.localStorage.removeItem(s):window.localStorage.setItem(s,new Date().getTime().toString()),!0}return!1}),!0}async load(){try{return await this._load()}catch{alert(`An unexpected error occurred while loading the workbench.

You will experience further errors that cannot be fixed.

Please reload the app and try again.`)}return!1}get displayName(){const e=this.activeWorkflow,n=this.getNickname();return e!=null?`${e.displayName} ${n?"(@"+n+")":""} `:"Welcome to Omnitool.ai!"}get canEdit(){return!this.readOnly}get canExecute(){return!!this.activeRecipe}get canExport(){return!!this.activeRecipe}get canFavorite(){return!!this.activeRecipe}get canSave(){return!this.readOnly}get canSaveAs(){return!!this.activeRecipe}get isBlank(){return!this.activeWorkflow||this.activeWorkflow.isBlank}get isFavorite(){return window.localStorage.getItem("fav-recipe"+this.activeRecipeId)!==null}isRunningActiveWorkflow(){return this.activeWorkflow!=null?this.getClient().jobs.getJobsforWorkflow(this.activeWorkflow.id).find(n=>n.state===au.RUNNING):!1}get copyOnWrite(){var e;return((e=this.activeRecipe)==null?void 0:e.copyOnWrite)??!1}get readOnly(){var e;return((e=this.activeWorkflow)==null?void 0:e.readOnly)??!0}getScopedKeyFromUserKey(e){const n=e==null?void 0:e.trim();return n?`workbench:${n}`:""}setWorkbenchSetting(e,n){typeof n=="object"&&(n=JSON.stringify(n));const r=this.getScopedKeyFromUserKey(e);if(!r)return Q.error("Invalid workbench setting key: ",e),!1;if(!n){const i=window.localStorage.getItem(r);return window.localStorage.removeItem(r),Q.debug("Removed workbench setting: ",e),!!i}return window.localStorage.setItem(r,n),Q.info("Set workbench setting: ",e),!0}deleteWorkbenchSetting(e){return this.setWorkbenchSetting(e,"")}getWorkbenchSetting(e){const n=this.getScopedKeyFromUserKey(e);if(!n){Q.error("Invalid workbench setting key: ",e);return}const r=window.localStorage.getItem(n);try{return JSON.parse(r??"")}catch{}return r}getWorkbenchSettingKeys(e){const n=[],r=`workbench:${e}`;for(let i=0;i<window.localStorage.length;i++){const s=window.localStorage.key(i);s!=null&&s.startsWith(r)&&n.push(s.substring(r.length))}return n}getKeyFromNickname(e){const n=e.trim().toLowerCase().replace(/[^a-z0-9]/g,"");return n?`nicknames:${n}`:void 0}deleteNickname(e){const n=this.getKeyFromNickname(e);return this.deleteWorkbenchSetting(n)}setNickname(e,n){var o;e=e.trim(),n??(n=(o=this.activeWorkflow)==null?void 0:o.id);const r=this.getKeyFromNickname(e);if(!r)return!1;const i={nickname:e,id:n},s=this.setWorkbenchSetting(r,i);return this.updateNickNames(),s}getNickname(e){var r;if(e??(e=(r=this.activeRecipe)==null?void 0:r.id),!e)return;const n=this.getWorkbenchSettingKeys("nicknames:");for(let i=0;i<n.length;i++){const s=n[i],o=this.getWorkbenchSetting(`nicknames:${s}`);if(o&&o.id===e)return o.nickname}}updateNickNames(){const e=[];this.getWorkbenchSettingKeys("nicknames:").forEach(i=>{const s=this.getWorkbenchSetting(`nicknames:${i}`);s!=null&&s.nickname&&e.push(s)}),e.sort((i,s)=>i.nickname.localeCompare(s.nickname));const r={};e.forEach(i=>{r[i.nickname]=i}),this.nicknames=r}async syncToServer(){if(!this.activeRecipe)return Q.error("workbench.syncToServer(): No active recipe"),!1;if(this.writeActiveRecipeIdToLocalStorage(),!this.activeRecipe.isDirty)return!0;const e=await this.activeRecipe.syncToServer();return this.writeActiveRecipeIdToLocalStorage(),e}async saveAs(){if(!this.activeWorkflow){Q.error("saveAs(): No active recipe");return}const e=this.activeWorkflow;let n=await Mt.prompt("Recipe name:",e.meta.name||"My Recipe");if(n=n?n.trim():null,!n)return;const r=this.getMetaDataBlock();r&&(r.data.title=n),e.meta.name=n,e.id="",e.readOnly=!1,e.copyOnWrite=!1,e.setDirty(),await this.save()}async save(){if(!this.activeWorkflow){Q.error("workbench.save(): No active recipe");return}this.updateMetaFromBlock();let e="Saving recipe...";await this.syncToServer()?(e=`Recipe "${this.activeWorkflow.meta.name}" saved.`,await this.loadFromCache(!1)):e=`Recipe "${this.activeWorkflow.meta.name}" (${this.activeWorkflow.id}) unable to save.`,await this.getClient().sendSystemMessage(e)}async forceSave(){this.activeRecipe&&this.activeRecipe.setDirty(),await this.save()}getRecipeIdFromNickname(e){const n=this.getKeyFromNickname(e);return n?this.getWorkbenchSetting(n):void 0}async executeByName(e,n){var i;if(e==="omni"){const s=(i=this.activeWorkflow)==null?void 0:i.id;return await this.executeById(s,n)}const r=this.getRecipeIdFromNickname(e);if(!r){await this.getClient().sendSystemMessage(`There is no recipe by the name of "*${e}*"!`);return}return n.xOmniNickName=e,await this.executeById(r.id,n)}async executeById(e,n){var o,a;if(Q.debug("workbench.executeById",e,n),((o=this.activeWorkflow)==null?void 0:o.id)===e){if(!this.readOnly&&!await this.syncToServer())return null;e=(a=this.activeWorkflow)==null?void 0:a.id}if(!e)throw new Error(`Invalid recipe id: ${e} Cannot execute.`);const r=this.getClient();n=JSON.parse(JSON.stringify(Object.assign({},r.clipboard,n))),r.clipboard={};const i={workflow:e,args:n};return(await Fe.post("/api/v1/workflow/exec",i,{withCredentials:!0})).data.result}async execute(e={}){if(this.activeWorkflow==null){Q.error(`execute(${e}): No active workflow`);return}return this.writeActiveRecipeIdToLocalStorage(),await this.executeById(this.activeWorkflow.id,e)}async loadFromCache(e=!0){const n=window.localStorage.getItem("active_recipe_id");await this.loadRecipe(n,e)}async remixRecipe(){const e=this.activeWorkflow;if(!e)throw new Error("Cannot remix empty recipe");if(!e.id)throw new Error("Cannot remix unsaved recipe");let n=await Mt.prompt("Recipe name:",`My ${e.meta.name}`);if(n=n?n.trim():null,!n)return null;const r=JSON.parse(JSON.stringify(e.meta));r.name=n,delete r.template,r.tags&&Array.isArray(r.tags)&&(r.tags=r.tags.filter(s=>s!=="template"&&s!=="#template"));const i=await qn.clone({id:e.id,meta:r});return i?(await this.loadRecipe(i.id),this.activeWorkflow):null}async newRecipe(e=""){var i;if(e||(e=await Mt.prompt("Name for new recipe:","My Recipe"),e=e?e.trim():null),!e)return;await this.loadFromJSON({}),await this.getClient().runScript("add",["omnitool.recipe_metadata"],{fromChatWindow:!1});const n=this.getMetaDataBlock();n&&(n.data.title=e,this.updateMetaFromBlock()),(i=this.activeRecipe)==null||i.setDirty(),await this.syncToServer(),await this.loadFromCache();const r=this.activeRecipe?`Recipe "${this.activeRecipe.meta.name}" created.`:"Failed to create a new recipe.";await this.getClient().sendSystemMessage(r)}async loadFromJSON(e,n,r=!0){var s;this.activeRecipe=null,this.isLoading=!0,this.activeRecipe=qn.fromJSON(e,n),this.writeActiveRecipeIdToLocalStorage();const i=!0;this.activeRecipe.readOnly&&i&&(this.activeRecipe.copyOnWrite=this.activeRecipe.readOnly,this.activeRecipe.readOnly=!1),await this.getClient().emit("workbench_workflow_loaded",(s=this.activeRecipe)==null?void 0:s.id),this.showRecipeHelp(),r&&await this.getClient().runScript("fit",{}),this.isLoading=!1}async loadRecipe(e,n=!0){if(this.activeRecipe=null,!e){console.log(`Unable to load recipe with id: ${e}`);return}let r;try{r=await Fe.get(`/api/v1/workflow/${e}`,{withCredentials:!0})}catch(o){console.log(`Error loading recipe with id: ${e}, error: ${o}`);return}const i=r.data.workflow,s=r.data.flags;await this.loadFromJSON(i,s,n)}async onLoadRecipeFromFileChange(e){var i,s,o,a,l,u,c;const n=((i=e==null?void 0:e.dataTransfer)==null?void 0:i.files)||((s=e==null?void 0:e.target)==null?void 0:s.files);let r;if(n.length>0){const d=n[0];if(d.name.endsWith(".json")&&d.type==="application/json")r=await new Promise((h,p)=>{const f=new FileReader;f.onload=m=>{var g;h(JSON.parse(((g=m==null?void 0:m.target)==null?void 0:g.result)??"{}"))},f.onerror=m=>{console.error("Error reading file: ",m),p(m)},f.readAsText(d)});else if(d.name.endsWith(".sql")){const h=await this.getClient().sdkHost.uploadSingleFile(d,"temporary");if(h&&(h.ticket||h.fid)){const p=await this.getClient().sdkHost.runServerScript("workflow",["import",h.fid??((o=h.ticket)==null?void 0:o.fid)]);p&&p.length>0?r=p[0]:console.error("Error uploading file. No workflow:",h)}else console.error("Error uploading file: ",h)}}r!=null&&r.id&&((a=r==null?void 0:r.meta)!=null&&a.name)&&((u=(l=r==null?void 0:r.rete)==null?void 0:l.id)!=null&&u.startsWith("mercs@"))?(r.id="",await this.loadFromJSON(r),(c=this.activeWorkflow)==null||c.setDirty()):console.error("Invalid recipe from file: ",r)}writeActiveRecipeIdToLocalStorage(){var n;const e=(n=this.activeWorkflow)==null?void 0:n.id;if(!e){window.localStorage.removeItem("active_recipe_id");return}window.localStorage.setItem("active_recipe_id",e)}generateAutoHelp(e){const n=`## New Recipe Checklist  
*Steps to take before running your recipe:*  

`,r=[{text:"Add a Recipe Metadata Block",check:()=>e.rete.nodes.find(o=>o.name==="omnitool.recipe_metadata")},{text:"Add a Chat Input Block",check:()=>e.rete.nodes.find(o=>o.name==="omnitool.chat_input")},{text:"Add a Chat Output Block",check:()=>e.rete.nodes.find(o=>o.name==="omnitool.chat_output")},{text:"Replace this Checklist by adding your own help information into the recipe metadata block",check:()=>!1}],i=`  

This checklist auto-updates every time the recipe is saved.`;return n+r.map(o=>o.check()?` ${o.text}`:` ${o.text}`).join(`  
`)+i}showTutorial(e){const n="workflow-tutorial";this.showExtension("omni-core-viewers",{video:"https://github.com/mercenaries-ai/omnitool-tutorials/releases/download/latest/quickstart.mp4"},"video.html",{singletonHash:n,winbox:{title:"Quickstart Video",minwidth:960,minheight:575,modal:e}})}showApiManagement(){this.showExtension("omni-core-collectionmanager",{type:"api"},void 0,{winbox:{title:"API Management",modal:!0},singletonHash:"omni-core-collectionmanager-api"})}toggleDevTool(){if(this.getClient().extensions.has("omni-extension-log-viewer")){const e="omni-extension-log-viewer";this.getClient().getWindow(e)?this.getClient().closeWindow(e):this.showExtension("omni-extension-log-viewer",{},void 0,{winbox:{title:"Developer Tool",x:"center",y:"bottom",width:1e3,height:200},singletonHash:"omni-extension-log-viewer"})}}showRecipeHelp(){var a,l;const e="workflow-intro",n=this.activeRecipe;if(!n){this.getClient().closeWindow(e);return}const r=(l=(a=n==null?void 0:n.meta)==null?void 0:a.help)==null?void 0:l.trim(),i=r?r.length?r:this.generateAutoHelp(n):this.generateAutoHelp(n),s="workflow-ui"+n.id,o=Object.values(window.Alpine.raw(n.rete.nodes)).find(u=>u.name==="omni-core-formio:formio.auto_ui");o&&o.data.enableUI&&this.showExtension("omni-core-formio",{recipe:{id:n.id,version:void 0}},o.data.editMode?"edit":"render",{singletonHash:s,winbox:{title:""+n.meta.name,x:"center",y:"center",minwidth:800,minheight:600,autosize:!0},hideToolbar:!0}),this.showExtension("omni-core-viewers",{markdown:i},"markdown",{singletonHash:e,winbox:{title:" '"+n.meta.name+"' - Information",x:"right",y:"bottom",minheight:450,minwidth:400,autosize:!0},hideToolbar:!0})}}var Rs={exports:{}},Is={exports:{}},Ne={},Z={};Z.__esModule=!0;Z.extend=mu;Z.indexOf=Dm;Z.escapeExpression=Fm;Z.isEmpty=Bm;Z.createFrame=$m;Z.blockParams=Um;Z.appendContextPath=Hm;var Pm={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},Nm=/[&<>"'`=]/g,Mm=/[&<>"'`=]/;function Lm(t){return Pm[t]}function mu(t){for(var e=1;e<arguments.length;e++)for(var n in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],n)&&(t[n]=arguments[e][n]);return t}var jo=Object.prototype.toString;Z.toString=jo;var Ps=function(e){return typeof e=="function"};Ps(/x/)&&(Z.isFunction=Ps=function(t){return typeof t=="function"&&jo.call(t)==="[object Function]"});Z.isFunction=Ps;var gu=Array.isArray||function(t){return t&&typeof t=="object"?jo.call(t)==="[object Array]":!1};Z.isArray=gu;function Dm(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}function Fm(t){if(typeof t!="string"){if(t&&t.toHTML)return t.toHTML();if(t==null)return"";if(!t)return t+"";t=""+t}return Mm.test(t)?t.replace(Nm,Lm):t}function Bm(t){return!t&&t!==0?!0:!!(gu(t)&&t.length===0)}function $m(t){var e=mu({},t);return e._parent=t,e}function Um(t,e){return t.path=e,t}function Hm(t,e){return(t?t+".":"")+e}var Ns={exports:{}};(function(t,e){e.__esModule=!0;var n=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function r(i,s){var o=s&&s.loc,a=void 0,l=void 0,u=void 0,c=void 0;o&&(a=o.start.line,l=o.end.line,u=o.start.column,c=o.end.column,i+=" - "+a+":"+u);for(var d=Error.prototype.constructor.call(this,i),h=0;h<n.length;h++)this[n[h]]=d[n[h]];Error.captureStackTrace&&Error.captureStackTrace(this,r);try{o&&(this.lineNumber=a,this.endLineNumber=l,Object.defineProperty?(Object.defineProperty(this,"column",{value:u,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:c,enumerable:!0})):(this.column=u,this.endColumn=c))}catch{}}r.prototype=new Error,e.default=r,t.exports=e.default})(Ns,Ns.exports);var je=Ns.exports,tr={},Ms={exports:{}};(function(t,e){e.__esModule=!0;var n=Z;e.default=function(r){r.registerHelper("blockHelperMissing",function(i,s){var o=s.inverse,a=s.fn;if(i===!0)return a(this);if(i===!1||i==null)return o(this);if(n.isArray(i))return i.length>0?(s.ids&&(s.ids=[s.name]),r.helpers.each(i,s)):o(this);if(s.data&&s.ids){var l=n.createFrame(s.data);l.contextPath=n.appendContextPath(s.data.contextPath,s.name),s={data:l}}return a(i,s)})},t.exports=e.default})(Ms,Ms.exports);var zm=Ms.exports,Ls={exports:{}};(function(t,e){e.__esModule=!0;function n(o){return o&&o.__esModule?o:{default:o}}var r=Z,i=je,s=n(i);e.default=function(o){o.registerHelper("each",function(a,l){if(!l)throw new s.default("Must pass iterator to #each");var u=l.fn,c=l.inverse,d=0,h="",p=void 0,f=void 0;l.data&&l.ids&&(f=r.appendContextPath(l.data.contextPath,l.ids[0])+"."),r.isFunction(a)&&(a=a.call(this)),l.data&&(p=r.createFrame(l.data));function m(y,_,A){p&&(p.key=y,p.index=_,p.first=_===0,p.last=!!A,f&&(p.contextPath=f+y)),h=h+u(a[y],{data:p,blockParams:r.blockParams([a[y],y],[f+y,null])})}if(a&&typeof a=="object")if(r.isArray(a))for(var g=a.length;d<g;d++)d in a&&m(d,d,d===a.length-1);else if(typeof Symbol=="function"&&a[Symbol.iterator]){for(var w=[],v=a[Symbol.iterator](),b=v.next();!b.done;b=v.next())w.push(b.value);a=w;for(var g=a.length;d<g;d++)m(d,d,d===a.length-1)}else(function(){var y=void 0;Object.keys(a).forEach(function(_){y!==void 0&&m(y,d-1),y=_,d++}),y!==void 0&&m(y,d-1,!0)})();return d===0&&(h=c(this)),h})},t.exports=e.default})(Ls,Ls.exports);var jm=Ls.exports,Ds={exports:{}};(function(t,e){e.__esModule=!0;function n(s){return s&&s.__esModule?s:{default:s}}var r=je,i=n(r);e.default=function(s){s.registerHelper("helperMissing",function(){if(arguments.length!==1)throw new i.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})},t.exports=e.default})(Ds,Ds.exports);var Wm=Ds.exports,Fs={exports:{}};(function(t,e){e.__esModule=!0;function n(o){return o&&o.__esModule?o:{default:o}}var r=Z,i=je,s=n(i);e.default=function(o){o.registerHelper("if",function(a,l){if(arguments.length!=2)throw new s.default("#if requires exactly one argument");return r.isFunction(a)&&(a=a.call(this)),!l.hash.includeZero&&!a||r.isEmpty(a)?l.inverse(this):l.fn(this)}),o.registerHelper("unless",function(a,l){if(arguments.length!=2)throw new s.default("#unless requires exactly one argument");return o.helpers.if.call(this,a,{fn:l.inverse,inverse:l.fn,hash:l.hash})})},t.exports=e.default})(Fs,Fs.exports);var qm=Fs.exports,Bs={exports:{}};(function(t,e){e.__esModule=!0,e.default=function(n){n.registerHelper("log",function(){for(var r=[void 0],i=arguments[arguments.length-1],s=0;s<arguments.length-1;s++)r.push(arguments[s]);var o=1;i.hash.level!=null?o=i.hash.level:i.data&&i.data.level!=null&&(o=i.data.level),r[0]=o,n.log.apply(n,r)})},t.exports=e.default})(Bs,Bs.exports);var Vm=Bs.exports,$s={exports:{}};(function(t,e){e.__esModule=!0,e.default=function(n){n.registerHelper("lookup",function(r,i,s){return r&&s.lookupProperty(r,i)})},t.exports=e.default})($s,$s.exports);var Jm=$s.exports,Us={exports:{}};(function(t,e){e.__esModule=!0;function n(o){return o&&o.__esModule?o:{default:o}}var r=Z,i=je,s=n(i);e.default=function(o){o.registerHelper("with",function(a,l){if(arguments.length!=2)throw new s.default("#with requires exactly one argument");r.isFunction(a)&&(a=a.call(this));var u=l.fn;if(r.isEmpty(a))return l.inverse(this);var c=l.data;return l.data&&l.ids&&(c=r.createFrame(l.data),c.contextPath=r.appendContextPath(l.data.contextPath,l.ids[0])),u(a,{data:c,blockParams:r.blockParams([a],[c&&c.contextPath])})})},t.exports=e.default})(Us,Us.exports);var Gm=Us.exports;tr.__esModule=!0;tr.registerDefaultHelpers=cg;tr.moveHelperToHooks=ug;function Ut(t){return t&&t.__esModule?t:{default:t}}var Km=zm,Ym=Ut(Km),Xm=jm,Zm=Ut(Xm),Qm=Wm,eg=Ut(Qm),tg=qm,ng=Ut(tg),rg=Vm,ig=Ut(rg),sg=Jm,og=Ut(sg),ag=Gm,lg=Ut(ag);function cg(t){Ym.default(t),Zm.default(t),eg.default(t),ng.default(t),ig.default(t),og.default(t),lg.default(t)}function ug(t,e,n){t.helpers[e]&&(t.hooks[e]=t.helpers[e],n||delete t.helpers[e])}var Wo={},Hs={exports:{}};(function(t,e){e.__esModule=!0;var n=Z;e.default=function(r){r.registerDecorator("inline",function(i,s,o,a){var l=i;return s.partials||(s.partials={},l=function(u,c){var d=o.partials;o.partials=n.extend({},d,s.partials);var h=i(u,c);return o.partials=d,h}),s.partials[a.args[0]]=a.fn,l})},t.exports=e.default})(Hs,Hs.exports);var hg=Hs.exports;Wo.__esModule=!0;Wo.registerDefaultDecorators=mg;function fg(t){return t&&t.__esModule?t:{default:t}}var dg=hg,pg=fg(dg);function mg(t){pg.default(t)}var zs={exports:{}};(function(t,e){e.__esModule=!0;var n=Z,r={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(s){if(typeof s=="string"){var o=n.indexOf(r.methodMap,s.toLowerCase());o>=0?s=o:s=parseInt(s,10)}return s},log:function(s){if(s=r.lookupLevel(s),typeof console<"u"&&r.lookupLevel(r.level)<=s){var o=r.methodMap[s];console[o]||(o="log");for(var a=arguments.length,l=Array(a>1?a-1:0),u=1;u<a;u++)l[u-1]=arguments[u];console[o].apply(console,l)}}};e.default=r,t.exports=e.default})(zs,zs.exports);var yu=zs.exports,hn={},qo={};qo.__esModule=!0;qo.createNewLookupObject=yg;var gg=Z;function yg(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return gg.extend.apply(void 0,[Object.create(null)].concat(e))}hn.__esModule=!0;hn.createProtoAccessControl=bg;hn.resultIsAllowed=kg;hn.resetLoggedProperties=Sg;function vg(t){return t&&t.__esModule?t:{default:t}}var Pl=qo,wg=yu,_g=vg(wg),Zr=Object.create(null);function bg(t){var e=Object.create(null);e.constructor=!1,e.__defineGetter__=!1,e.__defineSetter__=!1,e.__lookupGetter__=!1;var n=Object.create(null);return n.__proto__=!1,{properties:{whitelist:Pl.createNewLookupObject(n,t.allowedProtoProperties),defaultValue:t.allowProtoPropertiesByDefault},methods:{whitelist:Pl.createNewLookupObject(e,t.allowedProtoMethods),defaultValue:t.allowProtoMethodsByDefault}}}function kg(t,e,n){return Nl(typeof t=="function"?e.methods:e.properties,n)}function Nl(t,e){return t.whitelist[e]!==void 0?t.whitelist[e]===!0:t.defaultValue!==void 0?t.defaultValue:(xg(e),!1)}function xg(t){Zr[t]!==!0&&(Zr[t]=!0,_g.default.log("error",'Handlebars: Access has been denied to resolve the property "'+t+`" because it is not an "own property" of its parent.
You can add a runtime option to disable the check or this warning:
See https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details`))}function Sg(){Object.keys(Zr).forEach(function(t){delete Zr[t]})}Ne.__esModule=!0;Ne.HandlebarsEnvironment=js;function vu(t){return t&&t.__esModule?t:{default:t}}var At=Z,Eg=je,es=vu(Eg),Cg=tr,Ag=Wo,Og=yu,Qr=vu(Og),Tg=hn,Rg="4.7.8";Ne.VERSION=Rg;var Ig=8;Ne.COMPILER_REVISION=Ig;var Pg=7;Ne.LAST_COMPATIBLE_COMPILER_REVISION=Pg;var Ng={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};Ne.REVISION_CHANGES=Ng;var ts="[object Object]";function js(t,e,n){this.helpers=t||{},this.partials=e||{},this.decorators=n||{},Cg.registerDefaultHelpers(this),Ag.registerDefaultDecorators(this)}js.prototype={constructor:js,logger:Qr.default,log:Qr.default.log,registerHelper:function(e,n){if(At.toString.call(e)===ts){if(n)throw new es.default("Arg not supported with multiple helpers");At.extend(this.helpers,e)}else this.helpers[e]=n},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,n){if(At.toString.call(e)===ts)At.extend(this.partials,e);else{if(typeof n>"u")throw new es.default('Attempting to register a partial called "'+e+'" as undefined');this.partials[e]=n}},unregisterPartial:function(e){delete this.partials[e]},registerDecorator:function(e,n){if(At.toString.call(e)===ts){if(n)throw new es.default("Arg not supported with multiple decorators");At.extend(this.decorators,e)}else this.decorators[e]=n},unregisterDecorator:function(e){delete this.decorators[e]},resetLoggedPropertyAccesses:function(){Tg.resetLoggedProperties()}};var Mg=Qr.default.log;Ne.log=Mg;Ne.createFrame=At.createFrame;Ne.logger=Qr.default;var Ws={exports:{}};(function(t,e){e.__esModule=!0;function n(r){this.string=r}n.prototype.toString=n.prototype.toHTML=function(){return""+this.string},e.default=n,t.exports=e.default})(Ws,Ws.exports);var Lg=Ws.exports,kt={},Vo={};Vo.__esModule=!0;Vo.wrapHelper=Dg;function Dg(t,e){if(typeof t!="function")return t;var n=function(){var i=arguments[arguments.length-1];return arguments[arguments.length-1]=e(i),t.apply(this,arguments)};return n}kt.__esModule=!0;kt.checkRevision=zg;kt.template=jg;kt.wrapProgram=Br;kt.resolvePartial=Wg;kt.invokePartial=qg;kt.noop=wu;function Fg(t){return t&&t.__esModule?t:{default:t}}function Bg(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}var $g=Z,rt=Bg($g),Ug=je,it=Fg(Ug),st=Ne,Ml=tr,Hg=Vo,Ll=hn;function zg(t){var e=t&&t[0]||1,n=st.COMPILER_REVISION;if(!(e>=st.LAST_COMPATIBLE_COMPILER_REVISION&&e<=st.COMPILER_REVISION))if(e<st.LAST_COMPATIBLE_COMPILER_REVISION){var r=st.REVISION_CHANGES[n],i=st.REVISION_CHANGES[e];throw new it.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+r+") or downgrade your runtime to an older version ("+i+").")}else throw new it.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}function jg(t,e){if(!e)throw new it.default("No environment passed to template");if(!t||!t.main)throw new it.default("Unknown template object: "+typeof t);t.main.decorator=t.main_d,e.VM.checkRevision(t.compiler);var n=t.compiler&&t.compiler[0]===7;function r(o,a,l){l.hash&&(a=rt.extend({},a,l.hash),l.ids&&(l.ids[0]=!0)),o=e.VM.resolvePartial.call(this,o,a,l);var u=rt.extend({},l,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),c=e.VM.invokePartial.call(this,o,a,u);if(c==null&&e.compile&&(l.partials[l.name]=e.compile(o,t.compilerOptions,e),c=l.partials[l.name](a,u)),c!=null){if(l.indent){for(var d=c.split(`
`),h=0,p=d.length;h<p&&!(!d[h]&&h+1===p);h++)d[h]=l.indent+d[h];c=d.join(`
`)}return c}else throw new it.default("The partial "+l.name+" could not be compiled when running in runtime-only mode")}var i={strict:function(a,l,u){if(!a||!(l in a))throw new it.default('"'+l+'" not defined in '+a,{loc:u});return i.lookupProperty(a,l)},lookupProperty:function(a,l){var u=a[l];if(u==null||Object.prototype.hasOwnProperty.call(a,l)||Ll.resultIsAllowed(u,i.protoAccessControl,l))return u},lookup:function(a,l){for(var u=a.length,c=0;c<u;c++){var d=a[c]&&i.lookupProperty(a[c],l);if(d!=null)return a[c][l]}},lambda:function(a,l){return typeof a=="function"?a.call(l):a},escapeExpression:rt.escapeExpression,invokePartial:r,fn:function(a){var l=t[a];return l.decorator=t[a+"_d"],l},programs:[],program:function(a,l,u,c,d){var h=this.programs[a],p=this.fn(a);return l||d||c||u?h=Br(this,a,p,l,u,c,d):h||(h=this.programs[a]=Br(this,a,p)),h},data:function(a,l){for(;a&&l--;)a=a._parent;return a},mergeIfNeeded:function(a,l){var u=a||l;return a&&l&&a!==l&&(u=rt.extend({},l,a)),u},nullContext:Object.seal({}),noop:e.VM.noop,compilerInfo:t.compiler};function s(o){var a=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],l=a.data;s._setup(a),!a.partial&&t.useData&&(l=Vg(o,l));var u=void 0,c=t.useBlockParams?[]:void 0;t.useDepths&&(a.depths?u=o!=a.depths[0]?[o].concat(a.depths):a.depths:u=[o]);function d(h){return""+t.main(i,h,i.helpers,i.partials,l,c,u)}return d=_u(t.main,d,i,a.depths||[],l,c),d(o,a)}return s.isTop=!0,s._setup=function(o){if(o.partial)i.protoAccessControl=o.protoAccessControl,i.helpers=o.helpers,i.partials=o.partials,i.decorators=o.decorators,i.hooks=o.hooks;else{var a=rt.extend({},e.helpers,o.helpers);Jg(a,i),i.helpers=a,t.usePartial&&(i.partials=i.mergeIfNeeded(o.partials,e.partials)),(t.usePartial||t.useDecorators)&&(i.decorators=rt.extend({},e.decorators,o.decorators)),i.hooks={},i.protoAccessControl=Ll.createProtoAccessControl(o);var l=o.allowCallsToHelperMissing||n;Ml.moveHelperToHooks(i,"helperMissing",l),Ml.moveHelperToHooks(i,"blockHelperMissing",l)}},s._child=function(o,a,l,u){if(t.useBlockParams&&!l)throw new it.default("must pass block params");if(t.useDepths&&!u)throw new it.default("must pass parent depths");return Br(i,o,t[o],a,0,l,u)},s}function Br(t,e,n,r,i,s,o){function a(l){var u=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],c=o;return o&&l!=o[0]&&!(l===t.nullContext&&o[0]===null)&&(c=[l].concat(o)),n(t,l,t.helpers,t.partials,u.data||r,s&&[u.blockParams].concat(s),c)}return a=_u(n,a,t,o,r,s),a.program=e,a.depth=o?o.length:0,a.blockParams=i||0,a}function Wg(t,e,n){return t?!t.call&&!n.name&&(n.name=t,t=n.partials[t]):n.name==="@partial-block"?t=n.data["partial-block"]:t=n.partials[n.name],t}function qg(t,e,n){var r=n.data&&n.data["partial-block"];n.partial=!0,n.ids&&(n.data.contextPath=n.ids[0]||n.data.contextPath);var i=void 0;if(n.fn&&n.fn!==wu&&function(){n.data=st.createFrame(n.data);var s=n.fn;i=n.data["partial-block"]=function(a){var l=arguments.length<=1||arguments[1]===void 0?{}:arguments[1];return l.data=st.createFrame(l.data),l.data["partial-block"]=r,s(a,l)},s.partials&&(n.partials=rt.extend({},n.partials,s.partials))}(),t===void 0&&i&&(t=i),t===void 0)throw new it.default("The partial "+n.name+" could not be found");if(t instanceof Function)return t(e,n)}function wu(){return""}function Vg(t,e){return(!e||!("root"in e))&&(e=e?st.createFrame(e):{},e.root=t),e}function _u(t,e,n,r,i,s){if(t.decorator){var o={};e=t.decorator(e,o,n,r&&r[0],i,s,r),rt.extend(e,o)}return e}function Jg(t,e){Object.keys(t).forEach(function(n){var r=t[n];t[n]=Gg(r,e)})}function Gg(t,e){var n=e.lookupProperty;return Hg.wrapHelper(t,function(r){return rt.extend({lookupProperty:n},r)})}var qs={exports:{}};(function(t,e){e.__esModule=!0,e.default=function(n){(function(){typeof globalThis!="object"&&(Object.prototype.__defineGetter__("__magic__",function(){return this}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__)})();var r=globalThis.Handlebars;n.noConflict=function(){return globalThis.Handlebars===n&&(globalThis.Handlebars=r),n}},t.exports=e.default})(qs,qs.exports);var bu=qs.exports;(function(t,e){e.__esModule=!0;function n(v){return v&&v.__esModule?v:{default:v}}function r(v){if(v&&v.__esModule)return v;var b={};if(v!=null)for(var y in v)Object.prototype.hasOwnProperty.call(v,y)&&(b[y]=v[y]);return b.default=v,b}var i=Ne,s=r(i),o=Lg,a=n(o),l=je,u=n(l),c=Z,d=r(c),h=kt,p=r(h),f=bu,m=n(f);function g(){var v=new s.HandlebarsEnvironment;return d.extend(v,s),v.SafeString=a.default,v.Exception=u.default,v.Utils=d,v.escapeExpression=d.escapeExpression,v.VM=p,v.template=function(b){return p.template(b,v)},v}var w=g();w.create=g,m.default(w),w.default=w,e.default=w,t.exports=e.default})(Is,Is.exports);var Kg=Is.exports,Vs={exports:{}};(function(t,e){e.__esModule=!0;var n={helpers:{helperExpression:function(i){return i.type==="SubExpression"||(i.type==="MustacheStatement"||i.type==="BlockStatement")&&!!(i.params&&i.params.length||i.hash)},scopedId:function(i){return/^\.|this\b/.test(i.original)},simpleId:function(i){return i.parts.length===1&&!n.helpers.scopedId(i)&&!i.depth}}};e.default=n,t.exports=e.default})(Vs,Vs.exports);var ku=Vs.exports,nr={},Js={exports:{}};(function(t,e){e.__esModule=!0;var n=function(){var r={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,0],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function(a,l,u,c,d,h,p){var f=h.length-1;switch(d){case 1:return h[f-1];case 2:this.$=c.prepareProgram(h[f]);break;case 3:this.$=h[f];break;case 4:this.$=h[f];break;case 5:this.$=h[f];break;case 6:this.$=h[f];break;case 7:this.$=h[f];break;case 8:this.$=h[f];break;case 9:this.$={type:"CommentStatement",value:c.stripComment(h[f]),strip:c.stripFlags(h[f],h[f]),loc:c.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:h[f],value:h[f],loc:c.locInfo(this._$)};break;case 11:this.$=c.prepareRawBlock(h[f-2],h[f-1],h[f],this._$);break;case 12:this.$={path:h[f-3],params:h[f-2],hash:h[f-1]};break;case 13:this.$=c.prepareBlock(h[f-3],h[f-2],h[f-1],h[f],!1,this._$);break;case 14:this.$=c.prepareBlock(h[f-3],h[f-2],h[f-1],h[f],!0,this._$);break;case 15:this.$={open:h[f-5],path:h[f-4],params:h[f-3],hash:h[f-2],blockParams:h[f-1],strip:c.stripFlags(h[f-5],h[f])};break;case 16:this.$={path:h[f-4],params:h[f-3],hash:h[f-2],blockParams:h[f-1],strip:c.stripFlags(h[f-5],h[f])};break;case 17:this.$={path:h[f-4],params:h[f-3],hash:h[f-2],blockParams:h[f-1],strip:c.stripFlags(h[f-5],h[f])};break;case 18:this.$={strip:c.stripFlags(h[f-1],h[f-1]),program:h[f]};break;case 19:var m=c.prepareBlock(h[f-2],h[f-1],h[f],h[f],!1,this._$),g=c.prepareProgram([m],h[f-1].loc);g.chained=!0,this.$={strip:h[f-2].strip,program:g,chain:!0};break;case 20:this.$=h[f];break;case 21:this.$={path:h[f-1],strip:c.stripFlags(h[f-2],h[f])};break;case 22:this.$=c.prepareMustache(h[f-3],h[f-2],h[f-1],h[f-4],c.stripFlags(h[f-4],h[f]),this._$);break;case 23:this.$=c.prepareMustache(h[f-3],h[f-2],h[f-1],h[f-4],c.stripFlags(h[f-4],h[f]),this._$);break;case 24:this.$={type:"PartialStatement",name:h[f-3],params:h[f-2],hash:h[f-1],indent:"",strip:c.stripFlags(h[f-4],h[f]),loc:c.locInfo(this._$)};break;case 25:this.$=c.preparePartialBlock(h[f-2],h[f-1],h[f],this._$);break;case 26:this.$={path:h[f-3],params:h[f-2],hash:h[f-1],strip:c.stripFlags(h[f-4],h[f])};break;case 27:this.$=h[f];break;case 28:this.$=h[f];break;case 29:this.$={type:"SubExpression",path:h[f-3],params:h[f-2],hash:h[f-1],loc:c.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:h[f],loc:c.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:c.id(h[f-2]),value:h[f],loc:c.locInfo(this._$)};break;case 32:this.$=c.id(h[f-1]);break;case 33:this.$=h[f];break;case 34:this.$=h[f];break;case 35:this.$={type:"StringLiteral",value:h[f],original:h[f],loc:c.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(h[f]),original:Number(h[f]),loc:c.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:h[f]==="true",original:h[f]==="true",loc:c.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:void 0,value:void 0,loc:c.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:c.locInfo(this._$)};break;case 40:this.$=h[f];break;case 41:this.$=h[f];break;case 42:this.$=c.preparePath(!0,h[f],this._$);break;case 43:this.$=c.preparePath(!1,h[f],this._$);break;case 44:h[f-2].push({part:c.id(h[f]),original:h[f],separator:h[f-1]}),this.$=h[f-2];break;case 45:this.$=[{part:c.id(h[f]),original:h[f]}];break;case 46:this.$=[];break;case 47:h[f-1].push(h[f]);break;case 48:this.$=[];break;case 49:h[f-1].push(h[f]);break;case 50:this.$=[];break;case 51:h[f-1].push(h[f]);break;case 58:this.$=[];break;case 59:h[f-1].push(h[f]);break;case 64:this.$=[];break;case 65:h[f-1].push(h[f]);break;case 70:this.$=[];break;case 71:h[f-1].push(h[f]);break;case 78:this.$=[];break;case 79:h[f-1].push(h[f]);break;case 82:this.$=[];break;case 83:h[f-1].push(h[f]);break;case 86:this.$=[];break;case 87:h[f-1].push(h[f]);break;case 90:this.$=[];break;case 91:h[f-1].push(h[f]);break;case 94:this.$=[];break;case 95:h[f-1].push(h[f]);break;case 98:this.$=[h[f]];break;case 99:h[f-1].push(h[f]);break;case 100:this.$=[h[f]];break;case 101:h[f-1].push(h[f]);break}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{15:[2,48],17:39,18:[2,48]},{20:41,56:40,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:44,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:45,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:41,56:48,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:49,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,50]},{72:[1,35],86:51},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:52,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:53,38:55,39:[1,57],43:56,44:[1,58],45:54,47:[2,54]},{28:59,43:60,44:[1,58],47:[2,56]},{13:62,15:[1,20],18:[1,61]},{33:[2,86],57:63,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:64,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:65,47:[1,66]},{30:67,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:68,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:69,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:70,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:74,33:[2,80],50:71,63:72,64:75,65:[1,43],69:73,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,79]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,50]},{20:74,53:80,54:[2,84],63:81,64:75,65:[1,43],69:82,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:83,47:[1,66]},{47:[2,55]},{4:84,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:85,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:86,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:87,47:[1,66]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:74,33:[2,88],58:88,63:89,64:75,65:[1,43],69:90,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:91,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:92,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,31:93,33:[2,60],63:94,64:75,65:[1,43],69:95,70:76,71:77,72:[1,78],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,66],36:96,63:97,64:75,65:[1,43],69:98,70:76,71:77,72:[1,78],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,22:99,23:[2,52],63:100,64:75,65:[1,43],69:101,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,92],62:102,63:103,64:75,65:[1,43],69:104,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,105]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:106,72:[1,107],75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,108],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,109]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:55,39:[1,57],43:56,44:[1,58],45:111,46:110,47:[2,76]},{33:[2,70],40:112,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,113]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:74,63:115,64:75,65:[1,43],67:114,68:[2,96],69:116,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,117]},{32:118,33:[2,62],74:119,75:[1,120]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:121,74:122,75:[1,120]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,123]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,124]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,108]},{20:74,63:125,64:75,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:74,33:[2,72],41:126,63:127,64:75,65:[1,43],69:128,70:76,71:77,72:[1,78],75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,129]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,130]},{33:[2,63]},{72:[1,132],76:131},{33:[1,133]},{33:[2,69]},{15:[2,12],18:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:134,74:135,75:[1,120]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,137],77:[1,136]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,138]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],54:[2,55],56:[2,20],60:[2,57],73:[2,81],82:[2,85],86:[2,18],90:[2,89],101:[2,53],104:[2,93],110:[2,19],111:[2,77],116:[2,97],119:[2,63],122:[2,69],135:[2,75],136:[2,32]},parseError:function(a,l){throw new Error(a)},parse:function(a){var l=this,u=[0],c=[null],d=[],h=this.table,p="",f=0,m=0;this.lexer.setInput(a),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,typeof this.lexer.yylloc>"u"&&(this.lexer.yylloc={});var g=this.lexer.yylloc;d.push(g);var w=this.lexer.options&&this.lexer.options.ranges;typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);function v(){var D;return D=l.lexer.lex()||1,typeof D!="number"&&(D=l.symbols_[D]||D),D}for(var b,y,_,A,S={},I,z,x,E;;){if(y=u[u.length-1],this.defaultActions[y]?_=this.defaultActions[y]:((b===null||typeof b>"u")&&(b=v()),_=h[y]&&h[y][b]),typeof _>"u"||!_.length||!_[0]){var R="";{E=[];for(I in h[y])this.terminals_[I]&&I>2&&E.push("'"+this.terminals_[I]+"'");this.lexer.showPosition?R="Parse error on line "+(f+1)+`:
`+this.lexer.showPosition()+`
Expecting `+E.join(", ")+", got '"+(this.terminals_[b]||b)+"'":R="Parse error on line "+(f+1)+": Unexpected "+(b==1?"end of input":"'"+(this.terminals_[b]||b)+"'"),this.parseError(R,{text:this.lexer.match,token:this.terminals_[b]||b,line:this.lexer.yylineno,loc:g,expected:E})}}if(_[0]instanceof Array&&_.length>1)throw new Error("Parse Error: multiple actions possible at state: "+y+", token: "+b);switch(_[0]){case 1:u.push(b),c.push(this.lexer.yytext),d.push(this.lexer.yylloc),u.push(_[1]),b=null,m=this.lexer.yyleng,p=this.lexer.yytext,f=this.lexer.yylineno,g=this.lexer.yylloc;break;case 2:if(z=this.productions_[_[1]][1],S.$=c[c.length-z],S._$={first_line:d[d.length-(z||1)].first_line,last_line:d[d.length-1].last_line,first_column:d[d.length-(z||1)].first_column,last_column:d[d.length-1].last_column},w&&(S._$.range=[d[d.length-(z||1)].range[0],d[d.length-1].range[1]]),A=this.performAction.call(S,p,m,f,this.yy,_[1],c,d),typeof A<"u")return A;z&&(u=u.slice(0,-1*z*2),c=c.slice(0,-1*z),d=d.slice(0,-1*z)),u.push(this.productions_[_[1]][0]),c.push(S.$),d.push(S._$),x=h[u[u.length-2]][u[u.length-1]],u.push(x);break;case 3:return!0}}return!0}},i=function(){var o={EOF:1,parseError:function(l,u){if(this.yy.parser)this.yy.parser.parseError(l,u);else throw new Error(l)},setInput:function(l){return this._input=l,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var l=this._input[0];this.yytext+=l,this.yyleng++,this.offset++,this.match+=l,this.matched+=l;var u=l.match(/(?:\r\n?|\n).*/g);return u?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),l},unput:function(l){var u=l.length,c=l.split(/(?:\r\n?|\n)/g);this._input=l+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-u-1),this.offset-=u;var d=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),c.length-1&&(this.yylineno-=c.length-1);var h=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:c?(c.length===d.length?this.yylloc.first_column:0)+d[d.length-c.length].length-c[0].length:this.yylloc.first_column-u},this.options.ranges&&(this.yylloc.range=[h[0],h[0]+this.yyleng-u]),this},more:function(){return this._more=!0,this},less:function(l){this.unput(this.match.slice(l))},pastInput:function(){var l=this.matched.substr(0,this.matched.length-this.match.length);return(l.length>20?"...":"")+l.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var l=this.match;return l.length<20&&(l+=this._input.substr(0,20-l.length)),(l.substr(0,20)+(l.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var l=this.pastInput(),u=new Array(l.length+1).join("-");return l+this.upcomingInput()+`
`+u+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var l,u,c,d,h;this._more||(this.yytext="",this.match="");for(var p=this._currentRules(),f=0;f<p.length&&(c=this._input.match(this.rules[p[f]]),!(c&&(!u||c[0].length>u[0].length)&&(u=c,d=f,!this.options.flex)));f++);return u?(h=u[0].match(/(?:\r\n?|\n).*/g),h&&(this.yylineno+=h.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:h?h[h.length-1].length-h[h.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+u[0].length},this.yytext+=u[0],this.match+=u[0],this.matches=u,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(u[0].length),this.matched+=u[0],l=this.performAction.call(this,this.yy,this,p[d],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),l||void 0):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var l=this.next();return typeof l<"u"?l:this.lex()},begin:function(l){this.conditionStack.push(l)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(l){this.begin(l)}};return o.options={},o.performAction=function(l,u,c,d){function h(p,f){return u.yytext=u.yytext.substring(p,u.yyleng-f+p)}switch(c){case 0:if(u.yytext.slice(-2)==="\\\\"?(h(0,1),this.begin("mu")):u.yytext.slice(-1)==="\\"?(h(0,1),this.begin("emu")):this.begin("mu"),u.yytext)return 15;break;case 1:return 15;case 2:return this.popState(),15;case 3:return this.begin("raw"),15;case 4:return this.popState(),this.conditionStack[this.conditionStack.length-1]==="raw"?15:(h(5,9),"END_RAW_BLOCK");case 5:return 15;case 6:return this.popState(),14;case 7:return 65;case 8:return 68;case 9:return 19;case 10:return this.popState(),this.begin("raw"),23;case 11:return 55;case 12:return 60;case 13:return 29;case 14:return 47;case 15:return this.popState(),44;case 16:return this.popState(),44;case 17:return 34;case 18:return 39;case 19:return 51;case 20:return 48;case 21:this.unput(u.yytext),this.popState(),this.begin("com");break;case 22:return this.popState(),14;case 23:return 48;case 24:return 73;case 25:return 72;case 26:return 72;case 27:return 87;case 28:break;case 29:return this.popState(),54;case 30:return this.popState(),33;case 31:return u.yytext=h(1,2).replace(/\\"/g,'"'),80;case 32:return u.yytext=h(1,2).replace(/\\'/g,"'"),80;case 33:return 85;case 34:return 82;case 35:return 82;case 36:return 83;case 37:return 84;case 38:return 81;case 39:return 75;case 40:return 77;case 41:return 72;case 42:return u.yytext=u.yytext.replace(/\\([\\\]])/g,"$1"),72;case 43:return"INVALID";case 44:return 5}},o.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]+?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[(\\\]|[^\]])*\])/,/^(?:.)/,/^(?:$)/],o.conditions={mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[6],inclusive:!1},raw:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,44],inclusive:!0}},o}();r.lexer=i;function s(){this.yy={}}return s.prototype=r,r.Parser=s,new s}();e.default=n,t.exports=e.default})(Js,Js.exports);var Yg=Js.exports,Gs={exports:{}},Ks={exports:{}};(function(t,e){e.__esModule=!0;function n(u){return u&&u.__esModule?u:{default:u}}var r=je,i=n(r);function s(){this.parents=[]}s.prototype={constructor:s,mutating:!1,acceptKey:function(c,d){var h=this.accept(c[d]);if(this.mutating){if(h&&!s.prototype[h.type])throw new i.default('Unexpected node type "'+h.type+'" found when accepting '+d+" on "+c.type);c[d]=h}},acceptRequired:function(c,d){if(this.acceptKey(c,d),!c[d])throw new i.default(c.type+" requires "+d)},acceptArray:function(c){for(var d=0,h=c.length;d<h;d++)this.acceptKey(c,d),c[d]||(c.splice(d,1),d--,h--)},accept:function(c){if(c){if(!this[c.type])throw new i.default("Unknown type: "+c.type,c);this.current&&this.parents.unshift(this.current),this.current=c;var d=this[c.type](c);if(this.current=this.parents.shift(),!this.mutating||d)return d;if(d!==!1)return c}},Program:function(c){this.acceptArray(c.body)},MustacheStatement:o,Decorator:o,BlockStatement:a,DecoratorBlock:a,PartialStatement:l,PartialBlockStatement:function(c){l.call(this,c),this.acceptKey(c,"program")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:o,PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(c){this.acceptArray(c.pairs)},HashPair:function(c){this.acceptRequired(c,"value")}};function o(u){this.acceptRequired(u,"path"),this.acceptArray(u.params),this.acceptKey(u,"hash")}function a(u){o.call(this,u),this.acceptKey(u,"program"),this.acceptKey(u,"inverse")}function l(u){this.acceptRequired(u,"name"),this.acceptArray(u.params),this.acceptKey(u,"hash")}e.default=s,t.exports=e.default})(Ks,Ks.exports);var xu=Ks.exports;(function(t,e){e.__esModule=!0;function n(c){return c&&c.__esModule?c:{default:c}}var r=xu,i=n(r);function s(){var c=arguments.length<=0||arguments[0]===void 0?{}:arguments[0];this.options=c}s.prototype=new i.default,s.prototype.Program=function(c){var d=!this.options.ignoreStandalone,h=!this.isRootSeen;this.isRootSeen=!0;for(var p=c.body,f=0,m=p.length;f<m;f++){var g=p[f],w=this.accept(g);if(w){var v=o(p,f,h),b=a(p,f,h),y=w.openStandalone&&v,_=w.closeStandalone&&b,A=w.inlineStandalone&&v&&b;w.close&&l(p,f,!0),w.open&&u(p,f,!0),d&&A&&(l(p,f),u(p,f)&&g.type==="PartialStatement"&&(g.indent=/([ \t]+$)/.exec(p[f-1].original)[1])),d&&y&&(l((g.program||g.inverse).body),u(p,f)),d&&_&&(l(p,f),u((g.inverse||g.program).body))}}return c},s.prototype.BlockStatement=s.prototype.DecoratorBlock=s.prototype.PartialBlockStatement=function(c){this.accept(c.program),this.accept(c.inverse);var d=c.program||c.inverse,h=c.program&&c.inverse,p=h,f=h;if(h&&h.chained)for(p=h.body[0].program;f.chained;)f=f.body[f.body.length-1].program;var m={open:c.openStrip.open,close:c.closeStrip.close,openStandalone:a(d.body),closeStandalone:o((p||d).body)};if(c.openStrip.close&&l(d.body,null,!0),h){var g=c.inverseStrip;g.open&&u(d.body,null,!0),g.close&&l(p.body,null,!0),c.closeStrip.open&&u(f.body,null,!0),!this.options.ignoreStandalone&&o(d.body)&&a(p.body)&&(u(d.body),l(p.body))}else c.closeStrip.open&&u(d.body,null,!0);return m},s.prototype.Decorator=s.prototype.MustacheStatement=function(c){return c.strip},s.prototype.PartialStatement=s.prototype.CommentStatement=function(c){var d=c.strip||{};return{inlineStandalone:!0,open:d.open,close:d.close}};function o(c,d,h){d===void 0&&(d=c.length);var p=c[d-1],f=c[d-2];if(!p)return h;if(p.type==="ContentStatement")return(f||!h?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(p.original)}function a(c,d,h){d===void 0&&(d=-1);var p=c[d+1],f=c[d+2];if(!p)return h;if(p.type==="ContentStatement")return(f||!h?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(p.original)}function l(c,d,h){var p=c[d==null?0:d+1];if(!(!p||p.type!=="ContentStatement"||!h&&p.rightStripped)){var f=p.value;p.value=p.value.replace(h?/^\s+/:/^[ \t]*\r?\n?/,""),p.rightStripped=p.value!==f}}function u(c,d,h){var p=c[d==null?c.length-1:d-1];if(!(!p||p.type!=="ContentStatement"||!h&&p.leftStripped)){var f=p.value;return p.value=p.value.replace(h?/\s+$/:/[ \t]+$/,""),p.leftStripped=p.value!==f,p.leftStripped}}e.default=s,t.exports=e.default})(Gs,Gs.exports);var Xg=Gs.exports,Me={};Me.__esModule=!0;Me.SourceLocation=ey;Me.id=ty;Me.stripFlags=ny;Me.stripComment=ry;Me.preparePath=iy;Me.prepareMustache=sy;Me.prepareRawBlock=oy;Me.prepareBlock=ay;Me.prepareProgram=ly;Me.preparePartialBlock=cy;function Zg(t){return t&&t.__esModule?t:{default:t}}var Qg=je,Jo=Zg(Qg);function Go(t,e){if(e=e.path?e.path.original:e,t.path.original!==e){var n={loc:t.path.loc};throw new Jo.default(t.path.original+" doesn't match "+e,n)}}function ey(t,e){this.source=t,this.start={line:e.first_line,column:e.first_column},this.end={line:e.last_line,column:e.last_column}}function ty(t){return/^\[.*\]$/.test(t)?t.substring(1,t.length-1):t}function ny(t,e){return{open:t.charAt(2)==="~",close:e.charAt(e.length-3)==="~"}}function ry(t){return t.replace(/^\{\{~?!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function iy(t,e,n){n=this.locInfo(n);for(var r=t?"@":"",i=[],s=0,o=0,a=e.length;o<a;o++){var l=e[o].part,u=e[o].original!==l;if(r+=(e[o].separator||"")+l,!u&&(l===".."||l==="."||l==="this")){if(i.length>0)throw new Jo.default("Invalid path: "+r,{loc:n});l===".."&&s++}else i.push(l)}return{type:"PathExpression",data:t,depth:s,parts:i,original:r,loc:n}}function sy(t,e,n,r,i,s){var o=r.charAt(3)||r.charAt(2),a=o!=="{"&&o!=="&",l=/\*/.test(r);return{type:l?"Decorator":"MustacheStatement",path:t,params:e,hash:n,escaped:a,strip:i,loc:this.locInfo(s)}}function oy(t,e,n,r){Go(t,n),r=this.locInfo(r);var i={type:"Program",body:e,strip:{},loc:r};return{type:"BlockStatement",path:t.path,params:t.params,hash:t.hash,program:i,openStrip:{},inverseStrip:{},closeStrip:{},loc:r}}function ay(t,e,n,r,i,s){r&&r.path&&Go(t,r);var o=/\*/.test(t.open);e.blockParams=t.blockParams;var a=void 0,l=void 0;if(n){if(o)throw new Jo.default("Unexpected inverse block on decorator",n);n.chain&&(n.program.body[0].closeStrip=r.strip),l=n.strip,a=n.program}return i&&(i=a,a=e,e=i),{type:o?"DecoratorBlock":"BlockStatement",path:t.path,params:t.params,hash:t.hash,program:e,inverse:a,openStrip:t.strip,inverseStrip:l,closeStrip:r&&r.strip,loc:this.locInfo(s)}}function ly(t,e){if(!e&&t.length){var n=t[0].loc,r=t[t.length-1].loc;n&&r&&(e={source:n.source,start:{line:n.start.line,column:n.start.column},end:{line:r.end.line,column:r.end.column}})}return{type:"Program",body:t,strip:{},loc:e}}function cy(t,e,n,r){return Go(t,n),{type:"PartialBlockStatement",name:t.path,params:t.params,hash:t.hash,program:e,openStrip:t.strip,closeStrip:n&&n.strip,loc:this.locInfo(r)}}nr.__esModule=!0;nr.parseWithoutProcessing=Eu;nr.parse=yy;function uy(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function Su(t){return t&&t.__esModule?t:{default:t}}var hy=Yg,Ys=Su(hy),fy=Xg,dy=Su(fy),py=Me,my=uy(py),gy=Z;nr.parser=Ys.default;var $r={};gy.extend($r,my);function Eu(t,e){if(t.type==="Program")return t;Ys.default.yy=$r,$r.locInfo=function(r){return new $r.SourceLocation(e&&e.srcName,r)};var n=Ys.default.parse(t);return n}function yy(t,e){var n=Eu(t,e),r=new dy.default(e);return r.accept(n)}var rr={};rr.__esModule=!0;rr.Compiler=Xs;rr.precompile=by;rr.compile=ky;function Cu(t){return t&&t.__esModule?t:{default:t}}var vy=je,Fn=Cu(vy),Jn=Z,wy=ku,xn=Cu(wy),_y=[].slice;function Xs(){}Xs.prototype={compiler:Xs,equals:function(e){var n=this.opcodes.length;if(e.opcodes.length!==n)return!1;for(var r=0;r<n;r++){var i=this.opcodes[r],s=e.opcodes[r];if(i.opcode!==s.opcode||!Au(i.args,s.args))return!1}n=this.children.length;for(var r=0;r<n;r++)if(!this.children[r].equals(e.children[r]))return!1;return!0},guid:0,compile:function(e,n){return this.sourceNode=[],this.opcodes=[],this.children=[],this.options=n,this.stringParams=n.stringParams,this.trackIds=n.trackIds,n.blockParams=n.blockParams||[],n.knownHelpers=Jn.extend(Object.create(null),{helperMissing:!0,blockHelperMissing:!0,each:!0,if:!0,unless:!0,with:!0,log:!0,lookup:!0},n.knownHelpers),this.accept(e)},compileProgram:function(e){var n=new this.compiler,r=n.compile(e,this.options),i=this.guid++;return this.usePartial=this.usePartial||r.usePartial,this.children[i]=r,this.useDepths=this.useDepths||r.useDepths,i},accept:function(e){if(!this[e.type])throw new Fn.default("Unknown type: "+e.type,e);this.sourceNode.unshift(e);var n=this[e.type](e);return this.sourceNode.shift(),n},Program:function(e){this.options.blockParams.unshift(e.blockParams);for(var n=e.body,r=n.length,i=0;i<r;i++)this.accept(n[i]);return this.options.blockParams.shift(),this.isSimple=r===1,this.blockParams=e.blockParams?e.blockParams.length:0,this},BlockStatement:function(e){Dl(e);var n=e.program,r=e.inverse;n=n&&this.compileProgram(n),r=r&&this.compileProgram(r);var i=this.classifySexpr(e);i==="helper"?this.helperSexpr(e,n,r):i==="simple"?(this.simpleSexpr(e),this.opcode("pushProgram",n),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("blockValue",e.path.original)):(this.ambiguousSexpr(e,n,r),this.opcode("pushProgram",n),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},DecoratorBlock:function(e){var n=e.program&&this.compileProgram(e.program),r=this.setupFullMustacheParams(e,n,void 0),i=e.path;this.useDecorators=!0,this.opcode("registerDecorator",r.length,i.original)},PartialStatement:function(e){this.usePartial=!0;var n=e.program;n&&(n=this.compileProgram(e.program));var r=e.params;if(r.length>1)throw new Fn.default("Unsupported number of partial arguments: "+r.length,e);r.length||(this.options.explicitPartialContext?this.opcode("pushLiteral","undefined"):r.push({type:"PathExpression",parts:[],depth:0}));var i=e.name.original,s=e.name.type==="SubExpression";s&&this.accept(e.name),this.setupFullMustacheParams(e,n,void 0,!0);var o=e.indent||"";this.options.preventIndent&&o&&(this.opcode("appendContent",o),o=""),this.opcode("invokePartial",s,i,o),this.opcode("append")},PartialBlockStatement:function(e){this.PartialStatement(e)},MustacheStatement:function(e){this.SubExpression(e),e.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},Decorator:function(e){this.DecoratorBlock(e)},ContentStatement:function(e){e.value&&this.opcode("appendContent",e.value)},CommentStatement:function(){},SubExpression:function(e){Dl(e);var n=this.classifySexpr(e);n==="simple"?this.simpleSexpr(e):n==="helper"?this.helperSexpr(e):this.ambiguousSexpr(e)},ambiguousSexpr:function(e,n,r){var i=e.path,s=i.parts[0],o=n!=null||r!=null;this.opcode("getContext",i.depth),this.opcode("pushProgram",n),this.opcode("pushProgram",r),i.strict=!0,this.accept(i),this.opcode("invokeAmbiguous",s,o)},simpleSexpr:function(e){var n=e.path;n.strict=!0,this.accept(n),this.opcode("resolvePossibleLambda")},helperSexpr:function(e,n,r){var i=this.setupFullMustacheParams(e,n,r),s=e.path,o=s.parts[0];if(this.options.knownHelpers[o])this.opcode("invokeKnownHelper",i.length,o);else{if(this.options.knownHelpersOnly)throw new Fn.default("You specified knownHelpersOnly, but used the unknown helper "+o,e);s.strict=!0,s.falsy=!0,this.accept(s),this.opcode("invokeHelper",i.length,s.original,xn.default.helpers.simpleId(s))}},PathExpression:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var n=e.parts[0],r=xn.default.helpers.scopedId(e),i=!e.depth&&!r&&this.blockParamIndex(n);i?this.opcode("lookupBlockParam",i,e.parts):n?e.data?(this.options.data=!0,this.opcode("lookupData",e.depth,e.parts,e.strict)):this.opcode("lookupOnContext",e.parts,e.falsy,e.strict,r):this.opcode("pushContext")},StringLiteral:function(e){this.opcode("pushString",e.value)},NumberLiteral:function(e){this.opcode("pushLiteral",e.value)},BooleanLiteral:function(e){this.opcode("pushLiteral",e.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(e){var n=e.pairs,r=0,i=n.length;for(this.opcode("pushHash");r<i;r++)this.pushParam(n[r].value);for(;r--;)this.opcode("assignToHash",n[r].key);this.opcode("popHash")},opcode:function(e){this.opcodes.push({opcode:e,args:_y.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(e){e&&(this.useDepths=!0)},classifySexpr:function(e){var n=xn.default.helpers.simpleId(e.path),r=n&&!!this.blockParamIndex(e.path.parts[0]),i=!r&&xn.default.helpers.helperExpression(e),s=!r&&(i||n);if(s&&!i){var o=e.path.parts[0],a=this.options;a.knownHelpers[o]?i=!0:a.knownHelpersOnly&&(s=!1)}return i?"helper":s?"ambiguous":"simple"},pushParams:function(e){for(var n=0,r=e.length;n<r;n++)this.pushParam(e[n])},pushParam:function(e){var n=e.value!=null?e.value:e.original||"";if(this.stringParams)n.replace&&(n=n.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),e.depth&&this.addDepth(e.depth),this.opcode("getContext",e.depth||0),this.opcode("pushStringParam",n,e.type),e.type==="SubExpression"&&this.accept(e);else{if(this.trackIds){var r=void 0;if(e.parts&&!xn.default.helpers.scopedId(e)&&!e.depth&&(r=this.blockParamIndex(e.parts[0])),r){var i=e.parts.slice(1).join(".");this.opcode("pushId","BlockParam",r,i)}else n=e.original||n,n.replace&&(n=n.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")),this.opcode("pushId",e.type,n)}this.accept(e)}},setupFullMustacheParams:function(e,n,r,i){var s=e.params;return this.pushParams(s),this.opcode("pushProgram",n),this.opcode("pushProgram",r),e.hash?this.accept(e.hash):this.opcode("emptyHash",i),s},blockParamIndex:function(e){for(var n=0,r=this.options.blockParams.length;n<r;n++){var i=this.options.blockParams[n],s=i&&Jn.indexOf(i,e);if(i&&s>=0)return[n,s]}}};function by(t,e,n){if(t==null||typeof t!="string"&&t.type!=="Program")throw new Fn.default("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+t);e=e||{},"data"in e||(e.data=!0),e.compat&&(e.useDepths=!0);var r=n.parse(t,e),i=new n.Compiler().compile(r,e);return new n.JavaScriptCompiler().compile(i,e)}function ky(t,e,n){if(e===void 0&&(e={}),t==null||typeof t!="string"&&t.type!=="Program")throw new Fn.default("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+t);e=Jn.extend({},e),"data"in e||(e.data=!0),e.compat&&(e.useDepths=!0);var r=void 0;function i(){var o=n.parse(t,e),a=new n.Compiler().compile(o,e),l=new n.JavaScriptCompiler().compile(a,e,void 0,!0);return n.template(l)}function s(o,a){return r||(r=i()),r.call(this,o,a)}return s._setup=function(o){return r||(r=i()),r._setup(o)},s._child=function(o,a,l,u){return r||(r=i()),r._child(o,a,l,u)},s}function Au(t,e){if(t===e)return!0;if(Jn.isArray(t)&&Jn.isArray(e)&&t.length===e.length){for(var n=0;n<t.length;n++)if(!Au(t[n],e[n]))return!1;return!0}}function Dl(t){if(!t.path.parts){var e=t.path;t.path={type:"PathExpression",data:!1,depth:0,parts:[e.original+""],original:e.original+"",loc:e.loc}}}var Zs={exports:{}},Qs={exports:{}},Sn={},ns={},br={},kr={},Fl;function xy(){if(Fl)return kr;Fl=1;var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return kr.encode=function(e){if(0<=e&&e<t.length)return t[e];throw new TypeError("Must be between 0 and 63: "+e)},kr.decode=function(e){var n=65,r=90,i=97,s=122,o=48,a=57,l=43,u=47,c=26,d=52;return n<=e&&e<=r?e-n:i<=e&&e<=s?e-i+c:o<=e&&e<=a?e-o+d:e==l?62:e==u?63:-1},kr}var Bl;function Ou(){if(Bl)return br;Bl=1;var t=xy(),e=5,n=1<<e,r=n-1,i=n;function s(a){return a<0?(-a<<1)+1:(a<<1)+0}function o(a){var l=(a&1)===1,u=a>>1;return l?-u:u}return br.encode=function(l){var u="",c,d=s(l);do c=d&r,d>>>=e,d>0&&(c|=i),u+=t.encode(c);while(d>0);return u},br.decode=function(l,u,c){var d=l.length,h=0,p=0,f,m;do{if(u>=d)throw new Error("Expected more digits in base 64 VLQ value.");if(m=t.decode(l.charCodeAt(u++)),m===-1)throw new Error("Invalid base64 digit: "+l.charAt(u-1));f=!!(m&i),m&=r,h=h+(m<<p),p+=e}while(f);c.value=o(h),c.rest=u},br}var rs={},$l;function ir(){return $l||($l=1,function(t){function e(y,_,A){if(_ in y)return y[_];if(arguments.length===3)return A;throw new Error('"'+_+'" is a required argument.')}t.getArg=e;var n=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,r=/^data:.+\,.+$/;function i(y){var _=y.match(n);return _?{scheme:_[1],auth:_[2],host:_[3],port:_[4],path:_[5]}:null}t.urlParse=i;function s(y){var _="";return y.scheme&&(_+=y.scheme+":"),_+="//",y.auth&&(_+=y.auth+"@"),y.host&&(_+=y.host),y.port&&(_+=":"+y.port),y.path&&(_+=y.path),_}t.urlGenerate=s;function o(y){var _=y,A=i(y);if(A){if(!A.path)return y;_=A.path}for(var S=t.isAbsolute(_),I=_.split(/\/+/),z,x=0,E=I.length-1;E>=0;E--)z=I[E],z==="."?I.splice(E,1):z===".."?x++:x>0&&(z===""?(I.splice(E+1,x),x=0):(I.splice(E,2),x--));return _=I.join("/"),_===""&&(_=S?"/":"."),A?(A.path=_,s(A)):_}t.normalize=o;function a(y,_){y===""&&(y="."),_===""&&(_=".");var A=i(_),S=i(y);if(S&&(y=S.path||"/"),A&&!A.scheme)return S&&(A.scheme=S.scheme),s(A);if(A||_.match(r))return _;if(S&&!S.host&&!S.path)return S.host=_,s(S);var I=_.charAt(0)==="/"?_:o(y.replace(/\/+$/,"")+"/"+_);return S?(S.path=I,s(S)):I}t.join=a,t.isAbsolute=function(y){return y.charAt(0)==="/"||n.test(y)};function l(y,_){y===""&&(y="."),y=y.replace(/\/$/,"");for(var A=0;_.indexOf(y+"/")!==0;){var S=y.lastIndexOf("/");if(S<0||(y=y.slice(0,S),y.match(/^([^\/]+:\/)?\/*$/)))return _;++A}return Array(A+1).join("../")+_.substr(y.length+1)}t.relative=l;var u=function(){var y=Object.create(null);return!("__proto__"in y)}();function c(y){return y}function d(y){return p(y)?"$"+y:y}t.toSetString=u?c:d;function h(y){return p(y)?y.slice(1):y}t.fromSetString=u?c:h;function p(y){if(!y)return!1;var _=y.length;if(_<9||y.charCodeAt(_-1)!==95||y.charCodeAt(_-2)!==95||y.charCodeAt(_-3)!==111||y.charCodeAt(_-4)!==116||y.charCodeAt(_-5)!==111||y.charCodeAt(_-6)!==114||y.charCodeAt(_-7)!==112||y.charCodeAt(_-8)!==95||y.charCodeAt(_-9)!==95)return!1;for(var A=_-10;A>=0;A--)if(y.charCodeAt(A)!==36)return!1;return!0}function f(y,_,A){var S=g(y.source,_.source);return S!==0||(S=y.originalLine-_.originalLine,S!==0)||(S=y.originalColumn-_.originalColumn,S!==0||A)||(S=y.generatedColumn-_.generatedColumn,S!==0)||(S=y.generatedLine-_.generatedLine,S!==0)?S:g(y.name,_.name)}t.compareByOriginalPositions=f;function m(y,_,A){var S=y.generatedLine-_.generatedLine;return S!==0||(S=y.generatedColumn-_.generatedColumn,S!==0||A)||(S=g(y.source,_.source),S!==0)||(S=y.originalLine-_.originalLine,S!==0)||(S=y.originalColumn-_.originalColumn,S!==0)?S:g(y.name,_.name)}t.compareByGeneratedPositionsDeflated=m;function g(y,_){return y===_?0:y===null?1:_===null?-1:y>_?1:-1}function w(y,_){var A=y.generatedLine-_.generatedLine;return A!==0||(A=y.generatedColumn-_.generatedColumn,A!==0)||(A=g(y.source,_.source),A!==0)||(A=y.originalLine-_.originalLine,A!==0)||(A=y.originalColumn-_.originalColumn,A!==0)?A:g(y.name,_.name)}t.compareByGeneratedPositionsInflated=w;function v(y){return JSON.parse(y.replace(/^\)]}'[^\n]*\n/,""))}t.parseSourceMapInput=v;function b(y,_,A){if(_=_||"",y&&(y[y.length-1]!=="/"&&_[0]!=="/"&&(y+="/"),_=y+_),A){var S=i(A);if(!S)throw new Error("sourceMapURL could not be parsed");if(S.path){var I=S.path.lastIndexOf("/");I>=0&&(S.path=S.path.substring(0,I+1))}_=a(s(S),_)}return o(_)}t.computeSourceURL=b}(rs)),rs}var is={},Ul;function Tu(){if(Ul)return is;Ul=1;var t=ir(),e=Object.prototype.hasOwnProperty,n=typeof Map<"u";function r(){this._array=[],this._set=n?new Map:Object.create(null)}return r.fromArray=function(s,o){for(var a=new r,l=0,u=s.length;l<u;l++)a.add(s[l],o);return a},r.prototype.size=function(){return n?this._set.size:Object.getOwnPropertyNames(this._set).length},r.prototype.add=function(s,o){var a=n?s:t.toSetString(s),l=n?this.has(s):e.call(this._set,a),u=this._array.length;(!l||o)&&this._array.push(s),l||(n?this._set.set(s,u):this._set[a]=u)},r.prototype.has=function(s){if(n)return this._set.has(s);var o=t.toSetString(s);return e.call(this._set,o)},r.prototype.indexOf=function(s){if(n){var o=this._set.get(s);if(o>=0)return o}else{var a=t.toSetString(s);if(e.call(this._set,a))return this._set[a]}throw new Error('"'+s+'" is not in the set.')},r.prototype.at=function(s){if(s>=0&&s<this._array.length)return this._array[s];throw new Error("No element indexed by "+s)},r.prototype.toArray=function(){return this._array.slice()},is.ArraySet=r,is}var ss={},Hl;function Sy(){if(Hl)return ss;Hl=1;var t=ir();function e(r,i){var s=r.generatedLine,o=i.generatedLine,a=r.generatedColumn,l=i.generatedColumn;return o>s||o==s&&l>=a||t.compareByGeneratedPositionsInflated(r,i)<=0}function n(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}return n.prototype.unsortedForEach=function(i,s){this._array.forEach(i,s)},n.prototype.add=function(i){e(this._last,i)?(this._last=i,this._array.push(i)):(this._sorted=!1,this._array.push(i))},n.prototype.toArray=function(){return this._sorted||(this._array.sort(t.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},ss.MappingList=n,ss}var zl;function Ru(){if(zl)return ns;zl=1;var t=Ou(),e=ir(),n=Tu().ArraySet,r=Sy().MappingList;function i(s){s||(s={}),this._file=e.getArg(s,"file",null),this._sourceRoot=e.getArg(s,"sourceRoot",null),this._skipValidation=e.getArg(s,"skipValidation",!1),this._sources=new n,this._names=new n,this._mappings=new r,this._sourcesContents=null}return i.prototype._version=3,i.fromSourceMap=function(o){var a=o.sourceRoot,l=new i({file:o.file,sourceRoot:a});return o.eachMapping(function(u){var c={generated:{line:u.generatedLine,column:u.generatedColumn}};u.source!=null&&(c.source=u.source,a!=null&&(c.source=e.relative(a,c.source)),c.original={line:u.originalLine,column:u.originalColumn},u.name!=null&&(c.name=u.name)),l.addMapping(c)}),o.sources.forEach(function(u){var c=u;a!==null&&(c=e.relative(a,u)),l._sources.has(c)||l._sources.add(c);var d=o.sourceContentFor(u);d!=null&&l.setSourceContent(u,d)}),l},i.prototype.addMapping=function(o){var a=e.getArg(o,"generated"),l=e.getArg(o,"original",null),u=e.getArg(o,"source",null),c=e.getArg(o,"name",null);this._skipValidation||this._validateMapping(a,l,u,c),u!=null&&(u=String(u),this._sources.has(u)||this._sources.add(u)),c!=null&&(c=String(c),this._names.has(c)||this._names.add(c)),this._mappings.add({generatedLine:a.line,generatedColumn:a.column,originalLine:l!=null&&l.line,originalColumn:l!=null&&l.column,source:u,name:c})},i.prototype.setSourceContent=function(o,a){var l=o;this._sourceRoot!=null&&(l=e.relative(this._sourceRoot,l)),a!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[e.toSetString(l)]=a):this._sourcesContents&&(delete this._sourcesContents[e.toSetString(l)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))},i.prototype.applySourceMap=function(o,a,l){var u=a;if(a==null){if(o.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);u=o.file}var c=this._sourceRoot;c!=null&&(u=e.relative(c,u));var d=new n,h=new n;this._mappings.unsortedForEach(function(p){if(p.source===u&&p.originalLine!=null){var f=o.originalPositionFor({line:p.originalLine,column:p.originalColumn});f.source!=null&&(p.source=f.source,l!=null&&(p.source=e.join(l,p.source)),c!=null&&(p.source=e.relative(c,p.source)),p.originalLine=f.line,p.originalColumn=f.column,f.name!=null&&(p.name=f.name))}var m=p.source;m!=null&&!d.has(m)&&d.add(m);var g=p.name;g!=null&&!h.has(g)&&h.add(g)},this),this._sources=d,this._names=h,o.sources.forEach(function(p){var f=o.sourceContentFor(p);f!=null&&(l!=null&&(p=e.join(l,p)),c!=null&&(p=e.relative(c,p)),this.setSourceContent(p,f))},this)},i.prototype._validateMapping=function(o,a,l,u){if(a&&typeof a.line!="number"&&typeof a.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(o&&"line"in o&&"column"in o&&o.line>0&&o.column>=0&&!a&&!l&&!u)){if(o&&"line"in o&&"column"in o&&a&&"line"in a&&"column"in a&&o.line>0&&o.column>=0&&a.line>0&&a.column>=0&&l)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:o,source:l,original:a,name:u}))}},i.prototype._serializeMappings=function(){for(var o=0,a=1,l=0,u=0,c=0,d=0,h="",p,f,m,g,w=this._mappings.toArray(),v=0,b=w.length;v<b;v++){if(f=w[v],p="",f.generatedLine!==a)for(o=0;f.generatedLine!==a;)p+=";",a++;else if(v>0){if(!e.compareByGeneratedPositionsInflated(f,w[v-1]))continue;p+=","}p+=t.encode(f.generatedColumn-o),o=f.generatedColumn,f.source!=null&&(g=this._sources.indexOf(f.source),p+=t.encode(g-d),d=g,p+=t.encode(f.originalLine-1-u),u=f.originalLine-1,p+=t.encode(f.originalColumn-l),l=f.originalColumn,f.name!=null&&(m=this._names.indexOf(f.name),p+=t.encode(m-c),c=m)),h+=p}return h},i.prototype._generateSourcesContent=function(o,a){return o.map(function(l){if(!this._sourcesContents)return null;a!=null&&(l=e.relative(a,l));var u=e.toSetString(l);return Object.prototype.hasOwnProperty.call(this._sourcesContents,u)?this._sourcesContents[u]:null},this)},i.prototype.toJSON=function(){var o={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(o.file=this._file),this._sourceRoot!=null&&(o.sourceRoot=this._sourceRoot),this._sourcesContents&&(o.sourcesContent=this._generateSourcesContent(o.sources,o.sourceRoot)),o},i.prototype.toString=function(){return JSON.stringify(this.toJSON())},ns.SourceMapGenerator=i,ns}var En={},os={},jl;function Ey(){return jl||(jl=1,function(t){t.GREATEST_LOWER_BOUND=1,t.LEAST_UPPER_BOUND=2;function e(n,r,i,s,o,a){var l=Math.floor((r-n)/2)+n,u=o(i,s[l],!0);return u===0?l:u>0?r-l>1?e(l,r,i,s,o,a):a==t.LEAST_UPPER_BOUND?r<s.length?r:-1:l:l-n>1?e(n,l,i,s,o,a):a==t.LEAST_UPPER_BOUND?l:n<0?-1:n}t.search=function(r,i,s,o){if(i.length===0)return-1;var a=e(-1,i.length,r,i,s,o||t.GREATEST_LOWER_BOUND);if(a<0)return-1;for(;a-1>=0&&s(i[a],i[a-1],!0)===0;)--a;return a}}(os)),os}var as={},Wl;function Cy(){if(Wl)return as;Wl=1;function t(r,i,s){var o=r[i];r[i]=r[s],r[s]=o}function e(r,i){return Math.round(r+Math.random()*(i-r))}function n(r,i,s,o){if(s<o){var a=e(s,o),l=s-1;t(r,a,o);for(var u=r[o],c=s;c<o;c++)i(r[c],u)<=0&&(l+=1,t(r,l,c));t(r,l+1,c);var d=l+1;n(r,i,s,d-1),n(r,i,d+1,o)}}return as.quickSort=function(r,i){n(r,i,0,r.length-1)},as}var ql;function Ay(){if(ql)return En;ql=1;var t=ir(),e=Ey(),n=Tu().ArraySet,r=Ou(),i=Cy().quickSort;function s(u,c){var d=u;return typeof u=="string"&&(d=t.parseSourceMapInput(u)),d.sections!=null?new l(d,c):new o(d,c)}s.fromSourceMap=function(u,c){return o.fromSourceMap(u,c)},s.prototype._version=3,s.prototype.__generatedMappings=null,Object.defineProperty(s.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),s.prototype.__originalMappings=null,Object.defineProperty(s.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),s.prototype._charIsMappingSeparator=function(c,d){var h=c.charAt(d);return h===";"||h===","},s.prototype._parseMappings=function(c,d){throw new Error("Subclasses must implement _parseMappings")},s.GENERATED_ORDER=1,s.ORIGINAL_ORDER=2,s.GREATEST_LOWER_BOUND=1,s.LEAST_UPPER_BOUND=2,s.prototype.eachMapping=function(c,d,h){var p=d||null,f=h||s.GENERATED_ORDER,m;switch(f){case s.GENERATED_ORDER:m=this._generatedMappings;break;case s.ORIGINAL_ORDER:m=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var g=this.sourceRoot;m.map(function(w){var v=w.source===null?null:this._sources.at(w.source);return v=t.computeSourceURL(g,v,this._sourceMapURL),{source:v,generatedLine:w.generatedLine,generatedColumn:w.generatedColumn,originalLine:w.originalLine,originalColumn:w.originalColumn,name:w.name===null?null:this._names.at(w.name)}},this).forEach(c,p)},s.prototype.allGeneratedPositionsFor=function(c){var d=t.getArg(c,"line"),h={source:t.getArg(c,"source"),originalLine:d,originalColumn:t.getArg(c,"column",0)};if(h.source=this._findSourceIndex(h.source),h.source<0)return[];var p=[],f=this._findMapping(h,this._originalMappings,"originalLine","originalColumn",t.compareByOriginalPositions,e.LEAST_UPPER_BOUND);if(f>=0){var m=this._originalMappings[f];if(c.column===void 0)for(var g=m.originalLine;m&&m.originalLine===g;)p.push({line:t.getArg(m,"generatedLine",null),column:t.getArg(m,"generatedColumn",null),lastColumn:t.getArg(m,"lastGeneratedColumn",null)}),m=this._originalMappings[++f];else for(var w=m.originalColumn;m&&m.originalLine===d&&m.originalColumn==w;)p.push({line:t.getArg(m,"generatedLine",null),column:t.getArg(m,"generatedColumn",null),lastColumn:t.getArg(m,"lastGeneratedColumn",null)}),m=this._originalMappings[++f]}return p},En.SourceMapConsumer=s;function o(u,c){var d=u;typeof u=="string"&&(d=t.parseSourceMapInput(u));var h=t.getArg(d,"version"),p=t.getArg(d,"sources"),f=t.getArg(d,"names",[]),m=t.getArg(d,"sourceRoot",null),g=t.getArg(d,"sourcesContent",null),w=t.getArg(d,"mappings"),v=t.getArg(d,"file",null);if(h!=this._version)throw new Error("Unsupported version: "+h);m&&(m=t.normalize(m)),p=p.map(String).map(t.normalize).map(function(b){return m&&t.isAbsolute(m)&&t.isAbsolute(b)?t.relative(m,b):b}),this._names=n.fromArray(f.map(String),!0),this._sources=n.fromArray(p,!0),this._absoluteSources=this._sources.toArray().map(function(b){return t.computeSourceURL(m,b,c)}),this.sourceRoot=m,this.sourcesContent=g,this._mappings=w,this._sourceMapURL=c,this.file=v}o.prototype=Object.create(s.prototype),o.prototype.consumer=s,o.prototype._findSourceIndex=function(u){var c=u;if(this.sourceRoot!=null&&(c=t.relative(this.sourceRoot,c)),this._sources.has(c))return this._sources.indexOf(c);var d;for(d=0;d<this._absoluteSources.length;++d)if(this._absoluteSources[d]==u)return d;return-1},o.fromSourceMap=function(c,d){var h=Object.create(o.prototype),p=h._names=n.fromArray(c._names.toArray(),!0),f=h._sources=n.fromArray(c._sources.toArray(),!0);h.sourceRoot=c._sourceRoot,h.sourcesContent=c._generateSourcesContent(h._sources.toArray(),h.sourceRoot),h.file=c._file,h._sourceMapURL=d,h._absoluteSources=h._sources.toArray().map(function(A){return t.computeSourceURL(h.sourceRoot,A,d)});for(var m=c._mappings.toArray().slice(),g=h.__generatedMappings=[],w=h.__originalMappings=[],v=0,b=m.length;v<b;v++){var y=m[v],_=new a;_.generatedLine=y.generatedLine,_.generatedColumn=y.generatedColumn,y.source&&(_.source=f.indexOf(y.source),_.originalLine=y.originalLine,_.originalColumn=y.originalColumn,y.name&&(_.name=p.indexOf(y.name)),w.push(_)),g.push(_)}return i(h.__originalMappings,t.compareByOriginalPositions),h},o.prototype._version=3,Object.defineProperty(o.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function a(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}o.prototype._parseMappings=function(c,d){for(var h=1,p=0,f=0,m=0,g=0,w=0,v=c.length,b=0,y={},_={},A=[],S=[],I,z,x,E,R;b<v;)if(c.charAt(b)===";")h++,b++,p=0;else if(c.charAt(b)===",")b++;else{for(I=new a,I.generatedLine=h,E=b;E<v&&!this._charIsMappingSeparator(c,E);E++);if(z=c.slice(b,E),x=y[z],x)b+=z.length;else{for(x=[];b<E;)r.decode(c,b,_),R=_.value,b=_.rest,x.push(R);if(x.length===2)throw new Error("Found a source, but no line and column");if(x.length===3)throw new Error("Found a source and line, but no column");y[z]=x}I.generatedColumn=p+x[0],p=I.generatedColumn,x.length>1&&(I.source=g+x[1],g+=x[1],I.originalLine=f+x[2],f=I.originalLine,I.originalLine+=1,I.originalColumn=m+x[3],m=I.originalColumn,x.length>4&&(I.name=w+x[4],w+=x[4])),S.push(I),typeof I.originalLine=="number"&&A.push(I)}i(S,t.compareByGeneratedPositionsDeflated),this.__generatedMappings=S,i(A,t.compareByOriginalPositions),this.__originalMappings=A},o.prototype._findMapping=function(c,d,h,p,f,m){if(c[h]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+c[h]);if(c[p]<0)throw new TypeError("Column must be greater than or equal to 0, got "+c[p]);return e.search(c,d,f,m)},o.prototype.computeColumnSpans=function(){for(var c=0;c<this._generatedMappings.length;++c){var d=this._generatedMappings[c];if(c+1<this._generatedMappings.length){var h=this._generatedMappings[c+1];if(d.generatedLine===h.generatedLine){d.lastGeneratedColumn=h.generatedColumn-1;continue}}d.lastGeneratedColumn=1/0}},o.prototype.originalPositionFor=function(c){var d={generatedLine:t.getArg(c,"line"),generatedColumn:t.getArg(c,"column")},h=this._findMapping(d,this._generatedMappings,"generatedLine","generatedColumn",t.compareByGeneratedPositionsDeflated,t.getArg(c,"bias",s.GREATEST_LOWER_BOUND));if(h>=0){var p=this._generatedMappings[h];if(p.generatedLine===d.generatedLine){var f=t.getArg(p,"source",null);f!==null&&(f=this._sources.at(f),f=t.computeSourceURL(this.sourceRoot,f,this._sourceMapURL));var m=t.getArg(p,"name",null);return m!==null&&(m=this._names.at(m)),{source:f,line:t.getArg(p,"originalLine",null),column:t.getArg(p,"originalColumn",null),name:m}}}return{source:null,line:null,column:null,name:null}},o.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(c){return c==null}):!1},o.prototype.sourceContentFor=function(c,d){if(!this.sourcesContent)return null;var h=this._findSourceIndex(c);if(h>=0)return this.sourcesContent[h];var p=c;this.sourceRoot!=null&&(p=t.relative(this.sourceRoot,p));var f;if(this.sourceRoot!=null&&(f=t.urlParse(this.sourceRoot))){var m=p.replace(/^file:\/\//,"");if(f.scheme=="file"&&this._sources.has(m))return this.sourcesContent[this._sources.indexOf(m)];if((!f.path||f.path=="/")&&this._sources.has("/"+p))return this.sourcesContent[this._sources.indexOf("/"+p)]}if(d)return null;throw new Error('"'+p+'" is not in the SourceMap.')},o.prototype.generatedPositionFor=function(c){var d=t.getArg(c,"source");if(d=this._findSourceIndex(d),d<0)return{line:null,column:null,lastColumn:null};var h={source:d,originalLine:t.getArg(c,"line"),originalColumn:t.getArg(c,"column")},p=this._findMapping(h,this._originalMappings,"originalLine","originalColumn",t.compareByOriginalPositions,t.getArg(c,"bias",s.GREATEST_LOWER_BOUND));if(p>=0){var f=this._originalMappings[p];if(f.source===h.source)return{line:t.getArg(f,"generatedLine",null),column:t.getArg(f,"generatedColumn",null),lastColumn:t.getArg(f,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},En.BasicSourceMapConsumer=o;function l(u,c){var d=u;typeof u=="string"&&(d=t.parseSourceMapInput(u));var h=t.getArg(d,"version"),p=t.getArg(d,"sections");if(h!=this._version)throw new Error("Unsupported version: "+h);this._sources=new n,this._names=new n;var f={line:-1,column:0};this._sections=p.map(function(m){if(m.url)throw new Error("Support for url field in sections not implemented.");var g=t.getArg(m,"offset"),w=t.getArg(g,"line"),v=t.getArg(g,"column");if(w<f.line||w===f.line&&v<f.column)throw new Error("Section offsets must be ordered and non-overlapping.");return f=g,{generatedOffset:{generatedLine:w+1,generatedColumn:v+1},consumer:new s(t.getArg(m,"map"),c)}})}return l.prototype=Object.create(s.prototype),l.prototype.constructor=s,l.prototype._version=3,Object.defineProperty(l.prototype,"sources",{get:function(){for(var u=[],c=0;c<this._sections.length;c++)for(var d=0;d<this._sections[c].consumer.sources.length;d++)u.push(this._sections[c].consumer.sources[d]);return u}}),l.prototype.originalPositionFor=function(c){var d={generatedLine:t.getArg(c,"line"),generatedColumn:t.getArg(c,"column")},h=e.search(d,this._sections,function(f,m){var g=f.generatedLine-m.generatedOffset.generatedLine;return g||f.generatedColumn-m.generatedOffset.generatedColumn}),p=this._sections[h];return p?p.consumer.originalPositionFor({line:d.generatedLine-(p.generatedOffset.generatedLine-1),column:d.generatedColumn-(p.generatedOffset.generatedLine===d.generatedLine?p.generatedOffset.generatedColumn-1:0),bias:c.bias}):{source:null,line:null,column:null,name:null}},l.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(c){return c.consumer.hasContentsOfAllSources()})},l.prototype.sourceContentFor=function(c,d){for(var h=0;h<this._sections.length;h++){var p=this._sections[h],f=p.consumer.sourceContentFor(c,!0);if(f)return f}if(d)return null;throw new Error('"'+c+'" is not in the SourceMap.')},l.prototype.generatedPositionFor=function(c){for(var d=0;d<this._sections.length;d++){var h=this._sections[d];if(h.consumer._findSourceIndex(t.getArg(c,"source"))!==-1){var p=h.consumer.generatedPositionFor(c);if(p){var f={line:p.line+(h.generatedOffset.generatedLine-1),column:p.column+(h.generatedOffset.generatedLine===p.line?h.generatedOffset.generatedColumn-1:0)};return f}}}return{line:null,column:null}},l.prototype._parseMappings=function(c,d){this.__generatedMappings=[],this.__originalMappings=[];for(var h=0;h<this._sections.length;h++)for(var p=this._sections[h],f=p.consumer._generatedMappings,m=0;m<f.length;m++){var g=f[m],w=p.consumer._sources.at(g.source);w=t.computeSourceURL(p.consumer.sourceRoot,w,this._sourceMapURL),this._sources.add(w),w=this._sources.indexOf(w);var v=null;g.name&&(v=p.consumer._names.at(g.name),this._names.add(v),v=this._names.indexOf(v));var b={source:w,generatedLine:g.generatedLine+(p.generatedOffset.generatedLine-1),generatedColumn:g.generatedColumn+(p.generatedOffset.generatedLine===g.generatedLine?p.generatedOffset.generatedColumn-1:0),originalLine:g.originalLine,originalColumn:g.originalColumn,name:v};this.__generatedMappings.push(b),typeof b.originalLine=="number"&&this.__originalMappings.push(b)}i(this.__generatedMappings,t.compareByGeneratedPositionsDeflated),i(this.__originalMappings,t.compareByOriginalPositions)},En.IndexedSourceMapConsumer=l,En}var ls={},Vl;function Oy(){if(Vl)return ls;Vl=1;var t=Ru().SourceMapGenerator,e=ir(),n=/(\r?\n)/,r=10,i="$$$isSourceNode$$$";function s(o,a,l,u,c){this.children=[],this.sourceContents={},this.line=o??null,this.column=a??null,this.source=l??null,this.name=c??null,this[i]=!0,u!=null&&this.add(u)}return s.fromStringWithSourceMap=function(a,l,u){var c=new s,d=a.split(n),h=0,p=function(){var v=y(),b=y()||"";return v+b;function y(){return h<d.length?d[h++]:void 0}},f=1,m=0,g=null;return l.eachMapping(function(v){if(g!==null)if(f<v.generatedLine)w(g,p()),f++,m=0;else{var b=d[h]||"",y=b.substr(0,v.generatedColumn-m);d[h]=b.substr(v.generatedColumn-m),m=v.generatedColumn,w(g,y),g=v;return}for(;f<v.generatedLine;)c.add(p()),f++;if(m<v.generatedColumn){var b=d[h]||"";c.add(b.substr(0,v.generatedColumn)),d[h]=b.substr(v.generatedColumn),m=v.generatedColumn}g=v},this),h<d.length&&(g&&w(g,p()),c.add(d.splice(h).join(""))),l.sources.forEach(function(v){var b=l.sourceContentFor(v);b!=null&&(u!=null&&(v=e.join(u,v)),c.setSourceContent(v,b))}),c;function w(v,b){if(v===null||v.source===void 0)c.add(b);else{var y=u?e.join(u,v.source):v.source;c.add(new s(v.originalLine,v.originalColumn,y,b,v.name))}}},s.prototype.add=function(a){if(Array.isArray(a))a.forEach(function(l){this.add(l)},this);else if(a[i]||typeof a=="string")a&&this.children.push(a);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+a);return this},s.prototype.prepend=function(a){if(Array.isArray(a))for(var l=a.length-1;l>=0;l--)this.prepend(a[l]);else if(a[i]||typeof a=="string")this.children.unshift(a);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+a);return this},s.prototype.walk=function(a){for(var l,u=0,c=this.children.length;u<c;u++)l=this.children[u],l[i]?l.walk(a):l!==""&&a(l,{source:this.source,line:this.line,column:this.column,name:this.name})},s.prototype.join=function(a){var l,u,c=this.children.length;if(c>0){for(l=[],u=0;u<c-1;u++)l.push(this.children[u]),l.push(a);l.push(this.children[u]),this.children=l}return this},s.prototype.replaceRight=function(a,l){var u=this.children[this.children.length-1];return u[i]?u.replaceRight(a,l):typeof u=="string"?this.children[this.children.length-1]=u.replace(a,l):this.children.push("".replace(a,l)),this},s.prototype.setSourceContent=function(a,l){this.sourceContents[e.toSetString(a)]=l},s.prototype.walkSourceContents=function(a){for(var l=0,u=this.children.length;l<u;l++)this.children[l][i]&&this.children[l].walkSourceContents(a);for(var c=Object.keys(this.sourceContents),l=0,u=c.length;l<u;l++)a(e.fromSetString(c[l]),this.sourceContents[c[l]])},s.prototype.toString=function(){var a="";return this.walk(function(l){a+=l}),a},s.prototype.toStringWithSourceMap=function(a){var l={code:"",line:1,column:0},u=new t(a),c=!1,d=null,h=null,p=null,f=null;return this.walk(function(m,g){l.code+=m,g.source!==null&&g.line!==null&&g.column!==null?((d!==g.source||h!==g.line||p!==g.column||f!==g.name)&&u.addMapping({source:g.source,original:{line:g.line,column:g.column},generated:{line:l.line,column:l.column},name:g.name}),d=g.source,h=g.line,p=g.column,f=g.name,c=!0):c&&(u.addMapping({generated:{line:l.line,column:l.column}}),d=null,c=!1);for(var w=0,v=m.length;w<v;w++)m.charCodeAt(w)===r?(l.line++,l.column=0,w+1===v?(d=null,c=!1):c&&u.addMapping({source:g.source,original:{line:g.line,column:g.column},generated:{line:l.line,column:l.column},name:g.name})):l.column++}),this.walkSourceContents(function(m,g){u.setSourceContent(m,g)}),{code:l.code,map:u}},ls.SourceNode=s,ls}var Jl;function Ty(){return Jl||(Jl=1,Sn.SourceMapGenerator=Ru().SourceMapGenerator,Sn.SourceMapConsumer=Ay().SourceMapConsumer,Sn.SourceNode=Oy().SourceNode),Sn}(function(t,e){e.__esModule=!0;var n=Z,r=void 0;try{var i=Ty();r=i.SourceNode}catch{}r||(r=function(a,l,u,c){this.src="",c&&this.add(c)},r.prototype={add:function(l){n.isArray(l)&&(l=l.join("")),this.src+=l},prepend:function(l){n.isArray(l)&&(l=l.join("")),this.src=l+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}});function s(a,l,u){if(n.isArray(a)){for(var c=[],d=0,h=a.length;d<h;d++)c.push(l.wrap(a[d],u));return c}else if(typeof a=="boolean"||typeof a=="number")return a+"";return a}function o(a){this.srcFile=a,this.source=[]}o.prototype={isEmpty:function(){return!this.source.length},prepend:function(l,u){this.source.unshift(this.wrap(l,u))},push:function(l,u){this.source.push(this.wrap(l,u))},merge:function(){var l=this.empty();return this.each(function(u){l.add(["  ",u,`
`])}),l},each:function(l){for(var u=0,c=this.source.length;u<c;u++)l(this.source[u])},empty:function(){var l=this.currentLocation||{start:{}};return new r(l.start.line,l.start.column,this.srcFile)},wrap:function(l){var u=arguments.length<=1||arguments[1]===void 0?this.currentLocation||{start:{}}:arguments[1];return l instanceof r?l:(l=s(l,this,u),new r(u.start.line,u.start.column,this.srcFile,l))},functionCall:function(l,u,c){return c=this.generateList(c),this.wrap([l,u?"."+u+"(":"(",c,")"])},quotedString:function(l){return'"'+(l+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(l){var u=this,c=[];Object.keys(l).forEach(function(h){var p=s(l[h],u);p!=="undefined"&&c.push([u.quotedString(h),":",p])});var d=this.generateList(c);return d.prepend("{"),d.add("}"),d},generateList:function(l){for(var u=this.empty(),c=0,d=l.length;c<d;c++)c&&u.add(","),u.add(s(l[c],this));return u},generateArray:function(l){var u=this.generateList(l);return u.prepend("["),u.add("]"),u}},e.default=o,t.exports=e.default})(Qs,Qs.exports);var Ry=Qs.exports;(function(t,e){e.__esModule=!0;function n(h){return h&&h.__esModule?h:{default:h}}var r=Ne,i=je,s=n(i),o=Z,a=Ry,l=n(a);function u(h){this.value=h}function c(){}c.prototype={nameLookup:function(p,f){return this.internalNameLookup(p,f)},depthedLookup:function(p){return[this.aliasable("container.lookup"),"(depths, ",JSON.stringify(p),")"]},compilerInfo:function(){var p=r.COMPILER_REVISION,f=r.REVISION_CHANGES[p];return[p,f]},appendToBuffer:function(p,f,m){return o.isArray(p)||(p=[p]),p=this.source.wrap(p,f),this.environment.isSimple?["return ",p,";"]:m?["buffer += ",p,";"]:(p.appendToBuffer=!0,p)},initializeBuffer:function(){return this.quotedString("")},internalNameLookup:function(p,f){return this.lookupPropertyFunctionIsUsed=!0,["lookupProperty(",p,",",JSON.stringify(f),")"]},lookupPropertyFunctionIsUsed:!1,compile:function(p,f,m,g){this.environment=p,this.options=f,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!g,this.name=this.environment.name,this.isChild=!!m,this.context=m||{decorators:[],programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(p,f),this.useDepths=this.useDepths||p.useDepths||p.useDecorators||this.options.compat,this.useBlockParams=this.useBlockParams||p.useBlockParams;var w=p.opcodes,v=void 0,b=void 0,y=void 0,_=void 0;for(y=0,_=w.length;y<_;y++)v=w[y],this.source.currentLocation=v.loc,b=b||v.loc,this[v.opcode].apply(this,v.args);if(this.source.currentLocation=b,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new s.default("Compile completed with content left on stack");this.decorators.isEmpty()?this.decorators=void 0:(this.useDecorators=!0,this.decorators.prepend(["var decorators = container.decorators, ",this.lookupPropertyFunctionVarDeclaration(),`;
`]),this.decorators.push("return fn;"),g?this.decorators=Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()]):(this.decorators.prepend(`function(fn, props, container, depth0, data, blockParams, depths) {
`),this.decorators.push(`}
`),this.decorators=this.decorators.merge()));var A=this.createFunctionContext(g);if(this.isChild)return A;var S={compiler:this.compilerInfo(),main:A};this.decorators&&(S.main_d=this.decorators,S.useDecorators=!0);var I=this.context,z=I.programs,x=I.decorators;for(y=0,_=z.length;y<_;y++)z[y]&&(S[y]=z[y],x[y]&&(S[y+"_d"]=x[y],S.useDecorators=!0));return this.environment.usePartial&&(S.usePartial=!0),this.options.data&&(S.useData=!0),this.useDepths&&(S.useDepths=!0),this.useBlockParams&&(S.useBlockParams=!0),this.options.compat&&(S.compat=!0),g?S.compilerOptions=this.options:(S.compiler=JSON.stringify(S.compiler),this.source.currentLocation={start:{line:1,column:0}},S=this.objectLiteral(S),f.srcName?(S=S.toStringWithSourceMap({file:f.destName}),S.map=S.map&&S.map.toString()):S=S.toString()),S},preamble:function(){this.lastContext=0,this.source=new l.default(this.options.srcName),this.decorators=new l.default(this.options.srcName)},createFunctionContext:function(p){var f=this,m="",g=this.stackVars.concat(this.registers.list);g.length>0&&(m+=", "+g.join(", "));var w=0;Object.keys(this.aliases).forEach(function(y){var _=f.aliases[y];_.children&&_.referenceCount>1&&(m+=", alias"+ ++w+"="+y,_.children[0]="alias"+w)}),this.lookupPropertyFunctionIsUsed&&(m+=", "+this.lookupPropertyFunctionVarDeclaration());var v=["container","depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&v.push("blockParams"),this.useDepths&&v.push("depths");var b=this.mergeSource(m);return p?(v.push(b),Function.apply(this,v)):this.source.wrap(["function(",v.join(","),`) {
  `,b,"}"])},mergeSource:function(p){var f=this.environment.isSimple,m=!this.forceBuffer,g=void 0,w=void 0,v=void 0,b=void 0;return this.source.each(function(y){y.appendToBuffer?(v?y.prepend("  + "):v=y,b=y):(v&&(w?v.prepend("buffer += "):g=!0,b.add(";"),v=b=void 0),w=!0,f||(m=!1))}),m?v?(v.prepend("return "),b.add(";")):w||this.source.push('return "";'):(p+=", buffer = "+(g?"":this.initializeBuffer()),v?(v.prepend("return buffer + "),b.add(";")):this.source.push("return buffer;")),p&&this.source.prepend("var "+p.substring(2)+(g?"":`;
`)),this.source.merge()},lookupPropertyFunctionVarDeclaration:function(){return`
      lookupProperty = container.lookupProperty || function(parent, propertyName) {
        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {
          return parent[propertyName];
        }
        return undefined
    }
    `.trim()},blockValue:function(p){var f=this.aliasable("container.hooks.blockHelperMissing"),m=[this.contextName(0)];this.setupHelperArgs(p,0,m);var g=this.popStack();m.splice(1,0,g),this.push(this.source.functionCall(f,"call",m))},ambiguousBlockValue:function(){var p=this.aliasable("container.hooks.blockHelperMissing"),f=[this.contextName(0)];this.setupHelperArgs("",0,f,!0),this.flushInline();var m=this.topStack();f.splice(1,0,m),this.pushSource(["if (!",this.lastHelper,") { ",m," = ",this.source.functionCall(p,"call",f),"}"])},appendContent:function(p){this.pendingContent?p=this.pendingContent+p:this.pendingLocation=this.source.currentLocation,this.pendingContent=p},append:function(){if(this.isInline())this.replaceStack(function(f){return[" != null ? ",f,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var p=this.popStack();this.pushSource(["if (",p," != null) { ",this.appendToBuffer(p,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(p){this.lastContext=p},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(p,f,m,g){var w=0;!g&&this.options.compat&&!this.lastContext?this.push(this.depthedLookup(p[w++])):this.pushContext(),this.resolvePath("context",p,w,f,m)},lookupBlockParam:function(p,f){this.useBlockParams=!0,this.push(["blockParams[",p[0],"][",p[1],"]"]),this.resolvePath("context",f,1)},lookupData:function(p,f,m){p?this.pushStackLiteral("container.data(data, "+p+")"):this.pushStackLiteral("data"),this.resolvePath("data",f,0,!0,m)},resolvePath:function(p,f,m,g,w){var v=this;if(this.options.strict||this.options.assumeObjects){this.push(d(this.options.strict&&w,this,f,m,p));return}for(var b=f.length;m<b;m++)this.replaceStack(function(y){var _=v.nameLookup(y,f[m],p);return g?[" && ",_]:[" != null ? ",_," : ",y]})},resolvePossibleLambda:function(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(p,f){this.pushContext(),this.pushString(f),f!=="SubExpression"&&(typeof p=="string"?this.pushString(p):this.pushStackLiteral(p))},emptyHash:function(p){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(p?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:{},types:[],contexts:[],ids:[]}},popHash:function(){var p=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(p.ids)),this.stringParams&&(this.push(this.objectLiteral(p.contexts)),this.push(this.objectLiteral(p.types))),this.push(this.objectLiteral(p.values))},pushString:function(p){this.pushStackLiteral(this.quotedString(p))},pushLiteral:function(p){this.pushStackLiteral(p)},pushProgram:function(p){p!=null?this.pushStackLiteral(this.programExpression(p)):this.pushStackLiteral(null)},registerDecorator:function(p,f){var m=this.nameLookup("decorators",f,"decorator"),g=this.setupHelperArgs(f,p);this.decorators.push(["fn = ",this.decorators.functionCall(m,"",["fn","props","container",g])," || fn;"])},invokeHelper:function(p,f,m){var g=this.popStack(),w=this.setupHelper(p,f),v=[];m&&v.push(w.name),v.push(g),this.options.strict||v.push(this.aliasable("container.hooks.helperMissing"));var b=["(",this.itemsSeparatedBy(v,"||"),")"],y=this.source.functionCall(b,"call",w.callParams);this.push(y)},itemsSeparatedBy:function(p,f){var m=[];m.push(p[0]);for(var g=1;g<p.length;g++)m.push(f,p[g]);return m},invokeKnownHelper:function(p,f){var m=this.setupHelper(p,f);this.push(this.source.functionCall(m.name,"call",m.callParams))},invokeAmbiguous:function(p,f){this.useRegister("helper");var m=this.popStack();this.emptyHash();var g=this.setupHelper(0,p,f),w=this.lastHelper=this.nameLookup("helpers",p,"helper"),v=["(","(helper = ",w," || ",m,")"];this.options.strict||(v[0]="(helper = ",v.push(" != null ? helper : ",this.aliasable("container.hooks.helperMissing"))),this.push(["(",v,g.paramsInit?["),(",g.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",g.callParams)," : helper))"])},invokePartial:function(p,f,m){var g=[],w=this.setupParams(f,1,g);p&&(f=this.popStack(),delete w.name),m&&(w.indent=JSON.stringify(m)),w.helpers="helpers",w.partials="partials",w.decorators="container.decorators",p?g.unshift(f):g.unshift(this.nameLookup("partials",f,"partial")),this.options.compat&&(w.depths="depths"),w=this.objectLiteral(w),g.push(w),this.push(this.source.functionCall("container.invokePartial","",g))},assignToHash:function(p){var f=this.popStack(),m=void 0,g=void 0,w=void 0;this.trackIds&&(w=this.popStack()),this.stringParams&&(g=this.popStack(),m=this.popStack());var v=this.hash;m&&(v.contexts[p]=m),g&&(v.types[p]=g),w&&(v.ids[p]=w),v.values[p]=f},pushId:function(p,f,m){p==="BlockParam"?this.pushStackLiteral("blockParams["+f[0]+"].path["+f[1]+"]"+(m?" + "+JSON.stringify("."+m):"")):p==="PathExpression"?this.pushString(f):p==="SubExpression"?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:c,compileChildren:function(p,f){for(var m=p.children,g=void 0,w=void 0,v=0,b=m.length;v<b;v++){g=m[v],w=new this.compiler;var y=this.matchExistingProgram(g);if(y==null){this.context.programs.push("");var _=this.context.programs.length;g.index=_,g.name="program"+_,this.context.programs[_]=w.compile(g,f,this.context,!this.precompile),this.context.decorators[_]=w.decorators,this.context.environments[_]=g,this.useDepths=this.useDepths||w.useDepths,this.useBlockParams=this.useBlockParams||w.useBlockParams,g.useDepths=this.useDepths,g.useBlockParams=this.useBlockParams}else g.index=y.index,g.name="program"+y.index,this.useDepths=this.useDepths||y.useDepths,this.useBlockParams=this.useBlockParams||y.useBlockParams}},matchExistingProgram:function(p){for(var f=0,m=this.context.environments.length;f<m;f++){var g=this.context.environments[f];if(g&&g.equals(p))return g}},programExpression:function(p){var f=this.environment.children[p],m=[f.index,"data",f.blockParams];return(this.useBlockParams||this.useDepths)&&m.push("blockParams"),this.useDepths&&m.push("depths"),"container.program("+m.join(", ")+")"},useRegister:function(p){this.registers[p]||(this.registers[p]=!0,this.registers.list.push(p))},push:function(p){return p instanceof u||(p=this.source.wrap(p)),this.inlineStack.push(p),p},pushStackLiteral:function(p){this.push(new u(p))},pushSource:function(p){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),p&&this.source.push(p)},replaceStack:function(p){var f=["("],m=void 0,g=void 0,w=void 0;if(!this.isInline())throw new s.default("replaceStack on non-inline");var v=this.popStack(!0);if(v instanceof u)m=[v.value],f=["(",m],w=!0;else{g=!0;var b=this.incrStack();f=["((",this.push(b)," = ",v,")"],m=this.topStack()}var y=p.call(this,m);w||this.popStack(),g&&this.stackSlot--,this.push(f.concat(y,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var p=this.inlineStack;this.inlineStack=[];for(var f=0,m=p.length;f<m;f++){var g=p[f];if(g instanceof u)this.compileStack.push(g);else{var w=this.incrStack();this.pushSource([w," = ",g,";"]),this.compileStack.push(w)}}},isInline:function(){return this.inlineStack.length},popStack:function(p){var f=this.isInline(),m=(f?this.inlineStack:this.compileStack).pop();if(!p&&m instanceof u)return m.value;if(!f){if(!this.stackSlot)throw new s.default("Invalid stack pop");this.stackSlot--}return m},topStack:function(){var p=this.isInline()?this.inlineStack:this.compileStack,f=p[p.length-1];return f instanceof u?f.value:f},contextName:function(p){return this.useDepths&&p?"depths["+p+"]":"depth"+p},quotedString:function(p){return this.source.quotedString(p)},objectLiteral:function(p){return this.source.objectLiteral(p)},aliasable:function(p){var f=this.aliases[p];return f?(f.referenceCount++,f):(f=this.aliases[p]=this.source.wrap(p),f.aliasable=!0,f.referenceCount=1,f)},setupHelper:function(p,f,m){var g=[],w=this.setupHelperArgs(f,p,g,m),v=this.nameLookup("helpers",f,"helper"),b=this.aliasable(this.contextName(0)+" != null ? "+this.contextName(0)+" : (container.nullContext || {})");return{params:g,paramsInit:w,name:v,callParams:[b].concat(g)}},setupParams:function(p,f,m){var g={},w=[],v=[],b=[],y=!m,_=void 0;y&&(m=[]),g.name=this.quotedString(p),g.hash=this.popStack(),this.trackIds&&(g.hashIds=this.popStack()),this.stringParams&&(g.hashTypes=this.popStack(),g.hashContexts=this.popStack());var A=this.popStack(),S=this.popStack();(S||A)&&(g.fn=S||"container.noop",g.inverse=A||"container.noop");for(var I=f;I--;)_=this.popStack(),m[I]=_,this.trackIds&&(b[I]=this.popStack()),this.stringParams&&(v[I]=this.popStack(),w[I]=this.popStack());return y&&(g.args=this.source.generateArray(m)),this.trackIds&&(g.ids=this.source.generateArray(b)),this.stringParams&&(g.types=this.source.generateArray(v),g.contexts=this.source.generateArray(w)),this.options.data&&(g.data="data"),this.useBlockParams&&(g.blockParams="blockParams"),g},setupHelperArgs:function(p,f,m,g){var w=this.setupParams(p,f,m);return w.loc=JSON.stringify(this.source.currentLocation),w=this.objectLiteral(w),g?(this.useRegister("options"),m.push("options"),["options=",w]):m?(m.push(w),""):w}},function(){for(var h="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),p=c.RESERVED_WORDS={},f=0,m=h.length;f<m;f++)p[h[f]]=!0}(),c.isValidJavaScriptVariableName=function(h){return!c.RESERVED_WORDS[h]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(h)};function d(h,p,f,m,g){var w=p.popStack(),v=f.length;for(h&&v--;m<v;m++)w=p.nameLookup(w,f[m],g);return h?[p.aliasable("container.strict"),"(",w,", ",p.quotedString(f[m]),", ",JSON.stringify(p.source.currentLocation)," )"]:w}e.default=c,t.exports=e.default})(Zs,Zs.exports);var Iy=Zs.exports;(function(t,e){e.__esModule=!0;function n(v){return v&&v.__esModule?v:{default:v}}var r=Kg,i=n(r),s=ku,o=n(s),a=nr,l=rr,u=Iy,c=n(u),d=xu,h=n(d),p=bu,f=n(p),m=i.default.create;function g(){var v=m();return v.compile=function(b,y){return l.compile(b,y,v)},v.precompile=function(b,y){return l.precompile(b,y,v)},v.AST=o.default,v.Compiler=l.Compiler,v.JavaScriptCompiler=c.default,v.Parser=a.parser,v.parse=a.parse,v.parseWithoutProcessing=a.parseWithoutProcessing,v}var w=g();w.create=g,f.default(w),w.Visitor=h.default,w.default=w,e.default=w,t.exports=e.default})(Rs,Rs.exports);var Py=Rs.exports;const cs=Co(Py);function Ko(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Ht=Ko();function Iu(t){Ht=t}const Pu=/[&<>"']/,Ny=new RegExp(Pu.source,"g"),Nu=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,My=new RegExp(Nu.source,"g"),Ly={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Gl=t=>Ly[t];function Ce(t,e){if(e){if(Pu.test(t))return t.replace(Ny,Gl)}else if(Nu.test(t))return t.replace(My,Gl);return t}const Dy=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function Fy(t){return t.replace(Dy,(e,n)=>(n=n.toLowerCase(),n==="colon"?":":n.charAt(0)==="#"?n.charAt(1)==="x"?String.fromCharCode(parseInt(n.substring(2),16)):String.fromCharCode(+n.substring(1)):""))}const By=/(^|[^\[])\^/g;function V(t,e){let n=typeof t=="string"?t:t.source;e=e||"";const r={replace:(i,s)=>{let o=typeof s=="string"?s:s.source;return o=o.replace(By,"$1"),n=n.replace(i,o),r},getRegex:()=>new RegExp(n,e)};return r}function Kl(t){try{t=encodeURI(t).replace(/%25/g,"%")}catch{return null}return t}const Bn={exec:()=>null};function Yl(t,e){const n=t.replace(/\|/g,(s,o,a)=>{let l=!1,u=o;for(;--u>=0&&a[u]==="\\";)l=!l;return l?"|":" |"}),r=n.split(/ \|/);let i=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(/\\\|/g,"|");return r}function xr(t,e,n){const r=t.length;if(r===0)return"";let i=0;for(;i<r;){const s=t.charAt(r-i-1);if(s===e&&!n)i++;else if(s!==e&&n)i++;else break}return t.slice(0,r-i)}function $y(t,e){if(t.indexOf(e[1])===-1)return-1;let n=0;for(let r=0;r<t.length;r++)if(t[r]==="\\")r++;else if(t[r]===e[0])n++;else if(t[r]===e[1]&&(n--,n<0))return r;return-1}function Xl(t,e,n,r){const i=e.href,s=e.title?Ce(e.title):null,o=t[1].replace(/\\([\[\]])/g,"$1");if(t[0].charAt(0)!=="!"){r.state.inLink=!0;const a={type:"link",raw:n,href:i,title:s,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,a}return{type:"image",raw:n,href:i,title:s,text:Ce(o)}}function Uy(t,e){const n=t.match(/^(\s+)(?:```)/);if(n===null)return e;const r=n[1];return e.split(`
`).map(i=>{const s=i.match(/^\s+/);if(s===null)return i;const[o]=s;return o.length>=r.length?i.slice(r.length):i}).join(`
`)}class ei{constructor(e){B(this,"options");B(this,"rules");B(this,"lexer");this.options=e||Ht}space(e){const n=this.rules.block.newline.exec(e);if(n&&n[0].length>0)return{type:"space",raw:n[0]}}code(e){const n=this.rules.block.code.exec(e);if(n){const r=n[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:n[0],codeBlockStyle:"indented",text:this.options.pedantic?r:xr(r,`
`)}}}fences(e){const n=this.rules.block.fences.exec(e);if(n){const r=n[0],i=Uy(r,n[3]||"");return{type:"code",raw:r,lang:n[2]?n[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):n[2],text:i}}}heading(e){const n=this.rules.block.heading.exec(e);if(n){let r=n[2].trim();if(/#$/.test(r)){const i=xr(r,"#");(this.options.pedantic||!i||/ $/.test(i))&&(r=i.trim())}return{type:"heading",raw:n[0],depth:n[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){const n=this.rules.block.hr.exec(e);if(n)return{type:"hr",raw:n[0]}}blockquote(e){const n=this.rules.block.blockquote.exec(e);if(n){const r=xr(n[0].replace(/^ *>[ \t]?/gm,""),`
`),i=this.lexer.state.top;this.lexer.state.top=!0;const s=this.lexer.blockTokens(r);return this.lexer.state.top=i,{type:"blockquote",raw:n[0],tokens:s,text:r}}}list(e){let n=this.rules.block.list.exec(e);if(n){let r=n[1].trim();const i=r.length>1,s={type:"list",raw:"",ordered:i,start:i?+r.slice(0,-1):"",loose:!1,items:[]};r=i?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=i?r:"[*+-]");const o=new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`);let a="",l="",u=!1;for(;e;){let c=!1;if(!(n=o.exec(e))||this.rules.block.hr.test(e))break;a=n[0],e=e.substring(a.length);let d=n[2].split(`
`,1)[0].replace(/^\t+/,w=>" ".repeat(3*w.length)),h=e.split(`
`,1)[0],p=0;this.options.pedantic?(p=2,l=d.trimStart()):(p=n[2].search(/[^ ]/),p=p>4?1:p,l=d.slice(p),p+=n[1].length);let f=!1;if(!d&&/^ *$/.test(h)&&(a+=h+`
`,e=e.substring(h.length+1),c=!0),!c){const w=new RegExp(`^ {0,${Math.min(3,p-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),v=new RegExp(`^ {0,${Math.min(3,p-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),b=new RegExp(`^ {0,${Math.min(3,p-1)}}(?:\`\`\`|~~~)`),y=new RegExp(`^ {0,${Math.min(3,p-1)}}#`);for(;e;){const _=e.split(`
`,1)[0];if(h=_,this.options.pedantic&&(h=h.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),b.test(h)||y.test(h)||w.test(h)||v.test(e))break;if(h.search(/[^ ]/)>=p||!h.trim())l+=`
`+h.slice(p);else{if(f||d.search(/[^ ]/)>=4||b.test(d)||y.test(d)||v.test(d))break;l+=`
`+h}!f&&!h.trim()&&(f=!0),a+=_+`
`,e=e.substring(_.length+1),d=h.slice(p)}}s.loose||(u?s.loose=!0:/\n *\n *$/.test(a)&&(u=!0));let m=null,g;this.options.gfm&&(m=/^\[[ xX]\] /.exec(l),m&&(g=m[0]!=="[ ] ",l=l.replace(/^\[[ xX]\] +/,""))),s.items.push({type:"list_item",raw:a,task:!!m,checked:g,loose:!1,text:l,tokens:[]}),s.raw+=a}s.items[s.items.length-1].raw=a.trimEnd(),s.items[s.items.length-1].text=l.trimEnd(),s.raw=s.raw.trimEnd();for(let c=0;c<s.items.length;c++)if(this.lexer.state.top=!1,s.items[c].tokens=this.lexer.blockTokens(s.items[c].text,[]),!s.loose){const d=s.items[c].tokens.filter(p=>p.type==="space"),h=d.length>0&&d.some(p=>/\n.*\n/.test(p.raw));s.loose=h}if(s.loose)for(let c=0;c<s.items.length;c++)s.items[c].loose=!0;return s}}html(e){const n=this.rules.block.html.exec(e);if(n)return{type:"html",block:!0,raw:n[0],pre:n[1]==="pre"||n[1]==="script"||n[1]==="style",text:n[0]}}def(e){const n=this.rules.block.def.exec(e);if(n){const r=n[1].toLowerCase().replace(/\s+/g," "),i=n[2]?n[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=n[3]?n[3].substring(1,n[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):n[3];return{type:"def",tag:r,raw:n[0],href:i,title:s}}}table(e){const n=this.rules.block.table.exec(e);if(!n||!/[:|]/.test(n[2]))return;const r=Yl(n[1]),i=n[2].replace(/^\||\| *$/g,"").split("|"),s=n[3]&&n[3].trim()?n[3].replace(/\n[ \t]*$/,"").split(`
`):[],o={type:"table",raw:n[0],header:[],align:[],rows:[]};if(r.length===i.length){for(const a of i)/^ *-+: *$/.test(a)?o.align.push("right"):/^ *:-+: *$/.test(a)?o.align.push("center"):/^ *:-+ *$/.test(a)?o.align.push("left"):o.align.push(null);for(const a of r)o.header.push({text:a,tokens:this.lexer.inline(a)});for(const a of s)o.rows.push(Yl(a,o.header.length).map(l=>({text:l,tokens:this.lexer.inline(l)})));return o}}lheading(e){const n=this.rules.block.lheading.exec(e);if(n)return{type:"heading",raw:n[0],depth:n[2].charAt(0)==="="?1:2,text:n[1],tokens:this.lexer.inline(n[1])}}paragraph(e){const n=this.rules.block.paragraph.exec(e);if(n){const r=n[1].charAt(n[1].length-1)===`
`?n[1].slice(0,-1):n[1];return{type:"paragraph",raw:n[0],text:r,tokens:this.lexer.inline(r)}}}text(e){const n=this.rules.block.text.exec(e);if(n)return{type:"text",raw:n[0],text:n[0],tokens:this.lexer.inline(n[0])}}escape(e){const n=this.rules.inline.escape.exec(e);if(n)return{type:"escape",raw:n[0],text:Ce(n[1])}}tag(e){const n=this.rules.inline.tag.exec(e);if(n)return!this.lexer.state.inLink&&/^<a /i.test(n[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(n[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(n[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(n[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:n[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:n[0]}}link(e){const n=this.rules.inline.link.exec(e);if(n){const r=n[2].trim();if(!this.options.pedantic&&/^</.test(r)){if(!/>$/.test(r))return;const o=xr(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{const o=$y(n[2],"()");if(o>-1){const l=(n[0].indexOf("!")===0?5:4)+n[1].length+o;n[2]=n[2].substring(0,o),n[0]=n[0].substring(0,l).trim(),n[3]=""}}let i=n[2],s="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i);o&&(i=o[1],s=o[3])}else s=n[3]?n[3].slice(1,-1):"";return i=i.trim(),/^</.test(i)&&(this.options.pedantic&&!/>$/.test(r)?i=i.slice(1):i=i.slice(1,-1)),Xl(n,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},n[0],this.lexer)}}reflink(e,n){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){const i=(r[2]||r[1]).replace(/\s+/g," "),s=n[i.toLowerCase()];if(!s){const o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return Xl(r,s,r[0],this.lexer)}}emStrong(e,n,r=""){let i=this.rules.inline.emStrongLDelim.exec(e);if(!i||i[3]&&r.match(/[\p{L}\p{N}]/u))return;if(!(i[1]||i[2]||"")||!r||this.rules.inline.punctuation.exec(r)){const o=[...i[0]].length-1;let a,l,u=o,c=0;const d=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,n=n.slice(-1*e.length+o);(i=d.exec(n))!=null;){if(a=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!a)continue;if(l=[...a].length,i[3]||i[4]){u+=l;continue}else if((i[5]||i[6])&&o%3&&!((o+l)%3)){c+=l;continue}if(u-=l,u>0)continue;l=Math.min(l,l+u+c);const h=[...i[0]][0].length,p=e.slice(0,o+i.index+h+l);if(Math.min(o,l)%2){const m=p.slice(1,-1);return{type:"em",raw:p,text:m,tokens:this.lexer.inlineTokens(m)}}const f=p.slice(2,-2);return{type:"strong",raw:p,text:f,tokens:this.lexer.inlineTokens(f)}}}}codespan(e){const n=this.rules.inline.code.exec(e);if(n){let r=n[2].replace(/\n/g," ");const i=/[^ ]/.test(r),s=/^ /.test(r)&&/ $/.test(r);return i&&s&&(r=r.substring(1,r.length-1)),r=Ce(r,!0),{type:"codespan",raw:n[0],text:r}}}br(e){const n=this.rules.inline.br.exec(e);if(n)return{type:"br",raw:n[0]}}del(e){const n=this.rules.inline.del.exec(e);if(n)return{type:"del",raw:n[0],text:n[2],tokens:this.lexer.inlineTokens(n[2])}}autolink(e){const n=this.rules.inline.autolink.exec(e);if(n){let r,i;return n[2]==="@"?(r=Ce(n[1]),i="mailto:"+r):(r=Ce(n[1]),i=r),{type:"link",raw:n[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}url(e){var r;let n;if(n=this.rules.inline.url.exec(e)){let i,s;if(n[2]==="@")i=Ce(n[0]),s="mailto:"+i;else{let o;do o=n[0],n[0]=((r=this.rules.inline._backpedal.exec(n[0]))==null?void 0:r[0])??"";while(o!==n[0]);i=Ce(n[0]),n[1]==="www."?s="http://"+n[0]:s=n[0]}return{type:"link",raw:n[0],text:i,href:s,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e){const n=this.rules.inline.text.exec(e);if(n){let r;return this.lexer.state.inRawBlock?r=n[0]:r=Ce(n[0]),{type:"text",raw:n[0],text:r}}}}const Hy=/^(?: *(?:\n|$))+/,zy=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,jy=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,sr=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Wy=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Mu=/(?:[*+-]|\d{1,9}[.)])/,Lu=V(/^(?!bull )((?:.|\n(?!\s*?\n|bull ))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,Mu).getRegex(),Yo=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,qy=/^[^\n]+/,Xo=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Vy=V(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",Xo).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Jy=V(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Mu).getRegex(),Si="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Zo=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,Gy=V("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",Zo).replace("tag",Si).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Du=V(Yo).replace("hr",sr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Si).getRegex(),Ky=V(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Du).getRegex(),Qo={blockquote:Ky,code:zy,def:Vy,fences:jy,heading:Wy,hr:sr,html:Gy,lheading:Lu,list:Jy,newline:Hy,paragraph:Du,table:Bn,text:qy},Zl=V("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",sr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Si).getRegex(),Yy={...Qo,table:Zl,paragraph:V(Yo).replace("hr",sr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Zl).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Si).getRegex()},Xy={...Qo,html:V(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Zo).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Bn,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:V(Yo).replace("hr",sr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Lu).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Fu=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Zy=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Bu=/^( {2,}|\\)\n(?!\s*$)/,Qy=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,or="\\p{P}$+<=>`^|~",ev=V(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,or).getRegex(),tv=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,nv=V(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,or).getRegex(),rv=V("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,or).getRegex(),iv=V("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,or).getRegex(),sv=V(/\\([punct])/,"gu").replace(/punct/g,or).getRegex(),ov=V(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),av=V(Zo).replace("(?:-->|$)","-->").getRegex(),lv=V("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",av).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ti=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,cv=V(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",ti).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),$u=V(/^!?\[(label)\]\[(ref)\]/).replace("label",ti).replace("ref",Xo).getRegex(),Uu=V(/^!?\[(ref)\](?:\[\])?/).replace("ref",Xo).getRegex(),uv=V("reflink|nolink(?!\\()","g").replace("reflink",$u).replace("nolink",Uu).getRegex(),ea={_backpedal:Bn,anyPunctuation:sv,autolink:ov,blockSkip:tv,br:Bu,code:Zy,del:Bn,emStrongLDelim:nv,emStrongRDelimAst:rv,emStrongRDelimUnd:iv,escape:Fu,link:cv,nolink:Uu,punctuation:ev,reflink:$u,reflinkSearch:uv,tag:lv,text:Qy,url:Bn},hv={...ea,link:V(/^!?\[(label)\]\((.*?)\)/).replace("label",ti).getRegex(),reflink:V(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ti).getRegex()},eo={...ea,escape:V(Fu).replace("])","~|])").getRegex(),url:V(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},fv={...eo,br:V(Bu).replace("{2,}","*").getRegex(),text:V(eo.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Sr={normal:Qo,gfm:Yy,pedantic:Xy},Cn={normal:ea,gfm:eo,breaks:fv,pedantic:hv};class Ke{constructor(e){B(this,"tokens");B(this,"options");B(this,"state");B(this,"tokenizer");B(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Ht,this.options.tokenizer=this.options.tokenizer||new ei,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={block:Sr.normal,inline:Cn.normal};this.options.pedantic?(n.block=Sr.pedantic,n.inline=Cn.pedantic):this.options.gfm&&(n.block=Sr.gfm,this.options.breaks?n.inline=Cn.breaks:n.inline=Cn.gfm),this.tokenizer.rules=n}static get rules(){return{block:Sr,inline:Cn}}static lex(e,n){return new Ke(n).lex(e)}static lexInline(e,n){return new Ke(n).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,n=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(a,l,u)=>l+"    ".repeat(u.length));let r,i,s,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(r=a.call({lexer:this},e,n))?(e=e.substring(r.raw.length),n.push(r),!0):!1))){if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length),r.raw.length===1&&n.length>0?n[n.length-1].raw+=`
`:n.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length),i=n[n.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text):n.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length),i=n[n.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+r.raw,i.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),n.push(r);continue}if(s=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const l=e.slice(1);let u;this.options.extensions.startBlock.forEach(c=>{u=c.call({lexer:this},l),typeof u=="number"&&u>=0&&(a=Math.min(a,u))}),a<1/0&&a>=0&&(s=e.substring(0,a+1))}if(this.state.top&&(r=this.tokenizer.paragraph(s))){i=n[n.length-1],o&&i.type==="paragraph"?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):n.push(r),o=s.length!==e.length,e=e.substring(r.raw.length);continue}if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length),i=n[n.length-1],i&&i.type==="text"?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):n.push(r);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,n}inline(e,n=[]){return this.inlineQueue.push({src:e,tokens:n}),n}inlineTokens(e,n=[]){let r,i,s,o=e,a,l,u;if(this.tokens.links){const c=Object.keys(this.tokens.links);if(c.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)c.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null;)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(l||(u=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(c=>(r=c.call({lexer:this},e,n))?(e=e.substring(r.raw.length),n.push(r),!0):!1))){if(r=this.tokenizer.escape(e)){e=e.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.tag(e)){e=e.substring(r.raw.length),i=n[n.length-1],i&&r.type==="text"&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):n.push(r);continue}if(r=this.tokenizer.link(e)){e=e.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(r.raw.length),i=n[n.length-1],i&&r.type==="text"&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):n.push(r);continue}if(r=this.tokenizer.emStrong(e,o,u)){e=e.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.codespan(e)){e=e.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.br(e)){e=e.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.del(e)){e=e.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.autolink(e)){e=e.substring(r.raw.length),n.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(e))){e=e.substring(r.raw.length),n.push(r);continue}if(s=e,this.options.extensions&&this.options.extensions.startInline){let c=1/0;const d=e.slice(1);let h;this.options.extensions.startInline.forEach(p=>{h=p.call({lexer:this},d),typeof h=="number"&&h>=0&&(c=Math.min(c,h))}),c<1/0&&c>=0&&(s=e.substring(0,c+1))}if(r=this.tokenizer.inlineText(s)){e=e.substring(r.raw.length),r.raw.slice(-1)!=="_"&&(u=r.raw.slice(-1)),l=!0,i=n[n.length-1],i&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):n.push(r);continue}if(e){const c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return n}}class ni{constructor(e){B(this,"options");this.options=e||Ht}code(e,n,r){var s;const i=(s=(n||"").match(/^\S*/))==null?void 0:s[0];return e=e.replace(/\n$/,"")+`
`,i?'<pre><code class="language-'+Ce(i)+'">'+(r?e:Ce(e,!0))+`</code></pre>
`:"<pre><code>"+(r?e:Ce(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e,n){return e}heading(e,n,r){return`<h${n}>${e}</h${n}>
`}hr(){return`<hr>
`}list(e,n,r){const i=n?"ol":"ul",s=n&&r!==1?' start="'+r+'"':"";return"<"+i+s+`>
`+e+"</"+i+`>
`}listitem(e,n,r){return`<li>${e}</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(e){return`<p>${e}</p>
`}table(e,n){return n&&(n=`<tbody>${n}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+n+`</table>
`}tablerow(e){return`<tr>
${e}</tr>
`}tablecell(e,n){const r=n.header?"th":"td";return(n.align?`<${r} align="${n.align}">`:`<${r}>`)+e+`</${r}>
`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return"<br>"}del(e){return`<del>${e}</del>`}link(e,n,r){const i=Kl(e);if(i===null)return r;e=i;let s='<a href="'+e+'"';return n&&(s+=' title="'+n+'"'),s+=">"+r+"</a>",s}image(e,n,r){const i=Kl(e);if(i===null)return r;e=i;let s=`<img src="${e}" alt="${r}"`;return n&&(s+=` title="${n}"`),s+=">",s}text(e){return e}}class ta{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,n,r){return""+r}image(e,n,r){return""+r}br(){return""}}class Ye{constructor(e){B(this,"options");B(this,"renderer");B(this,"textRenderer");this.options=e||Ht,this.options.renderer=this.options.renderer||new ni,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new ta}static parse(e,n){return new Ye(n).parse(e)}static parseInline(e,n){return new Ye(n).parseInline(e)}parse(e,n=!0){let r="";for(let i=0;i<e.length;i++){const s=e[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const o=s,a=this.options.extensions.renderers[o.type].call({parser:this},o);if(a!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(o.type)){r+=a||"";continue}}switch(s.type){case"space":continue;case"hr":{r+=this.renderer.hr();continue}case"heading":{const o=s;r+=this.renderer.heading(this.parseInline(o.tokens),o.depth,Fy(this.parseInline(o.tokens,this.textRenderer)));continue}case"code":{const o=s;r+=this.renderer.code(o.text,o.lang,!!o.escaped);continue}case"table":{const o=s;let a="",l="";for(let c=0;c<o.header.length;c++)l+=this.renderer.tablecell(this.parseInline(o.header[c].tokens),{header:!0,align:o.align[c]});a+=this.renderer.tablerow(l);let u="";for(let c=0;c<o.rows.length;c++){const d=o.rows[c];l="";for(let h=0;h<d.length;h++)l+=this.renderer.tablecell(this.parseInline(d[h].tokens),{header:!1,align:o.align[h]});u+=this.renderer.tablerow(l)}r+=this.renderer.table(a,u);continue}case"blockquote":{const o=s,a=this.parse(o.tokens);r+=this.renderer.blockquote(a);continue}case"list":{const o=s,a=o.ordered,l=o.start,u=o.loose;let c="";for(let d=0;d<o.items.length;d++){const h=o.items[d],p=h.checked,f=h.task;let m="";if(h.task){const g=this.renderer.checkbox(!!p);u?h.tokens.length>0&&h.tokens[0].type==="paragraph"?(h.tokens[0].text=g+" "+h.tokens[0].text,h.tokens[0].tokens&&h.tokens[0].tokens.length>0&&h.tokens[0].tokens[0].type==="text"&&(h.tokens[0].tokens[0].text=g+" "+h.tokens[0].tokens[0].text)):h.tokens.unshift({type:"text",text:g+" "}):m+=g+" "}m+=this.parse(h.tokens,u),c+=this.renderer.listitem(m,f,!!p)}r+=this.renderer.list(c,a,l);continue}case"html":{const o=s;r+=this.renderer.html(o.text,o.block);continue}case"paragraph":{const o=s;r+=this.renderer.paragraph(this.parseInline(o.tokens));continue}case"text":{let o=s,a=o.tokens?this.parseInline(o.tokens):o.text;for(;i+1<e.length&&e[i+1].type==="text";)o=e[++i],a+=`
`+(o.tokens?this.parseInline(o.tokens):o.text);r+=n?this.renderer.paragraph(a):a;continue}default:{const o='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}parseInline(e,n){n=n||this.renderer;let r="";for(let i=0;i<e.length;i++){const s=e[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const o=this.options.extensions.renderers[s.type].call({parser:this},s);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){r+=o||"";continue}}switch(s.type){case"escape":{const o=s;r+=n.text(o.text);break}case"html":{const o=s;r+=n.html(o.text);break}case"link":{const o=s;r+=n.link(o.href,o.title,this.parseInline(o.tokens,n));break}case"image":{const o=s;r+=n.image(o.href,o.title,o.text);break}case"strong":{const o=s;r+=n.strong(this.parseInline(o.tokens,n));break}case"em":{const o=s;r+=n.em(this.parseInline(o.tokens,n));break}case"codespan":{const o=s;r+=n.codespan(o.text);break}case"br":{r+=n.br();break}case"del":{const o=s;r+=n.del(this.parseInline(o.tokens,n));break}case"text":{const o=s;r+=n.text(o.text);break}default:{const o='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}}class $n{constructor(e){B(this,"options");this.options=e||Ht}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}B($n,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));var Xn,to,pi,Hu;class dv{constructor(...e){Wi(this,Xn);Wi(this,pi);B(this,"defaults",Ko());B(this,"options",this.setOptions);B(this,"parse",gr(this,Xn,to).call(this,Ke.lex,Ye.parse));B(this,"parseInline",gr(this,Xn,to).call(this,Ke.lexInline,Ye.parseInline));B(this,"Parser",Ye);B(this,"Renderer",ni);B(this,"TextRenderer",ta);B(this,"Lexer",Ke);B(this,"Tokenizer",ei);B(this,"Hooks",$n);this.use(...e)}walkTokens(e,n){var i,s;let r=[];for(const o of e)switch(r=r.concat(n.call(this,o)),o.type){case"table":{const a=o;for(const l of a.header)r=r.concat(this.walkTokens(l.tokens,n));for(const l of a.rows)for(const u of l)r=r.concat(this.walkTokens(u.tokens,n));break}case"list":{const a=o;r=r.concat(this.walkTokens(a.items,n));break}default:{const a=o;(s=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&s[a.type]?this.defaults.extensions.childTokens[a.type].forEach(l=>{const u=a[l].flat(1/0);r=r.concat(this.walkTokens(u,n))}):a.tokens&&(r=r.concat(this.walkTokens(a.tokens,n)))}}return r}use(...e){const n=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(r=>{const i={...r};if(i.async=this.defaults.async||i.async||!1,r.extensions&&(r.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const o=n.renderers[s.name];o?n.renderers[s.name]=function(...a){let l=s.renderer.apply(this,a);return l===!1&&(l=o.apply(this,a)),l}:n.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=n[s.level];o?o.unshift(s.tokenizer):n[s.level]=[s.tokenizer],s.start&&(s.level==="block"?n.startBlock?n.startBlock.push(s.start):n.startBlock=[s.start]:s.level==="inline"&&(n.startInline?n.startInline.push(s.start):n.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(n.childTokens[s.name]=s.childTokens)}),i.extensions=n),r.renderer){const s=this.defaults.renderer||new ni(this.defaults);for(const o in r.renderer){if(!(o in s))throw new Error(`renderer '${o}' does not exist`);if(o==="options")continue;const a=o,l=r.renderer[a],u=s[a];s[a]=(...c)=>{let d=l.apply(s,c);return d===!1&&(d=u.apply(s,c)),d||""}}i.renderer=s}if(r.tokenizer){const s=this.defaults.tokenizer||new ei(this.defaults);for(const o in r.tokenizer){if(!(o in s))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const a=o,l=r.tokenizer[a],u=s[a];s[a]=(...c)=>{let d=l.apply(s,c);return d===!1&&(d=u.apply(s,c)),d}}i.tokenizer=s}if(r.hooks){const s=this.defaults.hooks||new $n;for(const o in r.hooks){if(!(o in s))throw new Error(`hook '${o}' does not exist`);if(o==="options")continue;const a=o,l=r.hooks[a],u=s[a];$n.passThroughHooks.has(o)?s[a]=c=>{if(this.defaults.async)return Promise.resolve(l.call(s,c)).then(h=>u.call(s,h));const d=l.call(s,c);return u.call(s,d)}:s[a]=(...c)=>{let d=l.apply(s,c);return d===!1&&(d=u.apply(s,c)),d}}i.hooks=s}if(r.walkTokens){const s=this.defaults.walkTokens,o=r.walkTokens;i.walkTokens=function(a){let l=[];return l.push(o.call(this,a)),s&&(l=l.concat(s.call(this,a))),l}}this.defaults={...this.defaults,...i}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,n){return Ke.lex(e,n??this.defaults)}parser(e,n){return Ye.parse(e,n??this.defaults)}}Xn=new WeakSet,to=function(e,n){return(r,i)=>{const s={...i},o={...this.defaults,...s};this.defaults.async===!0&&s.async===!1&&(o.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),o.async=!0);const a=gr(this,pi,Hu).call(this,!!o.silent,!!o.async);if(typeof r>"u"||r===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));if(o.hooks&&(o.hooks.options=o),o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(r):r).then(l=>e(l,o)).then(l=>o.hooks?o.hooks.processAllTokens(l):l).then(l=>o.walkTokens?Promise.all(this.walkTokens(l,o.walkTokens)).then(()=>l):l).then(l=>n(l,o)).then(l=>o.hooks?o.hooks.postprocess(l):l).catch(a);try{o.hooks&&(r=o.hooks.preprocess(r));let l=e(r,o);o.hooks&&(l=o.hooks.processAllTokens(l)),o.walkTokens&&this.walkTokens(l,o.walkTokens);let u=n(l,o);return o.hooks&&(u=o.hooks.postprocess(u)),u}catch(l){return a(l)}}},pi=new WeakSet,Hu=function(e,n){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const i="<p>An error occurred:</p><pre>"+Ce(r.message+"",!0)+"</pre>";return n?Promise.resolve(i):i}if(n)return Promise.reject(r);throw r}};const $t=new dv;function j(t,e){return $t.parse(t,e)}j.options=j.setOptions=function(t){return $t.setOptions(t),j.defaults=$t.defaults,Iu(j.defaults),j};j.getDefaults=Ko;j.defaults=Ht;j.use=function(...t){return $t.use(...t),j.defaults=$t.defaults,Iu(j.defaults),j};j.walkTokens=function(t,e){return $t.walkTokens(t,e)};j.parseInline=$t.parseInline;j.Parser=Ye;j.parser=Ye.parse;j.Renderer=ni;j.TextRenderer=ta;j.Lexer=Ke;j.lexer=Ke.lex;j.Tokenizer=ei;j.Hooks=$n;j.parse=j;j.options;j.setOptions;j.use;j.walkTokens;j.parseInline;Ye.parse;Ke.lex;var zu=class Ur{static isPlaceholder(e){return(e==null?void 0:e.onclick)!=null}static isAudio(e){var n;return e&&!Ur.isPlaceholder(e)&&((n=e==null?void 0:e.mimeType)==null?void 0:n.startsWith("audio/"))||e.mimeType=="application/ogg"}static isImage(e){var n;return e&&!Ur.isPlaceholder(e)&&((n=e==null?void 0:e.mimeType)==null?void 0:n.startsWith("image/"))}static isDocument(e){var n,r;return e&&!Ur.isPlaceholder(e)&&(((n=e==null?void 0:e.mimeType)==null?void 0:n.startsWith("text/"))||((r=e==null?void 0:e.mimeType)==null?void 0:r.startsWith("application/pdf")))}},pv=(t=>(t.image="image",t.audio="audio",t.document="document",t.video="video",t.file="file",t))(pv||{}),mv=class ju{constructor(e){var r;if(this.fid=e.fid||((r=e.ticket)==null?void 0:r.fid),!this.fid)throw new Error("Invalid resource, fid missing");this.ticket=e.ticket,this.fileName=e.fileName,this.size=e.size,this.data=e.data,this.url=e.url,this.mimeType=e.mimeType,this.expires=e.expires,this.meta=e.meta||{},this.meta.created=this.meta.created||Date.now();let n=this.fileName.split(".").pop();this.furl=`fid://${this.fid}.${n}`,this.fileType=ju.determineFileTypeFromMimeType(this.mimeType)||e.fileType||"file"}static determineFileTypeFromMimeType(e){const n=["audio","document","image","video","file"];if(e){let r=e.split("/")[0];if(n.includes(r))return r;if(r.startsWith("text/"))return"document";if(r==="application/ogg")return"audio";if(r==="application/pdf")return"document";if(r==="video/")return"video"}}isAudio(){var e,n;return this.fileType==="audio"?!0:this.mimeType?((e=this.mimeType)==null?void 0:e.startsWith("audio/"))||((n=this.mimeType)==null?void 0:n.startsWith("application/ogg")):!1}isVideo(){var e;return this.fileType==="video"?!0:this.mimeType?(e=this.mimeType)==null?void 0:e.startsWith("video/"):!1}isImage(){var e;return this.fileType==="image"?!0:this.mimeType?(e=this.mimeType)==null?void 0:e.startsWith("image/"):!1}isDocument(){var e,n;return this.fileType==="document"?!0:this.mimeType?((e=this.mimeType)==null?void 0:e.startsWith("text/"))||((n=this.mimeType)==null?void 0:n.startsWith("application/pdf")):!1}asBase64(e){if(this.data instanceof Buffer)return e?`data:${this.mimeType};base64,${this.data.toString("base64")}`:this.data.toString("base64");if(typeof this.data=="string")return this.data}},gv=class{constructor(t=(e,n)=>window.fetch(e,n)){this.fetch=t}async executeRequest(t,e){return await this.fetch(t,e)}},na=class{constructor(){this.messageHandlers={},this._isClient=!1,this.Resource=zu,this.events=new gt,this.intentMap=new Map,this._messageListenerHandler=t=>{if(t.origin!==window.location.origin){console.warn(`Dropping Message received from an unknown origin: ${t.origin}`);return}try{const e=t.data,n=this.messageHandlers[e.type];n?n.call(this,e,t.source):console.warn(`No handler found for message type: ${e.type}`)}catch(e){console.error("Error processing the message:",e)}},this._initMessageListener(),this._httpClient=new gv}unload(){window.removeEventListener("message",this._messageListenerHandler),console.log("Message listener removed.")}_initMessageListener(){window.addEventListener("message",this._messageListenerHandler,!1),console.log("Message listener initialized.")}addMessageHandler(t,e){this.messageHandlers[t]=e}getLocalValue(t,e){let n=t;this._isClient?n="omni/"+this._extensionId+"/"+t:n="omni/host/"+t;let r=globalThis.localStorage.getItem(n);if(r!==null){let i=JSON.parse(r),s=i.value;switch(i.type){case"boolean":s=s==="true";break;case"object":case"number":case"string":break;default:return console.warn("Unsupported value type",i.type,"on",t),null}return s}return null}setLocalValue(t,e){if(t==null||t.length==0)throw new Error("Invalid null Key passed into setLocalValue");let n=t;if(this._isClient?n="omni/"+this._extensionId+"/"+t:n="omni/host/"+t,e==null){globalThis.localStorage.removeItem(n);return}const r=typeof e;switch(r){case"number":case"string":case"object":break;case"boolean":break;default:console.warn("Unsupported value type",r,"on",t);return}globalThis.localStorage.setItem(n,JSON.stringify({type:r,value:e}))}send(t,e){this._isClient?(console.log("Sending message from client:",t),t.token=this.token,t=JSON.parse(JSON.stringify(t)),window.parent.postMessage(t,"*")):console.warn("Attempted to send a message from the host without specifying a target.")}async runServerScript(t,e){return await(await this._httpClient.executeRequest("/api/v1/mercenaries/runscript/"+t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json()}canEditFile(t){return t?this.intentMap.has(`file:edit:${t.mimeType}`):!1}canViewFile(t){return t?this.intentMap.has(`file:show:${t.mimeType}`):!1}async getFileObject(t){try{const n=await(await this._httpClient.executeRequest("/fid/"+t+"?obj=true",{method:"GET",headers:{"Content-Type":"application/json"}})).json();return n?(console.log("getFileObject",n),new mv(n)):(console.warn(`No valid file object found for fid ${t}`),null)}catch(e){return console.error(e),null}}async getFileBlob(t){try{return await(await this._httpClient.executeRequest("/fid/"+t+"?download=true")).blob()}catch(e){return console.error(e),null}}async uploadFiles(t,e="temporary"){if((t==null?void 0:t.length)>0){let n=await Promise.all(Array.from(t).map(async r=>{this.uploadSingleFile(r,e)}));return n=n.filter(r=>r),n}else return[]}async uploadSingleFile(t,e="temporary"){const n=new FormData;n.append("storageType",e),n.append("file",t,t.name||Date.now().toString());try{const r=await fetch("/fid",{method:"POST",body:n});if(r.ok){const i=await r.json();return i.length>0&&i[0].ticket&&i[0].fid?i[0]:(console.warn("Failed to upload file",{data:i,file:t}),null)}else return console.warn("Failed to upload file",{response:r,file:t}),null}catch(r){return console.error("Failed to upload file",{error:r,file:t}),null}}async startRecipe(t,e){const r=await(await fetch("/api/v1/workflow/exec",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({workflow:t,args:e})})).json();if(r.status==="JOB_STARTED")return{...r}}async downloadFile(t,e){const n=t.fid,r=e||t.fileName;fetch("/fid/"+n+"?download=true").then(i=>i.blob()).then(i=>{const s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=r,document.body.appendChild(o),o.click(),document.body.removeChild(o)}).catch(i=>console.error(i))}};na.Resource=zu;var yv=class extends na{constructor(t){super(),this._isClient=!0,this._extensionId=t;const e=new URLSearchParams(location.search);this.options=JSON.parse(e.get("o")||"{}"),this.args=JSON.parse(e.get("q")||"{}"),e.has("omniHash")?this.token=e.get("omniHash"):(console.warn("No omniHash found in the query string, this is not a window opened by OmniHost"),this.token=t+new Date().getTime().toString())}get extensionId(){return this._extensionId}init({subscriptions:t}={subscriptions:[]}){console.log("OmniSDKClient initialized for "+this.extensionId+".");const e=window.localStorage.getItem("omni-intentMap");if(e){const n=JSON.parse(e);n&&n.length>0&&(this.intentMap=new Map(n))}return this.addMessageHandler("host_cscript_response",this._handleClientScriptResponse),this.addMessageHandler("host_sync_data",this._handleSyncData),t.includes("custom_extension_event")&&this.addMessageHandler("custom_extension_event",this._handleCustomEvent),t.includes("host_chat_message_received")&&this.addMessageHandler("host_chat_message_received",this._handleChatMessageReceived),this.register(),this}register(){this.token&&this.send({type:"client_registration",token:this.token})}deregister(t){this.send({type:"client_deregistration",token:t})}sendChatMessage(t,e="text/markdown",n,r){const i={type:"client_send_chat",message:{content:t,type:e,attachments:n,flags:r}};this.send(i)}async runClientScript(t,e){const n={type:"client_run_cscript",script:t,args:e,invokeId:this.extensionId+new Date().getTime().toString()};return new Promise((r,i)=>{this.send(n),this.events.once("host_cscript_response:"+n.invokeId).then(s=>{r(s)})})}async _handleCustomEvent(t){if(t.type!=="custom_extension_event")return;const e=t;e.extensionId===this.extensionId&&await this.events.emit("custom_event",{eventId:e.eventId,eventArgs:e.eventArgs})}async _handleSyncData(t){if(t.type!=="host_sync_data")return;const e=t;this.intentMap=new Map(e.frame),await this.events.emit("data_updated",[{property:"intentMap"}])}async _handleChatMessageReceived(t){if(t.type!=="host_chat_message_received")return;const e=t;await this.events.emit("chat_message_received",[e.message])}async _handleClientScriptResponse(t){if(t.type!=="host_cscript_response")return;const e=t;await this.events.emit("host_cscript_response:"+e.invokeId,e.result)}showExtension(t,e,n="",r={},i="open"){const s={type:"client_show_extension",extensionId:t,action:i,args:e,page:n,opts:r};this.send(s)}hide(){const t={type:"client_window_message",action:"hide",args:{}};this.send(t)}show(){const t={type:"client_window_message",action:"show",args:{}};this.send(t)}close(){const t={type:"client_window_message",action:"close",args:{}};this.send(t)}signalIntent(t,e,n,r={}){const i={type:"client_signal_intent",intent:t,target:e,opts:r||{},payload:n};this.send(i)}showToast(t,e){const n={type:"client_show_toast",message:t,options:e};this.send(n)}showTopBanner(t,e,n){const r={type:"client_show_top_banner",bannerTitle:t,bannerDescription:e,options:n};this.send(r)}openRecipeInEditor(t,e){const n={type:"client_load_recipe",recipeId:t,recipeVersion:e};this.send(n)}async runExtensionScript(t,e){e??(e={});const n=await this._httpClient.executeRequest(`/api/v1/mercenaries/runscript/${this.extensionId}:`+t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok)throw new Error("Server error: HTTP status "+n.status);return await n.json()}},vv=class extends na{constructor(t){super(),this.registeredFrames={},this._app=t}get app(){return this._app}init(){return console.log("OmniSDKHost initialized."),this.addMessageHandler("client_registration",this._handleRegistration),this.addMessageHandler("client_deregistration",this._handleDeregistration),this.addMessageHandler("client_send_chat",this._handleSendChatMessage),this.addMessageHandler("client_run_cscript",this._handleRunClientScript),this.addMessageHandler("client_signal_intent",this._handleSignalIntent),this.addMessageHandler("client_window_message",this._handleWindowMessage),this.addMessageHandler("client_show_toast",this._handleShowToast),this.addMessageHandler("client_show_extension",this._handleShowExtension),this.addMessageHandler("client_load_recipe",this._handleLoadRecipe),this.addMessageHandler("client_show_top_banner",this._handleShowTopBanner),this}registerFileIntent(t,e,n){const r=`file:${t}:${e}`;console.log(`Registering file intent ${r}, handler: `,n),this.intentMap.has(r)?this.intentMap.get(r).push(n):this.intentMap.set(r,[n]),window.localStorage.setItem("omni-intentMap",JSON.stringify(Array.from(this.intentMap.entries())))}signalFileIntent(t,e,n){var s;const r=(s=e.mimeType)==null?void 0:s.split(";")[0].trim();let i=this.intentMap.get(`file:${t}:${r}`)||[];if(i.length==0&&(i=Array.from(this.intentMap.entries()).map(([o,a])=>{const[l,u,c]=o.split(":");if(l==="file"&&u===t&&c.endsWith("*")&&(r!=null&&r.startsWith(c.substring(0,c.length-1))))return a[0]}).filter(o=>o!==void 0)),i.length>0){console.log(i[0]);const{extensionId:o,page:a,hOpts:l}=i[0];console.log(`Showing ${t} intent for ${r} with extension ${o} and page ${a}`),this.app.workbench.showExtension(o,{file:e},a,Object.assign({},n,l))}else console.warn(`No handler found for intent ${t} and mime type ${e.mimeType}`)}signalCustomEvent(t,e,n){const r={type:"custom_extension_event",extensionId:t,eventId:e,eventArgs:n};this.send(r)}signalChatMessageReceived(t){t.workflowId||(t.workflowId="System");const e={type:"host_chat_message_received",message:t};this.send(e,"*")}deregister(t){t&&this.registeredFrames[t]?(console.log(`Iframe with token ${t} deregistered!`),delete this.registeredFrames[t]):console.warn(`No registered frame with token ${t}`)}async _handleRunClientScript(t){if(t.type!=="client_run_cscript")return;const e=t,n=e.script,r=e.args,i=await this.app.runScript(n,r),s={type:"host_cscript_response",invokeId:e.invokeId,result:i};this.send(s,t.token)}_handleWindowMessage(t){if(t.type!=="client_window_message")return;const e=t,n=e.action;e.args;const r=e.token;n==="close"&&this.app.closeWindow(r)}sendChatMessage(t,e="text/markdown",n,r){const i={type:"client_send_chat",message:{content:t,type:e,attachments:n,flags:r}};this._handleSendChatMessage(i)}_handleSendChatMessage(t){if(t.type!=="client_send_chat")return;const e=t.message;this.app.sendSystemMessage(e.content,e.type,e.attachments,e.flags)}_handleShowExtension(t){if(t.type!=="client_show_extension")return;const e=t,{action:n,args:r,extensionId:i,page:s,opts:o}=e;n==="open"?this.app.workbench.showExtension(i,r,s,o):n==="close"&&alert("hideExtension Not implemented")}_handleRegistration(t,e){if(t.type!=="client_registration")return;const n=t;e&&n.token&&"postMessage"in e&&!this.registeredFrames[n.token]&&(this.registeredFrames[n.token]={contentWindow:e,registeredAt:new Date},console.log(`Iframe with token ${n.token} registered!`),this.send({type:"host_sync_data",packet:"intentMap",frame:Array.from(this.intentMap.entries())},n.token))}_handleShowToast(t){if(t.type!=="client_show_toast")return;const e=t,{message:n,options:r}=e;this.app.showToast(n,r)}_handleSignalIntent(t){var n,r,i;if(t.type!=="client_signal_intent")return;const e=t;if((n=e.payload)!=null&&n.fid||(i=(r=e.payload)==null?void 0:r.ticket)!=null&&i.fid){this.signalFileIntent(e.intent,e.payload,e.opts);return}e.intent==="show"||e.intent==="edit"?this.app.workbench.showExtension(e.target,e.payload,void 0,e.opts):e.intent==="hide"?this.app.workbench.hideExtension(e.target):console.warn(`Invalid intent ${e.intent}`,e)}_handleDeregistration(t){if(t.type!=="client_deregistration")return;const e=t;e.token&&this.registeredFrames[e.token]&&this.deregister(e.token)}_handleLoadRecipe(t){if(t.type!=="client_load_recipe")return;const e=t;this.app.workbench.loadRecipe(e.recipeId,e.recipeVersion)}_handleShowTopBanner(t){if(t.type!=="client_show_top_banner")return;const e=t,{bannerTitle:n,bannerDescription:r,options:i}=e;this.app.showTopBanner(n,r,i)}send(t,e="*"){if(t.token=e,t=JSON.parse(JSON.stringify(t)),e==="*")for(const n of Object.values(this.registeredFrames))n.contentWindow.postMessage(t,"*");else{const n=this.registeredFrames[e];n?n.contentWindow.postMessage(t,"*"):console.warn(`No registered frame with token ${e}`)}}},Wu=new j.Renderer;Wu.link=function(t,e,n){return j.Renderer.prototype.link.apply(this,arguments).replace("<a","<a target='_blank'")};var wv=class{constructor(){this.SafeString=cs.SafeString,this.asyncResolvers={},this.handlebars=cs.create()}registerAsyncResolver(t,e){this.asyncResolvers[t]=e}registerToken(t,e){this.handlebars.registerHelper(t,e)}async getAsyncDataForDirective(t,e){const n=await this.asyncResolvers[t];if(!n)throw new Error(`No resolver registered for directive: ${t}`);return await n(e)}extractDirectiveData(t){var e,n,r;if(t.type==="MustacheStatement"||t.type==="BlockStatement"){const i=(e=t.path)==null?void 0:e.original,s=(r=(n=t.params)==null?void 0:n[0])==null?void 0:r.original;return{name:i,param:s}}return{}}async preprocessData(t,e){let n={};for(const[r,i]of e.entries()){const s=cs.parse(i),o=this.extractDirectiveData(s.body[0]),a=o==null?void 0:o.name,l=o==null?void 0:o.param;a&&l&&(t=t.replace(r,i))}return{content:t,data:n}}extractTokens(t){const e=/{{\s*([a-zA-Z0-9_-]+)\s*([^}]*)\s*}}/g,n=new Map;let r=0;return{modifiedContent:t.replace(e,s=>{const o=`TOKEN_${++r}`;return n.set(o,s),o}),tokens:n}}injectTokens(t,e){let n=t;return e.forEach((r,i)=>{n=n.replace(i,r)}),n}async render(t,e={}){let{modifiedContent:n,tokens:r}=this.extractTokens(t);const i=j.parse(n,{renderer:Wu});let{content:s,data:o}=await this.preprocessData(i,r);return s=this.injectTokens(s,r),this.handlebars.compile(s)(Object.assign({},o,e))}};/*! @license DOMPurify 3.0.8 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.0.8/LICENSE */const{entries:qu,setPrototypeOf:Ql,isFrozen:_v,getPrototypeOf:bv,getOwnPropertyDescriptor:ra}=Object;let{freeze:ge,seal:He,create:Vu}=Object,{apply:no,construct:ro}=typeof Reflect<"u"&&Reflect;ge||(ge=function(e){return e});He||(He=function(e){return e});no||(no=function(e,n,r){return e.apply(n,r)});ro||(ro=function(e,n){return new e(...n)});const Er=Pe(Array.prototype.forEach),ec=Pe(Array.prototype.pop),An=Pe(Array.prototype.push),Hr=Pe(String.prototype.toLowerCase),us=Pe(String.prototype.toString),kv=Pe(String.prototype.match),On=Pe(String.prototype.replace),xv=Pe(String.prototype.indexOf),Sv=Pe(String.prototype.trim),Ee=Pe(RegExp.prototype.test),Tn=Ev(TypeError);function Pe(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return no(t,e,r)}}function Ev(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return ro(t,n)}}function U(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Hr;Ql&&Ql(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const s=n(i);s!==i&&(_v(e)||(e[r]=s),i=s)}t[i]=!0}return t}function Cv(t){for(let e=0;e<t.length;e++)ra(t,e)===void 0&&(t[e]=null);return t}function Ot(t){const e=Vu(null);for(const[n,r]of qu(t))ra(t,n)!==void 0&&(Array.isArray(r)?e[n]=Cv(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=Ot(r):e[n]=r);return e}function Cr(t,e){for(;t!==null;){const r=ra(t,e);if(r){if(r.get)return Pe(r.get);if(typeof r.value=="function")return Pe(r.value)}t=bv(t)}function n(r){return console.warn("fallback value for",r),null}return n}const tc=ge(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),hs=ge(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),fs=ge(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Av=ge(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ds=ge(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Ov=ge(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),nc=ge(["#text"]),rc=ge(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),ps=ge(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ic=ge(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ar=ge(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Tv=He(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Rv=He(/<%[\w\W]*|[\w\W]*%>/gm),Iv=He(/\${[\w\W]*}/gm),Pv=He(/^data-[\-\w.\u00B7-\uFFFF]/),Nv=He(/^aria-[\-\w]+$/),Ju=He(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Mv=He(/^(?:\w+script|data):/i),Lv=He(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Gu=He(/^html$/i);var sc=Object.freeze({__proto__:null,MUSTACHE_EXPR:Tv,ERB_EXPR:Rv,TMPLIT_EXPR:Iv,DATA_ATTR:Pv,ARIA_ATTR:Nv,IS_ALLOWED_URI:Ju,IS_SCRIPT_OR_DATA:Mv,ATTR_WHITESPACE:Lv,DOCTYPE_NAME:Gu});const Dv=function(){return typeof window>"u"?null:window},Fv=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const s="dompurify"+(r?"#"+r:"");try{return e.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}};function Ku(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Dv();const e=M=>Ku(M);if(e.version="3.0.8",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:d,DOMParser:h,trustedTypes:p}=t,f=l.prototype,m=Cr(f,"cloneNode"),g=Cr(f,"nextSibling"),w=Cr(f,"childNodes"),v=Cr(f,"parentNode");if(typeof o=="function"){const M=n.createElement("template");M.content&&M.content.ownerDocument&&(n=M.content.ownerDocument)}let b,y="";const{implementation:_,createNodeIterator:A,createDocumentFragment:S,getElementsByTagName:I}=n,{importNode:z}=r;let x={};e.isSupported=typeof qu=="function"&&typeof v=="function"&&_&&_.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:E,ERB_EXPR:R,TMPLIT_EXPR:D,DATA_ATTR:N,ARIA_ATTR:Y,IS_SCRIPT_OR_DATA:te,ATTR_WHITESPACE:oe}=sc;let{IS_ALLOWED_URI:pe}=sc,F=null;const ie=U({},[...tc,...hs,...fs,...ds,...nc]);let W=null;const ht=U({},[...rc,...ps,...ic,...Ar]);let J=Object.seal(Vu(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Oe=null,Te=null,mn=!0,Wt=!0,gn=!1,yn=!0,qe=!1,Le=!1,qt=!1,Fi=!1,Vt=!1,fr=!1,dr=!1,La=!0,Da=!1;const Af="user-content-";let Bi=!0,vn=!1,Jt={},Gt=null;const Fa=U({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ba=null;const $a=U({},["audio","video","img","source","image","track"]);let $i=null;const Ua=U({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),pr="http://www.w3.org/1998/Math/MathML",mr="http://www.w3.org/2000/svg",Qe="http://www.w3.org/1999/xhtml";let Kt=Qe,Ui=!1,Hi=null;const Of=U({},[pr,mr,Qe],us);let wn=null;const Tf=["application/xhtml+xml","text/html"],Rf="text/html";let ae=null,Yt=null;const If=n.createElement("form"),Ha=function(k){return k instanceof RegExp||k instanceof Function},zi=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Yt&&Yt===k)){if((!k||typeof k!="object")&&(k={}),k=Ot(k),wn=Tf.indexOf(k.PARSER_MEDIA_TYPE)===-1?Rf:k.PARSER_MEDIA_TYPE,ae=wn==="application/xhtml+xml"?us:Hr,F="ALLOWED_TAGS"in k?U({},k.ALLOWED_TAGS,ae):ie,W="ALLOWED_ATTR"in k?U({},k.ALLOWED_ATTR,ae):ht,Hi="ALLOWED_NAMESPACES"in k?U({},k.ALLOWED_NAMESPACES,us):Of,$i="ADD_URI_SAFE_ATTR"in k?U(Ot(Ua),k.ADD_URI_SAFE_ATTR,ae):Ua,Ba="ADD_DATA_URI_TAGS"in k?U(Ot($a),k.ADD_DATA_URI_TAGS,ae):$a,Gt="FORBID_CONTENTS"in k?U({},k.FORBID_CONTENTS,ae):Fa,Oe="FORBID_TAGS"in k?U({},k.FORBID_TAGS,ae):{},Te="FORBID_ATTR"in k?U({},k.FORBID_ATTR,ae):{},Jt="USE_PROFILES"in k?k.USE_PROFILES:!1,mn=k.ALLOW_ARIA_ATTR!==!1,Wt=k.ALLOW_DATA_ATTR!==!1,gn=k.ALLOW_UNKNOWN_PROTOCOLS||!1,yn=k.ALLOW_SELF_CLOSE_IN_ATTR!==!1,qe=k.SAFE_FOR_TEMPLATES||!1,Le=k.WHOLE_DOCUMENT||!1,Vt=k.RETURN_DOM||!1,fr=k.RETURN_DOM_FRAGMENT||!1,dr=k.RETURN_TRUSTED_TYPE||!1,Fi=k.FORCE_BODY||!1,La=k.SANITIZE_DOM!==!1,Da=k.SANITIZE_NAMED_PROPS||!1,Bi=k.KEEP_CONTENT!==!1,vn=k.IN_PLACE||!1,pe=k.ALLOWED_URI_REGEXP||Ju,Kt=k.NAMESPACE||Qe,J=k.CUSTOM_ELEMENT_HANDLING||{},k.CUSTOM_ELEMENT_HANDLING&&Ha(k.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(J.tagNameCheck=k.CUSTOM_ELEMENT_HANDLING.tagNameCheck),k.CUSTOM_ELEMENT_HANDLING&&Ha(k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(J.attributeNameCheck=k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),k.CUSTOM_ELEMENT_HANDLING&&typeof k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(J.allowCustomizedBuiltInElements=k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),qe&&(Wt=!1),fr&&(Vt=!0),Jt&&(F=U({},nc),W=[],Jt.html===!0&&(U(F,tc),U(W,rc)),Jt.svg===!0&&(U(F,hs),U(W,ps),U(W,Ar)),Jt.svgFilters===!0&&(U(F,fs),U(W,ps),U(W,Ar)),Jt.mathMl===!0&&(U(F,ds),U(W,ic),U(W,Ar))),k.ADD_TAGS&&(F===ie&&(F=Ot(F)),U(F,k.ADD_TAGS,ae)),k.ADD_ATTR&&(W===ht&&(W=Ot(W)),U(W,k.ADD_ATTR,ae)),k.ADD_URI_SAFE_ATTR&&U($i,k.ADD_URI_SAFE_ATTR,ae),k.FORBID_CONTENTS&&(Gt===Fa&&(Gt=Ot(Gt)),U(Gt,k.FORBID_CONTENTS,ae)),Bi&&(F["#text"]=!0),Le&&U(F,["html","head","body"]),F.table&&(U(F,["tbody"]),delete Oe.tbody),k.TRUSTED_TYPES_POLICY){if(typeof k.TRUSTED_TYPES_POLICY.createHTML!="function")throw Tn('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof k.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Tn('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');b=k.TRUSTED_TYPES_POLICY,y=b.createHTML("")}else b===void 0&&(b=Fv(p,i)),b!==null&&typeof y=="string"&&(y=b.createHTML(""));ge&&ge(k),Yt=k}},za=U({},["mi","mo","mn","ms","mtext"]),ja=U({},["foreignobject","desc","title","annotation-xml"]),Pf=U({},["title","style","font","a","script"]),Wa=U({},[...hs,...fs,...Av]),qa=U({},[...ds,...Ov]),Nf=function(k){let O=v(k);(!O||!O.tagName)&&(O={namespaceURI:Kt,tagName:"template"});const P=Hr(k.tagName),X=Hr(O.tagName);return Hi[k.namespaceURI]?k.namespaceURI===mr?O.namespaceURI===Qe?P==="svg":O.namespaceURI===pr?P==="svg"&&(X==="annotation-xml"||za[X]):!!Wa[P]:k.namespaceURI===pr?O.namespaceURI===Qe?P==="math":O.namespaceURI===mr?P==="math"&&ja[X]:!!qa[P]:k.namespaceURI===Qe?O.namespaceURI===mr&&!ja[X]||O.namespaceURI===pr&&!za[X]?!1:!qa[P]&&(Pf[P]||!Wa[P]):!!(wn==="application/xhtml+xml"&&Hi[k.namespaceURI]):!1},St=function(k){An(e.removed,{element:k});try{k.parentNode.removeChild(k)}catch{k.remove()}},ji=function(k,O){try{An(e.removed,{attribute:O.getAttributeNode(k),from:O})}catch{An(e.removed,{attribute:null,from:O})}if(O.removeAttribute(k),k==="is"&&!W[k])if(Vt||fr)try{St(O)}catch{}else try{O.setAttribute(k,"")}catch{}},Va=function(k){let O=null,P=null;if(Fi)k="<remove></remove>"+k;else{const fe=kv(k,/^[\r\n\t ]+/);P=fe&&fe[0]}wn==="application/xhtml+xml"&&Kt===Qe&&(k='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+k+"</body></html>");const X=b?b.createHTML(k):k;if(Kt===Qe)try{O=new h().parseFromString(X,wn)}catch{}if(!O||!O.documentElement){O=_.createDocument(Kt,"template",null);try{O.documentElement.innerHTML=Ui?y:X}catch{}}const he=O.body||O.documentElement;return k&&P&&he.insertBefore(n.createTextNode(P),he.childNodes[0]||null),Kt===Qe?I.call(O,Le?"html":"body")[0]:Le?O.documentElement:he},Ja=function(k){return A.call(k.ownerDocument||k,k,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT,null)},Mf=function(k){return k instanceof d&&(typeof k.nodeName!="string"||typeof k.textContent!="string"||typeof k.removeChild!="function"||!(k.attributes instanceof c)||typeof k.removeAttribute!="function"||typeof k.setAttribute!="function"||typeof k.namespaceURI!="string"||typeof k.insertBefore!="function"||typeof k.hasChildNodes!="function")},Ga=function(k){return typeof a=="function"&&k instanceof a},et=function(k,O,P){x[k]&&Er(x[k],X=>{X.call(e,O,P,Yt)})},Ka=function(k){let O=null;if(et("beforeSanitizeElements",k,null),Mf(k))return St(k),!0;const P=ae(k.nodeName);if(et("uponSanitizeElement",k,{tagName:P,allowedTags:F}),k.hasChildNodes()&&!Ga(k.firstElementChild)&&Ee(/<[/\w]/g,k.innerHTML)&&Ee(/<[/\w]/g,k.textContent))return St(k),!0;if(!F[P]||Oe[P]){if(!Oe[P]&&Xa(P)&&(J.tagNameCheck instanceof RegExp&&Ee(J.tagNameCheck,P)||J.tagNameCheck instanceof Function&&J.tagNameCheck(P)))return!1;if(Bi&&!Gt[P]){const X=v(k)||k.parentNode,he=w(k)||k.childNodes;if(he&&X){const fe=he.length;for(let ye=fe-1;ye>=0;--ye)X.insertBefore(m(he[ye],!0),g(k))}}return St(k),!0}return k instanceof l&&!Nf(k)||(P==="noscript"||P==="noembed"||P==="noframes")&&Ee(/<\/no(script|embed|frames)/i,k.innerHTML)?(St(k),!0):(qe&&k.nodeType===3&&(O=k.textContent,Er([E,R,D],X=>{O=On(O,X," ")}),k.textContent!==O&&(An(e.removed,{element:k.cloneNode()}),k.textContent=O)),et("afterSanitizeElements",k,null),!1)},Ya=function(k,O,P){if(La&&(O==="id"||O==="name")&&(P in n||P in If))return!1;if(!(Wt&&!Te[O]&&Ee(N,O))){if(!(mn&&Ee(Y,O))){if(!W[O]||Te[O]){if(!(Xa(k)&&(J.tagNameCheck instanceof RegExp&&Ee(J.tagNameCheck,k)||J.tagNameCheck instanceof Function&&J.tagNameCheck(k))&&(J.attributeNameCheck instanceof RegExp&&Ee(J.attributeNameCheck,O)||J.attributeNameCheck instanceof Function&&J.attributeNameCheck(O))||O==="is"&&J.allowCustomizedBuiltInElements&&(J.tagNameCheck instanceof RegExp&&Ee(J.tagNameCheck,P)||J.tagNameCheck instanceof Function&&J.tagNameCheck(P))))return!1}else if(!$i[O]){if(!Ee(pe,On(P,oe,""))){if(!((O==="src"||O==="xlink:href"||O==="href")&&k!=="script"&&xv(P,"data:")===0&&Ba[k])){if(!(gn&&!Ee(te,On(P,oe,"")))){if(P)return!1}}}}}}return!0},Xa=function(k){return k.indexOf("-")>0},Za=function(k){et("beforeSanitizeAttributes",k,null);const{attributes:O}=k;if(!O)return;const P={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:W};let X=O.length;for(;X--;){const he=O[X],{name:fe,namespaceURI:ye,value:Et}=he,_n=ae(fe);let ve=fe==="value"?Et:Sv(Et);if(P.attrName=_n,P.attrValue=ve,P.keepAttr=!0,P.forceKeepAttr=void 0,et("uponSanitizeAttribute",k,P),ve=P.attrValue,P.forceKeepAttr||(ji(fe,k),!P.keepAttr))continue;if(!yn&&Ee(/\/>/i,ve)){ji(fe,k);continue}qe&&Er([E,R,D],el=>{ve=On(ve,el," ")});const Qa=ae(k.nodeName);if(Ya(Qa,_n,ve)){if(Da&&(_n==="id"||_n==="name")&&(ji(fe,k),ve=Af+ve),b&&typeof p=="object"&&typeof p.getAttributeType=="function"&&!ye)switch(p.getAttributeType(Qa,_n)){case"TrustedHTML":{ve=b.createHTML(ve);break}case"TrustedScriptURL":{ve=b.createScriptURL(ve);break}}try{ye?k.setAttributeNS(ye,fe,ve):k.setAttribute(fe,ve),ec(e.removed)}catch{}}}et("afterSanitizeAttributes",k,null)},Lf=function M(k){let O=null;const P=Ja(k);for(et("beforeSanitizeShadowDOM",k,null);O=P.nextNode();)et("uponSanitizeShadowNode",O,null),!Ka(O)&&(O.content instanceof s&&M(O.content),Za(O));et("afterSanitizeShadowDOM",k,null)};return e.sanitize=function(M){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},O=null,P=null,X=null,he=null;if(Ui=!M,Ui&&(M="<!-->"),typeof M!="string"&&!Ga(M))if(typeof M.toString=="function"){if(M=M.toString(),typeof M!="string")throw Tn("dirty is not a string, aborting")}else throw Tn("toString is not a function");if(!e.isSupported)return M;if(qt||zi(k),e.removed=[],typeof M=="string"&&(vn=!1),vn){if(M.nodeName){const Et=ae(M.nodeName);if(!F[Et]||Oe[Et])throw Tn("root node is forbidden and cannot be sanitized in-place")}}else if(M instanceof a)O=Va("<!---->"),P=O.ownerDocument.importNode(M,!0),P.nodeType===1&&P.nodeName==="BODY"||P.nodeName==="HTML"?O=P:O.appendChild(P);else{if(!Vt&&!qe&&!Le&&M.indexOf("<")===-1)return b&&dr?b.createHTML(M):M;if(O=Va(M),!O)return Vt?null:dr?y:""}O&&Fi&&St(O.firstChild);const fe=Ja(vn?M:O);for(;X=fe.nextNode();)Ka(X)||(X.content instanceof s&&Lf(X.content),Za(X));if(vn)return M;if(Vt){if(fr)for(he=S.call(O.ownerDocument);O.firstChild;)he.appendChild(O.firstChild);else he=O;return(W.shadowroot||W.shadowrootmode)&&(he=z.call(r,he,!0)),he}let ye=Le?O.outerHTML:O.innerHTML;return Le&&F["!doctype"]&&O.ownerDocument&&O.ownerDocument.doctype&&O.ownerDocument.doctype.name&&Ee(Gu,O.ownerDocument.doctype.name)&&(ye="<!DOCTYPE "+O.ownerDocument.doctype.name+`>
`+ye),qe&&Er([E,R,D],Et=>{ye=On(ye,Et," ")}),b&&dr?b.createHTML(ye):ye},e.setConfig=function(){let M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};zi(M),qt=!0},e.clearConfig=function(){Yt=null,qt=!1},e.isValidAttribute=function(M,k,O){Yt||zi({});const P=ae(M),X=ae(k);return Ya(P,X,O)},e.addHook=function(M,k){typeof k=="function"&&(x[M]=x[M]||[],An(x[M],k))},e.removeHook=function(M){if(x[M])return ec(x[M])},e.removeHooks=function(M){x[M]&&(x[M]=[])},e.removeAllHooks=function(){x={}},e}var Un=Ku();const Bv={unicode:!1};function $v(t){if(t={...Bv,...t},!t.emojis)throw new Error("Must provide emojis to markedEmoji");const e=Object.keys(t.emojis).map(i=>i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("|"),n=new RegExp(`:(${e}):`),r=new RegExp(`^${n.source}`);return{extensions:[{name:"emoji",level:"inline",start(i){var s;return(s=i.match(n))==null?void 0:s.index},tokenizer(i,s){const o=r.exec(i);if(!o)return;const a=o[1];let l=t.emojis[a],u=t.unicode;if(typeof l!="string")if(typeof l.char=="string")l=l.char,u=!0;else if(typeof l.url=="string")l=l.url,u=!1;else return;return{type:"emoji",raw:o[0],name:a,emoji:l,unicode:u}},renderer(i){return i.unicode?i.emoji:`<img alt="${i.name}" src="${i.emoji}" class="marked-emoji-img">`}}]}}class Yu extends ut{constructor(e,n){n??(n={}),n.marked??(n.marked={mangle:!1,gfm:!0,breaks:!0,headerIds:!1,headerPrefix:void 0}),n.markedEmoji??(n.markedEmoji={unicode:!0,emojis:{emojis:{fire:"",heart:"",thumbsup:""}}}),super({id:e??"text/markdown"},n)}async load(){j.use($v(this.opts.markedEmoji))}render(e){var s;const n=Array.isArray(e.value)?e.value.join(`

`):(s=e.value)==null?void 0:s.toString(),r=j.parse(n,{mangle:!1,headerIds:!1});return Un.sanitize(r,{ALLOWED_TAGS:["h1","h2","h3","h4","h5","h6","blockquote","p","a","ul","ol","nl","li","b","i","strong","em","strike","code","hr","br","div","table","thead","caption","tbody","tr","th","td","pre","img"],ALLOWED_ATTR:["href","alt","src","title"]})}}class Uv extends Yu{constructor(e,n){e??(e="text/markdown-code"),super(e,n)}render(e){var i;const n=s=>`<pre><code>${s}</code></pre>`,r=Array.isArray(e.value)?e.value.map(n).join(""):n(((i=e.value)==null?void 0:i.toString())||"");return super.render({type:"text/markdown",value:r})}}class It{constructor(){this.controls=new Map}add(e,n){this.controls.set(e,n)}get(e){return this.controls.get(e)}has(e){return this.controls.has(e)}static getInstance(){return It.instance==null&&(It.instance=new It),It.instance}}var Hv=function(e){return zv(e)&&!jv(e)};function zv(t){return!!t&&typeof t=="object"}function jv(t){var e=Object.prototype.toString.call(t);return e==="[object RegExp]"||e==="[object Date]"||Vv(t)}var Wv=typeof Symbol=="function"&&Symbol.for,qv=Wv?Symbol.for("react.element"):60103;function Vv(t){return t.$$typeof===qv}function Jv(t){return Array.isArray(t)?[]:{}}function Gn(t,e){return e.clone!==!1&&e.isMergeableObject(t)?sn(Jv(t),t,e):t}function Gv(t,e,n){return t.concat(e).map(function(r){return Gn(r,n)})}function Kv(t,e){if(!e.customMerge)return sn;var n=e.customMerge(t);return typeof n=="function"?n:sn}function Yv(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return Object.propertyIsEnumerable.call(t,e)}):[]}function oc(t){return Object.keys(t).concat(Yv(t))}function Xu(t,e){try{return e in t}catch{return!1}}function Xv(t,e){return Xu(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))}function Zv(t,e,n){var r={};return n.isMergeableObject(t)&&oc(t).forEach(function(i){r[i]=Gn(t[i],n)}),oc(e).forEach(function(i){Xv(t,i)||(Xu(t,i)&&n.isMergeableObject(e[i])?r[i]=Kv(i,n)(t[i],e[i],n):r[i]=Gn(e[i],n))}),r}function sn(t,e,n){n=n||{},n.arrayMerge=n.arrayMerge||Gv,n.isMergeableObject=n.isMergeableObject||Hv,n.cloneUnlessOtherwiseSpecified=Gn;var r=Array.isArray(e),i=Array.isArray(t),s=r===i;return s?r?n.arrayMerge(t,e,n):Zv(t,e,n):Gn(e,n)}sn.all=function(e,n){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(r,i){return sn(r,i,n)},{})};var Qv=sn,ew=Qv;const tw=Co(ew);/*!
* rete v1.5.2 
* (c) 2023 Vitaliy Stoliarov 
* Released under the MIT license.
*/function ac(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function io(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ac(Object(n),!0).forEach(function(r){T(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ac(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function $(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */$=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=typeof Symbol=="function"?Symbol:{},i=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function a(x,E,R){return Object.defineProperty(x,E,{value:R,enumerable:!0,configurable:!0,writable:!0}),x[E]}try{a({},"")}catch{a=function(E,R,D){return E[R]=D}}function l(x,E,R,D){var N=E&&E.prototype instanceof d?E:d,Y=Object.create(N.prototype),te=new S(D||[]);return Y._invoke=function(oe,pe,F){var ie="suspendedStart";return function(W,ht){if(ie==="executing")throw new Error("Generator is already running");if(ie==="completed"){if(W==="throw")throw ht;return z()}for(F.method=W,F.arg=ht;;){var J=F.delegate;if(J){var Oe=y(J,F);if(Oe){if(Oe===c)continue;return Oe}}if(F.method==="next")F.sent=F._sent=F.arg;else if(F.method==="throw"){if(ie==="suspendedStart")throw ie="completed",F.arg;F.dispatchException(F.arg)}else F.method==="return"&&F.abrupt("return",F.arg);ie="executing";var Te=u(oe,pe,F);if(Te.type==="normal"){if(ie=F.done?"completed":"suspendedYield",Te.arg===c)continue;return{value:Te.arg,done:F.done}}Te.type==="throw"&&(ie="completed",F.method="throw",F.arg=Te.arg)}}}(x,R,te),Y}function u(x,E,R){try{return{type:"normal",arg:x.call(E,R)}}catch(D){return{type:"throw",arg:D}}}t.wrap=l;var c={};function d(){}function h(){}function p(){}var f={};a(f,i,function(){return this});var m=Object.getPrototypeOf,g=m&&m(m(I([])));g&&g!==e&&n.call(g,i)&&(f=g);var w=p.prototype=d.prototype=Object.create(f);function v(x){["next","throw","return"].forEach(function(E){a(x,E,function(R){return this._invoke(E,R)})})}function b(x,E){function R(N,Y,te,oe){var pe=u(x[N],x,Y);if(pe.type!=="throw"){var F=pe.arg,ie=F.value;return ie&&typeof ie=="object"&&n.call(ie,"__await")?E.resolve(ie.__await).then(function(W){R("next",W,te,oe)},function(W){R("throw",W,te,oe)}):E.resolve(ie).then(function(W){F.value=W,te(F)},function(W){return R("throw",W,te,oe)})}oe(pe.arg)}var D;this._invoke=function(N,Y){function te(){return new E(function(oe,pe){R(N,Y,oe,pe)})}return D=D?D.then(te,te):te()}}function y(x,E){var R=x.iterator[E.method];if(R===void 0){if(E.delegate=null,E.method==="throw"){if(x.iterator.return&&(E.method="return",E.arg=void 0,y(x,E),E.method==="throw"))return c;E.method="throw",E.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var D=u(R,x.iterator,E.arg);if(D.type==="throw")return E.method="throw",E.arg=D.arg,E.delegate=null,c;var N=D.arg;return N?N.done?(E[x.resultName]=N.value,E.next=x.nextLoc,E.method!=="return"&&(E.method="next",E.arg=void 0),E.delegate=null,c):N:(E.method="throw",E.arg=new TypeError("iterator result is not an object"),E.delegate=null,c)}function _(x){var E={tryLoc:x[0]};1 in x&&(E.catchLoc=x[1]),2 in x&&(E.finallyLoc=x[2],E.afterLoc=x[3]),this.tryEntries.push(E)}function A(x){var E=x.completion||{};E.type="normal",delete E.arg,x.completion=E}function S(x){this.tryEntries=[{tryLoc:"root"}],x.forEach(_,this),this.reset(!0)}function I(x){if(x){var E=x[i];if(E)return E.call(x);if(typeof x.next=="function")return x;if(!isNaN(x.length)){var R=-1,D=function N(){for(;++R<x.length;)if(n.call(x,R))return N.value=x[R],N.done=!1,N;return N.value=void 0,N.done=!0,N};return D.next=D}}return{next:z}}function z(){return{value:void 0,done:!0}}return h.prototype=p,a(w,"constructor",p),a(p,"constructor",h),h.displayName=a(p,o,"GeneratorFunction"),t.isGeneratorFunction=function(x){var E=typeof x=="function"&&x.constructor;return!!E&&(E===h||(E.displayName||E.name)==="GeneratorFunction")},t.mark=function(x){return Object.setPrototypeOf?Object.setPrototypeOf(x,p):(x.__proto__=p,a(x,o,"GeneratorFunction")),x.prototype=Object.create(w),x},t.awrap=function(x){return{__await:x}},v(b.prototype),a(b.prototype,s,function(){return this}),t.AsyncIterator=b,t.async=function(x,E,R,D,N){N===void 0&&(N=Promise);var Y=new b(l(x,E,R,D),N);return t.isGeneratorFunction(E)?Y:Y.next().then(function(te){return te.done?te.value:Y.next()})},v(w),a(w,o,"Generator"),a(w,i,function(){return this}),a(w,"toString",function(){return"[object Generator]"}),t.keys=function(x){var E=[];for(var R in x)E.push(R);return E.reverse(),function D(){for(;E.length;){var N=E.pop();if(N in x)return D.value=N,D.done=!1,D}return D.done=!0,D}},t.values=I,S.prototype={constructor:S,reset:function(x){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!x)for(var E in this)E.charAt(0)==="t"&&n.call(this,E)&&!isNaN(+E.slice(1))&&(this[E]=void 0)},stop:function(){this.done=!0;var x=this.tryEntries[0].completion;if(x.type==="throw")throw x.arg;return this.rval},dispatchException:function(x){if(this.done)throw x;var E=this;function R(pe,F){return Y.type="throw",Y.arg=x,E.next=pe,F&&(E.method="next",E.arg=void 0),!!F}for(var D=this.tryEntries.length-1;D>=0;--D){var N=this.tryEntries[D],Y=N.completion;if(N.tryLoc==="root")return R("end");if(N.tryLoc<=this.prev){var te=n.call(N,"catchLoc"),oe=n.call(N,"finallyLoc");if(te&&oe){if(this.prev<N.catchLoc)return R(N.catchLoc,!0);if(this.prev<N.finallyLoc)return R(N.finallyLoc)}else if(te){if(this.prev<N.catchLoc)return R(N.catchLoc,!0)}else{if(!oe)throw new Error("try statement without catch or finally");if(this.prev<N.finallyLoc)return R(N.finallyLoc)}}}},abrupt:function(x,E){for(var R=this.tryEntries.length-1;R>=0;--R){var D=this.tryEntries[R];if(D.tryLoc<=this.prev&&n.call(D,"finallyLoc")&&this.prev<D.finallyLoc){var N=D;break}}N&&(x==="break"||x==="continue")&&N.tryLoc<=E&&E<=N.finallyLoc&&(N=null);var Y=N?N.completion:{};return Y.type=x,Y.arg=E,N?(this.method="next",this.next=N.finallyLoc,c):this.complete(Y)},complete:function(x,E){if(x.type==="throw")throw x.arg;return x.type==="break"||x.type==="continue"?this.next=x.arg:x.type==="return"?(this.rval=this.arg=x.arg,this.method="return",this.next="end"):x.type==="normal"&&E&&(this.next=E),c},finish:function(x){for(var E=this.tryEntries.length-1;E>=0;--E){var R=this.tryEntries[E];if(R.finallyLoc===x)return this.complete(R.completion,R.afterLoc),A(R),c}},catch:function(x){for(var E=this.tryEntries.length-1;E>=0;--E){var R=this.tryEntries[E];if(R.tryLoc===x){var D=R.completion;if(D.type==="throw"){var N=D.arg;A(R)}return N}}throw new Error("illegal catch attempt")},delegateYield:function(x,E,R){return this.delegate={iterator:I(x),resultName:E,nextLoc:R},this.method==="next"&&(this.arg=void 0),c}},t}function lc(t,e,n,r,i,s,o){try{var a=t[s](o),l=a.value}catch(u){n(u);return}a.done?e(l):Promise.resolve(l).then(r,i)}function ce(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(l){lc(s,r,i,o,a,"next",l)}function a(l){lc(s,r,i,o,a,"throw",l)}o(void 0)})}}function G(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function K(t,e,n){return e&&cc(t.prototype,e),n&&cc(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function T(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function be(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&so(t,e)}function on(t){return on=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},on(t)}function so(t,e){return so=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},so(t,e)}function nw(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function L(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rw(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return L(t)}function ke(t){var e=nw();return function(){var r=on(t),i;if(e){var s=on(this).constructor;i=Reflect.construct(r,arguments,s)}else i=r.apply(this,arguments);return rw(this,i)}}function iw(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=on(t),t!==null););return t}function zr(){return typeof Reflect<"u"&&Reflect.get?zr=Reflect.get.bind():zr=function(e,n,r){var i=iw(e,n);if(i){var s=Object.getOwnPropertyDescriptor(i,n);return s.get?s.get.call(arguments.length<3?e:r):s.value}},zr.apply(this,arguments)}function yt(t,e){return ow(t)||lw(t,e)||ia(t,e)||uw()}function Ae(t){return sw(t)||aw(t)||ia(t)||cw()}function sw(t){if(Array.isArray(t))return oo(t)}function ow(t){if(Array.isArray(t))return t}function aw(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function lw(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r=[],i=!0,s=!1,o,a;try{for(n=n.call(t);!(i=(o=n.next()).done)&&(r.push(o.value),!(e&&r.length===e));i=!0);}catch(l){s=!0,a=l}finally{try{!i&&n.return!=null&&n.return()}finally{if(s)throw a}}return r}}function ia(t,e){if(t){if(typeof t=="string")return oo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oo(t,e)}}function oo(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function cw(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uw(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uc(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=ia(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,o=!1,a;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return s=l.done,l},e:function(l){o=!0,a=l},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(o)throw a}}}}var hw=K(function t(e){G(this,t),T(this,"name",void 0),T(this,"data",{}),T(this,"engine",null),this.name=e}),ar=function(){function t(e){G(this,t),T(this,"name",void 0),T(this,"id",void 0),T(this,"position",[0,0]),T(this,"inputs",new Map),T(this,"outputs",new Map),T(this,"controls",new Map),T(this,"data",{}),T(this,"meta",{}),this.name=e,this.id=t.incrementId()}return K(t,[{key:"_add",value:function(n,r,i){if(n.has(r.key))throw new Error("Item with key '".concat(r.key,"' already been added to the node"));if(r[i]!==null)throw new Error("Item has already been added to some node");r[i]=this,n.set(r.key,r)}},{key:"addControl",value:function(n){return this._add(this.controls,n,"parent"),this}},{key:"removeControl",value:function(n){n.parent=null,this.controls.delete(n.key)}},{key:"addInput",value:function(n){return this._add(this.inputs,n,"node"),this}},{key:"removeInput",value:function(n){n.removeConnections(),n.node=null,this.inputs.delete(n.key)}},{key:"addOutput",value:function(n){return this._add(this.outputs,n,"node"),this}},{key:"removeOutput",value:function(n){n.removeConnections(),n.node=null,this.outputs.delete(n.key)}},{key:"setMeta",value:function(n){return this.meta=n,this}},{key:"getConnections",value:function(){var n=[].concat(Ae(this.inputs.values()),Ae(this.outputs.values())),r=n.reduce(function(i,s){return[].concat(Ae(i),Ae(s.connections))},[]);return r}},{key:"update",value:function(){}},{key:"toJSON",value:function(){var n=function(i){return Array.from(i).reduce(function(s,o){var a=yt(o,2),l=a[0],u=a[1];return s[l]=u.toJSON(),s},{})};return{id:this.id,data:this.data,inputs:n(this.inputs),outputs:n(this.outputs),position:this.position,name:this.name}}}],[{key:"incrementId",value:function(){return this.latestId?this.latestId++:this.latestId=1,this.latestId}},{key:"resetId",value:function(){this.latestId=0}},{key:"fromJSON",value:function(n){var r=new t(n.name),i=yt(n.position,2),s=i[0],o=i[1];return r.id=n.id,r.data=n.data,r.position=[s,o],r.name=n.name,t.latestId=Math.max(r.id,t.latestId),r}}]),t}();T(ar,"latestId",0);var Zu=function(t){be(n,t);var e=ke(n);function n(r){var i;return G(this,n),i=e.call(this,r),T(L(i),"editor",null),T(L(i),"data",{}),i}return K(n,[{key:"build",value:function(){var r=ce($().mark(function s(o){return $().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.builder(o);case 2:return l.abrupt("return",o);case 3:case"end":return l.stop()}},s,this)}));function i(s){return r.apply(this,arguments)}return i}()},{key:"createNode",value:function(){var r=ce($().mark(function s(){var o,a,l=arguments;return $().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=l.length>0&&l[0]!==void 0?l[0]:{},a=new ar(this.name),a.data=o,c.next=5,this.build(a);case 5:return c.abrupt("return",a);case 6:case"end":return c.stop()}},s,this)}));function i(){return r.apply(this,arguments)}return i}()}]),n}(hw),Qu=function(){function t(e,n){G(this,t),T(this,"output",void 0),T(this,"input",void 0),T(this,"data",{}),this.output=e,this.input=n,this.data={},this.input.addConnection(this)}return K(t,[{key:"remove",value:function(){this.input.removeConnection(this),this.output.removeConnection(this)}}]),t}(),fw=function(){function t(e){if(G(this,t),T(this,"key",void 0),T(this,"data",{}),T(this,"parent",null),this.constructor===t)throw new TypeError("Can not construct abstract class");if(!e)throw new Error("The key parameter is missing in super() of Control ");this.key=e}return K(t,[{key:"getNode",value:function(){if(this.parent===null)throw new Error("Control isn't added to Node/Input");if(this.parent instanceof ar)return this.parent;if(!this.parent.node)throw new Error("Control hasn't be added to Input or Node");return this.parent.node}},{key:"getData",value:function(n){return this.getNode().data[n]}},{key:"putData",value:function(n,r){this.getNode().data[n]=r}}]),t}(),xt=function(){function t(e){G(this,t),T(this,"events",{}),T(this,"silent",!1),this.events=e instanceof t?e.events:e.handlers}return K(t,[{key:"on",value:function(n,r){var i=this,s=n instanceof Array?n:n.split(" ");return s.forEach(function(o){if(!i.events[o])throw new Error("The event ".concat(o," does not exist"));i.events[o].push(r)}),this}},{key:"trigger",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!(n in this.events))throw new Error("The event ".concat(String(n)," cannot be triggered"));return this.events[n].reduce(function(i,s){return s(r)!==!1&&i},!0)}},{key:"bind",value:function(n){if(this.events[n])throw new Error("The event ".concat(n," is already bound"));this.events[n]=[]}},{key:"exist",value:function(n){return Array.isArray(this.events[n])}}]),t}(),sa=function(){function t(e,n,r,i){G(this,t),T(this,"node",null),T(this,"multipleConnections",void 0),T(this,"connections",[]),T(this,"key",void 0),T(this,"name",void 0),T(this,"socket",void 0),this.node=null,this.multipleConnections=i,this.connections=[],this.key=e,this.name=n,this.socket=r}return K(t,[{key:"removeConnection",value:function(n){this.connections.splice(this.connections.indexOf(n),1)}},{key:"removeConnections",value:function(){var n=this;this.connections.forEach(function(r){return n.removeConnection(r)})}}]),t}(),eh=function(t){be(n,t);var e=ke(n);function n(r,i,s){var o,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return G(this,n),o=e.call(this,r,i,s,a),T(L(o),"control",null),o}return K(n,[{key:"hasConnection",value:function(){return this.connections.length>0}},{key:"addConnection",value:function(i){if(!this.multipleConnections&&this.hasConnection())throw new Error("Multiple connections not allowed");this.connections.push(i)}},{key:"addControl",value:function(i){this.control=i,i.parent=this}},{key:"showControl",value:function(){return!this.hasConnection()&&this.control!==null}},{key:"toJSON",value:function(){return{connections:this.connections.map(function(i){if(!i.output.node)throw new Error("Node not added to Output");return{node:i.output.node.id,output:i.output.key,data:i.data}})}}}]),n}(sa),oa=function(){function t(){G(this,t)}return K(t,null,[{key:"isValidData",value:function(n){return typeof n.id=="string"&&this.isValidId(n.id)&&n.nodes instanceof Object&&!(n.nodes instanceof Array)}},{key:"isValidId",value:function(n){return/^[\w-]{3,}@[0-9]+\.[0-9]+\.[0-9]+$/.test(n)}},{key:"validate",value:function(n,r){var i=n.split("@"),s=r.id.split("@"),o=[];return this.isValidData(r)||o.push("Data is not suitable"),n!==r.id&&o.push("IDs not equal"),i[0]!==s[0]&&o.push("Names don't match"),i[1]!==s[1]&&o.push("Versions don't match"),{success:!o.length,msg:o.join(". ")}}}]),t}(),th=function(t){be(n,t);var e=ke(n);function n(r,i){var s;if(G(this,n),s=e.call(this,i),T(L(s),"id",void 0),T(L(s),"plugins",void 0),T(L(s),"components",void 0),!oa.isValidId(r))throw new Error("ID should be valid to name@0.1.0 format");return s.id=r,s.plugins=new Map,s.components=new Map,s}return K(n,[{key:"use",value:function(i,s){if(i.name&&this.plugins.has(i.name))throw new Error("Plugin ".concat(i.name," already in use"));i.install(this,s||{}),this.plugins.set(i.name,s)}},{key:"register",value:function(i){if(this.components.has(i.name))throw new Error("Component ".concat(i.name," already registered"));this.components.set(i.name,i),this.trigger("componentregister",i)}},{key:"destroy",value:function(){this.trigger("destroy")}}]),n}(xt);function mt(t,e){return window.addEventListener(t,e),function(){window.removeEventListener(t,e)}}function dw(t,e){for(var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8,r=t.offsetLeft,i=t.offsetTop,s=t.offsetParent;s&&s!==e&&n>0;)n--,r+=s.offsetLeft,i+=s.offsetTop,s=s.offsetParent;return{x:r,y:i}}var nh=function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(a,l,u){},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(a){},i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:function(a){};G(this,t),this.onTranslate=n,this.onStart=r,this.onDrag=i,T(this,"pointerStart",void 0),T(this,"el",void 0),T(this,"destroy",void 0),this.pointerStart=null,this.el=e,this.el.style.touchAction="none",this.el.addEventListener("pointerdown",this.down.bind(this));var s=mt("pointermove",this.move.bind(this)),o=mt("pointerup",this.up.bind(this));this.destroy=function(){s(),o()}}return K(t,[{key:"down",value:function(n){n.pointerType==="mouse"&&n.button!==0||(n.stopPropagation(),this.pointerStart=[n.pageX,n.pageY],this.onStart(n))}},{key:"move",value:function(n){if(this.pointerStart){n.preventDefault();var r=[n.pageX,n.pageY],i=r[0],s=r[1],o=[i-this.pointerStart[0],s-this.pointerStart[1]],a=this.el.getBoundingClientRect().width/this.el.offsetWidth;this.onTranslate(o[0]/a,o[1]/a,n)}}},{key:"up",value:function(n){this.pointerStart&&(this.pointerStart=null,this.onDrag(n))}}]),t}(),pw=function(){function t(e,n,r,i){G(this,t),T(this,"el",void 0),T(this,"intensity",void 0),T(this,"onzoom",void 0),T(this,"previous",null),T(this,"pointers",[]),T(this,"destroy",void 0),this.el=n,this.intensity=r,this.onzoom=i,e.addEventListener("wheel",this.wheel.bind(this)),e.addEventListener("pointerdown",this.down.bind(this)),e.addEventListener("dblclick",this.dblclick.bind(this));var s=mt("pointermove",this.move.bind(this)),o=mt("pointerup",this.end.bind(this)),a=mt("pointercancel",this.end.bind(this));this.destroy=function(){s(),o(),a()}}return K(t,[{key:"translating",get:function(){return this.pointers.length>=2}},{key:"wheel",value:function(n){n.preventDefault();var r=this.el.getBoundingClientRect(),i=n.deltaY<0,s=i?this.intensity:-this.intensity,o=(r.left-n.clientX)*s,a=(r.top-n.clientY)*s;this.onzoom(s,o,a,"wheel")}},{key:"touches",value:function(){var n={touches:this.pointers},r=[n.touches[0].clientX,n.touches[0].clientY],i=r[0],s=r[1],o=[n.touches[1].clientX,n.touches[1].clientY],a=o[0],l=o[1],u=Math.sqrt(Math.pow(i-a,2)+Math.pow(s-l,2));return{cx:(i+a)/2,cy:(s+l)/2,distance:u}}},{key:"down",value:function(n){this.pointers.push(n)}},{key:"move",value:function(n){if(this.pointers=this.pointers.map(function(d){return d.pointerId===n.pointerId?n:d}),!!this.translating){var r=this.el.getBoundingClientRect(),i=this.touches(),s=i.cx,o=i.cy,a=i.distance;if(this.previous!==null){var l=a/this.previous.distance-1,u=(r.left-s)*l,c=(r.top-o)*l;this.onzoom(l,u-(this.previous.cx-s),c-(this.previous.cy-o),"touch")}this.previous={cx:s,cy:o,distance:a}}}},{key:"end",value:function(n){this.previous=null,this.pointers=this.pointers.filter(function(r){return r.pointerId!==n.pointerId})}},{key:"dblclick",value:function(n){n.preventDefault();var r=this.el.getBoundingClientRect(),i=4*this.intensity,s=(r.left-n.clientX)*i,o=(r.top-n.clientY)*i;this.onzoom(i,s,o,"dblclick")}}]),t}(),mw=function(t){be(n,t);var e=ke(n);function n(r,i){var s;G(this,n),s=e.call(this,i),T(L(s),"el",void 0),T(L(s),"container",void 0),T(L(s),"transform",{k:1,x:0,y:0}),T(L(s),"mouse",{x:0,y:0}),T(L(s),"_startPosition",null),T(L(s),"_zoom",void 0),T(L(s),"_drag",void 0);var o=s.el=document.createElement("div");return s.container=r,o.style.transformOrigin="0 0",s._zoom=new pw(r,o,.1,s.onZoom.bind(L(s))),s._drag=new nh(r,s.onTranslate.bind(L(s)),s.onStart.bind(L(s))),i.on("destroy",function(){s._zoom.destroy(),s._drag.destroy()}),s.container.addEventListener("pointermove",s.pointermove.bind(L(s))),s.update(),s}return K(n,[{key:"update",value:function(){var i=this.transform;this.el.style.transform="translate(".concat(i.x,"px, ").concat(i.y,"px) scale(").concat(i.k,")")}},{key:"pointermove",value:function(i){var s=i.clientX,o=i.clientY,a=this.el.getBoundingClientRect(),l=s-a.left,u=o-a.top,c=this.transform.k;this.mouse={x:l/c,y:u/c},this.trigger("mousemove",io({},this.mouse))}},{key:"onStart",value:function(){this._startPosition=io({},this.transform)}},{key:"onTranslate",value:function(i,s){this._zoom.translating||this._startPosition&&this.translate(this._startPosition.x+i,this._startPosition.y+s)}},{key:"onZoom",value:function(i,s,o,a){this.zoom(this.transform.k*(1+i),s,o,a),this.update()}},{key:"translate",value:function(i,s){var o={transform:this.transform,x:i,y:s};this.trigger("translate",o)&&(this.transform.x=o.x,this.transform.y=o.y,this.update(),this.trigger("translated"))}},{key:"zoom",value:function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,l=this.transform.k,u={transform:this.transform,zoom:i,source:a};if(this.trigger("zoom",u)){var c=(l-u.zoom)/(l-i||1);this.transform.k=u.zoom||1,this.transform.x+=s*c,this.transform.y+=o*c,this.update(),this.trigger("zoomed",{source:a})}}},{key:"appendChild",value:function(i){this.el.appendChild(i)}},{key:"removeChild",value:function(i){this.el.removeChild(i)}}]),n}(xt),gw=function(t){be(n,t);var e=ke(n);function n(r,i,s,o){var a;return G(this,n),a=e.call(this,o),T(L(a),"connection",void 0),T(L(a),"inputNode",void 0),T(L(a),"outputNode",void 0),T(L(a),"el",void 0),a.connection=r,a.inputNode=i,a.outputNode=s,a.el=document.createElement("div"),a.el.style.position="absolute",a.el.style.zIndex="-1",a.trigger("renderconnection",{el:a.el,connection:a.connection,points:a.getPoints()}),a}return K(n,[{key:"getPoints",value:function(){var i=this.connection,s=i.input,o=i.output;if(this.inputNode.hasSocket(s)&&this.outputNode.hasSocket(o)){var a=this.outputNode.getSocketPosition(o),l=yt(a,2),u=l[0],c=l[1],d=this.inputNode.getSocketPosition(s),h=yt(d,2),p=h[0],f=h[1];return[u,c,p,f]}return[0,0,0,0]}},{key:"update",value:function(){this.trigger("updateconnection",{el:this.el,connection:this.connection,points:this.getPoints()})}}]),n}(xt),yw=function(t){be(n,t);var e=ke(n);function n(r,i,s){var o;return G(this,n),o=e.call(this,s),o.trigger("rendercontrol",{el:r,control:i}),o}return K(n)}(xt),vw=function(t){be(n,t);var e=ke(n);function n(r,i,s,o,a){var l,u;return G(this,n),u=e.call(this,a),T(L(u),"el",void 0),T(L(u),"type",void 0),T(L(u),"io",void 0),T(L(u),"node",void 0),u.el=r,u.type=i,u.io=s,u.node=o,u.trigger("rendersocket",(l={el:r},T(l,i,u.io),T(l,"socket",s.socket),l)),u}return K(n,[{key:"getPosition",value:function(i,s){var o=i.position,a=this.el,l=dw(a,s),u=l.x,c=l.y;return[o[0]+u+a.offsetWidth/2,o[1]+c+a.offsetHeight/2]}}]),n}(xt),ww=function(t){be(n,t);var e=ke(n);function n(r,i,s){var o;return G(this,n),o=e.call(this,s),T(L(o),"node",void 0),T(L(o),"component",void 0),T(L(o),"sockets",new Map),T(L(o),"controls",new Map),T(L(o),"el",void 0),T(L(o),"_startPosition",[]),T(L(o),"_drag",void 0),o.node=r,o.component=i,o.el=document.createElement("div"),o.el.style.position="absolute",o.el.addEventListener("contextmenu",function(a){return o.trigger("contextmenu",{e:a,node:o.node})}),o._drag=new nh(o.el,o.onTranslate.bind(L(o)),o.onSelect.bind(L(o)),function(){o.trigger("nodedraged",r),o.trigger("nodedragged",r)}),o.trigger("rendernode",{el:o.el,node:r,component:i.data,bindSocket:o.bindSocket.bind(L(o)),bindControl:o.bindControl.bind(L(o))}),o.update(),o}return K(n,[{key:"clearSockets",value:function(){var i=this,s=[].concat(Ae(this.node.inputs.values()),Ae(this.node.outputs.values()));this.sockets.forEach(function(o){s.includes(o.io)||i.sockets.delete(o.io)})}},{key:"bindSocket",value:function(i,s,o){this.clearSockets(),this.sockets.set(o,new vw(i,s,o,this.node,this))}},{key:"bindControl",value:function(i,s){this.controls.set(s,new yw(i,s,this))}},{key:"hasSocket",value:function(i){return this.sockets.has(i)}},{key:"getSocketPosition",value:function(i){var s=this.sockets.get(i);if(!s)throw new Error("Socket not found for ".concat(i.name," with key ").concat(i.key));return s.getPosition(this.node,this.el)}},{key:"onSelect",value:function(i){var s={node:this.node,accumulate:i.ctrlKey,e:i};this.onStart(),this.trigger("multiselectnode",s),this.trigger("selectnode",s)}},{key:"onStart",value:function(){this._startPosition=Ae(this.node.position)}},{key:"onTranslate",value:function(i,s){this.trigger("translatenode",{node:this.node,dx:i,dy:s})}},{key:"onDrag",value:function(i,s){var o=this._startPosition[0]+i,a=this._startPosition[1]+s;this.translate(o,a)}},{key:"translate",value:function(i,s){var o=this.node,a={node:o,x:i,y:s};if(this.trigger("nodetranslate",a)){var l=yt(o.position,2),u=l[0],c=l[1],d=[u,c];o.position[0]=a.x,o.position[1]=a.y,this.update(),this.trigger("nodetranslated",{node:o,prev:d})}}},{key:"update",value:function(){var i=yt(this.node.position,2),s=i[0],o=i[1];this.el.style.transform="translate(".concat(s,"px, ").concat(o,"px)")}},{key:"remove",value:function(){}},{key:"destroy",value:function(){this._drag.destroy()}}]),n}(xt),_w=function(t){be(n,t);var e=ke(n);function n(r,i,s){var o;return G(this,n),o=e.call(this,s),T(L(o),"container",void 0),T(L(o),"components",void 0),T(L(o),"nodes",new Map),T(L(o),"connections",new Map),T(L(o),"area",void 0),o.container=r,o.components=i,o.container.style.overflow="hidden",o.container.addEventListener("click",o.click.bind(L(o))),o.container.addEventListener("contextmenu",function(a){return o.trigger("contextmenu",{e:a,view:L(o)})}),s.on("destroy",mt("resize",o.resize.bind(L(o)))),s.on("destroy",function(){return o.nodes.forEach(function(a){return a.destroy()})}),o.on("nodetranslated",o.updateConnections.bind(L(o))),o.on("rendersocket",function(a){var l=a.input,u=a.output,c=Array.from(o.connections.entries()),d=c.filter(function(h){var p=yt(h,1),f=p[0];return f.input===l||f.output===u});d.forEach(function(h){var p=yt(h,2);p[0];var f=p[1];return requestAnimationFrame(function(){return f.update()})})}),o.area=new mw(r,L(o)),o.container.appendChild(o.area.el),o}return K(n,[{key:"addNode",value:function(i){var s=this.components.get(i.name);if(!s)throw new Error("Component ".concat(i.name," not found"));var o=new ww(i,s,this);this.nodes.set(i,o),this.area.appendChild(o.el)}},{key:"removeNode",value:function(i){var s=this.nodes.get(i);this.nodes.delete(i),s&&(this.area.removeChild(s.el),s.destroy())}},{key:"addConnection",value:function(i){if(!i.input.node||!i.output.node)throw new Error("Connection input or output not added to node");var s=this.nodes.get(i.input.node),o=this.nodes.get(i.output.node);if(!s||!o)throw new Error("View node not found for input or output");var a=new gw(i,s,o,this);this.connections.set(i,a),this.area.appendChild(a.el)}},{key:"removeConnection",value:function(i){var s=this.connections.get(i);this.connections.delete(i),s&&this.area.removeChild(s.el)}},{key:"updateConnections",value:function(i){var s=this,o=i.node;o.getConnections().forEach(function(a){var l=s.connections.get(a);if(!l)throw new Error("Connection view not found");l.update()})}},{key:"resize",value:function(){var i=this.container;if(!i.parentElement)throw new Error("Container doesn't have parent element");var s=i.parentElement.clientWidth,o=i.parentElement.clientHeight;i.style.width=s+"px",i.style.height=o+"px"}},{key:"click",value:function(i){var s=this.container;s===i.target&&this.trigger("click",{e:i,container:s})}}]),n}(xt),bw=function(){function t(){G(this,t),T(this,"list",[])}return K(t,[{key:"add",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r?this.contains(n)||this.list.push(n):this.list=[n]}},{key:"clear",value:function(){this.list=[]}},{key:"remove",value:function(n){this.list.splice(this.list.indexOf(n),1)}},{key:"contains",value:function(n){return this.list.indexOf(n)!==-1}},{key:"each",value:function(n){this.list.forEach(n)}}]),t}(),rh=K(function t(e){G(this,t),T(this,"handlers",void 0),this.handlers=io({warn:[console.warn],error:[console.error],componentregister:[],destroy:[]},e)}),kw=function(t){be(n,t);var e=ke(n);function n(){return G(this,n),e.call(this,{nodecreate:[],nodecreated:[],noderemove:[],noderemoved:[],connectioncreate:[],connectioncreated:[],connectionremove:[],connectionremoved:[],translatenode:[],nodetranslate:[],nodetranslated:[],nodedraged:[],nodedragged:[],selectnode:[],multiselectnode:[],nodeselect:[],nodeselected:[],rendernode:[],rendersocket:[],rendercontrol:[],renderconnection:[],updateconnection:[],keydown:[],keyup:[],translate:[],translated:[],zoom:[],zoomed:[],click:[],mousemove:[],contextmenu:[],import:[],export:[],process:[],clear:[]})}return K(n)}(rh),xw=function(t){be(n,t);var e=ke(n);function n(r,i){var s;return G(this,n),s=e.call(this,r,new kw),T(L(s),"nodes",[]),T(L(s),"selected",new bw),T(L(s),"view",void 0),s.view=new _w(i,s.components,L(s)),s.on("destroy",mt("keydown",function(o){return s.trigger("keydown",o)})),s.on("destroy",mt("keyup",function(o){return s.trigger("keyup",o)})),s.on("selectnode",function(o){var a=o.node,l=o.accumulate;return s.selectNode(a,l)}),s.on("nodeselected",function(){return s.selected.each(function(o){var a=s.view.nodes.get(o);a&&a.onStart()})}),s.on("translatenode",function(o){var a=o.dx,l=o.dy;return s.selected.each(function(u){var c=s.view.nodes.get(u);c&&c.onDrag(a,l)})}),s}return K(n,[{key:"addNode",value:function(i){this.trigger("nodecreate",i)&&(this.nodes.push(i),this.view.addNode(i),this.trigger("nodecreated",i))}},{key:"removeNode",value:function(i){var s=this;this.trigger("noderemove",i)&&(i.getConnections().forEach(function(o){return s.removeConnection(o)}),this.nodes.splice(this.nodes.indexOf(i),1),this.view.removeNode(i),this.trigger("noderemoved",i))}},{key:"connect",value:function(i,s){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.trigger("connectioncreate",{output:i,input:s}))try{var a=i.connectTo(s);a.data=o,this.view.addConnection(a),this.trigger("connectioncreated",a)}catch(l){this.trigger("warn",l)}}},{key:"removeConnection",value:function(i){this.trigger("connectionremove",i)&&(this.view.removeConnection(i),i.remove(),this.trigger("connectionremoved",i))}},{key:"selectNode",value:function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.nodes.indexOf(i)===-1)throw new Error("Node not exist in list");this.trigger("nodeselect",i)&&(this.selected.add(i,s),this.trigger("nodeselected",i))}},{key:"getComponent",value:function(i){var s=this.components.get(i);if(!s)throw"Component ".concat(i," not found");return s}},{key:"register",value:function(i){zr(on(n.prototype),"register",this).call(this,i),i.editor=this}},{key:"clear",value:function(){var i=this;Ae(this.nodes).forEach(function(s){return i.removeNode(s)}),this.trigger("clear")}},{key:"toJSON",value:function(){var i={id:this.id,nodes:{}};return this.nodes.forEach(function(s){return i.nodes[s.id]=s.toJSON()}),this.trigger("export",i),i}},{key:"beforeImport",value:function(i){var s=oa.validate(this.id,i);return s.success?(this.silent=!0,this.clear(),this.trigger("import",i),!0):(this.trigger("warn",s.msg),!1)}},{key:"afterImport",value:function(){return this.silent=!1,!0}},{key:"fromJSON",value:function(){var r=ce($().mark(function s(o){var a=this,l;return $().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(this.beforeImport(o)){c.next=2;break}return c.abrupt("return",!1);case 2:return l={},c.prev=3,c.next=6,Promise.all(Object.keys(o.nodes).map(function(){var d=ce($().mark(function h(p){var f,m;return $().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return f=o.nodes[p],m=a.getComponent(f.name),w.next=4,m.build(ar.fromJSON(f));case 4:l[p]=w.sent,a.addNode(l[p]);case 6:case"end":return w.stop()}},h)}));return function(h){return d.apply(this,arguments)}}()));case 6:Object.keys(o.nodes).forEach(function(d){var h=o.nodes[d],p=l[d];Object.keys(h.outputs).forEach(function(f){var m=h.outputs[f];m.connections.forEach(function(g){var w=g.node,v=g.data,b=p.outputs.get(f),y=l[w].inputs.get(g.input);if(!b||!y)return a.trigger("error","IO not found for node ".concat(p.id));a.connect(b,y,v)})})}),c.next=13;break;case 9:return c.prev=9,c.t0=c.catch(3),this.trigger("warn",c.t0),c.abrupt("return",!this.afterImport());case 13:return c.abrupt("return",this.afterImport());case 14:case"end":return c.stop()}},s,this,[[3,9]])}));function i(s){return r.apply(this,arguments)}return i}()}]),n}(th),ih=function(t){be(n,t);var e=ke(n);function n(r,i,s){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return G(this,n),e.call(this,r,i,s,o)}return K(n,[{key:"hasConnection",value:function(){return this.connections.length>0}},{key:"connectTo",value:function(i){if(!this.socket.compatibleWith(i.socket))throw new Error("Sockets not compatible");if(!i.multipleConnections&&i.hasConnection())throw new Error("Input already has one connection");if(!this.multipleConnections&&this.hasConnection())throw new Error("Output already has one connection");var s=new Qu(this,i);return this.connections.push(s),s}},{key:"connectedTo",value:function(i){return this.connections.some(function(s){return s.input===i})}},{key:"toJSON",value:function(){return{connections:this.connections.map(function(i){if(!i.input.node)throw new Error("Node not added to Input");return{node:i.input.node.id,input:i.input.key,data:i.data}})}}}]),n}(sa),sh=function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};G(this,t),T(this,"name",void 0),T(this,"data",void 0),T(this,"compatible",[]),this.name=e,this.data=n,this.compatible=[]}return K(t,[{key:"combineWith",value:function(n){this.compatible.push(n)}},{key:"compatibleWith",value:function(n){return this===n||this.compatible.includes(n)}}]),t}();function Sw(t,e){return t.filter(function(n){return e.indexOf(n)!==-1})}var oh=function(){function t(e){G(this,t),T(this,"nodes",void 0),this.nodes=e}return K(t,[{key:"extractInputNodes",value:function(n){var r=this;return Object.keys(n.inputs).reduce(function(i,s){var o=n.inputs[s].connections,a=(o||[]).reduce(function(l,u){return[].concat(Ae(l),[r.nodes[u.node]])},[]);return[].concat(Ae(i),Ae(a))},[])}},{key:"findSelf",value:function(n,r){var i=Sw(n,r);if(i.length)return i[0];var s=uc(r),o;try{for(s.s();!(o=s.n()).done;){var a=o.value,l=[a].concat(Ae(n)),u=this.findSelf(l,this.extractInputNodes(a));if(u)return u}}catch(c){s.e(c)}finally{s.f()}return null}},{key:"detect",value:function(){var n=this,r=Object.keys(this.nodes).map(function(l){return n.nodes[l]}),i=uc(r),s;try{for(i.s();!(s=i.n()).done;){var o=s.value,a=this.findSelf([o],this.extractInputNodes(o));if(a)return a}}catch(l){i.e(l)}finally{i.f()}return null}}]),t}(),De={AVAILABLE:0,PROCESSED:1,ABORT:2},Ew=function(t){be(n,t);var e=ke(n);function n(){return G(this,n),e.call(this,{})}return K(n)}(rh),Cw=function(t){be(n,t);var e=ke(n);function n(r){var i;return G(this,n),i=e.call(this,r,new Ew),T(L(i),"args",[]),T(L(i),"data",null),T(L(i),"state",De.AVAILABLE),T(L(i),"forwarded",new Set),T(L(i),"onAbort",function(){}),i}return K(n,[{key:"clone",value:function(){var i=new n(this.id);return this.components.forEach(function(s){return i.register(s)}),i}},{key:"throwError",value:function(){var r=ce($().mark(function s(o){var a,l=arguments;return $().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return a=l.length>1&&l[1]!==void 0?l[1]:null,c.next=3,this.abort();case 3:return this.trigger("error",{message:o,data:a}),this.processDone(),c.abrupt("return","error");case 6:case"end":return c.stop()}},s,this)}));function i(s){return r.apply(this,arguments)}return i}()},{key:"processStart",value:function(){return this.state===De.AVAILABLE?(this.state=De.PROCESSED,!0):(this.state===De.ABORT||console.warn(`The process is busy and has not been restarted.
                Use abort() to force it to complete`),!1)}},{key:"processDone",value:function(){var i=this.state!==De.ABORT;return this.state=De.AVAILABLE,i||(this.onAbort(),this.onAbort=function(){}),i}},{key:"abort",value:function(){var r=ce($().mark(function s(){var o=this;return $().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",new Promise(function(u){o.state===De.PROCESSED?(o.state=De.ABORT,o.onAbort=u):o.state===De.ABORT?(o.onAbort(),o.onAbort=u):u()}));case 1:case"end":return l.stop()}},s)}));function i(){return r.apply(this,arguments)}return i}()},{key:"lock",value:function(){var r=ce($().mark(function s(o){return $().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",new Promise(function(u){o.unlockPool=o.unlockPool||[],o.busy&&!o.outputData?o.unlockPool.push(u):u(),o.busy=!0}));case 1:case"end":return l.stop()}},s)}));function i(s){return r.apply(this,arguments)}return i}()},{key:"unlock",value:function(i){i.unlockPool.forEach(function(s){return s()}),i.unlockPool=[],i.busy=!1}},{key:"extractInputData",value:function(){var r=ce($().mark(function s(o){var a=this,l,u,c,d,h,p,f;return $().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:l={},u=0,c=Object.keys(o.inputs);case 2:if(!(u<c.length)){g.next=13;break}return d=c[u],h=o.inputs[d],p=h.connections,g.next=8,Promise.all(p.map(function(){var w=ce($().mark(function v(b){var y,_;return $().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return y=a.data.nodes[b.node],S.next=3,a.processNode(y);case 3:if(_=S.sent,_){S.next=8;break}a.abort(),S.next=9;break;case 8:return S.abrupt("return",_[b.output]);case 9:case"end":return S.stop()}},v)}));return function(v){return w.apply(this,arguments)}}()));case 8:f=g.sent,l[d]=f;case 10:u++,g.next=2;break;case 13:return g.abrupt("return",l);case 14:case"end":return g.stop()}},s)}));function i(s){return r.apply(this,arguments)}return i}()},{key:"processWorker",value:function(){var r=ce($().mark(function s(o){var a,l,u;return $().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.extractInputData(o);case 2:return a=d.sent,l=this.components.get(o.name),u={},d.prev=5,d.next=8,l.worker.apply(l,[o,a,u].concat(Ae(this.args)));case 8:d.next=14;break;case 10:d.prev=10,d.t0=d.catch(5),this.abort(),this.trigger("warn",d.t0);case 14:return d.abrupt("return",u);case 15:case"end":return d.stop()}},s,this,[[5,10]])}));function i(s){return r.apply(this,arguments)}return i}()},{key:"processNode",value:function(){var r=ce($().mark(function s(o){return $().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(this.state===De.ABORT||!o)){l.next=2;break}return l.abrupt("return",null);case 2:return l.next=4,this.lock(o);case 4:if(o.outputData){l.next=8;break}return l.next=7,this.processWorker(o);case 7:o.outputData=l.sent;case 8:return this.unlock(o),l.abrupt("return",o.outputData);case 10:case"end":return l.stop()}},s,this)}));function i(s){return r.apply(this,arguments)}return i}()},{key:"forwardProcess",value:function(){var r=ce($().mark(function s(o){var a=this;return $().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.state!==De.ABORT){u.next=2;break}return u.abrupt("return",null);case 2:return u.next=4,Promise.all(Object.keys(o.outputs).map(function(){var c=ce($().mark(function d(h){var p;return $().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return p=o.outputs[h],m.next=3,Promise.all(p.connections.map(function(){var g=ce($().mark(function w(v){var b;return $().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(b=a.data.nodes[v.node],a.forwarded.has(b)){_.next=7;break}return a.forwarded.add(b),_.next=5,a.processNode(b);case 5:return _.next=7,a.forwardProcess(b);case 7:case"end":return _.stop()}},w)}));return function(w){return g.apply(this,arguments)}}()));case 3:return m.abrupt("return",m.sent);case 4:case"end":return m.stop()}},d)}));return function(d){return c.apply(this,arguments)}}()));case 4:return u.abrupt("return",u.sent);case 5:case"end":return u.stop()}},s,this)}));function i(s){return r.apply(this,arguments)}return i}()},{key:"copy",value:function(i){return i=Object.assign({},i),i.nodes=Object.assign({},i.nodes),Object.keys(i.nodes).forEach(function(s){i.nodes[s]=Object.assign({},i.nodes[s])}),i}},{key:"validate",value:function(){var r=ce($().mark(function s(o){var a,l,u;return $().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(a=oa.validate(this.id,o),l=new oh(o.nodes),a.success){d.next=6;break}return d.next=5,this.throwError(a.msg);case 5:return d.abrupt("return",d.sent);case 6:if(u=l.detect(),!u){d.next=11;break}return d.next=10,this.throwError("Recursion detected",u);case 10:return d.abrupt("return",d.sent);case 11:return d.abrupt("return",!0);case 12:case"end":return d.stop()}},s,this)}));function i(s){return r.apply(this,arguments)}return i}()},{key:"processStartNode",value:function(){var r=ce($().mark(function s(o){var a;return $().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(o){u.next=2;break}return u.abrupt("return");case 2:if(a=this.data.nodes[o],a){u.next=7;break}return u.next=6,this.throwError("Node with such id not found");case 6:return u.abrupt("return",u.sent);case 7:return u.next=9,this.processNode(a);case 9:return u.next=11,this.forwardProcess(a);case 11:case"end":return u.stop()}},s,this)}));function i(s){return r.apply(this,arguments)}return i}()},{key:"processUnreachable",value:function(){var r=ce($().mark(function s(){var o,a,l;return $().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:o=this.data,c.t0=$().keys(o.nodes);case 2:if((c.t1=c.t0()).done){c.next=12;break}if(a=c.t1.value,l=o.nodes[a],!(typeof l.outputData>"u")){c.next=10;break}return c.next=8,this.processNode(l);case 8:return c.next=10,this.forwardProcess(l);case 10:c.next=2;break;case 12:case"end":return c.stop()}},s,this)}));function i(){return r.apply(this,arguments)}return i}()},{key:"process",value:function(){var r=ce($().mark(function s(o){var a,l,u,c,d=arguments;return $().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(a=d.length>1&&d[1]!==void 0?d[1]:null,this.processStart()){p.next=3;break}return p.abrupt("return");case 3:if(this.validate(o)){p.next=5;break}return p.abrupt("return");case 5:for(this.data=this.copy(o),l=d.length,u=new Array(l>2?l-2:0),c=2;c<l;c++)u[c-2]=d[c];return this.args=u,this.forwarded=new Set,p.next=11,this.processStartNode(a);case 11:return p.next=13,this.processUnreachable();case 13:return p.abrupt("return",this.processDone()?"success":"aborted");case 14:case"end":return p.stop()}},s,this)}));function i(s){return r.apply(this,arguments)}return i}()}]),n}(th),Aw={Engine:Cw,Recursion:oh,Component:Zu,Control:fw,Connection:Qu,Emitter:xt,Input:eh,IO:sa,Node:ar,NodeEditor:xw,Output:ih,Socket:sh};class vt extends sh{constructor(e,n,r){super(e,r),this.customActions=new Map,this.opts=r||{},this.type=n}get format(){return this.opts.format}get array(){return this.opts.array||!1}get customAction(){return this.opts.customAction}get customSettings(){return this.opts.customSettings}compatibleWith(e,n=!1){return n?super.compatibleWith(e):e.compatibleWith(this,!0)}isValidUrl(e){let n;if(!(typeof e=="string"&&e.length>0))return!1;try{n=new URL(e)}catch{return!1}return n.protocol==="http:"||n.protocol==="https:"}}class zt extends vt{compatibleWith(e,n){const r=this;return r.type?["string","image","audio","document","file"].includes(r.type):e instanceof zt}detectMimeType(e,n){}async persistObject(e,n,r){var s;if((n.ticket||n.fid)&&n.url&&!n.data)return await Promise.resolve(n);r??(r={}),r.mimeType??(r.mimeType=(s=this.detectMimeType)==null?void 0:s.call(this,e,n));const i={userId:e.userId,jobId:e.jobId,...r};return e.app.cdn.putTemp(n,i)}async persistObjects(e,n,r){return await Promise.all(n.map(async i=>await this.persistObject(e,i,r)))}async _inputFromString(e,n){if(typeof n!="string")return n;const i=n.split(`
`).map(s=>s.trim()).filter(s=>s.length);return await Promise.all(i.map(async s=>await this.persistObject(e,s)))}async _handleSingleObject(e,n,r=!1){var l,u,c,d;if(!n)return null;let i=null;const s=(l=this.format)!=null&&l.includes("base64")?"base64":void 0,o=s&&((u=this.format)==null?void 0:u.includes("withHeader"));if(n.fid)!r&&s!=="base64"?i=await e.app.cdn.find(n.fid):i=await e.app.cdn.get(n,null,s);else if(n instanceof Buffer)i=await this.persistObject(e,n);else if(typeof n=="string"){if(this.isValidUrl(n))i=await this.persistObject(e,n.trim());else if((c=n==null?void 0:n.startsWith)!=null&&c.call(n,"fid://")){const[h,p]=n.split("://")[1].split(".");i=await e.app.cdn.get({fid:h},null,s)}else n.length>0;i=await this.persistObject(e,n)}let a=null;return i&&i.fid?s==="base64"?a=i.asBase64(o):a=i:console.error("File socket: Failure to process value",n),a!==null&&((d=this.customSettings)!=null&&d.do_no_return_data)&&s!=="base64"&&delete a.data,a}async _handleObjectArray(e,n,r=!1){return n?(Array.isArray(n)||(n=[n]),n=n.filter(i=>i!==null),await Promise.all(n.map(async i=>await this._handleSingleObject(e,i,r)))):null}async _handlePort(e,n,r){return n=await this._inputFromString(e,n),Array.isArray(n)||(n=[n]),this.array?await this._handleObjectArray(e,n,r):await this._handleSingleObject(e,n[0],r)}async handleInput(e,n){return await this._handlePort(e,n,!0)}async handleOutput(e,n){return await this._handlePort(e,n,!1)}}class aa extends zt{mightBeUtf8PlainText(e){const r=e.length*.05;let i=0;for(const s of e){const o=s.charCodeAt(0);if((o>=0&&o<=31||o>=127&&o<=159)&&(i++,i>r))return!1}return!0}detectMimeType(e,n){if(n&&typeof n=="string"&&this.mightBeUtf8PlainText(n))return"text/plain"}compatibleWith(e,n){const r=this;return r.type?["string","text","document"].includes(r.type):e instanceof aa}}class Ow extends vt{async handleInput(e,n){return Array.isArray(n)&&(n=n[0]),n}async handleOutput(e,n){return await this.handleInput(e,n)}}class Tw extends vt{async handleSingleValue(e,n){if(n==null)return null;if(typeof n=="object")return n;if(typeof n=="string")try{return JSON.parse(n)}catch(r){return console.error("Error parsing object socket",r),null}return n}async _handlePort(e,n){const r=Array.isArray(n);let i=n;if(r&&!this.array?i=n.length>0?n[0]:[]:!r&&this.array&&(i=[n]),Array.isArray(i)){let s=await Promise.all(i.map(async o=>await this.handleSingleValue(e,o)));return s=s.filter(o=>o!=null),s.length>0?s:null}else{const s=await this.handleSingleValue(e,i);return s??null}}async handleInput(e,n){return await this._handlePort(e,n)}async handleOutput(e,n){return await this._handlePort(e,n)}}class la extends zt{compatibleWith(e,n){const r=this;return r.type?["string","file","image"].includes(r.type):e instanceof la}}class ca extends zt{compatibleWith(e,n){const r=this;return r.type?["string","file","video"].includes(r.type):e instanceof ca}}class ua extends zt{compatibleWith(e,n){const r=this;return r.type?["string","file","audio"].includes(r.type):e instanceof ua}}class ha extends vt{compatibleWith(e,n){const r=this;return r.type?["integer","number","float"].includes(r.type):e instanceof vt}async handleInput(e,n){return Array.isArray(n)&&(n=n[0]),n?n==="inf"?1/0:n==="-inf"?-1/0:n==="nan"?NaN:typeof n!="number"?Number(n):n:0}async handleOutput(e,n){return await this.handleInput(e,n)}}class Ei extends vt{compatibleWith(e,n){const r=this;return r.type?["string","object","number","integer","float","file","image","audio","document","text"].includes(r.type):e instanceof Ei}convertSingleValue(e){var n;return e==null||e===void 0?((n=this.customSettings)==null?void 0:n.null_value)||"":typeof e=="object"?e instanceof Date?e.toISOString():e.fid&&e.furl?e.furl:JSON.stringify(e,null,2):typeof e=="string"?e:typeof e=="number"?e.toString():typeof e=="boolean"?e?"true":"false":JSON.stringify(e,null,2)}async handleInput(e,n){var i,s;const r=((i=this.customSettings)==null?void 0:i.array_separator)??`
`;return this.array&&typeof n=="string"&&(n=n.split(r)),Array.isArray(n)||(n=[n]),n=n.map(this.convertSingleValue.bind(this)),(s=this.customSettings)!=null&&s.filter_empty&&(n=n.filter(o=>o)),this.array?n:n.join(r)}async handleOutput(e,n){return await this.handleInput(e,n)}}class Rw extends vt{async handleInput(e,n){return Array.isArray(n)&&(n=n[0]),!!n}async handleOutput(e,n){return await this.handleInput(e,n)}}class Iw extends vt{compatibleWith(e,n){return!0}async handleInput(e,n){return n}async handleOutput(e,n){return n}}const xe=new Map;xe.set("boolean",Rw);xe.set("number",ha);xe.set("integer",ha);xe.set("float",ha);xe.set("string",Ei);xe.set("text",Ei);xe.set("json",Tw);xe.set("file",zt);xe.set("image",la);xe.set("audio",ua);xe.set("document",aa);xe.set("video",ca);xe.set("any",Iw);const hc=function(t,e){let n=t;return e.array==!0&&(n+="Array"),e.format!==void 0&&(n+=`_${e.format}`),n};class Rt{constructor(){this.isSchemaObject=e=>"type"in e||"$ref"in e,this.sockets=new Map}static getSingleton(){return Rt.instance??(Rt.instance=new Rt),Rt.instance}constructSocket(e,n){let r=xe.get(e);r===void 0&&(console.warn(`Unknown socketType: ${e}, creating primimtive`),r=Ow);const i=hc(e,n),s=new r(i,e,{...n});return this.sockets.forEach(o=>{o.type===e&&(o.combineWith(s),s.combineWith(o))}),this.sockets.set(s.name,s),s}getOrCreateSocket(e,n){["image","audio","document","cdnObject","object","video","file"].forEach(s=>{e.startsWith(s)&&(e=s)}),e==="object"&&(e="json"),e.startsWith("cdnObject")&&(e="file"),e.includes("Array")&&(n.array=!0),e.includes("B64")&&(n.format="base64");const r=hc(e,n);return this.has(r)?this.get(r):this.constructSocket(e,n)}add(e,n){this.sockets.set(e,n)}get(e){return this.sockets.get(e)}has(e){return this.sockets.has(e)}}var ah=(t=>(t[t.NO_EXECUTE=1]="NO_EXECUTE",t[t.HAS_NATIVE_CODE=2]="HAS_NATIVE_CODE",t[t.UNIQUE_PER_WORKFLOW=3]="UNIQUE_PER_WORKFLOW",t))(ah||{});function lh(t){if(Array.isArray(t)){if(t.length===0)return[];if(typeof t[0]=="string")return t.map(e=>({title:e,value:e}));if(typeof t[0]=="object"&&"title"in t[0]&&"value"in t[0])return t}return typeof t=="object"&&"block"in t&&"map"in t,t}class ri{constructor(){this.data={}}create(e,n,r,i,s){return this.data.name=e,this.data.customSocket=i,this.data.socketOpts={...s},r==="array"&&(r="object",this.data.socketOpts.array=!0),this.data.type=r,this.data.dataTypes=[r],this.data.customData={},this.data.title=e,this.data.source={sourceType:n==="input"?"requestBody":"responseBody"},this}setRequired(e){return this.data.required=e,this}setHidden(e){return this.data.hidden=e,this}set(e,n){return this.data[e]=n,this}setFormat(e){return this.data.format=e,this}setDefault(e){return this.data.default=e,this}setControl(e){return e.dataType=this.data.type,this.data.control=e,this}allowMultiple(e=!0){return this.data.allowMultiple=e,this.data.socketOpts.array=!0,this}setConstraints(e,n,r){return this.data.minimum=e,this.data.maximum=n,this.data.step=r,this}setChoices(e,n){return n!=null&&(this.data.default=n),e!=null&&(this.data.choices=lh(e),this.data.choices||(this.data.choices=[{title:"(default)",value:n??""}])),this}setCustom(e,n){return this.data.customData[e]=n,this}toOmniIO(){var e;return(e=this.data).title??(e.title=this.data.name),this.data}}class ch{constructor(e){this.data={name:e},this.data.customData={}}create(e,n){return this.data.name=e,this.data.dataType=n,this}setRequired(e){return this.data.required=e,this}setHidden(e){return this.data.hidden=e,this}setCustom(e,n){return this.data.customData[e]=n,this}setControlType(e){return this.data.controlType=e,this}set(e,n){return this.data[e]=n,this}setChoices(e,n){return this.data.default=n,this.data.choices=lh(e),this.data.choices||(this.data.choices=[{title:"(default)",value:n??""}]),this}setReadonly(e){return this.data.readonly=e,this}setConstraints(e,n,r){return e!=null&&(this.data.minimum=e),n!=null&&(this.data.maximum=n),r!=null&&(this.data.step=r),this}setDefault(e){return this.data.default=e,this}toOmniControl(){var e;return(e=this.data).title??(e.title=this.data.name),this.data}}class uh{constructor(){this.data={}}fromJSON(e){return this.data=JSON.parse(JSON.stringify(e)),this}}class Pw extends uh{constructor(){super(),this.data.type="OAIComponent31",this.data.flags=0,this.data.macros={},this.data.origin="omnitool:Composer",this.data.customData={}}dependsOn(e){return this.data.dependsOn=e,this}fromScratch(){return this.data.apiNamespace=this.data.displayNamespace,this.data.apiOperationId=this.data.displayOperationId,this.data.responseContentType="application/json",this.data.category="Utilities",this.data.tags=["default"],this}createInput(e,n,r,i){return new ri().create(e,"input",n,r,i||{})}addInput(e){return this.data.inputs=this.data.inputs??{},this.data.inputs[e.name]=e,this}createOutput(e,n,r,i){return new ri().create(e,"output",n,r,i||{})}addOutput(e){return this.data.outputs=this.data.outputs??{},this.data.outputs[e.name]=e,this}setTags(e){return this.data.tags=e,this}setRenderTemplate(e){return this.data.renderTemplate=e,this}create(e,n){return this.data.displayNamespace=e,this.data.displayOperationId=n,this}set(e,n){return this.data[e]=n,this}setMethod(e){return this.data.method=e,this}useAPI(e,n){return this.data.apiNamespace=e,this.data.apiOperationId=n,this}setMeta(e){return this.data.meta=e,this}setFlags(e){return this.data.flags=e,this}setFlag(e,n=!0){const r=1<<e;return n?this.data.flags=this.data.flags|r:this.data.flags=this.data.flags&~r,this}setMacro(e,n){return this.data.macros[e]=n,n instanceof Function&&this.setFlag(ah.HAS_NATIVE_CODE),this}createControl(e,n){return new ch(e).create(e,n)}setCustom(e,n){var r;return(r=this.data).customData??(r.customData={}),this.data.customData[e]=n,this}addControl(e){return this.data.controls=this.data.controls??{},this.data.controls[e.name]=e,this}toJSON(){return this.data}}class Nw extends uh{constructor(){super(),this.data.macros={},this.data.origin="omnitool:Composer",this.data.customData={}}fromComponent(e,n){return this.data.apiNamespace=e,this.data.apiOperationId=n,this}createInput(e,n,r){return new ri().create(e,"input",n,r)}addInput(e){return this.data.inputs=this.data.inputs??{},this.data.inputs[e.name]=e,this}createOutput(e,n,r){return new ri().create(e,"output",n,r)}addOutput(e){return this.data.outputs=this.data.outputs??{},this.data.outputs[e.name]=e,this}create(e,n){return this.data.displayNamespace=e,this.data.displayOperationId=n,this}set(e,n){return this.data[e]=n,this}useAPI(e,n){return this.data.apiNamespace=e,this.data.apiOperationId=n,this}setMeta(e){return this.data.meta=e,this}setCustom(e,n){var r;return(r=this.data).customData??(r.customData={}),this.data.customData[e]=n,this}createControl(e){return new ch(e).create(e)}addControl(e){return this.data.controls=this.data.controls??{},this.data.controls[e.name]=e,this}hideExcept(e,n){(e==null?void 0:e.length)>0&&(this.data.scripts=this.data.scripts??{},this.data.scripts["hideExcept:inputs"]=e),(n==null?void 0:n.length)>0&&(this.data.scripts=this.data.scripts??{},this.data.scripts["hideExcept:outputs"]=n)}toJSON(){return this.data}}class Kn extends Aw.Control{constructor(e,n,r){super(e.name),this.data=JSON.parse(JSON.stringify(e)),this.emitter=r,this.props={ikey:e.name},this.component=n,n||console.error("Could not find component for "+e.controlType)}async initChoices(){var e,n,r;if(this.data.choices){const i=this.data.choices;if(Array.isArray(i)&&(this.data.choices=i.map(function(s){return typeof s=="object"?s:{value:s,title:s}})),typeof this.data.choices=="object"){const s=this.data.choices;if(s.block){let o=["Internal Error Fetching choices"];try{o=await globalThis.client.runBlock({block:s.block,args:s.args||{},cache:s.cache??s.map.cache??"none"})}catch(u){console.error("Could not load choices for "+this.data.name+": "+u.message),o=["ERROR: "+u.message,this.data.default]}o.error&&(console.error("Could not load choices for "+this.data.name+": "+o.error.message),o=["ERROR: "+o.error,this.data.default]);const a=(e=s.map)==null?void 0:e.root;a&&o[a]!=null&&(o=Array.isArray(o[a])?o[a]:Array.from(Object.values(o[a]))),Array.isArray(o)||(o=Array.from(Object.values(o)));const l=new RegExp((r=(n=s.map)==null?void 0:n.filter)==null?void 0:r.value);this.data.choices=o.map(u=>{var d,h;let c={value:u,title:u,description:""};return(d=s.map)!=null&&d.value&&((h=s.map)!=null&&h.title)&&(c={value:u[s.map.value],title:u[s.map.title],description:u[s.map.description]||""}),c}).filter(u=>u.value&&l.test(u.title)).sort((u,c)=>c.title.localeCompare(u.title))}this.data.required&&this.data.default==null&&Array.isArray(this.data.choices)&&this.data.choices.length>0&&(this.data.default=this.data.choices[0].value)}}}get dataType(){return this.data.dataType??"string"}get controlType(){return console.log("Access to field controlType on control"),this.data.controlType}get type(){return console.trace(),console.log("Access to deprecated field type on control"),this.data.dataType}get opts(){return this.data}get displays(){return this.data.displays??null}get minimum(){return this.data.minimum}get description(){return this.data.description}get title(){return this.data.title??this.data.name}get maximum(){return this.data.maximum}get customData(){return this.data.customData??{}}custom(e){var n;return((n=this.data.customData)==null?void 0:n[e])??null}get choices(){return this.data.choices??["(default)"]}get readonly(){return this.data.readonly??!1}_formatValue(e){return e&&((this.dataType==="number"||this.dataType=="float")&&typeof e=="string"||this.dataType==="integer"&&typeof e=="string"?e=parseFloat(e):this.dataType==="boolean"&&typeof e=="number"?e=e!=0:this.dataType==="boolean"&&typeof e=="string"&&(e=[!0,"true","1","on","active"].includes(e.toLowerCase()))),e}setValue(e){this.displays||this.readonly||(e=this._formatValue(e),this.putData(this.props.ikey,e),this.update())}static async fromControl(e,n){const r=It.getInstance().get(e.controlType),i=new Kn(e,r,n);return await i.initChoices(),i}static async fromIO(e,n,r){const i={dataType:n.type,controlType:e,name:n.name,title:n.title,choices:n.choices,description:n.description,step:n.step,default:n.default,minimum:n.minimum,maximum:n.maximum,required:n.required,...n.control||{}},s=It.getInstance().get(e),o=new Kn(i,s,r);return await o.initChoices(),o}}class Mw extends Zu{constructor(e,n){var i,s,o,a,l,u;const r=tw(e,n??{});super(`${r.displayNamespace}.${r.displayOperationId}`),this.data=r,(i=this.data).macros??(i.macros={}),(s=this.data).flags??(s.flags=0),(o=this.data).errors??(o.errors=[]),(a=this.data).xOmniEnabled??(a.xOmniEnabled=!0);for(const c in this.data.inputs)(l=this.data.inputs[c]).source??(l.source={sourceType:"requestBody"});for(const c in this.data.outputs)(u=this.data.outputs[c]).source??(u.source={sourceType:"responseBody"})}static create(e,n){return new Pw().create(e,n)}static createPatch(e,n){return new Nw().create(e,n)}get validator(){return this._validator??null}get title(){return this.data.title}get description(){return this.data.description}get scripts(){return this.data.scripts}get flags(){return this.data.flags??0}get summary(){var e;return this.data.description??((e=this.meta.source)==null?void 0:e.summary)}get category(){return this.data.category??"Base API"}get custom(){return this.data.customData||{}}get tags(){return this.data.tags}get apiKey(){return`${this.data.apiNamespace}.${this.data.apiOperationId}`}get apiNamespace(){return this.data.apiNamespace}get renderTemplate(){return this.data.renderTemplate||"default"}get type(){return this.data.type??"OAIComponent31"}get method(){return this.data.method}get inputs(){return this.data.inputs}get meta(){return this.data.meta??{}}get outputs(){return this.data.outputs}get macros(){return this.data.macros}get hash(){return this.data.hash}get controls(){return this.data.controls}get xOmniEnabled(){return this.data.xOmniEnabled??!0}set xOmniEnabled(e){this.data.xOmniEnabled=e}setType(e){return this.data.type=e,this}setApiOperationId(e){return this.data.apiOperationId=e,this}setApiNamespace(e){return this.data.apiNamespace=e,this}setDisplayNamespace(e){return this.data.displayNamespace=e,this}setDisplayOperationId(e){return this.data.displayOperationId=e,this}setTitle(e){return this.data.title=e,this}setMethod(e){return this.data.method=e,this}setDescription(e){return this.data.description=e,this}setUrlPath(e){return this.data.urlPath=e,this}setMeta(e){return this.data.meta=e,this}addInput(e,n){return this.data.inputs[e]=n,this}addControl(e,n){return this.data.controls[e]=n,this}addOutput(e,n){return this.data.outputs[e]=n,this}addTag(e){return this.data.tags.push(e),this}setCategory(e){return this.data.category=e,this}setRequestContentType(e){return this.data.requestContentType=e,this}setResponseContentType(e){return this.data.responseContentType=e,this}setCredentials(e){return this.data.credentials=e,this}setValidator(e){return this.data.validator=e,this}addSecurity(e){return this.data.security=this.data.security??[],this.data.security.push(e),this}setMacro(e,n){return this.data.macros[e]=n,this}pickDefaultControlFromDataType(e,n){var r;return e==="number"||e==="integer"||e==="float"?((r=n.format)!=null&&r.includes("int")?e="integer":(n.format==="float"||n.format==="double")&&(e="float"),n.step!=null||n.minimum!=null&&n.maximum!=null&&Math.abs(n.maximum-n.minimum)<=100?(e==="float"&&(n.step??(n.step=.1)),"AlpineNumWithSliderComponent"):"AlpineNumComponent"):e==="boolean"?"AlpineToggleComponent":e==="object"?"AlpineCodeMirrorComponent":e==="string"?n.format==="password"?"AlpinePasswordComponent":"AlpineTextComponent":null}pickDefaultControlFromControl(e){const n=e.controlType;if(n!=null)return n;if(e.choices!=null)return"AlpineSelectComponent";const r=e.dataType;if(r!=null){const i=this.pickDefaultControlFromDataType(r,e);if(i!=null)return i}return"AlpineLabelComponent"}pickDefaultControlFromIO(e){var o;const n=(o=e.control)==null?void 0:o.controlType;if(n!=null)return n;if(e.choices!=null)return"AlpineSelectComponent";const r=e.customSocket;if(r&&["imageArray","image","document","documentArray","audio","file","video","audioArray","fileArray"].includes(r))return"AlpineLabelComponent";const i=e.type,s=this.pickDefaultControlFromDataType(i,e);return s??"AlpineLabelComponent"}async builder(e){var n;e.title=this.title,e.description=this.description,await((n=this._builder)==null?void 0:n.call(this,e))}async workerStart(e,n){}async setControlValue(e,n,r){var i;if(this.data.controls[e]==null){omnilog.warn(this.name,"tried to update non existing control",e,` - suppressed.
Please check your component for a setComponentValue call that passes in a non existing control key.`);return}if(this.editor!=null){const s=((i=this.editor)==null?void 0:i.nodes.find(o=>o.id===r.node.id).controls.get(e))??null;s!=null&&s.setValue(n)}}async sendStatusUpdate(e,n,r){}}class Ci extends Mw{constructor(e,n,r){r&&omnilog.warn("fns not implemented"),super(e,n)}getSocketForIO(e){var r;let n="object";return e.customSocket?n=e.customSocket:e.type!=null&&typeof e.type=="string"?n=e.type:((r=e.dataTypes)==null?void 0:r.length)>0?n=e.dataTypes[0]:(e.step!=null||e.maximum!=null||e.minimum!=null)&&(n="number"),Rt.getSingleton().getOrCreateSocket(n,e.socketOpts||{})}async _redraw(e){}enumerateInputs(e){return Object.assign({},e.data["x-omni-dynamicInputs"]||{},this.data.inputs)}enumerateOutputs(e){return Object.assign({},e.data["x-omni-dynamicOutputs"]||{},this.data.outputs)}async _builder(e){var i,s;e.category=this.category,e.renderTemplate=this.renderTemplate,e.title=e.data["x-omni-title"]||this.title,e.summary=e.data["x-omni-summary"]||this.summary,e.namespace=this.data.displayNamespace??this.data.apiNamespace,e.meta=this.meta,e.meta.title=this.title??this.summary,e.errors=this.data.errors;const n=this.enumerateInputs(e);for(const o in n){const a=n[o];a.name??(a.name=o),a.title??(a.title=o);const l=this.pickDefaultControlFromIO(a);e.data[o]!=null&&a.default!=null&&(typeof e.data[o]!=typeof a.default||a.type==="number"&&typeof e.data[o]=="string")&&delete e.data[o],a.choices!=null&&a.choices.block&&((s=(i=a.choices.block).indexOf)==null?void 0:s.call(i,"."))===-1&&(a.choices.block=`${this.data.apiNamespace}.${a.choices.block}`);const u=await Kn.fromIO(l,a,this.editor);if(!a.hidden)if(a.readonly)e.addControl(u);else{const c=new eh(o,a.title||a.name,this.getSocketForIO(a),a.allowMultiple);c.name??(c.name=o),c.addControl(u),e.addInput(c)}}for(const o in this.controls){const a=this.controls[o];if(!a.hidden){a.name??(a.name=o),a.controlType??(a.controlType=this.pickDefaultControlFromControl(a));const l=await Kn.fromControl(a,this.editor);e.addControl(l)}}const r=this.enumerateOutputs(e);for(const o in r){const a={...r[o],name:o,title:r[o].title??o};if(!a.hidden){const l=new ih(o,a.title||a.name,this.getSocketForIO(a));l.name??(l.name=o),e.addOutput(l)}}}async runXFunction(e,n,r){return null}async _workerStart(e,n){}async runInputScripts(e,n){return e}async runOutputScripts(e,n){return e}getRequestComponents(e,n){return{requestBody:{},parameters:[]}}prunePayload(e,n,r){}async getPayload(e){return JSON.parse(JSON.stringify({}))}worker(){throw new Error("This should never be called")}static fromJSON(e,n){const r=new Ci(e,n);if(!r.name)throw new Error;return r}toJSON(){return JSON.parse(JSON.stringify({...this.data,name:this.name}))}}class Lw extends ut{constructor(e,n){super({id:e??"omni/component"},n)}render(e){const n=JSON.parse(e.value);let r;return n.type==="OAIComponent31"&&(r=Ci.fromJSON(n)),r?`
      <div class='component block rounded-lg px-4 py-2 text-sm w-full text-gray-500 hover:bg-gray-50 hover:text-gray-700  cursor-pointer'
        x-data='{}' x-tooltip='${r==null?void 0:r.name}'
        x-on:click="window.client.runScript('add',['${Un.sanitize(r.name)}'])">
        <div

          class='font-semibold max-w-md'>${Un.sanitize(r==null?void 0:r.title)}
        </div>

        <div>
        ${Un.sanitize(r==null?void 0:r.description)}</div>

      </div>`:`Can not render missing component ${e.value}`}}class Dw extends ut{constructor(e){e??(e={}),super({id:"omni/component-meta"},e)}async load(){}render(e){var r;let n="";return(r=e.value)!=null&&r.source?n=`
        <div x-data='${JSON.stringify(e.value)}'>
          <div x-show='title' class="font-bold text-center bg-gray-700 mb-2 text-gray-100" >
            <span x-text='title' ></span>
          </div>
          <div x-show='source' class=' bg-gray-300 m-1 pb-1 font-mono'>
            <div class="font-bold text-center bg-gray-700 mb-2 text-gray-100" >
              <span x-text='source?.title' ></span>
            </div>

            <div class='text-xs pl-2'>
              <div x-show='source?.authors'>
                <span class='font-semibold'>Authors: </span>
                <span  x-text='source?.authors?.join?.(", ")||source?.authors'></span>
              </div>
            </div>
            <p class='text-xs mt-1 mb-2 pl-2' x-text='source?.summary || "No Summary Available"'></p>
            <template x-for='(linkUrl,linkName) in source?.links' :key="linkName">
                <div class='text-xs  pl-1'><a class='text-blue-600  font-semibold cursor-pointer hover:text-blue-800'' :href='linkUrl' x-text='linkName' target='_blank' ></a></div>
            </template>
          </div>
        </div>`:n=`
        <div x-data='${JSON.stringify(e.value)}'>
          <div x-show='title' class="font-bold text-center bg-gray-700 mb-2 text-gray-100" >
            <span x-text='title'></span>
          </div>
          <div class=' bg-gray-300 m-1 pb-1 font-mono'>
            <p class='text-xs mt-1 mb-2  pl-2 ' x-text='"No meta info available"'></p>
          </div>
        </div>
      `,n}}class Fw extends ut{constructor(e,n){super({id:e??"omni/job"},n)}render(e){return`<div class='flex flex-col flex-wrap gap-1' x-data="{job: client.jobs.jobStorage['${e.value}']}"
            :class='{"text-gray-800": job.state == "running", "text-green-800": job.state === "success", "text-red-800": job.state == "error"}'
            x-effect="() => {
              if (job.state === 'success' || job.state === 'error') { $nextTick(() => onAsyncJobStatusEffectHandler($el, job)) }
            }"
      >
      <div class="flex">
      <span x-text="workbench.getNickname(job.workflowId) || job.meta?.name || job.id">:</span>
      &nbsp; (<span class="flex" x-text="job.activity"></span>)
      </div>
      <template x-for="(nodeId, idx) in job.activeNode" :key='idx'>
        <div class="text-blue-500" x-text="job.nodeDescriptionFromId(nodeId)"></div>
      </template>
      <template x-for="(error, idx) in job.errors" :key='idx'>
        <div class="text-red-500" x-text="error.nodeName +': '+ error.message"></div>
      </template>
      </div>`}}class Bw extends ut{constructor(e,n){super({id:e??"omni/rest-error"},n)}render(e){const n=e.value,r=function(i){let s=i;if(typeof i=="string")try{s=JSON.parse(i)}catch{}else typeof n=="object"&&(s=i);return JSON.stringify(s,null,2)};return"<div class='w-full text-red-500 font-semibold'> Error</div><div>Component Key: <span class='font-mono text-red-500'>"+(n.component||"")+"</div><div>Error Details: <pre class='font-mono text-red-500' style='white-space: pre-wrap;'>"+r(n.message)+"</pre></div>"}}function $w(t){if(!t||t.length===0)return console.warn("null text passed into escapeHtmlSpecialChars"),"";const e={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#039;"};return t.replace(/[<>&"']/g,n=>e[n])}class Uw extends ut{constructor(e,n){super({id:e??"text/plain"},n)}render(e){var r;const n=Array.isArray(e.value)?e.value.join(`
`):(r=e.value)==null?void 0:r.toString();return Un.sanitize($w(n)).replace(/\n/g,"<br/>")}}class Hw extends ut{constructor(e){e??(e={}),super({id:"omni-pro-billing/tab"},e)}async load(){}render(e){return`<div x-data='${JSON.stringify(e.value)}'>
      <div x-show='true' class=' bg-gray-300 m-1 pb-1 font-mono'>
        <div class="font-bold text-center bg-gray-700 mb-2 text-gray-100" >
        <span> </span><span x-text='jobId' >          </span>
        </div>
        <div class="flex-row w-full flex-wrap">
        <template x-for='(record,idx) in tab' :key="idx">
            <div class=' flex-row gap-1 w-full flex text-xs  pl-1'> <span x-text="idx+1"></span>.<span x-text="record.api?.toUpperCase()"></span> (<span x-text="record.model"></span>)<span class="flex-grow"></span> <span x-text="record.resource"></span>&nbsp; <span class='text-right' x-text="record.cost?.toFixed(5)"></span>  </div>
        </template>
        <div class='text-xs  pl-1 text-right'> TOTAL: <span x-text="total.toFixed(5)"></span></div>
        </div>
      </div> `}}class zw extends ut{constructor(e){e??(e={}),super({id:"omni/settings"},e)}async load(){}render(e){return`
    <div>

        <div class="flex-row w-full flex-wrap">
          <template x-for='(value,key) of window.client.${e.value}' :key="key">
            <div class=' flex-row gap-1 w-full flex text-xs  pl-1'> <span x-text="key"></span>: <span x-text="value"></span></div>
           </template>

    </div> `}}class jw extends ut{constructor(e){e??(e={}),super({id:"omni/extension-list"},e)}async load(){}render(e){const n=e.value;return`<div x-data='{extensionList: ${JSON.stringify(n)}}'><ul><b>Core Extensions</b>:<template x-for="(extension, idx) in extensionList['core']" :key='idx'>"<li x-text="extension.title + ' (' + extension.id + ')'"></li>"</template></ul>
    <ul><b>Premium Extensions</b>:<template x-for="(extension, idx) in extensionList['premium']" :key='idx'>"<li x-text="extension.title + ' (' + extension.id + ')'"></li>"</template></ul>
    <ul><b>Known Extensions</b>:<template x-for="(extension, idx) in extensionList['known']" :key='idx'>"<li x-text="extension.title + ' (' + extension.id + ')'"></li>"</template></ul>
    <ul><b>Available Extensions</b>:<template x-for="(extension, idx) in extensionList['available']" :key='idx'>"<li x-text="extension.title + ' (' + extension.id + ')'"></li>"</template></ul></div>`}}const hh=document.createElement("div");hh.innerHTML="<div class=wb-header><div class=wb-control><span class=wb-min></span><span class=wb-max></span><span class=wb-full></span><span class=wb-close></span></div><div class=wb-drag><div class=wb-icon></div><div class=wb-title></div></div></div><div class=wb-body></div><div class=wb-n></div><div class=wb-s></div><div class=wb-w></div><div class=wb-e></div><div class=wb-nw></div><div class=wb-ne></div><div class=wb-se></div><div class=wb-sw></div>";function Ww(t){return(t||hh).cloneNode(!0)}function Re(t,e,n,r){t&&t.addEventListener(e,n,r||!1)}function Or(t,e,n,r){t&&t.removeEventListener(e,n,r||!1)}function Hn(t,e){t.stopPropagation(),e&&t.preventDefault()}function $e(t,e){return t.getElementsByClassName(e)[0]}function fh(t,e){t.classList.add(e)}function qw(t,e){return t.classList.contains(e)}function dh(t,e){t.classList.remove(e)}function _e(t,e,n){n=""+n,t["_s_"+e]!==n&&(t.style.setProperty(e,n),t["_s_"+e]=n)}function Vw(t,e){const n=t.firstChild;n?n.nodeValue=e:t.textContent=e}const nn=[],Be=[],Rn={capture:!0,passive:!0};let Je,Jw=0,ii=10,an,nt,ph,we,Xe;function q(t,e){if(!(this instanceof q))return new q(t);Je||Gw();let n,r,i,s,o,a,l,u,c,d,h,p,f,m,g,w,v,b,y,_,A,S,I,z,x,E,R,D,N,Y,te,oe,pe,F,ie,W,ht,J,Oe,Te,mn,Wt,gn,yn;if(t&&(e&&(o=t,t=e),typeof t=="string"?o=t:(n=t.id,r=t.index,i=t.root,s=t.template,o=o||t.title,a=t.icon,l=t.mount,u=t.html,c=t.url,d=t.width,h=t.height,p=t.minwidth,f=t.minheight,m=t.maxwidth,g=t.maxheight,w=t.autosize,v=t.overflow,z=t.min,x=t.max,E=t.hidden,R=t.modal,b=t.x||(R?"center":0),y=t.y||(R?"center":0),_=t.top,A=t.left,S=t.bottom,I=t.right,D=t.background,N=t.border,Y=t.header,te=t.class,oe=t.oncreate,pe=t.onclose,F=t.onfocus,ie=t.onblur,W=t.onmove,ht=t.onresize,J=t.onfullscreen,Oe=t.onmaximize,Te=t.onminimize,mn=t.onrestore,Wt=t.onhide,gn=t.onshow,yn=t.onload)),this.dom=Ww(s),this.dom.id=this.id=n||"winbox-"+ ++Jw,this.dom.className="winbox"+(te?" "+(typeof te=="string"?te:te.join(" ")):"")+(R?" modal":""),this.dom.winbox=this,this.window=this.dom,this.body=$e(this.dom,"wb-body"),this.header=Y||35,Be.push(this),D&&this.setBackground(D),N?_e(this.body,"margin",N+(isNaN(N)?"":"px")):N=0,Y){const qt=$e(this.dom,"wb-header");_e(qt,"height",Y+"px"),_e(qt,"line-height",Y+"px"),_e(this.body,"top",Y+"px")}o&&this.setTitle(o),a&&this.setIcon(a),l?this.mount(l):u?this.body.innerHTML=u:c&&this.setUrl(c,yn),_=_?de(_,Xe):0,S=S?de(S,Xe):0,A=A?de(A,we):0,I=I?de(I,we):0;const qe=we-A-I,Le=Xe-_-S;m=m?de(m,qe):qe,g=g?de(g,Le):Le,p=p?de(p,m):150,f=f?de(f,g):this.header,w?((i||Je).appendChild(this.body),d=Math.max(Math.min(this.body.clientWidth+N*2+1,m),p),h=Math.max(Math.min(this.body.clientHeight+this.header+N+1,g),f),this.dom.appendChild(this.body)):(d=d?de(d,m):Math.max(m/2,p)|0,h=h?de(h,g):Math.max(g/2,f)|0),b=b?de(b,qe,d):A,y=y?de(y,Le,h):_,this.x=b,this.y=y,this.width=d,this.height=h,this.minwidth=p,this.minheight=f,this.maxwidth=m,this.maxheight=g,this.top=_,this.right=I,this.bottom=S,this.left=A,this.index=r,this.overflow=v,this.min=!1,this.max=!1,this.full=!1,this.hidden=!1,this.focused=!1,this.onclose=pe,this.onfocus=F,this.onblur=ie,this.onmove=W,this.onresize=ht,this.onfullscreen=J,this.onmaximize=Oe,this.onminimize=Te,this.onrestore=mn,this.onhide=Wt,this.onshow=gn,x?this.maximize():z?this.minimize():this.resize().move(),E?this.hide():(this.focus(),(r||r===0)&&(this.index=r,_e(this.dom,"z-index",r),r>ii&&(ii=r))),Kw(this),(i||Je).appendChild(this.dom),oe&&oe.call(this,t)}q.new=function(t){return new q(t)};q.stack=function(){return Be};function de(t,e,n){if(typeof t=="string")if(t==="center")t=(e-n)/2|0;else if(t==="right"||t==="bottom")t=e-n;else{const r=parseFloat(t);(""+r!==t&&t.substring((""+r).length))==="%"?t=e/100*r|0:t=r}return t}function Gw(){Je=document.body,Je[nt="requestFullscreen"]||Je[nt="msRequestFullscreen"]||Je[nt="webkitRequestFullscreen"]||Je[nt="mozRequestFullscreen"]||(nt=""),ph=nt&&nt.replace("request","exit").replace("mozRequest","mozCancel").replace("Request","Exit"),Re(window,"resize",function(){fc(),fa()}),fc()}function Kw(t){tt(t,"drag"),tt(t,"n"),tt(t,"s"),tt(t,"w"),tt(t,"e"),tt(t,"nw"),tt(t,"ne"),tt(t,"se"),tt(t,"sw"),Re($e(t.dom,"wb-min"),"click",function(e){Hn(e),t.min?t.restore().focus():t.minimize()}),Re($e(t.dom,"wb-max"),"click",function(e){t.max?t.restore().focus():t.maximize().focus()}),nt?Re($e(t.dom,"wb-full"),"click",function(e){t.fullscreen()}):t.addClass("no-full"),Re($e(t.dom,"wb-close"),"click",function(e){Hn(e),t.close()||(t=null)}),Re(t.dom,"click",function(e){t.focus()})}function Ai(t){nn.splice(nn.indexOf(t),1),fa(),t.removeClass("min"),t.min=!1,t.dom.title=""}function fa(){const t=nn.length,e={},n={};for(let r=0,i,s;r<t;r++)i=nn[r],s=(i.left||i.right)+":"+(i.top||i.bottom),n[s]?n[s]++:(e[s]=0,n[s]=1);for(let r=0,i,s,o;r<t;r++)i=nn[r],s=(i.left||i.right)+":"+(i.top||i.bottom),o=Math.min((we-i.left-i.right)/n[s],250),i.resize(o+1|0,i.header,!0).move(i.left+e[s]*o|0,Xe-i.bottom-i.header,!0),e[s]++}function tt(t,e){const n=$e(t.dom,"wb-"+e);if(!n)return;let r,i,s,o=0;Re(n,"mousedown",a),Re(n,"touchstart",a,Rn);function a(c){if(Hn(c),t.focus(),e==="drag"){if(t.min){t.restore();return}const d=Date.now(),h=d-o;if(o=d,h<300){t.max?t.restore():t.maximize();return}}t.min||(fh(Je,"wb-lock"),(r=c.touches)&&(r=r[0])?(c=r,Re(window,"touchmove",l,Rn),Re(window,"touchend",u,Rn)):(Re(window,"mousemove",l),Re(window,"mouseup",u)),i=c.pageX,s=c.pageY)}function l(c){Hn(c,!r),r&&(c=c.touches[0]);const d=c.pageX,h=c.pageY,p=d-i,f=h-s,m=t.width,g=t.height,w=t.x,v=t.y;let b,y,_,A;e==="drag"?(t.x+=p,t.y+=f,_=A=1):(e==="e"||e==="se"||e==="ne"?(t.width+=p,b=1):(e==="w"||e==="sw"||e==="nw")&&(t.x+=p,t.width-=p,b=1,_=1),e==="s"||e==="se"||e==="sw"?(t.height+=f,y=1):(e==="n"||e==="ne"||e==="nw")&&(t.y+=f,t.height-=f,y=1,A=1)),b&&(t.width=Math.max(Math.min(t.width,t.maxwidth,we-t.x-t.right),t.minwidth),b=t.width!==m),y&&(t.height=Math.max(Math.min(t.height,t.maxheight,Xe-t.y-t.bottom),t.minheight),y=t.height!==g),(b||y)&&t.resize(),_&&(t.max&&(t.x=(d<we/3?t.left:d>we/3*2?we-t.width-t.right:we/2-t.width/2)+p),t.x=Math.max(Math.min(t.x,t.overflow?we-30:we-t.width-t.right),t.overflow?30-t.width:t.left),_=t.x!==w),A&&(t.max&&(t.y=t.top+f),t.y=Math.max(Math.min(t.y,t.overflow?Xe-t.header:Xe-t.height-t.bottom),t.top),A=t.y!==v),(_||A)&&(t.max&&t.restore(),t.move()),(b||_)&&(i=d),(y||A)&&(s=h)}function u(c){Hn(c),dh(Je,"wb-lock"),r?(Or(window,"touchmove",l,Rn),Or(window,"touchend",u,Rn)):(Or(window,"mousemove",l),Or(window,"mouseup",u))}}function fc(){const t=document.documentElement;we=t.clientWidth,Xe=t.clientHeight}q.prototype.mount=function(t){return this.unmount(),t._backstore||(t._backstore=t.parentNode),this.body.textContent="",this.body.appendChild(t),this};q.prototype.unmount=function(t){const e=this.body.firstChild;if(e){const n=t||e._backstore;n&&n.appendChild(e),e._backstore=t}return this};q.prototype.setTitle=function(t){const e=$e(this.dom,"wb-title");return Vw(e,this.title=t),this};q.prototype.setIcon=function(t){const e=$e(this.dom,"wb-icon");return _e(e,"background-image","url("+t+")"),_e(e,"display","inline-block"),this};q.prototype.setBackground=function(t){return _e(this.dom,"background",t),this};q.prototype.setUrl=function(t,e){const n=this.body.firstChild;return n&&n.tagName.toLowerCase()==="iframe"?n.src=t:(this.body.innerHTML='<iframe src="'+t+'"></iframe>',e&&(this.body.firstChild.onload=e)),this};q.prototype.focus=function(t){if(t===!1)return this.blur();if(!this.focused){const e=Be.length;if(e>1)for(let n=1;n<=e;n++){const r=Be[e-n];if(r.focused){r.blur(),Be.push(Be.splice(Be.indexOf(this),1)[0]);break}}_e(this.dom,"z-index",++ii),this.index=ii,this.addClass("focus"),this.focused=!0,this.onfocus&&this.onfocus()}return this};q.prototype.blur=function(t){return t===!1?this.focus():(this.focused&&(this.removeClass("focus"),this.focused=!1,this.onblur&&this.onblur()),this)};q.prototype.hide=function(t){if(t===!1)return this.show();if(!this.hidden)return this.onhide&&this.onhide(),this.hidden=!0,this.addClass("hide")};q.prototype.show=function(t){if(t===!1)return this.hide();if(this.hidden)return this.onshow&&this.onshow(),this.hidden=!1,this.removeClass("hide")};q.prototype.minimize=function(t){if(t===!1)return this.restore();if(an&&Oi(),this.max&&(this.removeClass("max"),this.max=!1),!this.min){nn.push(this),fa(),this.dom.title=this.title,this.addClass("min"),this.blur(),this.min=!0;const e=Be.length;if(e>1)for(let n=1;n<=e;n++){const r=Be[e-n];if(!r.min){r.focus();break}}this.onminimize&&this.onminimize()}return this};q.prototype.restore=function(){return an&&Oi(),this.min&&(Ai(this),this.resize().move(),this.onrestore&&this.onrestore()),this.max&&(this.max=!1,this.removeClass("max").resize().move(),this.onrestore&&this.onrestore()),this};q.prototype.maximize=function(t){return t===!1?this.restore():(an&&Oi(),this.min&&Ai(this),this.max||(this.addClass("max").resize(we-this.left-this.right,Xe-this.top-this.bottom,!0).move(this.left,this.top,!0),this.max=!0,this.onmaximize&&this.onmaximize()),this)};q.prototype.fullscreen=function(t){if(this.min&&(Ai(this),this.resize().move()),!an||!Oi())this.body[nt](),an=this,this.full=!0,this.onfullscreen&&this.onfullscreen();else if(t===!1)return this.restore();return this};function Yw(){return document.fullscreen||document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement}function Oi(){if(an.full=!1,Yw())return document[ph](),!0}q.prototype.close=function(t){if(this.onclose&&this.onclose(t))return!0;this.min&&Ai(this),Be.splice(Be.indexOf(this),1),this.unmount(),this.dom.remove(),this.dom.textContent="",this.dom.winbox=null,this.body=null,this.dom=null};q.prototype.move=function(t,e,n){return!t&&t!==0?(t=this.x,e=this.y):n||(this.x=t?t=de(t,we-this.left-this.right,this.width):0,this.y=e?e=de(e,Xe-this.top-this.bottom,this.height):0),_e(this.dom,"left",t+"px"),_e(this.dom,"top",e+"px"),this.onmove&&this.onmove(t,e),this};q.prototype.resize=function(t,e,n){return!t&&t!==0?(t=this.width,e=this.height):n||(this.width=t?t=de(t,this.maxwidth):0,this.height=e?e=de(e,this.maxheight):0,t=Math.max(t,this.minwidth),e=Math.max(e,this.minheight)),_e(this.dom,"width",t+"px"),_e(this.dom,"height",e+"px"),this.onresize&&this.onresize(t,e),this};q.prototype.addControl=function(t){const e=t.class,n=t.image,r=t.click,i=t.index,s=document.createElement("span"),o=$e(this.dom,"wb-control"),a=this;return e&&(s.className=e),n&&_e(s,"background-image","url("+n+")"),r&&(s.onclick=function(l){r.call(this,l,a)}),o.insertBefore(s,o.childNodes[i||0]),this};q.prototype.removeControl=function(t){return t=$e(this.dom,t),t&&t.remove(),this};q.prototype.addClass=function(t){return fh(this.dom,t),this};q.prototype.removeClass=function(t){return dh(this.dom,t),this};q.prototype.hasClass=function(t){return qw(this.dom,t)};q.prototype.toggleClass=function(t){return this.hasClass(t)?this.removeClass(t):this.addClass(t)};q.prototype.setUrl=function(t,e){const n=this.body.firstChild;return n&&n.tagName.toLowerCase()==="iframe"?n.src=t:(this.body.innerHTML=`<iframe allowtransparency="${this.allowTransparency?"true":"false"}" style="background:${this.allowTransparency?"transparent":"white"};"  src="${t}"></iframe>`,e&&(this.body.firstChild.onload=e)),this};var mh=(t=>(t.curve="curve",t))(mh||{});class Xw extends mi{constructor(n){super(n);B(this,"factories");B(this,"componentCache");this.factories=new Map,this.componentCache=new Map,this.registerType("OAIComponent31",Ci.fromJSON)}registerType(n,r){if(!n)throw new Error("registerType(): key cannot be undefined");if(!r||typeof r!="function")throw new Error(`Factory ${n} must be a function`);if(this.factories.has(n))throw new Error(`Block type ${n} already registered`);this.factories.set(n,r)}get client(){return this.app}async _rpc(n,r){return await this.client.runScript("blockManager",{command:n,args:r},{fromChatWindow:!1})}async getInstance(n){const r=await this.getInstances([n]);return r?r[0]:void 0}async getInstances(n){if(!n)throw new Error("getInstances(): key cannot be undefined");let r=n.map(s=>this.componentCache.get(s))||[];const i=n.filter(s=>!this.componentCache.has(s));if(i.length>0){const o=await this._rpc("getInstances",[i,void 0,"missing_block"]),a=await Promise.all(o.map(async l=>{const u=this.factories.get(l.type||"OAIComponent31");if(!u)throw new Error(`Internal error, Block type ${l.type} not registered`);const c=u(l);return this.componentCache.set(c.name,c),c}));r.push(...a)}return r=r.filter(s=>s!==void 0),r}}class dk extends cu{constructor(n,r){super(n,r);B(this,"clipboard",{});B(this,"workbench");B(this,"uiSettings",{});B(this,"reteSettings");B(this,"SDK",yv);B(this,"windows");B(this,"sdkHost");B(this,"markdownEngine");B(this,"_blocks");this.markdownEngine=new wv,this.windows=new Map,this.sdkHost=new vv(this).init(),this.workbench=new window.Alpine.reactive(new Im(this));const i=this;this._blocks=new Xw(this),this.reteSettings=new window.Alpine.reactive({curve:window.localStorage.getItem("settings.rete.curve")??"curveBasis",arrow:window.localStorage.getItem("settings.rete.arrow")==="true",curvature:parseFloat(window.localStorage.getItem("settings.rete.curvature")??"0.3")});for(const s in mh){const o=window.localStorage.getItem(`settings.rete.${s}`);o&&(this.reteSettings[s]=o)}this.uiSettings=new window.Alpine.reactive({minimalChat:window.localStorage.getItem("settings.minimalChat")==="true",chatSide:window.localStorage.getItem("settings.chatSide")??"left",tabBarStyle:window.localStorage.getItem("settings.tabBarStyle")??"tabs",chatMinimized:window.localStorage.getItem("settings.chatMinimized")??!1,async toggleMinimal(){this.minimalChat=!this.minimalChat,window.localStorage.setItem("settings.minimalChat",this.minimalChat),await i.emit("request_editor_resize",{})},async toggleSide(){this.chatSide=this.chatSide==="left"?"right":"left",window.localStorage.setItem("settings.chatSide",this.chatSide),await i.emit("request_editor_resize",{})},async toggleMinimized(s){this.chatMinimized=s!==void 0?s:!this.chatMinimized,window.localStorage.setItem("settings.chatMinimized",this.chatMinimized?"true":"false"),await i.emit("request_editor_resize",{})}}),this.extensions=new window.Alpine.reactive(new lu(this))}showToast(n,r={description:"",type:"default",position:"top-right",html:""}){const i=r.description??"",s=r.type??"default",o=r.position??"top-right",a=r.html??"";window.dispatchEvent(new CustomEvent("toast-show",{detail:{type:s,message:n,description:i,position:o,html:a}}))}showTopBanner(n,r,i){const s=i.link??"";window.dispatchEvent(new CustomEvent("top-banner-show",{detail:{bannerTitle:n,bannerDescription:r,link:s}}))}closeWindow(n){const r=this.getWindow(n);return r&&r.close(),!!r}getWindow(n){return n?this.windows.get(n):void 0}toggleWindow(n,r,i){i??(i={}),i.x??(i.x="center"),i.y??(i.y="center"),i.class="test",r&&(this.closeWindow(r),n+=`&omniHash=${r}`);const s=document.createElement("div");s.innerHTML=`
        <div class="wb-header asdf">
            <div class="wb-control">
                <span class="wb-custom"></span>
                <span class="wb-close"></span>
            </div>
            <div class="wb-drag">
                <div class="wb-title">
                </div>
            </div>
        </div>
        <div class="wb-body"></div>
    `;const o=new q(Object.assign({},{url:n,class:[],autosize:!0},i,{onCreate:a=>{a.allowTransparency=i.allowTransparency??!1},onclose:()=>{r&&(this.windows.delete(r),this.sdkHost.deregister(r)),this.workbench.refreshUI()}}));return r&&this.windows.set(r,o),this.workbench.refreshUI(),window}get blocks(){return this._blocks}async onConfigure(){return this.success("onConfigure"),!0}async onLoad(){return this.success("onLoad"),!0}async onStart(){const n=[];return n.push(this.chat.registerRenderer(new Uw)),n.push(this.chat.registerRenderer(new Yu)),n.push(this.chat.registerRenderer(new Fw)),n.push(this.chat.registerRenderer(new Lw)),n.push(this.chat.registerRenderer(new Dw)),n.push(this.chat.registerRenderer(new Bw)),n.push(this.chat.registerRenderer(new Hw)),n.push(this.chat.registerRenderer(new zw)),n.push(this.chat.registerRenderer(new jw)),n.push(this.chat.registerRenderer(new Uv)),await Promise.all(n),this.io.registerMessageHandler({type:"chat",handler:this.chat.onChatMessage.bind(this.chat)}),this.io.registerMessageHandler({type:Fr.CLIENT_TOAST,handler:r=>{this.showToast(r.body.message,r.body.options)}}),this.io.registerMessageHandler({type:"chat:system",handler:this.chat.onChatMessage.bind(this.chat)}),this.io.registerMessageHandler({type:Fr.SHOW_EXTENSION,handler:r=>{this.workbench.showExtension(r.body.extensionId,r.body.args,r.body.page,r.body.opts)}}),this.io.registerMessageHandler({type:Fr.CUSTOM_EXTENSION_EVENT,handler:r=>{const{extensionId:i,eventId:s,eventArgs:o}=r.body;this.sdkHost.signalCustomEvent(i,s,o)}}),this.io.registerMessageHandler({type:"job:status",handler:this.jobs.handleMessages.bind(this.jobs)}),this.io.registerMessageHandler({type:"job:error",handler:this.jobs.handleMessages.bind(this.jobs)}),this.io.registerMessageHandler({type:"job:update",handler:this.jobs.handleMessages.bind(this.jobs)}),this.events.on("chat_message_added",async r=>{const[i]=r;console.log(i),this.sdkHost.signalChatMessageReceived(i)}),await this.io.startSSE(""),await this.workbench.load(),!0}get io(){return this.services.get("messaging")}get jobs(){return this.services.get("jobs")}get chat(){return this.services.get("chat")}addImageToClipboard(n){var r;n&&(Array.isArray(n)||(n=[n]),this.clipboard??(this.clipboard={}),(r=this.clipboard).images??(r.images=[]),this.clipboard.images=this.clipboard.images.concat(n))}}var ao=!1,lo=!1,Lt=[],co=-1;function Zw(t){Qw(t)}function Qw(t){Lt.includes(t)||Lt.push(t),e_()}function gh(t){let e=Lt.indexOf(t);e!==-1&&e>co&&Lt.splice(e,1)}function e_(){!lo&&!ao&&(ao=!0,queueMicrotask(t_))}function t_(){ao=!1,lo=!0;for(let t=0;t<Lt.length;t++)Lt[t](),co=t;Lt.length=0,co=-1,lo=!1}var fn,jt,dn,yh,uo=!0;function n_(t){uo=!1,t(),uo=!0}function r_(t){fn=t.reactive,dn=t.release,jt=e=>t.effect(e,{scheduler:n=>{uo?Zw(n):n()}}),yh=t.raw}function dc(t){jt=t}function i_(t){let e=()=>{};return[r=>{let i=jt(r);return t._x_effects||(t._x_effects=new Set,t._x_runEffects=()=>{t._x_effects.forEach(s=>s())}),t._x_effects.add(i),e=()=>{i!==void 0&&(t._x_effects.delete(i),dn(i))},i},()=>{e()}]}function vh(t,e){let n=!0,r,i=jt(()=>{let s=t();JSON.stringify(s),n?r=s:queueMicrotask(()=>{e(s,r),r=s}),n=!1});return()=>dn(i)}function zn(t,e,n={}){t.dispatchEvent(new CustomEvent(e,{detail:n,bubbles:!0,composed:!0,cancelable:!0}))}function wt(t,e){if(typeof ShadowRoot=="function"&&t instanceof ShadowRoot){Array.from(t.children).forEach(i=>wt(i,e));return}let n=!1;if(e(t,()=>n=!0),n)return;let r=t.firstElementChild;for(;r;)wt(r,e),r=r.nextElementSibling}function lt(t,...e){console.warn(`Alpine Warning: ${t}`,...e)}var pc=!1;function s_(){pc&&lt("Alpine has already been initialized on this page. Calling Alpine.start() more than once can cause problems."),pc=!0,document.body||lt("Unable to initialize. Trying to load Alpine before `<body>` is available. Did you forget to add `defer` in Alpine's `<script>` tag?"),zn(document,"alpine:init"),zn(document,"alpine:initializing"),va(),l_(e=>ct(e,wt)),ma(e=>pa(e)),Oh((e,n)=>{ka(e,n).forEach(r=>r())});let t=e=>!Ti(e.parentElement,!0);Array.from(document.querySelectorAll(bh().join(","))).filter(t).forEach(e=>{ct(e)}),zn(document,"alpine:initialized")}var da=[],wh=[];function _h(){return da.map(t=>t())}function bh(){return da.concat(wh).map(t=>t())}function kh(t){da.push(t)}function xh(t){wh.push(t)}function Ti(t,e=!1){return Ri(t,n=>{if((e?bh():_h()).some(i=>n.matches(i)))return!0})}function Ri(t,e){if(t){if(e(t))return t;if(t._x_teleportBack&&(t=t._x_teleportBack),!!t.parentElement)return Ri(t.parentElement,e)}}function o_(t){return _h().some(e=>t.matches(e))}var Sh=[];function a_(t){Sh.push(t)}function ct(t,e=wt,n=()=>{}){k_(()=>{e(t,(r,i)=>{n(r,i),Sh.forEach(s=>s(r,i)),ka(r,r.attributes).forEach(s=>s()),r._x_ignore&&i()})})}function pa(t){wt(t,e=>{Rh(e),c_(e)})}var Eh=[],Ch=[],Ah=[];function l_(t){Ah.push(t)}function ma(t,e){typeof e=="function"?(t._x_cleanups||(t._x_cleanups=[]),t._x_cleanups.push(e)):(e=t,Ch.push(e))}function Oh(t){Eh.push(t)}function Th(t,e,n){t._x_attributeCleanups||(t._x_attributeCleanups={}),t._x_attributeCleanups[e]||(t._x_attributeCleanups[e]=[]),t._x_attributeCleanups[e].push(n)}function Rh(t,e){t._x_attributeCleanups&&Object.entries(t._x_attributeCleanups).forEach(([n,r])=>{(e===void 0||e.includes(n))&&(r.forEach(i=>i()),delete t._x_attributeCleanups[n])})}function c_(t){if(t._x_cleanups)for(;t._x_cleanups.length;)t._x_cleanups.pop()()}var ga=new MutationObserver(_a),ya=!1;function va(){ga.observe(document,{subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0}),ya=!0}function Ih(){u_(),ga.disconnect(),ya=!1}var In=[];function u_(){let t=ga.takeRecords();In.push(()=>t.length>0&&_a(t));let e=In.length;queueMicrotask(()=>{if(In.length===e)for(;In.length>0;)In.shift()()})}function se(t){if(!ya)return t();Ih();let e=t();return va(),e}var wa=!1,si=[];function h_(){wa=!0}function f_(){wa=!1,_a(si),si=[]}function _a(t){if(wa){si=si.concat(t);return}let e=new Set,n=new Set,r=new Map,i=new Map;for(let s=0;s<t.length;s++)if(!t[s].target._x_ignoreMutationObserver&&(t[s].type==="childList"&&(t[s].addedNodes.forEach(o=>o.nodeType===1&&e.add(o)),t[s].removedNodes.forEach(o=>o.nodeType===1&&n.add(o))),t[s].type==="attributes")){let o=t[s].target,a=t[s].attributeName,l=t[s].oldValue,u=()=>{r.has(o)||r.set(o,[]),r.get(o).push({name:a,value:o.getAttribute(a)})},c=()=>{i.has(o)||i.set(o,[]),i.get(o).push(a)};o.hasAttribute(a)&&l===null?u():o.hasAttribute(a)?(c(),u()):c()}i.forEach((s,o)=>{Rh(o,s)}),r.forEach((s,o)=>{Eh.forEach(a=>a(o,s))});for(let s of n)e.has(s)||(Ch.forEach(o=>o(s)),pa(s));e.forEach(s=>{s._x_ignoreSelf=!0,s._x_ignore=!0});for(let s of e)n.has(s)||s.isConnected&&(delete s._x_ignoreSelf,delete s._x_ignore,Ah.forEach(o=>o(s)),s._x_ignore=!0,s._x_ignoreSelf=!0);e.forEach(s=>{delete s._x_ignoreSelf,delete s._x_ignore}),e=null,n=null,r=null,i=null}function Ph(t){return cr(ln(t))}function lr(t,e,n){return t._x_dataStack=[e,...ln(n||t)],()=>{t._x_dataStack=t._x_dataStack.filter(r=>r!==e)}}function ln(t){return t._x_dataStack?t._x_dataStack:typeof ShadowRoot=="function"&&t instanceof ShadowRoot?ln(t.host):t.parentNode?ln(t.parentNode):[]}function cr(t){return new Proxy({objects:t},d_)}var d_={ownKeys({objects:t}){return Array.from(new Set(t.flatMap(e=>Object.keys(e))))},has({objects:t},e){return e==Symbol.unscopables?!1:t.some(n=>Object.prototype.hasOwnProperty.call(n,e))},get({objects:t},e,n){return e=="toJSON"?p_:Reflect.get(t.find(r=>Object.prototype.hasOwnProperty.call(r,e))||{},e,n)},set({objects:t},e,n,r){const i=t.find(o=>Object.prototype.hasOwnProperty.call(o,e))||t[t.length-1],s=Object.getOwnPropertyDescriptor(i,e);return s!=null&&s.set&&(s!=null&&s.get)?Reflect.set(i,e,n,r):Reflect.set(i,e,n)}};function p_(){return Reflect.ownKeys(this).reduce((e,n)=>(e[n]=Reflect.get(this,n),e),{})}function Nh(t){let e=r=>typeof r=="object"&&!Array.isArray(r)&&r!==null,n=(r,i="")=>{Object.entries(Object.getOwnPropertyDescriptors(r)).forEach(([s,{value:o,enumerable:a}])=>{if(a===!1||o===void 0)return;let l=i===""?s:`${i}.${s}`;typeof o=="object"&&o!==null&&o._x_interceptor?r[s]=o.initialize(t,l,s):e(o)&&o!==r&&!(o instanceof Element)&&n(o,l)})};return n(t)}function Mh(t,e=()=>{}){let n={initialValue:void 0,_x_interceptor:!0,initialize(r,i,s){return t(this.initialValue,()=>m_(r,i),o=>ho(r,i,o),i,s)}};return e(n),r=>{if(typeof r=="object"&&r!==null&&r._x_interceptor){let i=n.initialize.bind(n);n.initialize=(s,o,a)=>{let l=r.initialize(s,o,a);return n.initialValue=l,i(s,o,a)}}else n.initialValue=r;return n}}function m_(t,e){return e.split(".").reduce((n,r)=>n[r],t)}function ho(t,e,n){if(typeof e=="string"&&(e=e.split(".")),e.length===1)t[e[0]]=n;else{if(e.length===0)throw error;return t[e[0]]||(t[e[0]]={}),ho(t[e[0]],e.slice(1),n)}}var Lh={};function We(t,e){Lh[t]=e}function fo(t,e){return Object.entries(Lh).forEach(([n,r])=>{let i=null;function s(){if(i)return i;{let[o,a]=Hh(e);return i={interceptor:Mh,...o},ma(e,a),i}}Object.defineProperty(t,`$${n}`,{get(){return r(e,s())},enumerable:!1})}),t}function g_(t,e,n,...r){try{return n(...r)}catch(i){Yn(i,t,e)}}function Yn(t,e,n=void 0){t=Object.assign(t??{message:"No error message given."},{el:e,expression:n}),console.warn(`Alpine Expression Error: ${t.message}

${n?'Expression: "'+n+`"

`:""}`,e),setTimeout(()=>{throw t},0)}var jr=!0;function Dh(t){let e=jr;jr=!1;let n=t();return jr=e,n}function Dt(t,e,n={}){let r;return me(t,e)(i=>r=i,n),r}function me(...t){return Fh(...t)}var Fh=Bh;function y_(t){Fh=t}function Bh(t,e){let n={};fo(n,t);let r=[n,...ln(t)],i=typeof e=="function"?v_(r,e):__(r,e,t);return g_.bind(null,t,e,i)}function v_(t,e){return(n=()=>{},{scope:r={},params:i=[]}={})=>{let s=e.apply(cr([r,...t]),i);oi(n,s)}}var ms={};function w_(t,e){if(ms[t])return ms[t];let n=Object.getPrototypeOf(async function(){}).constructor,r=/^[\n\s]*if.*\(.*\)/.test(t.trim())||/^(let|const)\s/.test(t.trim())?`(async()=>{ ${t} })()`:t,s=(()=>{try{let o=new n(["__self","scope"],`with (scope) { __self.result = ${r} }; __self.finished = true; return __self.result;`);return Object.defineProperty(o,"name",{value:`[Alpine] ${t}`}),o}catch(o){return Yn(o,e,t),Promise.resolve()}})();return ms[t]=s,s}function __(t,e,n){let r=w_(e,n);return(i=()=>{},{scope:s={},params:o=[]}={})=>{r.result=void 0,r.finished=!1;let a=cr([s,...t]);if(typeof r=="function"){let l=r(r,a).catch(u=>Yn(u,n,e));r.finished?(oi(i,r.result,a,o,n),r.result=void 0):l.then(u=>{oi(i,u,a,o,n)}).catch(u=>Yn(u,n,e)).finally(()=>r.result=void 0)}}}function oi(t,e,n,r,i){if(jr&&typeof e=="function"){let s=e.apply(n,r);s instanceof Promise?s.then(o=>oi(t,o,n,r)).catch(o=>Yn(o,i,e)):t(s)}else typeof e=="object"&&e instanceof Promise?e.then(s=>t(s)):t(e)}var ba="x-";function pn(t=""){return ba+t}function b_(t){ba=t}var po={};function re(t,e){return po[t]=e,{before(n){if(!po[n]){console.warn(String.raw`Cannot find directive \`${n}\`. \`${t}\` will use the default order of execution`);return}const r=Pt.indexOf(n);Pt.splice(r>=0?r:Pt.indexOf("DEFAULT"),0,t)}}}function ka(t,e,n){if(e=Array.from(e),t._x_virtualDirectives){let s=Object.entries(t._x_virtualDirectives).map(([a,l])=>({name:a,value:l})),o=$h(s);s=s.map(a=>o.find(l=>l.name===a.name)?{name:`x-bind:${a.name}`,value:`"${a.value}"`}:a),e=e.concat(s)}let r={};return e.map(Wh((s,o)=>r[s]=o)).filter(Vh).map(S_(r,n)).sort(E_).map(s=>x_(t,s))}function $h(t){return Array.from(t).map(Wh()).filter(e=>!Vh(e))}var mo=!1,Mn=new Map,Uh=Symbol();function k_(t){mo=!0;let e=Symbol();Uh=e,Mn.set(e,[]);let n=()=>{for(;Mn.get(e).length;)Mn.get(e).shift()();Mn.delete(e)},r=()=>{mo=!1,n()};t(n),r()}function Hh(t){let e=[],n=a=>e.push(a),[r,i]=i_(t);return e.push(i),[{Alpine:hr,effect:r,cleanup:n,evaluateLater:me.bind(me,t),evaluate:Dt.bind(Dt,t)},()=>e.forEach(a=>a())]}function x_(t,e){let n=()=>{},r=po[e.type]||n,[i,s]=Hh(t);Th(t,e.original,s);let o=()=>{t._x_ignore||t._x_ignoreSelf||(r.inline&&r.inline(t,e,i),r=r.bind(r,t,e,i),mo?Mn.get(Uh).push(r):r())};return o.runCleanups=s,o}var zh=(t,e)=>({name:n,value:r})=>(n.startsWith(t)&&(n=n.replace(t,e)),{name:n,value:r}),jh=t=>t;function Wh(t=()=>{}){return({name:e,value:n})=>{let{name:r,value:i}=qh.reduce((s,o)=>o(s),{name:e,value:n});return r!==e&&t(r,e),{name:r,value:i}}}var qh=[];function xa(t){qh.push(t)}function Vh({name:t}){return Jh().test(t)}var Jh=()=>new RegExp(`^${ba}([^:^.]+)\\b`);function S_(t,e){return({name:n,value:r})=>{let i=n.match(Jh()),s=n.match(/:([a-zA-Z0-9\-_:]+)/),o=n.match(/\.[^.\]]+(?=[^\]]*$)/g)||[],a=e||t[n]||n;return{type:i?i[1]:null,value:s?s[1]:null,modifiers:o.map(l=>l.replace(".","")),expression:r,original:a}}}var go="DEFAULT",Pt=["ignore","ref","data","id","anchor","bind","init","for","model","modelable","transition","show","if",go,"teleport"];function E_(t,e){let n=Pt.indexOf(t.type)===-1?go:t.type,r=Pt.indexOf(e.type)===-1?go:e.type;return Pt.indexOf(n)-Pt.indexOf(r)}var yo=[],Sa=!1;function Ea(t=()=>{}){return queueMicrotask(()=>{Sa||setTimeout(()=>{vo()})}),new Promise(e=>{yo.push(()=>{t(),e()})})}function vo(){for(Sa=!1;yo.length;)yo.shift()()}function C_(){Sa=!0}function Ca(t,e){return Array.isArray(e)?mc(t,e.join(" ")):typeof e=="object"&&e!==null?A_(t,e):typeof e=="function"?Ca(t,e()):mc(t,e)}function mc(t,e){let n=i=>i.split(" ").filter(s=>!t.classList.contains(s)).filter(Boolean),r=i=>(t.classList.add(...i),()=>{t.classList.remove(...i)});return e=e===!0?e="":e||"",r(n(e))}function A_(t,e){let n=a=>a.split(" ").filter(Boolean),r=Object.entries(e).flatMap(([a,l])=>l?n(a):!1).filter(Boolean),i=Object.entries(e).flatMap(([a,l])=>l?!1:n(a)).filter(Boolean),s=[],o=[];return i.forEach(a=>{t.classList.contains(a)&&(t.classList.remove(a),o.push(a))}),r.forEach(a=>{t.classList.contains(a)||(t.classList.add(a),s.push(a))}),()=>{o.forEach(a=>t.classList.add(a)),s.forEach(a=>t.classList.remove(a))}}function Ii(t,e){return typeof e=="object"&&e!==null?O_(t,e):T_(t,e)}function O_(t,e){let n={};return Object.entries(e).forEach(([r,i])=>{n[r]=t.style[r],r.startsWith("--")||(r=R_(r)),t.style.setProperty(r,i)}),setTimeout(()=>{t.style.length===0&&t.removeAttribute("style")}),()=>{Ii(t,n)}}function T_(t,e){let n=t.getAttribute("style",e);return t.setAttribute("style",e),()=>{t.setAttribute("style",n||"")}}function R_(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function wo(t,e=()=>{}){let n=!1;return function(){n?e.apply(this,arguments):(n=!0,t.apply(this,arguments))}}re("transition",(t,{value:e,modifiers:n,expression:r},{evaluate:i})=>{typeof r=="function"&&(r=i(r)),r!==!1&&(!r||typeof r=="boolean"?P_(t,n,e):I_(t,r,e))});function I_(t,e,n){Gh(t,Ca,""),{enter:i=>{t._x_transition.enter.during=i},"enter-start":i=>{t._x_transition.enter.start=i},"enter-end":i=>{t._x_transition.enter.end=i},leave:i=>{t._x_transition.leave.during=i},"leave-start":i=>{t._x_transition.leave.start=i},"leave-end":i=>{t._x_transition.leave.end=i}}[n](e)}function P_(t,e,n){Gh(t,Ii);let r=!e.includes("in")&&!e.includes("out")&&!n,i=r||e.includes("in")||["enter"].includes(n),s=r||e.includes("out")||["leave"].includes(n);e.includes("in")&&!r&&(e=e.filter((w,v)=>v<e.indexOf("out"))),e.includes("out")&&!r&&(e=e.filter((w,v)=>v>e.indexOf("out")));let o=!e.includes("opacity")&&!e.includes("scale"),a=o||e.includes("opacity"),l=o||e.includes("scale"),u=a?0:1,c=l?Pn(e,"scale",95)/100:1,d=Pn(e,"delay",0)/1e3,h=Pn(e,"origin","center"),p="opacity, transform",f=Pn(e,"duration",150)/1e3,m=Pn(e,"duration",75)/1e3,g="cubic-bezier(0.4, 0.0, 0.2, 1)";i&&(t._x_transition.enter.during={transformOrigin:h,transitionDelay:`${d}s`,transitionProperty:p,transitionDuration:`${f}s`,transitionTimingFunction:g},t._x_transition.enter.start={opacity:u,transform:`scale(${c})`},t._x_transition.enter.end={opacity:1,transform:"scale(1)"}),s&&(t._x_transition.leave.during={transformOrigin:h,transitionDelay:`${d}s`,transitionProperty:p,transitionDuration:`${m}s`,transitionTimingFunction:g},t._x_transition.leave.start={opacity:1,transform:"scale(1)"},t._x_transition.leave.end={opacity:u,transform:`scale(${c})`})}function Gh(t,e,n={}){t._x_transition||(t._x_transition={enter:{during:n,start:n,end:n},leave:{during:n,start:n,end:n},in(r=()=>{},i=()=>{}){_o(t,e,{during:this.enter.during,start:this.enter.start,end:this.enter.end},r,i)},out(r=()=>{},i=()=>{}){_o(t,e,{during:this.leave.during,start:this.leave.start,end:this.leave.end},r,i)}})}window.Element.prototype._x_toggleAndCascadeWithTransitions=function(t,e,n,r){const i=document.visibilityState==="visible"?requestAnimationFrame:setTimeout;let s=()=>i(n);if(e){t._x_transition&&(t._x_transition.enter||t._x_transition.leave)?t._x_transition.enter&&(Object.entries(t._x_transition.enter.during).length||Object.entries(t._x_transition.enter.start).length||Object.entries(t._x_transition.enter.end).length)?t._x_transition.in(n):s():t._x_transition?t._x_transition.in(n):s();return}t._x_hidePromise=t._x_transition?new Promise((o,a)=>{t._x_transition.out(()=>{},()=>o(r)),t._x_transitioning&&t._x_transitioning.beforeCancel(()=>a({isFromCancelledTransition:!0}))}):Promise.resolve(r),queueMicrotask(()=>{let o=Kh(t);o?(o._x_hideChildren||(o._x_hideChildren=[]),o._x_hideChildren.push(t)):i(()=>{let a=l=>{let u=Promise.all([l._x_hidePromise,...(l._x_hideChildren||[]).map(a)]).then(([c])=>c());return delete l._x_hidePromise,delete l._x_hideChildren,u};a(t).catch(l=>{if(!l.isFromCancelledTransition)throw l})})})};function Kh(t){let e=t.parentNode;if(e)return e._x_hidePromise?e:Kh(e)}function _o(t,e,{during:n,start:r,end:i}={},s=()=>{},o=()=>{}){if(t._x_transitioning&&t._x_transitioning.cancel(),Object.keys(n).length===0&&Object.keys(r).length===0&&Object.keys(i).length===0){s(),o();return}let a,l,u;N_(t,{start(){a=e(t,r)},during(){l=e(t,n)},before:s,end(){a(),u=e(t,i)},after:o,cleanup(){l(),u()}})}function N_(t,e){let n,r,i,s=wo(()=>{se(()=>{n=!0,r||e.before(),i||(e.end(),vo()),e.after(),t.isConnected&&e.cleanup(),delete t._x_transitioning})});t._x_transitioning={beforeCancels:[],beforeCancel(o){this.beforeCancels.push(o)},cancel:wo(function(){for(;this.beforeCancels.length;)this.beforeCancels.shift()();s()}),finish:s},se(()=>{e.start(),e.during()}),C_(),requestAnimationFrame(()=>{if(n)return;let o=Number(getComputedStyle(t).transitionDuration.replace(/,.*/,"").replace("s",""))*1e3,a=Number(getComputedStyle(t).transitionDelay.replace(/,.*/,"").replace("s",""))*1e3;o===0&&(o=Number(getComputedStyle(t).animationDuration.replace("s",""))*1e3),se(()=>{e.before()}),r=!0,requestAnimationFrame(()=>{n||(se(()=>{e.end()}),vo(),setTimeout(t._x_transitioning.finish,o+a),i=!0)})})}function Pn(t,e,n){if(t.indexOf(e)===-1)return n;const r=t[t.indexOf(e)+1];if(!r||e==="scale"&&isNaN(r))return n;if(e==="duration"||e==="delay"){let i=r.match(/([0-9]+)ms/);if(i)return i[1]}return e==="origin"&&["top","right","left","center","bottom"].includes(t[t.indexOf(e)+2])?[r,t[t.indexOf(e)+2]].join(" "):r}var _t=!1;function ur(t,e=()=>{}){return(...n)=>_t?e(...n):t(...n)}function M_(t){return(...e)=>_t&&t(...e)}var Yh=[];function Pi(t){Yh.push(t)}function L_(t,e){Yh.forEach(n=>n(t,e)),_t=!0,Xh(()=>{ct(e,(n,r)=>{r(n,()=>{})})}),_t=!1}var bo=!1;function D_(t,e){e._x_dataStack||(e._x_dataStack=t._x_dataStack),_t=!0,bo=!0,Xh(()=>{F_(e)}),_t=!1,bo=!1}function F_(t){let e=!1;ct(t,(r,i)=>{wt(r,(s,o)=>{if(e&&o_(s))return o();e=!0,i(s,o)})})}function Xh(t){let e=jt;dc((n,r)=>{let i=e(n);return dn(i),()=>{}}),t(),dc(e)}function Zh(t,e,n,r=[]){switch(t._x_bindings||(t._x_bindings=fn({})),t._x_bindings[e]=n,e=r.includes("camel")?q_(e):e,e){case"value":B_(t,n);break;case"style":U_(t,n);break;case"class":$_(t,n);break;case"selected":case"checked":H_(t,e,n);break;default:Qh(t,e,n);break}}function B_(t,e){if(t.type==="radio")t.attributes.value===void 0&&(t.value=e),window.fromModel&&(typeof e=="boolean"?t.checked=Wr(t.value)===e:t.checked=gc(t.value,e));else if(t.type==="checkbox")Number.isInteger(e)?t.value=e:!Array.isArray(e)&&typeof e!="boolean"&&![null,void 0].includes(e)?t.value=String(e):Array.isArray(e)?t.checked=e.some(n=>gc(n,t.value)):t.checked=!!e;else if(t.tagName==="SELECT")W_(t,e);else{if(t.value===e)return;t.value=e===void 0?"":e}}function $_(t,e){t._x_undoAddedClasses&&t._x_undoAddedClasses(),t._x_undoAddedClasses=Ca(t,e)}function U_(t,e){t._x_undoAddedStyles&&t._x_undoAddedStyles(),t._x_undoAddedStyles=Ii(t,e)}function H_(t,e,n){Qh(t,e,n),j_(t,e,n)}function Qh(t,e,n){[null,void 0,!1].includes(n)&&V_(e)?t.removeAttribute(e):(ef(e)&&(n=e),z_(t,e,n))}function z_(t,e,n){t.getAttribute(e)!=n&&t.setAttribute(e,n)}function j_(t,e,n){t[e]!==n&&(t[e]=n)}function W_(t,e){const n=[].concat(e).map(r=>r+"");Array.from(t.options).forEach(r=>{r.selected=n.includes(r.value)})}function q_(t){return t.toLowerCase().replace(/-(\w)/g,(e,n)=>n.toUpperCase())}function gc(t,e){return t==e}function Wr(t){return[1,"1","true","on","yes",!0].includes(t)?!0:[0,"0","false","off","no",!1].includes(t)?!1:t?!!t:null}function ef(t){return["disabled","checked","required","readonly","hidden","open","selected","autofocus","itemscope","multiple","novalidate","allowfullscreen","allowpaymentrequest","formnovalidate","autoplay","controls","loop","muted","playsinline","default","ismap","reversed","async","defer","nomodule"].includes(t)}function V_(t){return!["aria-pressed","aria-checked","aria-expanded","aria-selected"].includes(t)}function J_(t,e,n){return t._x_bindings&&t._x_bindings[e]!==void 0?t._x_bindings[e]:tf(t,e,n)}function G_(t,e,n,r=!0){if(t._x_bindings&&t._x_bindings[e]!==void 0)return t._x_bindings[e];if(t._x_inlineBindings&&t._x_inlineBindings[e]!==void 0){let i=t._x_inlineBindings[e];return i.extract=r,Dh(()=>Dt(t,i.expression))}return tf(t,e,n)}function tf(t,e,n){let r=t.getAttribute(e);return r===null?typeof n=="function"?n():n:r===""?!0:ef(e)?!![e,"true"].includes(r):r}function nf(t,e){var n;return function(){var r=this,i=arguments,s=function(){n=null,t.apply(r,i)};clearTimeout(n),n=setTimeout(s,e)}}function rf(t,e){let n;return function(){let r=this,i=arguments;n||(t.apply(r,i),n=!0,setTimeout(()=>n=!1,e))}}function sf({get:t,set:e},{get:n,set:r}){let i=!0,s,o=jt(()=>{let a=t(),l=n();if(i)r(gs(a)),i=!1;else{let u=JSON.stringify(a),c=JSON.stringify(l);u!==s?r(gs(a)):u!==c&&e(gs(l))}s=JSON.stringify(t()),JSON.stringify(n())});return()=>{dn(o)}}function gs(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function K_(t){(Array.isArray(t)?t:[t]).forEach(n=>n(hr))}var Tt={},yc=!1;function Y_(t,e){if(yc||(Tt=fn(Tt),yc=!0),e===void 0)return Tt[t];Tt[t]=e,typeof e=="object"&&e!==null&&e.hasOwnProperty("init")&&typeof e.init=="function"&&Tt[t].init(),Nh(Tt[t])}function X_(){return Tt}var of={};function Z_(t,e){let n=typeof e!="function"?()=>e:e;return t instanceof Element?af(t,n()):(of[t]=n,()=>{})}function Q_(t){return Object.entries(of).forEach(([e,n])=>{Object.defineProperty(t,e,{get(){return(...r)=>n(...r)}})}),t}function af(t,e,n){let r=[];for(;r.length;)r.pop()();let i=Object.entries(e).map(([o,a])=>({name:o,value:a})),s=$h(i);return i=i.map(o=>s.find(a=>a.name===o.name)?{name:`x-bind:${o.name}`,value:`"${o.value}"`}:o),ka(t,i,n).map(o=>{r.push(o.runCleanups),o()}),()=>{for(;r.length;)r.pop()()}}var lf={};function eb(t,e){lf[t]=e}function tb(t,e){return Object.entries(lf).forEach(([n,r])=>{Object.defineProperty(t,n,{get(){return(...i)=>r.bind(e)(...i)},enumerable:!1})}),t}var nb={get reactive(){return fn},get release(){return dn},get effect(){return jt},get raw(){return yh},version:"3.13.5",flushAndStopDeferringMutations:f_,dontAutoEvaluateFunctions:Dh,disableEffectScheduling:n_,startObservingMutations:va,stopObservingMutations:Ih,setReactivityEngine:r_,onAttributeRemoved:Th,onAttributesAdded:Oh,closestDataStack:ln,skipDuringClone:ur,onlyDuringClone:M_,addRootSelector:kh,addInitSelector:xh,interceptClone:Pi,addScopeToNode:lr,deferMutations:h_,mapAttributes:xa,evaluateLater:me,interceptInit:a_,setEvaluator:y_,mergeProxies:cr,extractProp:G_,findClosest:Ri,onElRemoved:ma,closestRoot:Ti,destroyTree:pa,interceptor:Mh,transition:_o,setStyles:Ii,mutateDom:se,directive:re,entangle:sf,throttle:rf,debounce:nf,evaluate:Dt,initTree:ct,nextTick:Ea,prefixed:pn,prefix:b_,plugin:K_,magic:We,store:Y_,start:s_,clone:D_,cloneNode:L_,bound:J_,$data:Ph,watch:vh,walk:wt,data:eb,bind:Z_},hr=nb;function rb(t,e){const n=Object.create(null),r=t.split(",");for(let i=0;i<r.length;i++)n[r[i]]=!0;return e?i=>!!n[i.toLowerCase()]:i=>!!n[i]}var ib=Object.freeze({}),sb=Object.prototype.hasOwnProperty,Ni=(t,e)=>sb.call(t,e),Ft=Array.isArray,jn=t=>cf(t)==="[object Map]",ob=t=>typeof t=="string",Aa=t=>typeof t=="symbol",Mi=t=>t!==null&&typeof t=="object",ab=Object.prototype.toString,cf=t=>ab.call(t),uf=t=>cf(t).slice(8,-1),Oa=t=>ob(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,lb=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},cb=lb(t=>t.charAt(0).toUpperCase()+t.slice(1)),hf=(t,e)=>t!==e&&(t===t||e===e),ko=new WeakMap,Nn=[],Ve,Bt=Symbol("iterate"),xo=Symbol("Map key iterate");function ub(t){return t&&t._isEffect===!0}function hb(t,e=ib){ub(t)&&(t=t.raw);const n=pb(t,e);return e.lazy||n(),n}function fb(t){t.active&&(ff(t),t.options.onStop&&t.options.onStop(),t.active=!1)}var db=0;function pb(t,e){const n=function(){if(!n.active)return t();if(!Nn.includes(n)){ff(n);try{return gb(),Nn.push(n),Ve=n,t()}finally{Nn.pop(),df(),Ve=Nn[Nn.length-1]}}};return n.id=db++,n.allowRecurse=!!e.allowRecurse,n._isEffect=!0,n.active=!0,n.raw=t,n.deps=[],n.options=e,n}function ff(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}var cn=!0,Ta=[];function mb(){Ta.push(cn),cn=!1}function gb(){Ta.push(cn),cn=!0}function df(){const t=Ta.pop();cn=t===void 0?!0:t}function ze(t,e,n){if(!cn||Ve===void 0)return;let r=ko.get(t);r||ko.set(t,r=new Map);let i=r.get(n);i||r.set(n,i=new Set),i.has(Ve)||(i.add(Ve),Ve.deps.push(i),Ve.options.onTrack&&Ve.options.onTrack({effect:Ve,target:t,type:e,key:n}))}function bt(t,e,n,r,i,s){const o=ko.get(t);if(!o)return;const a=new Set,l=c=>{c&&c.forEach(d=>{(d!==Ve||d.allowRecurse)&&a.add(d)})};if(e==="clear")o.forEach(l);else if(n==="length"&&Ft(t))o.forEach((c,d)=>{(d==="length"||d>=r)&&l(c)});else switch(n!==void 0&&l(o.get(n)),e){case"add":Ft(t)?Oa(n)&&l(o.get("length")):(l(o.get(Bt)),jn(t)&&l(o.get(xo)));break;case"delete":Ft(t)||(l(o.get(Bt)),jn(t)&&l(o.get(xo)));break;case"set":jn(t)&&l(o.get(Bt));break}const u=c=>{c.options.onTrigger&&c.options.onTrigger({effect:c,target:t,key:n,type:e,newValue:r,oldValue:i,oldTarget:s}),c.options.scheduler?c.options.scheduler(c):c()};a.forEach(u)}var yb=rb("__proto__,__v_isRef,__isVue"),pf=new Set(Object.getOwnPropertyNames(Symbol).map(t=>Symbol[t]).filter(Aa)),vb=mf(),wb=mf(!0),vc=_b();function _b(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const r=ee(this);for(let s=0,o=this.length;s<o;s++)ze(r,"get",s+"");const i=r[e](...n);return i===-1||i===!1?r[e](...n.map(ee)):i}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){mb();const r=ee(this)[e].apply(this,n);return df(),r}}),t}function mf(t=!1,e=!1){return function(r,i,s){if(i==="__v_isReactive")return!t;if(i==="__v_isReadonly")return t;if(i==="__v_raw"&&s===(t?e?Db:wf:e?Lb:vf).get(r))return r;const o=Ft(r);if(!t&&o&&Ni(vc,i))return Reflect.get(vc,i,s);const a=Reflect.get(r,i,s);return(Aa(i)?pf.has(i):yb(i))||(t||ze(r,"get",i),e)?a:So(a)?!o||!Oa(i)?a.value:a:Mi(a)?t?_f(a):Na(a):a}}var bb=kb();function kb(t=!1){return function(n,r,i,s){let o=n[r];if(!t&&(i=ee(i),o=ee(o),!Ft(n)&&So(o)&&!So(i)))return o.value=i,!0;const a=Ft(n)&&Oa(r)?Number(r)<n.length:Ni(n,r),l=Reflect.set(n,r,i,s);return n===ee(s)&&(a?hf(i,o)&&bt(n,"set",r,i,o):bt(n,"add",r,i)),l}}function xb(t,e){const n=Ni(t,e),r=t[e],i=Reflect.deleteProperty(t,e);return i&&n&&bt(t,"delete",e,void 0,r),i}function Sb(t,e){const n=Reflect.has(t,e);return(!Aa(e)||!pf.has(e))&&ze(t,"has",e),n}function Eb(t){return ze(t,"iterate",Ft(t)?"length":Bt),Reflect.ownKeys(t)}var Cb={get:vb,set:bb,deleteProperty:xb,has:Sb,ownKeys:Eb},Ab={get:wb,set(t,e){return console.warn(`Set operation on key "${String(e)}" failed: target is readonly.`,t),!0},deleteProperty(t,e){return console.warn(`Delete operation on key "${String(e)}" failed: target is readonly.`,t),!0}},Ra=t=>Mi(t)?Na(t):t,Ia=t=>Mi(t)?_f(t):t,Pa=t=>t,Li=t=>Reflect.getPrototypeOf(t);function Tr(t,e,n=!1,r=!1){t=t.__v_raw;const i=ee(t),s=ee(e);e!==s&&!n&&ze(i,"get",e),!n&&ze(i,"get",s);const{has:o}=Li(i),a=r?Pa:n?Ia:Ra;if(o.call(i,e))return a(t.get(e));if(o.call(i,s))return a(t.get(s));t!==i&&t.get(e)}function Rr(t,e=!1){const n=this.__v_raw,r=ee(n),i=ee(t);return t!==i&&!e&&ze(r,"has",t),!e&&ze(r,"has",i),t===i?n.has(t):n.has(t)||n.has(i)}function Ir(t,e=!1){return t=t.__v_raw,!e&&ze(ee(t),"iterate",Bt),Reflect.get(t,"size",t)}function wc(t){t=ee(t);const e=ee(this);return Li(e).has.call(e,t)||(e.add(t),bt(e,"add",t,t)),this}function _c(t,e){e=ee(e);const n=ee(this),{has:r,get:i}=Li(n);let s=r.call(n,t);s?yf(n,r,t):(t=ee(t),s=r.call(n,t));const o=i.call(n,t);return n.set(t,e),s?hf(e,o)&&bt(n,"set",t,e,o):bt(n,"add",t,e),this}function bc(t){const e=ee(this),{has:n,get:r}=Li(e);let i=n.call(e,t);i?yf(e,n,t):(t=ee(t),i=n.call(e,t));const s=r?r.call(e,t):void 0,o=e.delete(t);return i&&bt(e,"delete",t,void 0,s),o}function kc(){const t=ee(this),e=t.size!==0,n=jn(t)?new Map(t):new Set(t),r=t.clear();return e&&bt(t,"clear",void 0,void 0,n),r}function Pr(t,e){return function(r,i){const s=this,o=s.__v_raw,a=ee(o),l=e?Pa:t?Ia:Ra;return!t&&ze(a,"iterate",Bt),o.forEach((u,c)=>r.call(i,l(u),l(c),s))}}function Nr(t,e,n){return function(...r){const i=this.__v_raw,s=ee(i),o=jn(s),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,u=i[t](...r),c=n?Pa:e?Ia:Ra;return!e&&ze(s,"iterate",l?xo:Bt),{next(){const{value:d,done:h}=u.next();return h?{value:d,done:h}:{value:a?[c(d[0]),c(d[1])]:c(d),done:h}},[Symbol.iterator](){return this}}}}function pt(t){return function(...e){{const n=e[0]?`on key "${e[0]}" `:"";console.warn(`${cb(t)} operation ${n}failed: target is readonly.`,ee(this))}return t==="delete"?!1:this}}function Ob(){const t={get(s){return Tr(this,s)},get size(){return Ir(this)},has:Rr,add:wc,set:_c,delete:bc,clear:kc,forEach:Pr(!1,!1)},e={get(s){return Tr(this,s,!1,!0)},get size(){return Ir(this)},has:Rr,add:wc,set:_c,delete:bc,clear:kc,forEach:Pr(!1,!0)},n={get(s){return Tr(this,s,!0)},get size(){return Ir(this,!0)},has(s){return Rr.call(this,s,!0)},add:pt("add"),set:pt("set"),delete:pt("delete"),clear:pt("clear"),forEach:Pr(!0,!1)},r={get(s){return Tr(this,s,!0,!0)},get size(){return Ir(this,!0)},has(s){return Rr.call(this,s,!0)},add:pt("add"),set:pt("set"),delete:pt("delete"),clear:pt("clear"),forEach:Pr(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=Nr(s,!1,!1),n[s]=Nr(s,!0,!1),e[s]=Nr(s,!1,!0),r[s]=Nr(s,!0,!0)}),[t,n,e,r]}var[Tb,Rb,Ib,Pb]=Ob();function gf(t,e){const n=e?t?Pb:Ib:t?Rb:Tb;return(r,i,s)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?r:Reflect.get(Ni(n,i)&&i in r?n:r,i,s)}var Nb={get:gf(!1,!1)},Mb={get:gf(!0,!1)};function yf(t,e,n){const r=ee(n);if(r!==n&&e.call(t,r)){const i=uf(t);console.warn(`Reactive ${i} contains both the raw and reactive versions of the same object${i==="Map"?" as keys":""}, which can lead to inconsistencies. Avoid differentiating between the raw and reactive versions of an object and only use the reactive version if possible.`)}}var vf=new WeakMap,Lb=new WeakMap,wf=new WeakMap,Db=new WeakMap;function Fb(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Bb(t){return t.__v_skip||!Object.isExtensible(t)?0:Fb(uf(t))}function Na(t){return t&&t.__v_isReadonly?t:bf(t,!1,Cb,Nb,vf)}function _f(t){return bf(t,!0,Ab,Mb,wf)}function bf(t,e,n,r,i){if(!Mi(t))return console.warn(`value cannot be made reactive: ${String(t)}`),t;if(t.__v_raw&&!(e&&t.__v_isReactive))return t;const s=i.get(t);if(s)return s;const o=Bb(t);if(o===0)return t;const a=new Proxy(t,o===2?r:n);return i.set(t,a),a}function ee(t){return t&&ee(t.__v_raw)||t}function So(t){return!!(t&&t.__v_isRef===!0)}We("nextTick",()=>Ea);We("dispatch",t=>zn.bind(zn,t));We("watch",(t,{evaluateLater:e,cleanup:n})=>(r,i)=>{let s=e(r),a=vh(()=>{let l;return s(u=>l=u),l},i);n(a)});We("store",X_);We("data",t=>Ph(t));We("root",t=>Ti(t));We("refs",t=>(t._x_refs_proxy||(t._x_refs_proxy=cr($b(t))),t._x_refs_proxy));function $b(t){let e=[],n=t;for(;n;)n._x_refs&&e.push(n._x_refs),n=n.parentNode;return e}var ys={};function kf(t){return ys[t]||(ys[t]=0),++ys[t]}function Ub(t,e){return Ri(t,n=>{if(n._x_ids&&n._x_ids[e])return!0})}function Hb(t,e){t._x_ids||(t._x_ids={}),t._x_ids[e]||(t._x_ids[e]=kf(e))}We("id",(t,{cleanup:e})=>(n,r=null)=>{let i=`${n}${r?`-${r}`:""}`;return zb(t,i,e,()=>{let s=Ub(t,n),o=s?s._x_ids[n]:kf(n);return r?`${n}-${o}-${r}`:`${n}-${o}`})});Pi((t,e)=>{t._x_id&&(e._x_id=t._x_id)});function zb(t,e,n,r){if(t._x_id||(t._x_id={}),t._x_id[e])return t._x_id[e];let i=r();return t._x_id[e]=i,n(()=>{delete t._x_id[e]}),i}We("el",t=>t);xf("Focus","focus","focus");xf("Persist","persist","persist");function xf(t,e,n){We(e,r=>lt(`You can't use [$${e}] without first installing the "${t}" plugin here: https://alpinejs.dev/plugins/${n}`,r))}re("modelable",(t,{expression:e},{effect:n,evaluateLater:r,cleanup:i})=>{let s=r(e),o=()=>{let c;return s(d=>c=d),c},a=r(`${e} = __placeholder`),l=c=>a(()=>{},{scope:{__placeholder:c}}),u=o();l(u),queueMicrotask(()=>{if(!t._x_model)return;t._x_removeModelListeners.default();let c=t._x_model.get,d=t._x_model.set,h=sf({get(){return c()},set(p){d(p)}},{get(){return o()},set(p){l(p)}});i(h)})});re("teleport",(t,{modifiers:e,expression:n},{cleanup:r})=>{t.tagName.toLowerCase()!=="template"&&lt("x-teleport can only be used on a <template> tag",t);let i=xc(n),s=t.content.cloneNode(!0).firstElementChild;t._x_teleport=s,s._x_teleportBack=t,t.setAttribute("data-teleport-template",!0),s.setAttribute("data-teleport-target",!0),t._x_forwardEvents&&t._x_forwardEvents.forEach(a=>{s.addEventListener(a,l=>{l.stopPropagation(),t.dispatchEvent(new l.constructor(l.type,l))})}),lr(s,{},t);let o=(a,l,u)=>{u.includes("prepend")?l.parentNode.insertBefore(a,l):u.includes("append")?l.parentNode.insertBefore(a,l.nextSibling):l.appendChild(a)};se(()=>{o(s,i,e),ct(s),s._x_ignore=!0}),t._x_teleportPutBack=()=>{let a=xc(n);se(()=>{o(t._x_teleport,a,e)})},r(()=>s.remove())});var jb=document.createElement("div");function xc(t){let e=ur(()=>document.querySelector(t),()=>jb)();return e||lt(`Cannot find x-teleport element for selector: "${t}"`),e}var Sf=()=>{};Sf.inline=(t,{modifiers:e},{cleanup:n})=>{e.includes("self")?t._x_ignoreSelf=!0:t._x_ignore=!0,n(()=>{e.includes("self")?delete t._x_ignoreSelf:delete t._x_ignore})};re("ignore",Sf);re("effect",ur((t,{expression:e},{effect:n})=>{n(me(t,e))}));function Eo(t,e,n,r){let i=t,s=l=>r(l),o={},a=(l,u)=>c=>u(l,c);if(n.includes("dot")&&(e=Wb(e)),n.includes("camel")&&(e=qb(e)),n.includes("passive")&&(o.passive=!0),n.includes("capture")&&(o.capture=!0),n.includes("window")&&(i=window),n.includes("document")&&(i=document),n.includes("debounce")){let l=n[n.indexOf("debounce")+1]||"invalid-wait",u=ai(l.split("ms")[0])?Number(l.split("ms")[0]):250;s=nf(s,u)}if(n.includes("throttle")){let l=n[n.indexOf("throttle")+1]||"invalid-wait",u=ai(l.split("ms")[0])?Number(l.split("ms")[0]):250;s=rf(s,u)}return n.includes("prevent")&&(s=a(s,(l,u)=>{u.preventDefault(),l(u)})),n.includes("stop")&&(s=a(s,(l,u)=>{u.stopPropagation(),l(u)})),n.includes("self")&&(s=a(s,(l,u)=>{u.target===t&&l(u)})),(n.includes("away")||n.includes("outside"))&&(i=document,s=a(s,(l,u)=>{t.contains(u.target)||u.target.isConnected!==!1&&(t.offsetWidth<1&&t.offsetHeight<1||t._x_isShown!==!1&&l(u))})),n.includes("once")&&(s=a(s,(l,u)=>{l(u),i.removeEventListener(e,s,o)})),s=a(s,(l,u)=>{Jb(e)&&Gb(u,n)||l(u)}),i.addEventListener(e,s,o),()=>{i.removeEventListener(e,s,o)}}function Wb(t){return t.replace(/-/g,".")}function qb(t){return t.toLowerCase().replace(/-(\w)/g,(e,n)=>n.toUpperCase())}function ai(t){return!Array.isArray(t)&&!isNaN(t)}function Vb(t){return[" ","_"].includes(t)?t:t.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[_\s]/,"-").toLowerCase()}function Jb(t){return["keydown","keyup"].includes(t)}function Gb(t,e){let n=e.filter(s=>!["window","document","prevent","stop","once","capture"].includes(s));if(n.includes("debounce")){let s=n.indexOf("debounce");n.splice(s,ai((n[s+1]||"invalid-wait").split("ms")[0])?2:1)}if(n.includes("throttle")){let s=n.indexOf("throttle");n.splice(s,ai((n[s+1]||"invalid-wait").split("ms")[0])?2:1)}if(n.length===0||n.length===1&&Sc(t.key).includes(n[0]))return!1;const i=["ctrl","shift","alt","meta","cmd","super"].filter(s=>n.includes(s));return n=n.filter(s=>!i.includes(s)),!(i.length>0&&i.filter(o=>((o==="cmd"||o==="super")&&(o="meta"),t[`${o}Key`])).length===i.length&&Sc(t.key).includes(n[0]))}function Sc(t){if(!t)return[];t=Vb(t);let e={ctrl:"control",slash:"/",space:" ",spacebar:" ",cmd:"meta",esc:"escape",up:"arrow-up",down:"arrow-down",left:"arrow-left",right:"arrow-right",period:".",equal:"=",minus:"-",underscore:"_"};return e[t]=t,Object.keys(e).map(n=>{if(e[n]===t)return n}).filter(n=>n)}re("model",(t,{modifiers:e,expression:n},{effect:r,cleanup:i})=>{let s=t;e.includes("parent")&&(s=t.parentNode);let o=me(s,n),a;typeof n=="string"?a=me(s,`${n} = __placeholder`):typeof n=="function"&&typeof n()=="string"?a=me(s,`${n()} = __placeholder`):a=()=>{};let l=()=>{let h;return o(p=>h=p),Ec(h)?h.get():h},u=h=>{let p;o(f=>p=f),Ec(p)?p.set(h):a(()=>{},{scope:{__placeholder:h}})};typeof n=="string"&&t.type==="radio"&&se(()=>{t.hasAttribute("name")||t.setAttribute("name",n)});var c=t.tagName.toLowerCase()==="select"||["checkbox","radio"].includes(t.type)||e.includes("lazy")?"change":"input";let d=_t?()=>{}:Eo(t,c,e,h=>{u(Kb(t,e,h,l()))});if(e.includes("fill")&&([void 0,null,""].includes(l())||t.type==="checkbox"&&Array.isArray(l()))&&t.dispatchEvent(new Event(c,{})),t._x_removeModelListeners||(t._x_removeModelListeners={}),t._x_removeModelListeners.default=d,i(()=>t._x_removeModelListeners.default()),t.form){let h=Eo(t.form,"reset",[],p=>{Ea(()=>t._x_model&&t._x_model.set(t.value))});i(()=>h())}t._x_model={get(){return l()},set(h){u(h)}},t._x_forceModelUpdate=h=>{h===void 0&&typeof n=="string"&&n.match(/\./)&&(h=""),window.fromModel=!0,se(()=>Zh(t,"value",h)),delete window.fromModel},r(()=>{let h=l();e.includes("unintrusive")&&document.activeElement.isSameNode(t)||t._x_forceModelUpdate(h)})});function Kb(t,e,n,r){return se(()=>{if(n instanceof CustomEvent&&n.detail!==void 0)return n.detail!==null&&n.detail!==void 0?n.detail:n.target.value;if(t.type==="checkbox")if(Array.isArray(r)){let i=null;return e.includes("number")?i=vs(n.target.value):e.includes("boolean")?i=Wr(n.target.value):i=n.target.value,n.target.checked?r.concat([i]):r.filter(s=>!Yb(s,i))}else return n.target.checked;else return t.tagName.toLowerCase()==="select"&&t.multiple?e.includes("number")?Array.from(n.target.selectedOptions).map(i=>{let s=i.value||i.text;return vs(s)}):e.includes("boolean")?Array.from(n.target.selectedOptions).map(i=>{let s=i.value||i.text;return Wr(s)}):Array.from(n.target.selectedOptions).map(i=>i.value||i.text):e.includes("number")?vs(n.target.value):e.includes("boolean")?Wr(n.target.value):e.includes("trim")?n.target.value.trim():n.target.value})}function vs(t){let e=t?parseFloat(t):null;return Xb(e)?e:t}function Yb(t,e){return t==e}function Xb(t){return!Array.isArray(t)&&!isNaN(t)}function Ec(t){return t!==null&&typeof t=="object"&&typeof t.get=="function"&&typeof t.set=="function"}re("cloak",t=>queueMicrotask(()=>se(()=>t.removeAttribute(pn("cloak")))));xh(()=>`[${pn("init")}]`);re("init",ur((t,{expression:e},{evaluate:n})=>typeof e=="string"?!!e.trim()&&n(e,{},!1):n(e,{},!1)));re("text",(t,{expression:e},{effect:n,evaluateLater:r})=>{let i=r(e);n(()=>{i(s=>{se(()=>{t.textContent=s})})})});re("html",(t,{expression:e},{effect:n,evaluateLater:r})=>{let i=r(e);n(()=>{i(s=>{se(()=>{t.innerHTML=s,t._x_ignoreSelf=!0,ct(t),delete t._x_ignoreSelf})})})});xa(zh(":",jh(pn("bind:"))));var Ef=(t,{value:e,modifiers:n,expression:r,original:i},{effect:s})=>{if(!e){let a={};Q_(a),me(t,r)(u=>{af(t,u,i)},{scope:a});return}if(e==="key")return Zb(t,r);if(t._x_inlineBindings&&t._x_inlineBindings[e]&&t._x_inlineBindings[e].extract)return;let o=me(t,r);s(()=>o(a=>{a===void 0&&typeof r=="string"&&r.match(/\./)&&(a=""),se(()=>Zh(t,e,a,n))}))};Ef.inline=(t,{value:e,modifiers:n,expression:r})=>{e&&(t._x_inlineBindings||(t._x_inlineBindings={}),t._x_inlineBindings[e]={expression:r,extract:!1})};re("bind",Ef);function Zb(t,e){t._x_keyExpression=e}kh(()=>`[${pn("data")}]`);re("data",(t,{expression:e},{cleanup:n})=>{if(Qb(t))return;e=e===""?"{}":e;let r={};fo(r,t);let i={};tb(i,r);let s=Dt(t,e,{scope:i});(s===void 0||s===!0)&&(s={}),fo(s,t);let o=fn(s);Nh(o);let a=lr(t,o);o.init&&Dt(t,o.init),n(()=>{o.destroy&&Dt(t,o.destroy),a()})});Pi((t,e)=>{t._x_dataStack&&(e._x_dataStack=t._x_dataStack,e.setAttribute("data-has-alpine-state",!0))});function Qb(t){return _t?bo?!0:t.hasAttribute("data-has-alpine-state"):!1}re("show",(t,{modifiers:e,expression:n},{effect:r})=>{let i=me(t,n);t._x_doHide||(t._x_doHide=()=>{se(()=>{t.style.setProperty("display","none",e.includes("important")?"important":void 0)})}),t._x_doShow||(t._x_doShow=()=>{se(()=>{t.style.length===1&&t.style.display==="none"?t.removeAttribute("style"):t.style.removeProperty("display")})});let s=()=>{t._x_doHide(),t._x_isShown=!1},o=()=>{t._x_doShow(),t._x_isShown=!0},a=()=>setTimeout(o),l=wo(d=>d?o():s(),d=>{typeof t._x_toggleAndCascadeWithTransitions=="function"?t._x_toggleAndCascadeWithTransitions(t,d,o,s):d?a():s()}),u,c=!0;r(()=>i(d=>{!c&&d===u||(e.includes("immediate")&&(d?a():s()),l(d),u=d,c=!1)}))});re("for",(t,{expression:e},{effect:n,cleanup:r})=>{let i=tk(e),s=me(t,i.items),o=me(t,t._x_keyExpression||"index");t._x_prevKeys=[],t._x_lookup={},n(()=>ek(t,i,s,o)),r(()=>{Object.values(t._x_lookup).forEach(a=>a.remove()),delete t._x_prevKeys,delete t._x_lookup})});function ek(t,e,n,r){let i=o=>typeof o=="object"&&!Array.isArray(o),s=t;n(o=>{nk(o)&&o>=0&&(o=Array.from(Array(o).keys(),g=>g+1)),o===void 0&&(o=[]);let a=t._x_lookup,l=t._x_prevKeys,u=[],c=[];if(i(o))o=Object.entries(o).map(([g,w])=>{let v=Cc(e,w,g,o);r(b=>c.push(b),{scope:{index:g,...v}}),u.push(v)});else for(let g=0;g<o.length;g++){let w=Cc(e,o[g],g,o);r(v=>c.push(v),{scope:{index:g,...w}}),u.push(w)}let d=[],h=[],p=[],f=[];for(let g=0;g<l.length;g++){let w=l[g];c.indexOf(w)===-1&&p.push(w)}l=l.filter(g=>!p.includes(g));let m="template";for(let g=0;g<c.length;g++){let w=c[g],v=l.indexOf(w);if(v===-1)l.splice(g,0,w),d.push([m,g]);else if(v!==g){let b=l.splice(g,1)[0],y=l.splice(v-1,1)[0];l.splice(g,0,y),l.splice(v,0,b),h.push([b,y])}else f.push(w);m=w}for(let g=0;g<p.length;g++){let w=p[g];a[w]._x_effects&&a[w]._x_effects.forEach(gh),a[w].remove(),a[w]=null,delete a[w]}for(let g=0;g<h.length;g++){let[w,v]=h[g],b=a[w],y=a[v],_=document.createElement("div");se(()=>{y||lt('x-for ":key" is undefined or invalid',s),y.after(_),b.after(y),y._x_currentIfEl&&y.after(y._x_currentIfEl),_.before(b),b._x_currentIfEl&&b.after(b._x_currentIfEl),_.remove()}),y._x_refreshXForScope(u[c.indexOf(v)])}for(let g=0;g<d.length;g++){let[w,v]=d[g],b=w==="template"?s:a[w];b._x_currentIfEl&&(b=b._x_currentIfEl);let y=u[v],_=c[v],A=document.importNode(s.content,!0).firstElementChild,S=fn(y);lr(A,S,s),A._x_refreshXForScope=I=>{Object.entries(I).forEach(([z,x])=>{S[z]=x})},se(()=>{b.after(A),ct(A)}),typeof _=="object"&&lt("x-for key cannot be an object, it must be a string or an integer",s),a[_]=A}for(let g=0;g<f.length;g++)a[f[g]]._x_refreshXForScope(u[c.indexOf(f[g])]);s._x_prevKeys=c})}function tk(t){let e=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,n=/^\s*\(|\)\s*$/g,r=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,i=t.match(r);if(!i)return;let s={};s.items=i[2].trim();let o=i[1].replace(n,"").trim(),a=o.match(e);return a?(s.item=o.replace(e,"").trim(),s.index=a[1].trim(),a[2]&&(s.collection=a[2].trim())):s.item=o,s}function Cc(t,e,n,r){let i={};return/^\[.*\]$/.test(t.item)&&Array.isArray(e)?t.item.replace("[","").replace("]","").split(",").map(o=>o.trim()).forEach((o,a)=>{i[o]=e[a]}):/^\{.*\}$/.test(t.item)&&!Array.isArray(e)&&typeof e=="object"?t.item.replace("{","").replace("}","").split(",").map(o=>o.trim()).forEach(o=>{i[o]=e[o]}):i[t.item]=e,t.index&&(i[t.index]=n),t.collection&&(i[t.collection]=r),i}function nk(t){return!Array.isArray(t)&&!isNaN(t)}function Cf(){}Cf.inline=(t,{expression:e},{cleanup:n})=>{let r=Ti(t);r._x_refs||(r._x_refs={}),r._x_refs[e]=t,n(()=>delete r._x_refs[e])};re("ref",Cf);re("if",(t,{expression:e},{effect:n,cleanup:r})=>{t.tagName.toLowerCase()!=="template"&&lt("x-if can only be used on a <template> tag",t);let i=me(t,e),s=()=>{if(t._x_currentIfEl)return t._x_currentIfEl;let a=t.content.cloneNode(!0).firstElementChild;return lr(a,{},t),se(()=>{t.after(a),ct(a)}),t._x_currentIfEl=a,t._x_undoIf=()=>{wt(a,l=>{l._x_effects&&l._x_effects.forEach(gh)}),a.remove(),delete t._x_currentIfEl},a},o=()=>{t._x_undoIf&&(t._x_undoIf(),delete t._x_undoIf)};n(()=>i(a=>{a?s():o()})),r(()=>t._x_undoIf&&t._x_undoIf())});re("id",(t,{expression:e},{evaluate:n})=>{n(e).forEach(i=>Hb(t,i))});Pi((t,e)=>{t._x_ids&&(e._x_ids=t._x_ids)});xa(zh("@",jh(pn("on:"))));re("on",ur((t,{value:e,modifiers:n,expression:r},{cleanup:i})=>{let s=r?me(t,r):()=>{};t.tagName.toLowerCase()==="template"&&(t._x_forwardEvents||(t._x_forwardEvents=[]),t._x_forwardEvents.includes(e)||t._x_forwardEvents.push(e));let o=Eo(t,e,n,a=>{s(()=>{},{scope:{$event:a},params:[a]})});i(()=>o())}));Di("Collapse","collapse","collapse");Di("Intersect","intersect","intersect");Di("Focus","trap","focus");Di("Mask","mask","mask");function Di(t,e,n){re(e,r=>lt(`You can't use [x-${e}] without first installing the "${t}" plugin here: https://alpinejs.dev/plugins/${n}`,r))}hr.setEvaluator(Bh);hr.setReactivityEngine({reactive:Na,effect:hb,release:fb,raw:ee});var rk=hr,pk=rk;const mk=async function(t){const{username:e,password:n}=t,r=window.client.services.get("auth");r.info("Attempt login",e||"[AuthenticatedUser]");let i=null;if(!e&&!n)i=await r.getAuthenticatedUser(),i||(i=await r.tryAutoLogin());else if(i=await r.login(e,n),!i)throw new Error("Login failed! Please check your username and password.");return i?r.success("LoginSuccess",e||i.username):r.warn("LoginFailure",e),i?window.sessionStorage.setItem("uid",i.username):window.sessionStorage.removeItem("uid"),i},gk=function(t){return t!=null&&t!==""&&typeof t=="object"&&Object.keys(t).length>0},yk=function(){return{open:(window.sessionStorage.getItem("uid")??"").length===0,input:{username:"",password:""},newUserRegistration:!1,error:{},async login(){this.error={},this.newUserRegistration?(/^[a-zA-Z0-9]+$/.test(this.input.username)||(this.error.username="Username must be alphanumeric"),this.input.password.length>=8||(this.error.password="Password must be at least 8 characters long")):(this.input.username===""&&(this.error.username="Username is required"),this.input.password===""&&(this.error.password="Password is required")),Object.keys(this.error).length===0?(await this.$dispatch("login",{username:this.input.username,password:this.input.password,newUser:this.newUserRegistration}),console.log("Login event emitted:",this.input.username,this.newUserRegistration)):window.Alpine.store("toasts").createToast("Login Failed! Please try again","login","error")},toggleHeader(){this.newUserRegistration=!this.newUserRegistration}}};export{uk as A,Nt as C,pv as E,eh as I,lk as J,ak as M,xw as N,Mw as O,Io as S,Ol as U,It as W,au as a,Fe as b,am as c,ih as d,sk as e,pk as f,Co as g,Cw as h,Dn as i,fk as j,hk as k,gk as l,j as m,mk as n,Q as o,Un as p,dk as q,ok as r,yk as s};
