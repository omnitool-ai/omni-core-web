var ah=Object.defineProperty;var lh=(n,e,t)=>e in n?ah(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var W=(n,e,t)=>(lh(n,typeof e!="symbol"?e+"":e,t),t),ch=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var Di=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)};var pr=(n,e,t)=>(ch(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var Xw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qs(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var uh={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},hh={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},ph=/(&amp;|&lt;|&gt;|&quot;|&#39;)/g,dh=/[&<>"']/g;function fh(n){return uh[n]}function gh(n){return hh[n]}function ss(n){return n==null?"":String(n).replace(dh,fh)}function os(n){return n==null?"":String(n).replace(ph,gh)}ss.options=os.options={};var ml={encode:ss,escape:ss,decode:os,unescape:os,version:"1.0.0-browser"};function yl(n){for(var e=Array.prototype.slice.call(arguments,1),t,r;e.length;){t=e.shift();for(r in t)t.hasOwnProperty(r)&&(Object.prototype.toString.call(n[r])==="[object Object]"?n[r]=yl(n[r],t[r]):n[r]=t[r])}return n}var mh=yl,wl=function(e){return typeof e=="string"?e.toLowerCase():e};function yh(n){return n.reduce(wh,{})}function wh(n,e){return n[e]=!0,n}var bl=yh,bh=bl,vh=["background","base","cite","href","longdesc","src","usemap"],_h={uris:bh(vh)},kh=bl,xh=["area","br","col","hr","img","wbr","input","base","basefont","link","meta"],vl={voids:kh(xh)},Sh=ml,sa=wl,Eh=vl,Ah=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,Oh=/^<\s*\/\s*([\w:-]+)[^>]*>/,Ch=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,Th=/^</,Rh=/^<\s*\//;function Ih(){var n=[];return n.lastItem=function(){return n[n.length-1]},n}function Ph(n,e){for(var t=Ih(),r=n,i;n;)s();p();function s(){i=!0,o();var d=n===r;r=n,d&&(n="")}function o(){n.substr(0,4)==="<!--"?l():Rh.test(n)?a(Oh,p):Th.test(n)&&a(Ah,u),h()}function a(d,c){var f=n.match(d);f&&(n=n.substring(f[0].length),f[0].replace(d,c),i=!1)}function l(){var d=n.indexOf("-->");d>=0&&(e.comment&&e.comment(n.substring(4,d)),n=n.substring(d+3),i=!1)}function h(){if(i){var d,c=n.indexOf("<");c>=0?(d=n.substring(0,c),n=n.substring(c)):(d=n,n=""),e.chars&&e.chars(d)}}function u(d,c,f,g){var m={},y=sa(c),w=Eh.voids[y]||!!g;f.replace(Ch,_),w||t.push(y),e.start&&e.start(y,m,w);function _(v,b,x,E,N){x===void 0&&E===void 0&&N===void 0?m[b]=void 0:m[b]=Sh.decode(x||E||N||"")}}function p(d,c){var f,g=0,m=sa(c);if(m)for(g=t.length-1;g>=0&&t[g]!==m;g--);if(g>=0){for(f=t.length-1;f>=g;f--)e.end&&e.end(t[f]);t.length=g}}}var Nh=Ph,Lh=ml,ji=wl,Mh=_h,$h=vl;function Dh(n,e){var t,r=e||{};return p(),{start:s,end:o,chars:l};function i(d){n.push(d)}function s(d,c,f){var g=ji(d);if(t.ignoring){h(g);return}if((r.allowedTags||[]).indexOf(g)===-1){h(g);return}if(r.filter&&!r.filter({tag:g,attrs:c})){h(g);return}i("<"),i(g),Object.keys(c).forEach(m),i(f?"/>":">");function m(y){var w=c[y],_=(r.allowedClasses||{})[g]||[],v=(r.allowedAttributes||{})[g]||[],b,x=ji(y);x==="class"&&v.indexOf(x)===-1?(w=w.split(" ").filter(E).join(" ").trim(),b=w.length):b=v.indexOf(x)!==-1&&(Mh.uris[x]!==!0||a(w)),b&&(i(" "),i(y),typeof w=="string"&&(i('="'),i(Lh.encode(w)),i('"')));function E(N){return _&&_.indexOf(N)!==-1}}}function o(d){var c=ji(d),f=(r.allowedTags||[]).indexOf(c)!==-1;f&&t.ignoring===!1?(i("</"),i(c),i(">")):u(c)}function a(d){var c=d[0];if(c==="#"||c==="/")return!0;var f=d.indexOf(":");if(f===-1)return!0;var g=d.indexOf("?");if(g!==-1&&f>g)return!0;var m=d.indexOf("#");if(m!==-1&&f>m)return!0;return r.allowedSchemes.some(y);function y(w){return d.indexOf(w+":")===0}}function l(d){t.ignoring===!1&&i(r.transformText?r.transformText(d):d)}function h(d){$h.voids[d]||(t.ignoring===!1?t={ignoring:d,depth:1}:t.ignoring===d&&t.depth++)}function u(d){t.ignoring===d&&--t.depth<=0&&p()}function p(){t={ignoring:!1,depth:0}}}var jh=Dh,Bh={allowedAttributes:{a:["href","name","target","title","aria-label"],iframe:["allowfullscreen","frameborder","src"],img:["src","alt","title","aria-label"]},allowedClasses:{},allowedSchemes:["http","https","mailto"],allowedTags:["a","abbr","article","b","blockquote","br","caption","code","del","details","div","em","h1","h2","h3","h4","h5","h6","hr","i","img","ins","kbd","li","main","mark","ol","p","pre","section","span","strike","strong","sub","summary","sup","table","tbody","td","th","thead","tr","u","ul"],filter:null},zh=Bh,Fh=mh,Uh=Nh,Hh=jh,_l=zh;function kl(n,e,t){var r=[],i=t===!0?e:Fh({},_l,e),s=Hh(r,i);return Uh(n,s),r.join("")}kl.defaults=_l;var Wh=kl;const dr=qs(Wh),mt=new WeakMap,Rt=new WeakMap,ct=new WeakMap,Br=Symbol("anyProducer"),oa=Promise.resolve(),zr=Symbol("listenerAdded"),Fr=Symbol("listenerRemoved");let Ur=!1,Bi=!1;function nn(n){if(typeof n!="string"&&typeof n!="symbol"&&typeof n!="number")throw new TypeError("`eventName` must be a string, symbol, or number")}function fr(n){if(typeof n!="function")throw new TypeError("listener must be a function")}function rn(n,e){const t=Rt.get(n);if(t.has(e))return t.get(e)}function Dn(n,e){const t=typeof e=="string"||typeof e=="symbol"||typeof e=="number"?e:Br,r=ct.get(n);if(r.has(t))return r.get(t)}function qh(n,e,t){const r=ct.get(n);if(r.has(e))for(const i of r.get(e))i.enqueue(t);if(r.has(Br)){const i=Promise.all([e,t]);for(const s of r.get(Br))s.enqueue(i)}}function aa(n,e){e=Array.isArray(e)?e:[e];let t=!1,r=()=>{},i=[];const s={enqueue(o){i.push(o),r()},finish(){t=!0,r()}};for(const o of e){let a=Dn(n,o);a||(a=new Set,ct.get(n).set(o,a)),a.add(s)}return{async next(){return i?i.length===0?t?(i=void 0,this.next()):(await new Promise(o=>{r=o}),this.next()):{done:!1,value:await i.shift()}:{done:!0}},async return(o){i=void 0;for(const a of e){const l=Dn(n,a);l&&(l.delete(s),l.size===0&&ct.get(n).delete(a))}return r(),arguments.length>0?{done:!0,value:await o}:{done:!0}},[Symbol.asyncIterator](){return this}}}function la(n){if(n===void 0)return ca;if(!Array.isArray(n))throw new TypeError("`methodNames` must be an array of strings");for(const e of n)if(!ca.includes(e))throw typeof e!="string"?new TypeError("`methodNames` element must be a string"):new Error(`${e} is not Emittery method`);return n}const cn=n=>n===zr||n===Fr;function gr(n,e,t){if(cn(e))try{Ur=!0,n.emit(e,t)}finally{Ur=!1}}class Ht{static mixin(e,t){return t=la(t),r=>{if(typeof r!="function")throw new TypeError("`target` must be function");for(const o of t)if(r.prototype[o]!==void 0)throw new Error(`The property \`${o}\` already exists on \`target\``);function i(){return Object.defineProperty(this,e,{enumerable:!1,value:new Ht}),this[e]}Object.defineProperty(r.prototype,e,{enumerable:!1,get:i});const s=o=>function(...a){return this[e][o](...a)};for(const o of t)Object.defineProperty(r.prototype,o,{enumerable:!1,value:s(o)});return r}}static get isDebugEnabled(){var t;if(typeof((t=globalThis.process)==null?void 0:t.env)!="object")return Bi;const{env:e}=globalThis.process??{env:{}};return e.DEBUG==="emittery"||e.DEBUG==="*"||Bi}static set isDebugEnabled(e){Bi=e}constructor(e={}){mt.set(this,new Set),Rt.set(this,new Map),ct.set(this,new Map),ct.get(this).set(Br,new Set),this.debug=e.debug??{},this.debug.enabled===void 0&&(this.debug.enabled=!1),this.debug.logger||(this.debug.logger=(t,r,i,s)=>{try{s=JSON.stringify(s)}catch{s=`Object with the following keys failed to stringify: ${Object.keys(s).join(",")}`}(typeof i=="symbol"||typeof i=="number")&&(i=i.toString());const o=new Date,a=`${o.getHours()}:${o.getMinutes()}:${o.getSeconds()}.${o.getMilliseconds()}`;console.log(`[${a}][emittery:${t}][${r}] Event Name: ${i}
	data: ${s}`)})}logIfDebugEnabled(e,t,r){(Ht.isDebugEnabled||this.debug.enabled)&&this.debug.logger(e,this.debug.name,t,r)}on(e,t){fr(t),e=Array.isArray(e)?e:[e];for(const r of e){nn(r);let i=rn(this,r);i||(i=new Set,Rt.get(this).set(r,i)),i.add(t),this.logIfDebugEnabled("subscribe",r,void 0),cn(r)||gr(this,zr,{eventName:r,listener:t})}return this.off.bind(this,e,t)}off(e,t){fr(t),e=Array.isArray(e)?e:[e];for(const r of e){nn(r);const i=rn(this,r);i&&(i.delete(t),i.size===0&&Rt.get(this).delete(r)),this.logIfDebugEnabled("unsubscribe",r,void 0),cn(r)||gr(this,Fr,{eventName:r,listener:t})}}once(e){let t;const r=new Promise(i=>{t=this.on(e,s=>{t(),i(s)})});return r.off=t,r}events(e){e=Array.isArray(e)?e:[e];for(const t of e)nn(t);return aa(this,e)}async emit(e,t){if(nn(e),cn(e)&&!Ur)throw new TypeError("`eventName` cannot be meta event `listenerAdded` or `listenerRemoved`");this.logIfDebugEnabled("emit",e,t),qh(this,e,t);const r=rn(this,e)??new Set,i=mt.get(this),s=[...r],o=cn(e)?[]:[...i];await oa,await Promise.all([...s.map(async a=>{if(r.has(a))return a(t)}),...o.map(async a=>{if(i.has(a))return a(e,t)})])}async emitSerial(e,t){if(nn(e),cn(e)&&!Ur)throw new TypeError("`eventName` cannot be meta event `listenerAdded` or `listenerRemoved`");this.logIfDebugEnabled("emitSerial",e,t);const r=rn(this,e)??new Set,i=mt.get(this),s=[...r],o=[...i];await oa;for(const a of s)r.has(a)&&await a(t);for(const a of o)i.has(a)&&await a(e,t)}onAny(e){return fr(e),this.logIfDebugEnabled("subscribeAny",void 0,void 0),mt.get(this).add(e),gr(this,zr,{listener:e}),this.offAny.bind(this,e)}anyEvent(){return aa(this)}offAny(e){fr(e),this.logIfDebugEnabled("unsubscribeAny",void 0,void 0),gr(this,Fr,{listener:e}),mt.get(this).delete(e)}clearListeners(e){e=Array.isArray(e)?e:[e];for(const t of e)if(this.logIfDebugEnabled("clear",t,void 0),typeof t=="string"||typeof t=="symbol"||typeof t=="number"){const r=rn(this,t);r&&r.clear();const i=Dn(this,t);if(i){for(const s of i)s.finish();i.clear()}}else{mt.get(this).clear();for(const[r,i]of Rt.get(this).entries())i.clear(),Rt.get(this).delete(r);for(const[r,i]of ct.get(this).entries()){for(const s of i)s.finish();i.clear(),ct.get(this).delete(r)}}}listenerCount(e){var r,i,s;e=Array.isArray(e)?e:[e];let t=0;for(const o of e){if(typeof o=="string"){t+=mt.get(this).size+(((r=rn(this,o))==null?void 0:r.size)??0)+(((i=Dn(this,o))==null?void 0:i.size)??0)+(((s=Dn(this))==null?void 0:s.size)??0);continue}typeof o<"u"&&nn(o),t+=mt.get(this).size;for(const a of Rt.get(this).values())t+=a.size;for(const a of ct.get(this).values())t+=a.size}return t}bindMethods(e,t){if(typeof e!="object"||e===null)throw new TypeError("`target` must be an object");t=la(t);for(const r of t){if(e[r]!==void 0)throw new Error(`The property \`${r}\` already exists on \`target\``);Object.defineProperty(e,r,{enumerable:!1,value:this[r].bind(this)})}}}const ca=Object.getOwnPropertyNames(Ht.prototype).filter(n=>n!=="constructor");Object.defineProperty(Ht,"listenerAdded",{value:zr,writable:!1,enumerable:!0,configurable:!1});Object.defineProperty(Ht,"listenerRemoved",{value:Fr,writable:!1,enumerable:!0,configurable:!1});const Pe={silent:Number.NEGATIVE_INFINITY,fatal:0,error:0,warn:1,log:2,info:3,success:3,fail:3,ready:3,start:3,box:3,debug:4,trace:5,verbose:Number.POSITIVE_INFINITY},ua={silent:{level:-1},fatal:{level:Pe.fatal},error:{level:Pe.error},warn:{level:Pe.warn},log:{level:Pe.log},info:{level:Pe.info},success:{level:Pe.success},fail:{level:Pe.fail},ready:{level:Pe.info},start:{level:Pe.info},box:{level:Pe.info},debug:{level:Pe.debug},trace:{level:Pe.trace},verbose:{level:Pe.verbose}};function zi(n){return n!==null&&typeof n=="object"}function as(n,e,t=".",r){if(!zi(e))return as(n,{},t,r);const i=Object.assign({},e);for(const s in n){if(s==="__proto__"||s==="constructor")continue;const o=n[s];o!=null&&(r&&r(i,s,o,t)||(Array.isArray(o)&&Array.isArray(i[s])?i[s]=[...o,...i[s]]:zi(o)&&zi(i[s])?i[s]=as(o,i[s],(t?`${t}.`:"")+s.toString(),r):i[s]=o))}return i}function Vh(n){return(...e)=>e.reduce((t,r)=>as(t,r,"",n),{})}const Jh=Vh();function Gh(n){return Object.prototype.toString.call(n)==="[object Object]"}function Kh(n){return!(!Gh(n)||!n.message&&!n.args||n.stack)}let Fi=!1;const ha=[];class we{constructor(e={}){const t=e.types||ua;this.options=Jh({...e,defaults:{...e.defaults},level:Ui(e.level,t),reporters:[...e.reporters||[]]},{types:ua,throttle:1e3,throttleMin:5,formatOptions:{date:!0,colors:!1,compact:!0}});for(const r in t){const i={type:r,...this.options.defaults,...t[r]};this[r]=this._wrapLogFn(i),this[r].raw=this._wrapLogFn(i,!0)}this.options.mockFn&&this.mockTypes(),this._lastLog={}}get level(){return this.options.level}set level(e){this.options.level=Ui(e,this.options.types,this.options.level)}prompt(e,t){if(!this.options.prompt)throw new Error("prompt is not supported!");return this.options.prompt(e,t)}create(e){const t=new we({...this.options,...e});return this._mockFn&&t.mockTypes(this._mockFn),t}withDefaults(e){return this.create({...this.options,defaults:{...this.options.defaults,...e}})}withTag(e){return this.withDefaults({tag:this.options.defaults.tag?this.options.defaults.tag+":"+e:e})}addReporter(e){return this.options.reporters.push(e),this}removeReporter(e){if(e){const t=this.options.reporters.indexOf(e);if(t>=0)return this.options.reporters.splice(t,1)}else this.options.reporters.splice(0);return this}setReporters(e){return this.options.reporters=Array.isArray(e)?e:[e],this}wrapAll(){this.wrapConsole(),this.wrapStd()}restoreAll(){this.restoreConsole(),this.restoreStd()}wrapConsole(){for(const e in this.options.types)console["__"+e]||(console["__"+e]=console[e]),console[e]=this[e].raw}restoreConsole(){for(const e in this.options.types)console["__"+e]&&(console[e]=console["__"+e],delete console["__"+e])}wrapStd(){this._wrapStream(this.options.stdout,"log"),this._wrapStream(this.options.stderr,"log")}_wrapStream(e,t){e&&(e.__write||(e.__write=e.write),e.write=r=>{this[t].raw(String(r).trim())})}restoreStd(){this._restoreStream(this.options.stdout),this._restoreStream(this.options.stderr)}_restoreStream(e){e&&e.__write&&(e.write=e.__write,delete e.__write)}pauseLogs(){Fi=!0}resumeLogs(){Fi=!1;const e=ha.splice(0);for(const t of e)t[0]._logFn(t[1],t[2])}mockTypes(e){const t=e||this.options.mockFn;if(this._mockFn=t,typeof t=="function")for(const r in this.options.types)this[r]=t(r,this.options.types[r])||this[r],this[r].raw=this[r]}_wrapLogFn(e,t){return(...r)=>{if(Fi){ha.push([this,e,r,t]);return}return this._logFn(e,r,t)}}_logFn(e,t,r){if((e.level||0)>this.level)return!1;const i={date:new Date,args:[],...e,level:Ui(e.level,this.options.types)};!r&&t.length===1&&Kh(t[0])?Object.assign(i,t[0]):i.args=[...t],i.message&&(i.args.unshift(i.message),delete i.message),i.additional&&(Array.isArray(i.additional)||(i.additional=i.additional.split(`
`)),i.args.push(`
`+i.additional.join(`
`)),delete i.additional),i.type=typeof i.type=="string"?i.type.toLowerCase():"log",i.tag=typeof i.tag=="string"?i.tag:"";const s=(a=!1)=>{const l=(this._lastLog.count||0)-this.options.throttleMin;if(this._lastLog.object&&l>0){const h=[...this._lastLog.object.args];l>1&&h.push(`(repeated ${l} times)`),this._log({...this._lastLog.object,args:h}),this._lastLog.count=1}a&&(this._lastLog.object=i,this._log(i))};clearTimeout(this._lastLog.timeout);const o=this._lastLog.time&&i.date?i.date.getTime()-this._lastLog.time.getTime():0;if(this._lastLog.time=i.date,o<this.options.throttle)try{const a=JSON.stringify([i.type,i.tag,i.args]),l=this._lastLog.serialized===a;if(this._lastLog.serialized=a,l&&(this._lastLog.count=(this._lastLog.count||0)+1,this._lastLog.count>this.options.throttleMin)){this._lastLog.timeout=setTimeout(s,this.options.throttle);return}}catch{}s(!0)}_log(e){for(const t of this.options.reporters)t.log(e,{options:this.options})}}function Ui(n,e={},t=3){return n===void 0?t:typeof n=="number"?n:e[n]&&e[n].level!==void 0?e[n].level:t}we.prototype.add=we.prototype.addReporter;we.prototype.remove=we.prototype.removeReporter;we.prototype.clear=we.prototype.removeReporter;we.prototype.withScope=we.prototype.withTag;we.prototype.mock=we.prototype.mockTypes;we.prototype.pause=we.prototype.pauseLogs;we.prototype.resume=we.prototype.resumeLogs;function Yh(n={}){return new we(n)}class Zh{constructor(e){this.options={...e},this.defaultColor="#7f8c8d",this.levelColorMap={0:"#c0392b",1:"#f39c12",3:"#00BCD4"},this.typeColorMap={success:"#2ecc71"}}_getLogFn(e){return e<1?console.__error||console.error:e===1?console.__warn||console.warn:console.__log||console.log}log(e){const t=this._getLogFn(e.level),r=e.type==="log"?"":e.type,i=e.tag||"",o=`
      background: ${this.typeColorMap[e.type]||this.levelColorMap[e.level]||this.defaultColor};
      border-radius: 0.5em;
      color: white;
      font-weight: bold;
      padding: 2px 0.5em;
    `,a=`%c${[i,r].filter(Boolean).join(":")}`;typeof e.args[0]=="string"?t(`${a}%c ${e.args[0]}`,o,"",...e.args.slice(1)):t(a,o,...e.args)}}function Xh(n={}){return Yh({reporters:n.reporters||[new Zh({})],prompt(t,r={}){return r.type==="confirm"?Promise.resolve(confirm(t)):Promise.resolve(prompt(t))},...n})}const me=Xh();var jn=(n=>(n[n.silent=Number.NEGATIVE_INFINITY]="silent",n[n.always=0]="always",n[n.fatal=0]="fatal",n[n.warning=1]="warning",n[n.normal=2]="normal",n[n.info=3]="info",n[n.debug=4]="debug",n[n.trace=5]="trace",n[n.verbose=Number.POSITIVE_INFINITY]="verbose",n))(jn||{});const pa=2,ls=class cs{constructor(){if(this._status_priority=me.create({level:jn.verbose}),this._void=e=>{},this.__log=e=>{me.log(e)},this._log=this._void,cs._instance!==void 0)throw new Error("Log instance duplicate error");me.level=pa,this._customLevel=new Map,cs._instance=this}get level(){return me.level}set level(e){this._status_priority.level=e<0?e:jn.verbose,this._log=e>=3?this.__log:this._void,me.level=e,e<0&&this._customLevel.forEach(t=>{jn.silent})}get warn(){return me.warn}get error(){return me.error}get info(){return me.info}get debug(){return me.debug}get verbose(){return me.verbose}get ready(){return me.ready}get success(){return me.success}get trace(){return me.trace}get log(){return this._log}get assert(){return console.assert}status_start(e){this._status_priority.start(e)}status_success(e){this._status_priority.success(e)}status_fail(e){this._status_priority.fail(e)}access(e){this._status_priority.trace(e)}createWithTag(e){return me.withTag(e)}wrapConsoleLogger(){me.wrapConsole()}restoreConsoleLogger(){me.restoreConsole()}setCustomLevel(e,t){this._customLevel.set(e,t)}getCustomLevel(e){return this._customLevel.get(e)??pa}addConsolaReporter(e){me.addReporter(e),this._status_priority.addReporter(e)}removeConsolaReporter(e){me.removeReporter(e),this._status_priority.removeReporter(e)}};ls._instance=new ls;let Qh=ls;const ce=Qh._instance;function Qw(){globalThis&&(globalThis.omnilog=ce)}class li{constructor(e){this.app=e,this.children=new Map;const t=ce.createWithTag("Services");this.info=t.info,this.success=t.success,this.debug=t.debug,this.verbose=t.verbose,this.warn=t.warn,this.error=t.error}register(e,t,r){throw new Error("Manager register method not implemented")}async load(){var t;for(const[r,i]of this.children)this.verbose(`${r} load`),await((t=i.load)==null?void 0:t.call(i));return!0}async start(){var e;for(const[t,r]of this.children)ce.log(`child ${t} start`),await((e=r.start)==null?void 0:e.call(r));return ce.log("All children started"),!0}async stop(){var e;this.debug("stopping children...");for(const t of Array.from(this.children.values()).reverse())this.verbose(`${t.id} stop`),await((e=t.stop)==null?void 0:e.call(t));return this.success("children stopped"),!0}get(e){return this.children.get(e)}has(e){return this.children.has(e)}}class xl{constructor(e,t,r){this.id=e,this.manager=t,this.app=t.app,this.config=r;const i=ce.createWithTag(e);this.info=i.info,this.success=i.success,this.debug=i.debug,this.verbose=i.verbose,this.warn=i.warn,this.error=i.error,this.trace=i.trace}async emitGlobalEvent(e,t){this.verbose(`[Global.EMIT] ${this.id} emits event '${e}'`),await this.app.events.emit(e,t)}async emit(e,t){this.verbose(`[SERVICE.EMIT] ${this.id} emits event '${e}'`),await this.app.events.emit(`${this.id}.${e}`,t)}subscribeToServiceEvent(e,t,r){const i=e.id??e;i===this.id&&this.error(`[SERVICE.SUB] ${this.id} subscribed to self event '${t}'`),this.app.services.has(i)||this.error(`[SERVICE.SUB] ${this.id} subscribed to non-existent service event '${t}' on ${i}`),this.info(`[SERVICE.SUB Service] ${this.id} subscribed to service event '${t}' on ${i}.`),this.app.events.on(`${i}.${t}`,r)}subscribeToGlobalEvent(e,t){this.debug(`[GLOBAL.SUB] ${this.id} subscribed to GlobalEvent ${e}`),this.app.events.on(e,t)}unsubscribeFromGlobalEvent(e,t){this.verbose(`[GLOBAL.UNSUBSUB] ${this.id} unsubscribed from GlobalEvent ${e}`),this.app.events.off(e,t)}async registerAPI({method:e,url:t,handler:r,insecure:i,authStrategy:s,schema:o,websocket:a}){if(this.debug("registerAPI",e,t),!t)return this.error("registerAPI: url is required"),!1;if(r==null||typeof r!="function")return this.error("registerAPI: handler is required and must be a function",e,t),!1;await this.emitGlobalEvent("registerAPI",{method:e,url:t,handler:r,insecure:i,authStrategy:s,schema:o,websocket:a})}}class da extends li{constructor(e){super(e),Object.defineProperty(this,"integrations",{get:()=>this.children}),this._integrations=[]}register(e,t){this.verbose(`pre-registering ${t.id} integration`),this._integrations.push([e,t])}async load(){var t;for(const[r,i]of this._integrations){this.verbose(`registering integration ${i.id}...`);const s=new r(i.id,this,i);this.children.set(i.id,s),(t=s.create)==null||t.call(s)}this.debug("loading integrations...");const e=await super.load();return this.success("integrations loaded"),e}async start(){return this.debug("starting integrations..."),await super.start(),this.success("integrations started"),!0}}class ep extends li{constructor(e){super(e),Object.defineProperty(this,"services",{get:()=>this.children})}register(e,t,r){var s;this.debug(`registering ${t.id} service`);let i=new e(t.id,this,t);return r&&typeof r=="function"&&(i=r(i)),this.children.set(t.id,i),(s=i.create)==null||s.call(i),i}async load(){return this.debug("loading services..."),await super.load()?(this.success("services loaded"),!0):(this.error("failed to load services"),!1)}async start(){return this.debug("starting services..."),await super.start(),this.success("services started"),!0}}const Sl=-1,ci=0,Hr=1,Wr=2,Vs=3,Js=4,Gs=5,Ks=6,El=7,Al=8,fa=typeof self=="object"?self:globalThis,tp=(n,e)=>{const t=(i,s)=>(n.set(s,i),i),r=i=>{if(n.has(i))return n.get(i);const[s,o]=e[i];switch(s){case ci:case Sl:return t(o,i);case Hr:{const a=t([],i);for(const l of o)a.push(r(l));return a}case Wr:{const a=t({},i);for(const[l,h]of o)a[r(l)]=r(h);return a}case Vs:return t(new Date(o),i);case Js:{const{source:a,flags:l}=o;return t(new RegExp(a,l),i)}case Gs:{const a=t(new Map,i);for(const[l,h]of o)a.set(r(l),r(h));return a}case Ks:{const a=t(new Set,i);for(const l of o)a.add(r(l));return a}case El:{const{name:a,message:l}=o;return t(new fa[a](l),i)}case Al:return t(BigInt(o),i);case"BigInt":return t(Object(BigInt(o)),i)}return t(new fa[s](o),i)};return r},np=n=>tp(new Map,n)(0),sn="",{toString:rp}={},{keys:ip}=Object,On=n=>{const e=typeof n;if(e!=="object"||!n)return[ci,e];const t=rp.call(n).slice(8,-1);switch(t){case"Array":return[Hr,sn];case"Object":return[Wr,sn];case"Date":return[Vs,sn];case"RegExp":return[Js,sn];case"Map":return[Gs,sn];case"Set":return[Ks,sn]}return t.includes("Array")?[Hr,t]:t.includes("Error")?[El,t]:[Wr,t]},mr=([n,e])=>n===ci&&(e==="function"||e==="symbol"),sp=(n,e,t,r)=>{const i=(o,a)=>{const l=r.push(o)-1;return t.set(a,l),l},s=o=>{if(t.has(o))return t.get(o);let[a,l]=On(o);switch(a){case ci:{let u=o;switch(l){case"bigint":a=Al,u=o.toString();break;case"function":case"symbol":if(n)throw new TypeError("unable to serialize "+l);u=null;break;case"undefined":return i([Sl],o)}return i([a,u],o)}case Hr:{if(l)return i([l,[...o]],o);const u=[],p=i([a,u],o);for(const d of o)u.push(s(d));return p}case Wr:{if(l)switch(l){case"BigInt":return i([l,o.toString()],o);case"Boolean":case"Number":case"String":return i([l,o.valueOf()],o)}if(e&&"toJSON"in o)return s(o.toJSON());const u=[],p=i([a,u],o);for(const d of ip(o))(n||!mr(On(o[d])))&&u.push([s(d),s(o[d])]);return p}case Vs:return i([a,o.toISOString()],o);case Js:{const{source:u,flags:p}=o;return i([a,{source:u,flags:p}],o)}case Gs:{const u=[],p=i([a,u],o);for(const[d,c]of o)(n||!(mr(On(d))||mr(On(c))))&&u.push([s(d),s(c)]);return p}case Ks:{const u=[],p=i([a,u],o);for(const d of o)(n||!mr(On(d)))&&u.push(s(d));return p}}const{message:h}=o;return i([a,{name:l,message:h}],o)};return s},op=(n,{json:e,lossy:t}={})=>{const r=[];return sp(!(e||t),!!e,new Map,r)(n),r};/*! (c) Andrea Giammarchi - ISC */const{parse:ap,stringify:lp}=JSON,cp={json:!0,lossy:!0},up=n=>np(ap(n)),hp=n=>lp(op(n,cp));class pp{constructor(e){this.settings=new Map,this.scope=e}bindStorage(e){this.settings=e}add(e){return this.settings.has(e.key)?(ce.debug(`Setting ${e.key} already exists, doing nothing...`),this):(this.settings.set(e.key,e),this)}get(e){return this.settings.get(e)}update(e,t){const r=this.get(e);r&&(r.value=t,this.settings.set(e,r))}reset(e){const t=this.get(e);t&&(t.value=t.defaultValue,this.settings.set(e,t))}resetAll(){if(this.settings)for(const e of this.settings.values())e.value=e.defaultValue,this.settings.set(e.key,e)}getAll(){return Array.from(this.settings.values())}delete(e){this.settings.delete(e)}}var Ol=(n=>(n[n.CREATED=0]="CREATED",n[n.CONFIGURED=1]="CONFIGURED",n[n.LOADED=2]="LOADED",n[n.STARTED=3]="STARTED",n[n.STOPPED=4]="STOPPED",n))(Ol||{});class Cl{constructor(e,t,r){this.state=0,this.id=e,r??(r={integrationsManagerType:da}),this.config=t,this.version=t.version,this.logger=ce,this.services=new ep(this),this.integrations=new(r.integrationsManagerType||da)(this);const i=this.logger.createWithTag(e);this.settings=new pp,this.info=i.info,this.success=i.success,this.debug=i.debug,this.error=i.error,this.verbose=i.verbose,this.warn=i.warn,this.events=new Ht(ce.getCustomLevel("emittery")>jn.silent?{debug:{name:"app.events",enabled:!0}}:void 0)}use(e,t,r,i){if(this.verbose("[APP.USE] use",e.name),r==="service"||e.name.endsWith("Service")){const s=e;this.services.register(s,t,i)}else if(r==="integration"||e.name.endsWith("Integration")){const s=e;this.integrations.register(s,t)}else this.warn(`[APP.USE] Unknown middleware type ${e.name}`);return this}async emit(e,t){this.debug("[APP.EMIT Global] emit",e),await this.events.emit(e,t)}async load(){if(this.state>=2)return ce.warn("Cannot load more than once, ignoring call"),!0;const e=this;if(e.onConfigure!=null&&await e.onConfigure(),this.state=1,!await this.services.load())throw new Error("Failed to load services, see console for details");return await this.integrations.load(),e.onLoad!=null&&await e.onLoad(),await this.emit("loaded",{}),this.success("app loaded"),this.state=2,!0}async start(){if(this.state===3)return ce.warn("Cannot start more than once, ignoring call"),!0;const e=this;return await this.services.start(),await this.integrations.start(),e.onStart!=null&&await e.onStart(),this.success("app started"),this.state=3,await this.emit("started",{}),!0}async stop(){return this.info("app stopping"),await this.integrations.stop(),await this.services.stop(),await this.emit("stopped",{}),this.success("app stopped"),this.state=4,!0}subscribeToGlobalEvent(e,t){this.info(`[APP.SUB Global] ${this.id} subscribed to GlobalEvent ${e}`),this.events.on(e,t)}subscribeToServiceEvent(e,t,r){const i=e.id??e;this.services.has(i)||this.warn(`[SERVICE.SUB Service] ${this.id} subscribed to unknown service '${i}'. This can be ok in some cases, but usually indicates a bug.`),this.info(`[SERVICE.SUB App] ${this.id} subscribed to service event '${t}' on ${i}`),this.events.on(`${i}.${t}`,r)}stringify(e){return hp(e)}parse(e){return up(e)}}Cl.STATES=Ol;class Ys extends xl{constructor(e,t,r){super(e,t,r)}}class dp extends xl{constructor(e,t,r){super(e,t,r)}async emit(e,...t){this.verbose(`[Extension.EMIT] ${this.id} emits event '${e}'`),await this.app.emit(`${this.id}.${e}`,t)}get extensionConfig(){return this.config}}class fp extends li{constructor(e){super(e)}}class ui{get blockIds(){var e;return Array.from(new Set(Object.values(((e=this==null?void 0:this.rete)==null?void 0:e.nodes)??{}).map(t=>t.name))).sort()}constructor(e,t){this.id=e??"",this.setMeta(t),this.setRete(null),this.setAPI(null),this.setUI(null)}setMeta(e){var t,r,i,s,o;return e=JSON.parse(JSON.stringify(e??{})),e=e??{name:"New Recipe",description:"No description.",pictureUrl:"omni.png",author:"Anonymous"},this.meta=e,(t=this.meta).updated??(t.updated=Date.now()),(r=this.meta).created??(r.created=Date.now()),(i=this.meta).tags??(i.tags=[]),(s=this.meta).author||(s.author="Anonymous"),(o=this.meta).help||(o.help=""),this.meta.name=dr(this.meta.name,{allowedTags:[],allowedAttributes:{}}),this.meta.description=dr(this.meta.description,{allowedTags:[],allowedAttributes:{}}),this.meta.author=dr(this.meta.author,{allowedTags:[],allowedAttributes:{}}),this.meta.help=dr(this.meta.help,{allowedTags:[],allowedAttributes:{}}),this}setRete(e){return this.rete=e,this}setAPI(e){return this.api=e??{fields:{}},this}setUI(e){return this.ui=e??{},this}get isBlank(){var e;return(((e=this==null?void 0:this.rete)==null?void 0:e.nodes)??[]).length===0}toJSON(){return{id:this.id,meta:this.meta,rete:this.rete,api:this.api,ui:this.ui,blockIds:this.blockIds}}static fromJSON(e){const t=new ui(e.id);return t.setMeta(e.meta),e.rete.nodes=JSON.parse(JSON.stringify(e.rete.nodes).replace(/omni-extension-replicate:/g,"omni-core-replicate:")),e.rete.nodes=JSON.parse(JSON.stringify(e.rete.nodes).replace(/omni-extension-formio:/g,"omni-core-formio:")),t.setRete(e.rete),t.setAPI(e.api),t.setUI(e.ui),t}}const gp=class Tl extends ui{constructor(e,t,r){super(e,r),this._id=`wf:${e}`,this.owner=t.owner,this.org=t.org}toJSON(){return{...super.toJSON(),_id:this._id,_rev:this._rev,owner:this.owner,org:this.org}}static fromJSON(e){var i;let t=((i=e._id)==null?void 0:i.replace("wf:",""))||e.id;e.id&&e.id.length>16&&t.startsWith(e.id)&&(t=e.id);const r=new Tl(t,{owner:e.owner||e.meta.owner,org:e.org});return e.rete=JSON.parse(JSON.stringify(e.rete).replace(/omni-extension-replicate:/g,"omni-core-replicate:")),e.rete=JSON.parse(JSON.stringify(e.rete).replace(/omni-extension-formio:/g,"omni-core-formio:")),r.setMeta(e.meta),r.setRete(e.rete),r.setAPI(e.api),r.setUI(e.ui),e._rev&&(r._rev=e._rev),r}};gp.modelName="Workflow";function Rl(n,e){return function(){return n.apply(e,arguments)}}const{toString:mp}=Object.prototype,{getPrototypeOf:Zs}=Object,hi=(n=>e=>{const t=mp.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),it=n=>(n=n.toLowerCase(),e=>hi(e)===n),pi=n=>e=>typeof e===n,{isArray:wn}=Array,Jn=pi("undefined");function yp(n){return n!==null&&!Jn(n)&&n.constructor!==null&&!Jn(n.constructor)&&ze(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const Il=it("ArrayBuffer");function wp(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&Il(n.buffer),e}const bp=pi("string"),ze=pi("function"),Pl=pi("number"),di=n=>n!==null&&typeof n=="object",vp=n=>n===!0||n===!1,Rr=n=>{if(hi(n)!=="object")return!1;const e=Zs(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},_p=it("Date"),kp=it("File"),xp=it("Blob"),Sp=it("FileList"),Ep=n=>di(n)&&ze(n.pipe),Ap=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||ze(n.append)&&((e=hi(n))==="formdata"||e==="object"&&ze(n.toString)&&n.toString()==="[object FormData]"))},Op=it("URLSearchParams"),Cp=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Qn(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let r,i;if(typeof n!="object"&&(n=[n]),wn(n))for(r=0,i=n.length;r<i;r++)e.call(null,n[r],r,n);else{const s=t?Object.getOwnPropertyNames(n):Object.keys(n),o=s.length;let a;for(r=0;r<o;r++)a=s[r],e.call(null,n[a],a,n)}}function Nl(n,e){e=e.toLowerCase();const t=Object.keys(n);let r=t.length,i;for(;r-- >0;)if(i=t[r],e===i.toLowerCase())return i;return null}const Ll=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),Ml=n=>!Jn(n)&&n!==Ll;function us(){const{caseless:n}=Ml(this)&&this||{},e={},t=(r,i)=>{const s=n&&Nl(e,i)||i;Rr(e[s])&&Rr(r)?e[s]=us(e[s],r):Rr(r)?e[s]=us({},r):wn(r)?e[s]=r.slice():e[s]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Qn(arguments[r],t);return e}const Tp=(n,e,t,{allOwnKeys:r}={})=>(Qn(e,(i,s)=>{t&&ze(i)?n[s]=Rl(i,t):n[s]=i},{allOwnKeys:r}),n),Rp=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),Ip=(n,e,t,r)=>{n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},Pp=(n,e,t,r)=>{let i,s,o;const a={};if(e=e||{},n==null)return e;do{for(i=Object.getOwnPropertyNames(n),s=i.length;s-- >0;)o=i[s],(!r||r(o,n,e))&&!a[o]&&(e[o]=n[o],a[o]=!0);n=t!==!1&&Zs(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},Np=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return r!==-1&&r===t},Lp=n=>{if(!n)return null;if(wn(n))return n;let e=n.length;if(!Pl(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},Mp=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&Zs(Uint8Array)),$p=(n,e)=>{const r=(n&&n[Symbol.iterator]).call(n);let i;for(;(i=r.next())&&!i.done;){const s=i.value;e.call(n,s[0],s[1])}},Dp=(n,e)=>{let t;const r=[];for(;(t=n.exec(e))!==null;)r.push(t);return r},jp=it("HTMLFormElement"),Bp=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,i){return r.toUpperCase()+i}),ga=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),zp=it("RegExp"),$l=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),r={};Qn(t,(i,s)=>{let o;(o=e(i,s,n))!==!1&&(r[s]=o||i)}),Object.defineProperties(n,r)},Fp=n=>{$l(n,(e,t)=>{if(ze(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=n[t];if(ze(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},Up=(n,e)=>{const t={},r=i=>{i.forEach(s=>{t[s]=!0})};return wn(n)?r(n):r(String(n).split(e)),t},Hp=()=>{},Wp=(n,e)=>(n=+n,Number.isFinite(n)?n:e),Hi="abcdefghijklmnopqrstuvwxyz",ma="0123456789",Dl={DIGIT:ma,ALPHA:Hi,ALPHA_DIGIT:Hi+Hi.toUpperCase()+ma},qp=(n=16,e=Dl.ALPHA_DIGIT)=>{let t="";const{length:r}=e;for(;n--;)t+=e[Math.random()*r|0];return t};function Vp(n){return!!(n&&ze(n.append)&&n[Symbol.toStringTag]==="FormData"&&n[Symbol.iterator])}const Jp=n=>{const e=new Array(10),t=(r,i)=>{if(di(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[i]=r;const s=wn(r)?[]:{};return Qn(r,(o,a)=>{const l=t(o,i+1);!Jn(l)&&(s[a]=l)}),e[i]=void 0,s}}return r};return t(n,0)},Gp=it("AsyncFunction"),Kp=n=>n&&(di(n)||ze(n))&&ze(n.then)&&ze(n.catch),C={isArray:wn,isArrayBuffer:Il,isBuffer:yp,isFormData:Ap,isArrayBufferView:wp,isString:bp,isNumber:Pl,isBoolean:vp,isObject:di,isPlainObject:Rr,isUndefined:Jn,isDate:_p,isFile:kp,isBlob:xp,isRegExp:zp,isFunction:ze,isStream:Ep,isURLSearchParams:Op,isTypedArray:Mp,isFileList:Sp,forEach:Qn,merge:us,extend:Tp,trim:Cp,stripBOM:Rp,inherits:Ip,toFlatObject:Pp,kindOf:hi,kindOfTest:it,endsWith:Np,toArray:Lp,forEachEntry:$p,matchAll:Dp,isHTMLForm:jp,hasOwnProperty:ga,hasOwnProp:ga,reduceDescriptors:$l,freezeMethods:Fp,toObjectSet:Up,toCamelCase:Bp,noop:Hp,toFiniteNumber:Wp,findKey:Nl,global:Ll,isContextDefined:Ml,ALPHABET:Dl,generateString:qp,isSpecCompliantForm:Vp,toJSONObject:Jp,isAsyncFn:Gp,isThenable:Kp};function K(n,e,t,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),i&&(this.response=i)}C.inherits(K,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:C.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const jl=K.prototype,Bl={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{Bl[n]={value:n}});Object.defineProperties(K,Bl);Object.defineProperty(jl,"isAxiosError",{value:!0});K.from=(n,e,t,r,i,s)=>{const o=Object.create(jl);return C.toFlatObject(n,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),K.call(o,n.message,e,t,r,i),o.cause=n,o.name=n.name,s&&Object.assign(o,s),o};const Yp=null;function hs(n){return C.isPlainObject(n)||C.isArray(n)}function zl(n){return C.endsWith(n,"[]")?n.slice(0,-2):n}function ya(n,e,t){return n?n.concat(e).map(function(i,s){return i=zl(i),!t&&s?"["+i+"]":i}).join(t?".":""):e}function Zp(n){return C.isArray(n)&&!n.some(hs)}const Xp=C.toFlatObject(C,{},null,function(e){return/^is[A-Z]/.test(e)});function fi(n,e,t){if(!C.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=C.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,m){return!C.isUndefined(m[g])});const r=t.metaTokens,i=t.visitor||u,s=t.dots,o=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&C.isSpecCompliantForm(e);if(!C.isFunction(i))throw new TypeError("visitor must be a function");function h(f){if(f===null)return"";if(C.isDate(f))return f.toISOString();if(!l&&C.isBlob(f))throw new K("Blob is not supported. Use a Buffer instead.");return C.isArrayBuffer(f)||C.isTypedArray(f)?l&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function u(f,g,m){let y=f;if(f&&!m&&typeof f=="object"){if(C.endsWith(g,"{}"))g=r?g:g.slice(0,-2),f=JSON.stringify(f);else if(C.isArray(f)&&Zp(f)||(C.isFileList(f)||C.endsWith(g,"[]"))&&(y=C.toArray(f)))return g=zl(g),y.forEach(function(_,v){!(C.isUndefined(_)||_===null)&&e.append(o===!0?ya([g],v,s):o===null?g:g+"[]",h(_))}),!1}return hs(f)?!0:(e.append(ya(m,g,s),h(f)),!1)}const p=[],d=Object.assign(Xp,{defaultVisitor:u,convertValue:h,isVisitable:hs});function c(f,g){if(!C.isUndefined(f)){if(p.indexOf(f)!==-1)throw Error("Circular reference detected in "+g.join("."));p.push(f),C.forEach(f,function(y,w){(!(C.isUndefined(y)||y===null)&&i.call(e,y,C.isString(w)?w.trim():w,g,d))===!0&&c(y,g?g.concat(w):[w])}),p.pop()}}if(!C.isObject(n))throw new TypeError("data must be an object");return c(n),e}function wa(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function Xs(n,e){this._pairs=[],n&&fi(n,this,e)}const Fl=Xs.prototype;Fl.append=function(e,t){this._pairs.push([e,t])};Fl.toString=function(e){const t=e?function(r){return e.call(this,r,wa)}:wa;return this._pairs.map(function(i){return t(i[0])+"="+t(i[1])},"").join("&")};function Qp(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ul(n,e,t){if(!e)return n;const r=t&&t.encode||Qp,i=t&&t.serialize;let s;if(i?s=i(e,t):s=C.isURLSearchParams(e)?e.toString():new Xs(e,t).toString(r),s){const o=n.indexOf("#");o!==-1&&(n=n.slice(0,o)),n+=(n.indexOf("?")===-1?"?":"&")+s}return n}class ed{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){C.forEach(this.handlers,function(r){r!==null&&e(r)})}}const ba=ed,Hl={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},td=typeof URLSearchParams<"u"?URLSearchParams:Xs,nd=typeof FormData<"u"?FormData:null,rd=typeof Blob<"u"?Blob:null,id=(()=>{let n;return typeof navigator<"u"&&((n=navigator.product)==="ReactNative"||n==="NativeScript"||n==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),sd=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),et={isBrowser:!0,classes:{URLSearchParams:td,FormData:nd,Blob:rd},isStandardBrowserEnv:id,isStandardBrowserWebWorkerEnv:sd,protocols:["http","https","file","blob","url","data"]};function od(n,e){return fi(n,new et.classes.URLSearchParams,Object.assign({visitor:function(t,r,i,s){return et.isNode&&C.isBuffer(t)?(this.append(r,t.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},e))}function ad(n){return C.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function ld(n){const e={},t=Object.keys(n);let r;const i=t.length;let s;for(r=0;r<i;r++)s=t[r],e[s]=n[s];return e}function Wl(n){function e(t,r,i,s){let o=t[s++];const a=Number.isFinite(+o),l=s>=t.length;return o=!o&&C.isArray(i)?i.length:o,l?(C.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!a):((!i[o]||!C.isObject(i[o]))&&(i[o]=[]),e(t,r,i[o],s)&&C.isArray(i[o])&&(i[o]=ld(i[o])),!a)}if(C.isFormData(n)&&C.isFunction(n.entries)){const t={};return C.forEachEntry(n,(r,i)=>{e(ad(r),i,t,0)}),t}return null}function cd(n,e,t){if(C.isString(n))try{return(e||JSON.parse)(n),C.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(n)}const Qs={transitional:Hl,adapter:["xhr","http"],transformRequest:[function(e,t){const r=t.getContentType()||"",i=r.indexOf("application/json")>-1,s=C.isObject(e);if(s&&C.isHTMLForm(e)&&(e=new FormData(e)),C.isFormData(e))return i&&i?JSON.stringify(Wl(e)):e;if(C.isArrayBuffer(e)||C.isBuffer(e)||C.isStream(e)||C.isFile(e)||C.isBlob(e))return e;if(C.isArrayBufferView(e))return e.buffer;if(C.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return od(e,this.formSerializer).toString();if((a=C.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return fi(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||i?(t.setContentType("application/json",!1),cd(e)):e}],transformResponse:[function(e){const t=this.transitional||Qs.transitional,r=t&&t.forcedJSONParsing,i=this.responseType==="json";if(e&&C.isString(e)&&(r&&!this.responseType||i)){const o=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?K.from(a,K.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:et.classes.FormData,Blob:et.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};C.forEach(["delete","get","head","post","put","patch"],n=>{Qs.headers[n]={}});const eo=Qs,ud=C.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),hd=n=>{const e={};let t,r,i;return n&&n.split(`
`).forEach(function(o){i=o.indexOf(":"),t=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!t||e[t]&&ud[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},va=Symbol("internals");function Cn(n){return n&&String(n).trim().toLowerCase()}function Ir(n){return n===!1||n==null?n:C.isArray(n)?n.map(Ir):String(n)}function pd(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(n);)e[r[1]]=r[2];return e}const dd=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function Wi(n,e,t,r,i){if(C.isFunction(r))return r.call(this,e,t);if(i&&(e=t),!!C.isString(e)){if(C.isString(r))return e.indexOf(r)!==-1;if(C.isRegExp(r))return r.test(e)}}function fd(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function gd(n,e){const t=C.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(n,r+t,{value:function(i,s,o){return this[r].call(this,e,i,s,o)},configurable:!0})})}class gi{constructor(e){e&&this.set(e)}set(e,t,r){const i=this;function s(a,l,h){const u=Cn(l);if(!u)throw new Error("header name must be a non-empty string");const p=C.findKey(i,u);(!p||i[p]===void 0||h===!0||h===void 0&&i[p]!==!1)&&(i[p||l]=Ir(a))}const o=(a,l)=>C.forEach(a,(h,u)=>s(h,u,l));return C.isPlainObject(e)||e instanceof this.constructor?o(e,t):C.isString(e)&&(e=e.trim())&&!dd(e)?o(hd(e),t):e!=null&&s(t,e,r),this}get(e,t){if(e=Cn(e),e){const r=C.findKey(this,e);if(r){const i=this[r];if(!t)return i;if(t===!0)return pd(i);if(C.isFunction(t))return t.call(this,i,r);if(C.isRegExp(t))return t.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Cn(e),e){const r=C.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||Wi(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let i=!1;function s(o){if(o=Cn(o),o){const a=C.findKey(r,o);a&&(!t||Wi(r,r[a],a,t))&&(delete r[a],i=!0)}}return C.isArray(e)?e.forEach(s):s(e),i}clear(e){const t=Object.keys(this);let r=t.length,i=!1;for(;r--;){const s=t[r];(!e||Wi(this,this[s],s,e,!0))&&(delete this[s],i=!0)}return i}normalize(e){const t=this,r={};return C.forEach(this,(i,s)=>{const o=C.findKey(r,s);if(o){t[o]=Ir(i),delete t[s];return}const a=e?fd(s):String(s).trim();a!==s&&delete t[s],t[a]=Ir(i),r[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return C.forEach(this,(r,i)=>{r!=null&&r!==!1&&(t[i]=e&&C.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(i=>r.set(i)),r}static accessor(e){const r=(this[va]=this[va]={accessors:{}}).accessors,i=this.prototype;function s(o){const a=Cn(o);r[a]||(gd(i,o),r[a]=!0)}return C.isArray(e)?e.forEach(s):s(e),this}}gi.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);C.reduceDescriptors(gi.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(r){this[t]=r}}});C.freezeMethods(gi);const ht=gi;function qi(n,e){const t=this||eo,r=e||t,i=ht.from(r.headers);let s=r.data;return C.forEach(n,function(a){s=a.call(t,s,i.normalize(),e?e.status:void 0)}),i.normalize(),s}function ql(n){return!!(n&&n.__CANCEL__)}function er(n,e,t){K.call(this,n??"canceled",K.ERR_CANCELED,e,t),this.name="CanceledError"}C.inherits(er,K,{__CANCEL__:!0});function md(n,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?n(t):e(new K("Request failed with status code "+t.status,[K.ERR_BAD_REQUEST,K.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}const yd=et.isStandardBrowserEnv?function(){return{write:function(t,r,i,s,o,a){const l=[];l.push(t+"="+encodeURIComponent(r)),C.isNumber(i)&&l.push("expires="+new Date(i).toGMTString()),C.isString(s)&&l.push("path="+s),C.isString(o)&&l.push("domain="+o),a===!0&&l.push("secure"),document.cookie=l.join("; ")},read:function(t){const r=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function wd(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function bd(n,e){return e?n.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):n}function Vl(n,e){return n&&!wd(e)?bd(n,e):e}const vd=et.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let r;function i(s){let o=s;return e&&(t.setAttribute("href",o),o=t.href),t.setAttribute("href",o),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return r=i(window.location.href),function(o){const a=C.isString(o)?i(o):o;return a.protocol===r.protocol&&a.host===r.host}}():function(){return function(){return!0}}();function _d(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function kd(n,e){n=n||10;const t=new Array(n),r=new Array(n);let i=0,s=0,o;return e=e!==void 0?e:1e3,function(l){const h=Date.now(),u=r[s];o||(o=h),t[i]=l,r[i]=h;let p=s,d=0;for(;p!==i;)d+=t[p++],p=p%n;if(i=(i+1)%n,i===s&&(s=(s+1)%n),h-o<e)return;const c=u&&h-u;return c?Math.round(d*1e3/c):void 0}}function _a(n,e){let t=0;const r=kd(50,250);return i=>{const s=i.loaded,o=i.lengthComputable?i.total:void 0,a=s-t,l=r(a),h=s<=o;t=s;const u={loaded:s,total:o,progress:o?s/o:void 0,bytes:a,rate:l||void 0,estimated:l&&o&&h?(o-s)/l:void 0,event:i};u[e?"download":"upload"]=!0,n(u)}}const xd=typeof XMLHttpRequest<"u",Sd=xd&&function(n){return new Promise(function(t,r){let i=n.data;const s=ht.from(n.headers).normalize(),o=n.responseType;let a;function l(){n.cancelToken&&n.cancelToken.unsubscribe(a),n.signal&&n.signal.removeEventListener("abort",a)}let h;C.isFormData(i)&&(et.isStandardBrowserEnv||et.isStandardBrowserWebWorkerEnv?s.setContentType(!1):s.getContentType(/^\s*multipart\/form-data/)?C.isString(h=s.getContentType())&&s.setContentType(h.replace(/^\s*(multipart\/form-data);+/,"$1")):s.setContentType("multipart/form-data"));let u=new XMLHttpRequest;if(n.auth){const f=n.auth.username||"",g=n.auth.password?unescape(encodeURIComponent(n.auth.password)):"";s.set("Authorization","Basic "+btoa(f+":"+g))}const p=Vl(n.baseURL,n.url);u.open(n.method.toUpperCase(),Ul(p,n.params,n.paramsSerializer),!0),u.timeout=n.timeout;function d(){if(!u)return;const f=ht.from("getAllResponseHeaders"in u&&u.getAllResponseHeaders()),m={data:!o||o==="text"||o==="json"?u.responseText:u.response,status:u.status,statusText:u.statusText,headers:f,config:n,request:u};md(function(w){t(w),l()},function(w){r(w),l()},m),u=null}if("onloadend"in u?u.onloadend=d:u.onreadystatechange=function(){!u||u.readyState!==4||u.status===0&&!(u.responseURL&&u.responseURL.indexOf("file:")===0)||setTimeout(d)},u.onabort=function(){u&&(r(new K("Request aborted",K.ECONNABORTED,n,u)),u=null)},u.onerror=function(){r(new K("Network Error",K.ERR_NETWORK,n,u)),u=null},u.ontimeout=function(){let g=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const m=n.transitional||Hl;n.timeoutErrorMessage&&(g=n.timeoutErrorMessage),r(new K(g,m.clarifyTimeoutError?K.ETIMEDOUT:K.ECONNABORTED,n,u)),u=null},et.isStandardBrowserEnv){const f=vd(p)&&n.xsrfCookieName&&yd.read(n.xsrfCookieName);f&&s.set(n.xsrfHeaderName,f)}i===void 0&&s.setContentType(null),"setRequestHeader"in u&&C.forEach(s.toJSON(),function(g,m){u.setRequestHeader(m,g)}),C.isUndefined(n.withCredentials)||(u.withCredentials=!!n.withCredentials),o&&o!=="json"&&(u.responseType=n.responseType),typeof n.onDownloadProgress=="function"&&u.addEventListener("progress",_a(n.onDownloadProgress,!0)),typeof n.onUploadProgress=="function"&&u.upload&&u.upload.addEventListener("progress",_a(n.onUploadProgress)),(n.cancelToken||n.signal)&&(a=f=>{u&&(r(!f||f.type?new er(null,n,u):f),u.abort(),u=null)},n.cancelToken&&n.cancelToken.subscribe(a),n.signal&&(n.signal.aborted?a():n.signal.addEventListener("abort",a)));const c=_d(p);if(c&&et.protocols.indexOf(c)===-1){r(new K("Unsupported protocol "+c+":",K.ERR_BAD_REQUEST,n));return}u.send(i||null)})},ps={http:Yp,xhr:Sd};C.forEach(ps,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const ka=n=>`- ${n}`,Ed=n=>C.isFunction(n)||n===null||n===!1,Jl={getAdapter:n=>{n=C.isArray(n)?n:[n];const{length:e}=n;let t,r;const i={};for(let s=0;s<e;s++){t=n[s];let o;if(r=t,!Ed(t)&&(r=ps[(o=String(t)).toLowerCase()],r===void 0))throw new K(`Unknown adapter '${o}'`);if(r)break;i[o||"#"+s]=r}if(!r){const s=Object.entries(i).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?s.length>1?`since :
`+s.map(ka).join(`
`):" "+ka(s[0]):"as no adapter specified";throw new K("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:ps};function Vi(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new er(null,n)}function xa(n){return Vi(n),n.headers=ht.from(n.headers),n.data=qi.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),Jl.getAdapter(n.adapter||eo.adapter)(n).then(function(r){return Vi(n),r.data=qi.call(n,n.transformResponse,r),r.headers=ht.from(r.headers),r},function(r){return ql(r)||(Vi(n),r&&r.response&&(r.response.data=qi.call(n,n.transformResponse,r.response),r.response.headers=ht.from(r.response.headers))),Promise.reject(r)})}const Sa=n=>n instanceof ht?n.toJSON():n;function pn(n,e){e=e||{};const t={};function r(h,u,p){return C.isPlainObject(h)&&C.isPlainObject(u)?C.merge.call({caseless:p},h,u):C.isPlainObject(u)?C.merge({},u):C.isArray(u)?u.slice():u}function i(h,u,p){if(C.isUndefined(u)){if(!C.isUndefined(h))return r(void 0,h,p)}else return r(h,u,p)}function s(h,u){if(!C.isUndefined(u))return r(void 0,u)}function o(h,u){if(C.isUndefined(u)){if(!C.isUndefined(h))return r(void 0,h)}else return r(void 0,u)}function a(h,u,p){if(p in e)return r(h,u);if(p in n)return r(void 0,h)}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(h,u)=>i(Sa(h),Sa(u),!0)};return C.forEach(Object.keys(Object.assign({},n,e)),function(u){const p=l[u]||i,d=p(n[u],e[u],u);C.isUndefined(d)&&p!==a||(t[u]=d)}),t}const Gl="1.6.0",to={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{to[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});const Ea={};to.transitional=function(e,t,r){function i(s,o){return"[Axios v"+Gl+"] Transitional option '"+s+"'"+o+(r?". "+r:"")}return(s,o,a)=>{if(e===!1)throw new K(i(o," has been removed"+(t?" in "+t:"")),K.ERR_DEPRECATED);return t&&!Ea[o]&&(Ea[o]=!0,console.warn(i(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(s,o,a):!0}};function Ad(n,e,t){if(typeof n!="object")throw new K("options must be an object",K.ERR_BAD_OPTION_VALUE);const r=Object.keys(n);let i=r.length;for(;i-- >0;){const s=r[i],o=e[s];if(o){const a=n[s],l=a===void 0||o(a,s,n);if(l!==!0)throw new K("option "+s+" must be "+l,K.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new K("Unknown option "+s,K.ERR_BAD_OPTION)}}const ds={assertOptions:Ad,validators:to},yt=ds.validators;class qr{constructor(e){this.defaults=e,this.interceptors={request:new ba,response:new ba}}request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=pn(this.defaults,t);const{transitional:r,paramsSerializer:i,headers:s}=t;r!==void 0&&ds.assertOptions(r,{silentJSONParsing:yt.transitional(yt.boolean),forcedJSONParsing:yt.transitional(yt.boolean),clarifyTimeoutError:yt.transitional(yt.boolean)},!1),i!=null&&(C.isFunction(i)?t.paramsSerializer={serialize:i}:ds.assertOptions(i,{encode:yt.function,serialize:yt.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=s&&C.merge(s.common,s[t.method]);s&&C.forEach(["delete","get","head","post","put","patch","common"],f=>{delete s[f]}),t.headers=ht.concat(o,s);const a=[];let l=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(t)===!1||(l=l&&g.synchronous,a.unshift(g.fulfilled,g.rejected))});const h=[];this.interceptors.response.forEach(function(g){h.push(g.fulfilled,g.rejected)});let u,p=0,d;if(!l){const f=[xa.bind(this),void 0];for(f.unshift.apply(f,a),f.push.apply(f,h),d=f.length,u=Promise.resolve(t);p<d;)u=u.then(f[p++],f[p++]);return u}d=a.length;let c=t;for(p=0;p<d;){const f=a[p++],g=a[p++];try{c=f(c)}catch(m){g.call(this,m);break}}try{u=xa.call(this,c)}catch(f){return Promise.reject(f)}for(p=0,d=h.length;p<d;)u=u.then(h[p++],h[p++]);return u}getUri(e){e=pn(this.defaults,e);const t=Vl(e.baseURL,e.url);return Ul(t,e.params,e.paramsSerializer)}}C.forEach(["delete","get","head","options"],function(e){qr.prototype[e]=function(t,r){return this.request(pn(r||{},{method:e,url:t,data:(r||{}).data}))}});C.forEach(["post","put","patch"],function(e){function t(r){return function(s,o,a){return this.request(pn(a||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}qr.prototype[e]=t(),qr.prototype[e+"Form"]=t(!0)});const Pr=qr;class no{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(s){t=s});const r=this;this.promise.then(i=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](i);r._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(a=>{r.subscribe(a),s=a}).then(i);return o.cancel=function(){r.unsubscribe(s)},o},e(function(s,o,a){r.reason||(r.reason=new er(s,o,a),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}static source(){let e;return{token:new no(function(i){e=i}),cancel:e}}}const Od=no;function Cd(n){return function(t){return n.apply(null,t)}}function Td(n){return C.isObject(n)&&n.isAxiosError===!0}const fs={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(fs).forEach(([n,e])=>{fs[e]=n});const Rd=fs;function Kl(n){const e=new Pr(n),t=Rl(Pr.prototype.request,e);return C.extend(t,Pr.prototype,e,{allOwnKeys:!0}),C.extend(t,e,null,{allOwnKeys:!0}),t.create=function(i){return Kl(pn(n,i))},t}const ue=Kl(eo);ue.Axios=Pr;ue.CanceledError=er;ue.CancelToken=Od;ue.isCancel=ql;ue.VERSION=Gl;ue.toFormData=fi;ue.AxiosError=K;ue.Cancel=ue.CanceledError;ue.all=function(e){return Promise.all(e)};ue.spread=Cd;ue.isAxiosError=Td;ue.mergeConfig=pn;ue.AxiosHeaders=ht;ue.formToJSON=n=>Wl(C.isHTMLForm(n)?new FormData(n):n);ue.getAdapter=Jl.getAdapter;ue.HttpStatusCode=Rd;ue.default=ue;const We=ue;class eb extends Ys{constructor(e,t,r){super(e,t,r||{id:"messaging"}),this.config=r}}var Nr=(n=>(n.CLIENT_TOAST="client:toast",n.CUSTOM_EXTENSION_EVENT="custom_extension_event",n.SHOW_EXTENSION="extension:show",n))(Nr||{}),Yl=(n=>(n.READY="ready",n.RUNNING="running",n.SUCCESS="success",n.STOPPED="stopped",n.FORCESTOP="forceStop",n.ERROR="error",n))(Yl||{});class tb{constructor(e){this._activeNode=[],this._activeNodeName="",this.errors=[],this._nodeNameMap={},this.id=e.id,this._state="ready",this._meta=e==null?void 0:e.meta,this._activity=""}get meta(){return this._meta}get activity(){return this._activity}get workflowId(){return this._workflowId}set workflowId(e){this._workflowId=e}get state(){return this._state}set state(e){this._state=e}get activeNode(){return this._activeNode}nodeDescriptionFromId(e){return this._nodeNameMap[e]??`node_${e}`}setNodeName(e,t){this._nodeNameMap[e]=t}}class Aa{static isValidUrl(e){let t;try{t=new URL(e)}catch{return!1}return t.protocol==="http:"||t.protocol==="https:"}static async fetchJSON(e,t=!0){return await new Promise((r,i)=>{this.isValidUrl(e)||i(new Error(`Invalid URL: ${e}`)),t&&(e=`/api/v1/mercenaries/fetch?url=${encodeURIComponent(e)}`),fetch(e).then(s=>{s.ok?r(s.json()):i(new Error(`Failed to fetch ${e}: ${s.status} ${s.statusText}`))}).catch(s=>{i(new Error(`Failed to fetch ${e}: ${s}`))})})}}class Id extends dp{constructor(e,t,r){r.singleton=!!r.singleton,super(e,t,r)}get singleton(){return this.extensionConfig.singleton}get winbox(){return this.extensionConfig.winbox}get client(){return this.app}get extensionConfig(){return this.config}get fileIntents(){return this.extensionConfig.fileIntents}get pinned(){return this.extensionConfig.addToWorkbench===!0&&window.localStorage.getItem(`fav-extension${this.id}`)!==null}set pinned(e){e?window.localStorage.setItem(`fav-extension${this.id}`,"true"):window.localStorage.removeItem(`fav-extension${this.id}`)}async create(){var e;if(this.debug("create()",this.id),(e=this.extensionConfig.scripts)!=null&&e.client)for(const t in this.extensionConfig.scripts.client){const r=this.extensionConfig.scripts.client[t];try{this.info(`Deserializing client extension script, id:"${t}", text:`,r.length>60?r.slice(0,40)+"...":r);const s=(0,eval)("("+JSON.parse(r)+")"),o=s==null?void 0:s();o!=null&&o.exec&&(this.client.registerClientScript(t,o.exec),this.commands??(this.commands={}),this.commands[t]={title:o.title,description:o.description})}catch(i){this.error("Error registering extension script script",r.id,i)}}}}class Zl extends fp{constructor(e){super(e)}get extensions(){return this.children}get(e){return this.extensions.get(e)}has(e){return this.extensions.has(e)}all(){return Array.from(this.extensions.values())}async register(e,t,r){var s;this.debug(`registering ${t.id} extensions`);let i=new e(t.id,this,t);return r&&typeof r=="function"&&(i=r(i)),this.children.set(t.id,i),await((s=i.create)==null?void 0:s.call(i)),i}async init(){let e=await fetch("/api/v1/mercenaries/extensions");e=await e.json();for(const t of e){const r=await this.register(Id,t);if(r.fileIntents){if(r.fileIntents.show&&Object.keys(r.fileIntents.show).length>0)for(const i in r.fileIntents.show){const s=r.fileIntents.show[i];this.app.sdkHost.registerFileIntent("show",i,{extensionId:r.id,page:s.page,opts:s.opts||{}})}if(r.fileIntents.edit&&Object.keys(r.fileIntents.edit).length>0)for(const i in r.fileIntents.edit){const s=r.fileIntents.edit[i];this.app.sdkHost.registerFileIntent("edit",i,{extensionId:r.id,page:s.page,opts:s.opts||{}})}}}}}class Xl extends Cl{constructor(e,t){super(e,t),this.scripts=new Map,this.renderers=new Map,this.extensions=new Zl(this),this.abortController=new AbortController,this.registerClientScript("help",async r=>{const i=Array.from(this.scripts.keys()).filter(a=>a!=="help").sort().map(a=>({title:"/"+a,id:a,args:[],classes:["btn-xs","rounded","bg-slate-300","text-black","hover:bg-slate-700","hover:text-white","w-32"]})),s=["Welcome to **Omnitool.ai**.","Greetings to **Omnitool.ai**.","Salutations, to **Omnitool.ai**.","Welcome, you have arrived at **Omnitool.ai**.","Hello and welcome to **Omnitool.ai**.","Hey there, welcome to **Omnitool.ai**.","We are pleased to welcome you to **Omnitool.ai**.","Thanks for trying **Omnitool.ai**.","Nice to see you at **Omnitool.ai**.","Good to have you at **Omnitool.ai**.","Pleased to meet you at **Omnitool.ai**.","Glad you're here at **Omnitool.ai**.","Happy to have you at **Omnitool.ai**.","Delighted to see you at **Omnitool.ai**.","Thank you for being here at **Omnitool.ai**.","It's a pleasure to welcome you to **Omnitool.ai**.","You've arrived at the right place, **Omnitool.ai**.","We've been expecting you at **Omnitool.ai**.","You're in good company at **Omnitool.ai**."],o=s[Math.floor(Math.random()*Math.random()*s.length)];return this.sendSystemMessage(o,"text/markdown",{commands:i}),{response:"",hide:!0}})}async init(){try{this.version=await(await fetch("/version")).text(),this.info(`Binding to version ${this.version}...`),this.info("Initializing Extension System..."),await this.extensions.init(),this.success("Extension System successfully initialized.")}catch(e){this.error("Unable to load extensions. Proceeding without.",e)}}registerClientScript(e,t){this.success("registering client script",e),this.scripts.set(e,t)}async sendSystemMessage(e,t="text/markdown",r=[],i=[],s="omni"){this.sendSystemMessages([{message:e,type:t}],r,i,s)}async sendSystemMessages(e,t=[],r=[],i="omni"){const s={type:"chat:system",from:i||"omni",flags:new Set(r)},o={content:e.map(l=>({value:l.message,type:l.type??"text/markdown"})),attachments:t},a={...s,body:o};this.emit("send:message",a)}async runBlock(e){return await this.services.get("command").runServerScript("runBlock",e)}async runScript(e,t,r){r??(r={fromChatWindow:!1});const i=this;if(!e)return{error:{message:"No script specified"}};if(this.debug("executing script",e,t),this.scripts.has(e)){const s=this.scripts.get(e);try{const o=await(s==null?void 0:s(t??[]))||{};if(o.response){const a=o.hide??!1;return r.fromChatWindow||a||await i.sendSystemMessage(o.response),{response:o.response,hide:a,result:o.result}}else return{error:o.error}}catch(o){return this.error("Error running client script",o),{error:{message:o.message}}}}else try{return await this.services.get("command").runServerScript(e,t)}catch(s){return this.error("Error running server script",s),{error:{message:s.message||s}}}}async onStart(){return!0}}class nb extends Ys{constructor(e,t,r){super(e,t,r||{id:e})}async login(e,t){const r=this.config;if(!e||!t)return null;try{const i=await We.post(r.host+r.authUrl,{username:e,password:t},{withCredentials:!0});return await this.emit("authenticated",i==null?void 0:i.data),i==null?void 0:i.data}catch(i){if(i.response.status===404)throw new Error("Login failed! Unable to connect with authentication service. (Error code 404.)");return this.error("Failed to connect to auth server "+i),null}}async register(e,t){const r=this.config;if(!e||!t)return null;try{const i=await We.put(r.host+r.signupUrl,{username:e,password:t},{withCredentials:!0});return await this.emit("authenticated",i==null?void 0:i.data),i==null?void 0:i.data}catch(i){return this.error("Failed to connect to auth server "+i),null}}async logout(){const e=this.config;this.debug("Logout URL ",e.host+e.logoutUrl);try{await We.post(e.host+e.logoutUrl,{},{withCredentials:!0}),await this.emit("authenticated",null)}catch(t){this.error("Failed to connect with auth server"+t)}}async getAuthenticatedUser(){const e=this.config;try{const t=await We.get(e.host+e.userUrl,{withCredentials:!0});return await this.emit("authenticated",t==null?void 0:t.data),t.data!=null?t==null?void 0:t.data:null}catch(t){return this.error("Failed to connect with auth server"+t),null}}async tryAutoLogin(){const e=this.config;try{const t=await We.get(`${e.host}/api/v1/auth/autologin`,{withCredentials:!0});return await this.emit("authenticated",t==null?void 0:t.data),t.data!=null?t==null?void 0:t.data:null}catch(t){return this.error("Failed to connect with auth server"+t),null}}create(){return this.info(`${this.id} create`),!0}async load(){return this.info(`${this.id} load`),!0}async start(){return this.info(`${this.id} start`),!0}async stop(){return this.info(`${this.id} stop`),!0}}var Pd=(n=>(n[n.User=0]="User",n[n.Omni=1]="Omni",n[n.AsyncJob=2]="AsyncJob",n))(Pd||{});class jt{static GetMessageStorageType(e){return e.from!==void 0&&e.from==="omni"?1:e.sender!==void 0&&e.sender==="me"?0:2}static async IsValidImageUrl(e){var t;try{const r=await fetch(e,{method:"HEAD"});return r.ok?((t=r.headers.get("Content-Type"))==null?void 0:t.startsWith("image"))??!1:!1}catch{return!1}}static CreateAsyncJobServerPayload(e,t){return{message:e,sender:"asyncjob",ts:t}}static IsAsyncJobMessage(e){var t,r;try{return((r=(t=e.body)==null?void 0:t.content[0])==null?void 0:r.type)==="omni/job"}catch{return!1}}static GetAsyncJobIdFromMessage(e){try{return e.body.content[0].value}catch{return null}}static ShouldPersist(e){var r;if(this.GetMessageStorageType(e)===0||this.GetMessageStorageType(e)===2)return!0;const t=e;return jt.HasChatContentProperty(t,"images")?!0:jt.HasChatContentProperty(t,"commands")?!1:!!(jt.HasChatContentProperty(t,"text")||((r=e.body)==null?void 0:r.content)!==void 0)}static HasChatContentProperty(e,t){var r;try{return((r=e.body.attachments[t])==null?void 0:r.length)>0}catch{return!1}}}const Nd=()=>new Intl.DateTimeFormat("en-US",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(new Date);class Ld{constructor(e,t){this._id=e.id,this._opts=t}get id(){return this._id}get opts(){return this._opts}}class ft extends Ld{constructor(e,t){super(e,t)}load(){return Promise.resolve()}}class rb extends Ys{constructor(e,t,r){super(e,t,r||{id:e}),this._renderers=new Map,this.activeContextId=0,this.state=r.initialState??{},this.workbench=r.workbench,this._pendingAsyncJobUpdates=new Map}async registerRenderer(e){var t;this.info(`registering renderer ${e.id}`),this._renderers.set(e.id,e),await((t=e.load)==null?void 0:t.call(e))}renderMessage(e){return(e==null?void 0:e.length)===0?null:e.map(t=>this.renderContent(t)).join(`
`)}async onChatMessage(e){await this._onChatMessage(e),await this.updateChatServer(e,Date.now())}async _onChatMessage(e){var u,p,d,c,f,g;const t=e.body;if(!t)return;const{from:r,flags:i,workflowId:s}=e,{attachments:o,content:a}=t,l=this.renderMessage(a),h={sender:r||"omni",text:l,whenText:Nd(),attachments:0,workflowId:s??((p=(u=this.workbench)==null?void 0:u.activeWorkflow)==null?void 0:p.id),flags:i||new Set};for(const m in o)["sender","text","whenText","attachments"].includes(m)||(o.key&&((c=(d=o==null?void 0:o[m])==null?void 0:d.forEach)==null||c.call(d,y=>{var _;const w=y&&(y.fid??((_=y==null?void 0:y.ticket)==null?void 0:_.fid));w&&(y.url="/fid/"+w)})),h[m]=o[m],h.attachments+=isNaN((f=o[m])==null?void 0:f.length)?0:(g=o[m])==null?void 0:g.length);await this.emitGlobalEvent("chat_message_added",[h]),this.state.messages.push(h)}async updateChatServer(e,t){if(jt.IsAsyncJobMessage(e)){const r=jt.GetAsyncJobIdFromMessage(e);r!==null&&this._pendingAsyncJobUpdates.set(r,!0);return}jt.ShouldPersist(e)&&(this.workbench===null||this.workbench.activeWorkflow===null||(e.workflowId=this.workbench.activeWorkflow.id,await We.put(`/api/v1/chat/${this.activeContextId}`,{payload:{msgstore:e,version:0,ts:t}},{withCredentials:!0}).then(r=>{},r=>{ce.error(r.message)})))}async clearChat(){await We.delete(`/api/v1/chat/${this.activeContextId}`,{withCredentials:!0}).then(e=>{},e=>{ce.error(e.message)})}async postUpdateChatServerForJobs(e,t,r){this._pendingAsyncJobUpdates.get(t)&&(await this.updateChatServer(e,r),this._pendingAsyncJobUpdates.delete(t))}renderContent(e){const t=this._renderers.get(e.type);return t!=null?t.render(e):`Error: Unknown chat renderer type ${e.type}`}create(){return this.info(`${this.id} create`),!0}async load(){return this.info(`${this.id} load`),!0}async start(){return this.info(`${this.id} start`),!0}async stop(){return this.info(`${this.id} stop`),!0}}const ib=(n,e,t=Xl)=>new t(n,e);class Gn extends ui{constructor(){super(...arguments);W(this,"_errors",[]);W(this,"_dirty",0);W(this,"_flags",[])}get displayName(){let t=this.meta.name||this.id;return this.isDirty&&(t+="*"),this.readOnly&&(t+=" (read-only)"),this.copyOnWrite&&(t+=" (copy-on-write)"),t}hasFlag(t){if(t!==t.toLowerCase())throw new Error(`ClientWorkflow Flag "${t}" must be lower-case`);return this._flags.includes(t)}setFlag(t,r=!0){if(t!==t.toLowerCase())throw new Error(`ClientWorkflow Flag "${t}" must be lower-case`);if(r){this._flags.includes(t)||this._flags.push(t);return}this._flags=this._flags.filter(i=>i!==t)}clearFlag(t){this.setFlag(t,!1)}get isDirty(){return this._dirty!==0}setDirty(){this._dirty=1}get copyOnWrite(){return this.hasFlag("copyonwrite")}set copyOnWrite(t){this.setFlag("copyonwrite",t)}get readOnly(){return this.hasFlag("readonly")}set readOnly(t){this.setFlag("readonly",t)}static async clone(t){const i=(await We.post("/api/v1/workflow/clone",{...t},{withCredentials:!0})).data.workflow;return Gn.fromJSON(i)}async syncToServer(){if(this.readOnly)return!1;this.copyOnWrite&&(this.copyOnWrite=!1,this.id="");const t=new Date().getTime();this._dirty=t,this.meta.updated=Date.now();const r=window.Alpine.raw(this.toJSON());try{const i=await We({method:this.id?"put":"post",url:"/api/v1/workflow",data:r,withCredentials:!0});if(i.status!==200||!i.data.workflow)return!1;const s=i.data.workflow.id;if(!s)throw new Error("Server did not return a valid recipe Id");this.id&&this.id!==s&&ce.log("server updated our id unexpectedly",this.id,s),this.id=s}catch(i){return ce.log("error writing to server",i),!1}return this._dirty===t&&(this._dirty=0),!0}static fromJSON(t,r=void 0){const i=new Gn(t.id);return i.id=t.id,!i.id&&t._id&&(i.id=t._id.replace("wf:","")),i.setMeta(t.meta),i.setRete(t.rete),i.setAPI(t.api),r&&r.length>0?i._flags=r:t._flags&&(i._flags=t._flags),i}toJSON(){const t=super.toJSON();return t._flags=this._flags,t}}function Md(n){return n>=55296&&n<=56319}function $d(n){return n>=56320&&n<=57343}var Dd=function(e,t,r){if(typeof t!="string")throw new Error("Input must be string");for(var i=t.length,s=0,o,a,l=0;l<i;l+=1){if(o=t.charCodeAt(l),a=t[l],Md(o)&&$d(t.charCodeAt(l+1))&&(l+=1,a+=t[l]),s+=e(a),s===r)return t.slice(0,l+1);if(s>r)return t.slice(0,l-a.length+1)}return t};function jd(n){return n>=55296&&n<=56319}function Bd(n){return n>=56320&&n<=57343}var zd=function(e){if(typeof e!="string")throw new Error("Input must be string");for(var t=e.length,r=0,i=null,s=null,o=0;o<t;o++)i=e.charCodeAt(o),Bd(i)?s!=null&&jd(s)?r+=1:r+=3:i<=127?r+=1:i>=128&&i<=2047?r+=2:i>=2048&&i<=65535&&(r+=3),s=i;return r},Fd=Dd,Ud=zd,Hd=Fd.bind(null,Ud),Wd=Hd,qd=/[\/\?<>\\:\*\|"]/g,Vd=/[\x00-\x1f\x80-\x9f]/g,Jd=/^\.+$/,Gd=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,Kd=/[\. ]+$/;function Oa(n,e){if(typeof n!="string")throw new Error("Input must be string");var t=n.replace(qd,e).replace(Vd,e).replace(Jd,e).replace(Gd,e).replace(Kd,e);return Wd(t,255)}var Yd=function(n,e){var t=e&&e.replacement||"",r=Oa(n,t);return t===""?r:Oa(r,"")};const Zd=qs(Yd);class Xd{constructor(){W(this,"_activeRecipe",null);W(this,"nicknames",{});W(this,"_activeExtension");W(this,"showFloatingExtension",!1);W(this,"floatingExtensionX",window.screen.width/2);W(this,"floatingExtensionY",window.screen.height/2);W(this,"refreshTS",Date.now());W(this,"isLoading",!1)}get activeExtension(){return this._activeExtension}hideExtension(){this._activeExtension=void 0}showExtension(e,t,r="",i){var d,c;i??(i={}),r.length>0&&!r.endsWith(".html")&&(r=r+".html");const s=this.getClient().extensions.get(e);if(!s)return;this._activeExtension=s;const o=(i.displayMode??((d=s==null?void 0:s.extensionConfig)==null?void 0:d.displayMode))||"default";let a="";const l=Date.now();if(typeof t=="string")a=`/extensions/${e}/${r}?${t}&ts=${l}&o=${encodeURIComponent(JSON.stringify({mode:o,hideToolbar:i.hideToolbar}))}`;else if(!t||typeof t=="object"){t??(t={});const f="q="+encodeURIComponent(JSON.stringify(t)),g="o="+encodeURIComponent(JSON.stringify({mode:o,hideToolbar:i.hideToolbar}));a=`/extensions/${e}/${r}?${f}&${g}`,ce.debug("rev",new URLSearchParams(a.toString()).toString())}const h=i.singletonHash??(s.singleton?s.id:void 0),u=Object.assign({},{...s.extensionConfig.winbox||{x:"center",y:"center"},title:s.extensionConfig.title||s.id},i.winbox||{}),p=this.getClient().toggleWindow(a,h,u);p&&p.show(),(c=this.getClient().extensions.get(e))!=null&&c.extensionConfig.minimizeChat&&this.getClient().uiSettings.toggleMinimized(!0)}refreshUI(){this.refreshTS=Date.now()}isSingletonActive(e){return!!this.getClient().getWindow(e)}getClient(){return window.client}getExtensions(){return this.getClient().extensions.all()}get activeWorkflow(){return this._activeRecipe}get activeRecipe(){return this._activeRecipe}set activeRecipe(e){this._activeRecipe=e}get activeRecipeId(){var e;return(e=this._activeRecipe)==null?void 0:e.id}getMetaDataBlock(){return this.activeWorkflow?Object.values(this.activeWorkflow.rete.nodes).find(t=>t.name==="omnitool.recipe_metadata"):void 0}updateMetaFromBlock(){if(!this.activeWorkflow)return;const e=this.getMetaDataBlock();e&&(this.activeWorkflow.meta.name=e.data.title,this.activeWorkflow.meta.description=e.data.description,this.activeWorkflow.meta.author=e.data.author,this.activeWorkflow.meta.help=e.data.help)}setDemoRecipe(e,t){this.getRecipeIdFromNickname(e),this.setNickname(e,t)}async _load(){this.updateNickNames(),this.setDemoRecipe("Bugbear","c0deba5e-417d-49df-96d3-8aeb8fc15402");const e=this.getClient(),t=i=>{for(const s in i)Array.isArray(i[s].connections)&&i[s].connections.length===0&&delete i[s].connections},r=function(i){for(const s in i)["inputs","controls","outputs"].forEach(o=>{Object.prototype.hasOwnProperty.call(i[s],o)&&t(i[s][o])});return i};return e.registerClientScript("explain",async i=>{if(!this.activeWorkflow)return;const s=i[0]||"beginner just learning omnitool and AI",o=await this.activeWorkflow.toJSON(),a=r(o.rete);await e.sendSystemMessage(` Analyzing the recipe to provide an explanation for a ${s}. Please wait...`);const l=o.meta.name,h=o.meta.pictureUrl;let u=`Acting as a smart, thoughtful, humble, and experienced teacher, given a Rete.js workflow, please explain using proper language and analogies for a ${s} what the purpose of the recipe this workflow represents is and how it operates.
Format your explanation using markdown.
Start with a Level 1 heading titled '${l}'.`;h&&(u+=` Add an image tag pointing to '/${h}' below the heading.`),u+=` Break the document into logical sections with Level 2 headings (Overview, Nodes Explanation, Recipe).
When referring to a "Rete Workflow", use the word "Recipe" instead.
When referring to a "Rete Node", use the word "Block" instead.
Explain the most critical and commonly misunderstood blocks in detail.
Do not include JSON notation or mention the JSON directly inside the markdown.
Remember that the user cannot see the node id numbers. The numbers for your use only. When referencing the blocks, use the block name, (or "x-omni-title") instead.
Close with a "Further Exploration" section that contains 1-2 bullet points with interesting aspects for the user to explore when looking to extend the recipe.`;const p=await e.runBlock({block:"omnitool.large_language_model",args:{Instruction:u,Prompt:JSON.stringify(a),Criteria:"Accurate"}});if(!(p!=null&&p.Reply)){await e.sendSystemMessage("Apologies, there was a problem analyzing the recipe.");return}let d=p.Reply;d=d.replace(/node/gi,"Block"),d=d.replace(/workflow/gi,"Recipe"),this.showExtension("omni-core-viewers",{markdown:d},"markdown",{displayMode:"floating"})}),e.registerClientScript("save",async()=>{if(this.canSave)try{return await this.save(),{response:"Recipe saved."}}catch(i){return await this.getClient().sendSystemMessage("Failed to save recipe"+i.message,"text/plain",{},["error"]),{error:"Failed to save"}}}),e.registerClientScript("dump",async()=>{if(this.activeWorkflow==null)return;const i=JSON.stringify(await this.activeWorkflow.toJSON(),null,2);let s=`${this.activeWorkflow.meta.name}_${this.activeWorkflow.id.replace(/[^a-zA-Z0-9-_]/g,"_")}_${Date.now()}.json`;s=Zd(s);const o="data:text/json;charset=utf-8,"+encodeURIComponent(i),a=document.createElement("a");return a.setAttribute("href",o),a.setAttribute("download",s),document.body.appendChild(a),a.click(),a.remove(),{response:"Recipe Exported as "+s}}),e.registerClientScript("load",async i=>{if(this.canSave&&await this.save(),i.length===0)return"Loads a recipe. Usage: /load <url>";const s=i[0];if(!Aa.isValidUrl(s))return"Invalid URL";const o=await Aa.fetchJSON(s);return await this.loadFromJSON(o),`Recipe loaded from  ${s}`}),e.registerClientScript("setname",async i=>{const s=i[0];if(!s)return{response:`**setname**  
Sets a nickname for the current recipe, allowing you to invoke it at any time by using **@nickname** in chat.  
Usage: **/setname** <name> 
`};this.deleteNickname(s);for(let a=0;a<10;a++){const l=this.getNickname();if(!l)break;this.deleteNickname(l)}return this.setNickname(s)?{response:`Recipe nickname set to **${s}**. You can now start this recipe from any chat by using **@${s}** <text>.`}:{response:"Failed to set nickname."}}),e.registerClientScript("unsetname",async i=>{if(i.length>0){const s=i[0];if(this.deleteNickname(s))return{response:"Recipe nickname removed."}}return{response:`**unsetsetname**  
Removes a nickname for a recipe previously set with /setname.  
Usage: **/unsetname** <name> 
`}}),e.registerClientScript("toggleFavorite",async i=>{if(i.length>0){const s=i[0];return window.localStorage.getItem(s)!==null?window.localStorage.removeItem(s):window.localStorage.setItem(s,new Date().getTime().toString()),!0}return!1}),!0}async load(){try{return await this._load()}catch{alert(`An unexpected error occurred while loading the workbench.

You will experience further errors that cannot be fixed.

Please reload the app and try again.`)}return!1}get displayName(){const e=this.activeWorkflow,t=this.getNickname();return e!=null?`${e.displayName} ${t?"(@"+t+")":""} `:"Welcome to Omnitool.ai!"}get canEdit(){return!this.readOnly}get canExecute(){return!!this.activeRecipe}get canExport(){return!!this.activeRecipe}get canFavorite(){return!!this.activeRecipe}get canSave(){return!this.readOnly}get canSaveAs(){return!!this.activeRecipe}get isBlank(){return!this.activeWorkflow||this.activeWorkflow.isBlank}get isFavorite(){return window.localStorage.getItem("fav-recipe"+this.activeRecipeId)!==null}isRunningActiveWorkflow(){return this.activeWorkflow!=null?this.getClient().jobs.getJobsforWorkflow(this.activeWorkflow.id).find(t=>t.state===Yl.RUNNING):!1}get copyOnWrite(){var e;return((e=this.activeRecipe)==null?void 0:e.copyOnWrite)??!1}get readOnly(){var e;return((e=this.activeWorkflow)==null?void 0:e.readOnly)??!0}getScopedKeyFromUserKey(e){const t=e==null?void 0:e.trim();return t?`workbench:${t}`:""}setWorkbenchSetting(e,t){typeof t=="object"&&(t=JSON.stringify(t));const r=this.getScopedKeyFromUserKey(e);if(!r)return ce.error("Invalid workbench setting key: ",e),!1;if(!t){const i=window.localStorage.getItem(r);return window.localStorage.removeItem(r),ce.debug("Removed workbench setting: ",e),!!i}return window.localStorage.setItem(r,t),ce.info("Set workbench setting: ",e),!0}deleteWorkbenchSetting(e){return this.setWorkbenchSetting(e,"")}getWorkbenchSetting(e){const t=this.getScopedKeyFromUserKey(e);if(!t){ce.error("Invalid workbench setting key: ",e);return}const r=window.localStorage.getItem(t);try{return JSON.parse(r??"")}catch{}return r}getWorkbenchSettingKeys(e){const t=[],r=`workbench:${e}`;for(let i=0;i<window.localStorage.length;i++){const s=window.localStorage.key(i);s!=null&&s.startsWith(r)&&t.push(s.substring(r.length))}return t}getKeyFromNickname(e){const t=e.trim().toLowerCase().replace(/[^a-z0-9]/g,"");return t?`nicknames:${t}`:void 0}deleteNickname(e){const t=this.getKeyFromNickname(e);return this.deleteWorkbenchSetting(t)}setNickname(e,t){var o;e=e.trim(),t??(t=(o=this.activeWorkflow)==null?void 0:o.id);const r=this.getKeyFromNickname(e);if(!r)return!1;const i={nickname:e,id:t},s=this.setWorkbenchSetting(r,i);return this.updateNickNames(),s}getNickname(e){var r;if(e??(e=(r=this.activeRecipe)==null?void 0:r.id),!e)return;const t=this.getWorkbenchSettingKeys("nicknames:");for(let i=0;i<t.length;i++){const s=t[i],o=this.getWorkbenchSetting(`nicknames:${s}`);if(o&&o.id===e)return o.nickname}}updateNickNames(){const e=[];this.getWorkbenchSettingKeys("nicknames:").forEach(i=>{const s=this.getWorkbenchSetting(`nicknames:${i}`);s!=null&&s.nickname&&e.push(s)}),e.sort((i,s)=>i.nickname.localeCompare(s.nickname));const r={};e.forEach(i=>{r[i.nickname]=i}),this.nicknames=r}async syncToServer(){if(!this.activeRecipe)return ce.error("workbench.syncToServer(): No active recipe"),!1;if(this.writeActiveRecipeIdToLocalStorage(),!this.activeRecipe.isDirty)return!0;const e=await this.activeRecipe.syncToServer();return this.writeActiveRecipeIdToLocalStorage(),e}async saveAs(){if(!this.activeWorkflow){ce.error("saveAs(): No active recipe");return}const e=this.activeWorkflow;let t=prompt("Recipe name:",e.meta.name||"My Recipe");if(t=t?t.trim():null,!t)return;const r=this.getMetaDataBlock();r&&(r.data.title=t),e.meta.name=t,e.id="",e.readOnly=!1,e.copyOnWrite=!1,e.setDirty(),await this.save()}async save(){if(!this.activeWorkflow){ce.error("workbench.save(): No active recipe");return}this.updateMetaFromBlock();let e="Saving recipe...";await this.syncToServer()?(e=`Recipe "${this.activeWorkflow.meta.name}" saved.`,await this.loadFromCache(!1)):e=`Recipe "${this.activeWorkflow.meta.name}" (${this.activeWorkflow.id}) unable to save.`,await this.getClient().sendSystemMessage(e)}async forceSave(){this.activeRecipe&&this.activeRecipe.setDirty(),await this.save()}getRecipeIdFromNickname(e){const t=this.getKeyFromNickname(e);return t?this.getWorkbenchSetting(t):void 0}async executeByName(e,t){var i;if(e==="omni"){const s=(i=this.activeWorkflow)==null?void 0:i.id;return await this.executeById(s,t)}const r=this.getRecipeIdFromNickname(e);if(!r){await this.getClient().sendSystemMessage(`There is no recipe by the name of "*${e}*"!`);return}return t.xOmniNickName=e,await this.executeById(r.id,t)}async executeById(e,t){var o,a;if(ce.debug("workbench.executeById",e,t),((o=this.activeWorkflow)==null?void 0:o.id)===e){if(!this.readOnly&&!await this.syncToServer())return null;e=(a=this.activeWorkflow)==null?void 0:a.id}if(!e)throw new Error(`Invalid recipe id: ${e} Cannot execute.`);const r=this.getClient();t=JSON.parse(JSON.stringify(Object.assign({},r.clipboard,t))),r.clipboard={};const i={workflow:e,args:t};return(await We.post("/api/v1/workflow/exec",i,{withCredentials:!0})).data.result}async execute(e={}){if(this.activeWorkflow==null){ce.error(`execute(${e}): No active workflow`);return}return this.writeActiveRecipeIdToLocalStorage(),await this.executeById(this.activeWorkflow.id,e)}async loadFromCache(e=!0){const t=window.localStorage.getItem("active_recipe_id");await this.loadRecipe(t,e)}async remixRecipe(){const e=this.activeWorkflow;if(!e)throw new Error("Cannot remix empty recipe");if(!e.id)throw new Error("Cannot remix unsaved recipe");let t=prompt("Recipe name:",`My ${e.meta.name}`);if(t=t?t.trim():null,!t)return null;const r=JSON.parse(JSON.stringify(e.meta));r.name=t,delete r.template,r.tags&&Array.isArray(r.tags)&&(r.tags=r.tags.filter(s=>s!=="template"&&s!=="#template"));const i=await Gn.clone({id:e.id,meta:r});return i?(await this.loadRecipe(i.id),this.activeWorkflow):null}async newRecipe(e=""){var i;if(e||(e=prompt("Name for new recipe:","My Recipe"),e=e?e.trim():null),!e)return;await this.loadFromJSON({}),await this.getClient().runScript("add",["omnitool.recipe_metadata"],{fromChatWindow:!1});const t=this.getMetaDataBlock();t&&(t.data.title=e,this.updateMetaFromBlock()),(i=this.activeRecipe)==null||i.setDirty(),await this.syncToServer(),await this.loadFromCache();const r=this.activeRecipe?`Recipe "${this.activeRecipe.meta.name}" created.`:"Failed to create a new recipe.";await this.getClient().sendSystemMessage(r)}async loadFromJSON(e,t,r=!0){var s;this.activeRecipe=null,this.isLoading=!0,this.activeRecipe=Gn.fromJSON(e,t),this.writeActiveRecipeIdToLocalStorage();const i=!0;this.activeRecipe.readOnly&&i&&(this.activeRecipe.copyOnWrite=this.activeRecipe.readOnly,this.activeRecipe.readOnly=!1),await this.getClient().emit("workbench_workflow_loaded",(s=this.activeRecipe)==null?void 0:s.id),this.showRecipeHelp(),r&&await this.getClient().runScript("fit",{}),this.isLoading=!1}async loadRecipe(e,t=!0){if(this.activeRecipe=null,!e){console.log(`Unable to load recipe with id: ${e}`);return}let r;try{r=await We.get(`/api/v1/workflow/${e}`,{withCredentials:!0})}catch(o){console.log(`Error loading recipe with id: ${e}, error: ${o}`);return}const i=r.data.workflow,s=r.data.flags;await this.loadFromJSON(i,s,t)}async onLoadRecipeFromFileChange(e){var i,s,o,a,l,h;const t=((i=e==null?void 0:e.dataTransfer)==null?void 0:i.files)||((s=e==null?void 0:e.target)==null?void 0:s.files);let r;if(t.length>0){const u=t[0];u.name.endsWith(".json")&&u.type==="application/json"&&(r=await new Promise((p,d)=>{const c=new FileReader;c.onload=f=>{var g;p(JSON.parse(((g=f==null?void 0:f.target)==null?void 0:g.result)??"{}"))},c.onerror=f=>{d(f)},c.readAsText(u)}))}r!=null&&r.id&&((o=r==null?void 0:r.meta)!=null&&o.name)&&((l=(a=r==null?void 0:r.rete)==null?void 0:a.id)!=null&&l.startsWith("mercs@"))&&(r.id="",await this.loadFromJSON(r),(h=this.activeWorkflow)==null||h.setDirty())}writeActiveRecipeIdToLocalStorage(){var t;const e=(t=this.activeWorkflow)==null?void 0:t.id;if(!e){window.localStorage.removeItem("active_recipe_id");return}window.localStorage.setItem("active_recipe_id",e)}generateAutoHelp(e){const t=`## New Recipe Checklist  
*Steps to take before running your recipe:*  

`,r=[{text:"Add a Recipe Metadata Block",check:()=>e.rete.nodes.find(o=>o.name==="omnitool.recipe_metadata")},{text:"Add a Chat Input Block",check:()=>e.rete.nodes.find(o=>o.name==="omnitool.chat_input")},{text:"Add a Chat Output Block",check:()=>e.rete.nodes.find(o=>o.name==="omnitool.chat_output")},{text:"Replace this Checklist by adding your own help information into the recipe metadata block",check:()=>!1}],i=`  

This checklist auto-updates every time the recipe is saved.`;return t+r.map(o=>o.check()?` ${o.text}`:` ${o.text}`).join(`  
`)+i}showTutorial(e){const t="workflow-tutorial";this.showExtension("omni-core-viewers",{video:"https://github.com/mercenaries-ai/omnitool-tutorials/releases/download/latest/quickstart.mp4"},"video.html",{singletonHash:t,winbox:{title:"Quickstart Video",minwidth:960,minheight:575,modal:e}})}showApiManagement(){this.showExtension("omni-core-collectionmanager",{type:"api"},void 0,{winbox:{title:"API Management",modal:!0},singletonHash:"omni-core-collectionmanager-api"})}toggleDevTool(){if(this.getClient().extensions.has("omni-extension-log-viewer")){const e="omni-extension-log-viewer";this.getClient().getWindow(e)?this.getClient().closeWindow(e):this.showExtension("omni-extension-log-viewer",{},void 0,{winbox:{title:"Developer Tool",x:"center",y:"bottom",width:1e3,height:200},singletonHash:"omni-extension-log-viewer"})}}showRecipeHelp(){var a,l;const e="workflow-intro",t=this.activeRecipe;if(!t){this.getClient().closeWindow(e);return}const r=(l=(a=t==null?void 0:t.meta)==null?void 0:a.help)==null?void 0:l.trim(),i=r?r.length?r:this.generateAutoHelp(t):this.generateAutoHelp(t),s="workflow-ui"+t.id,o=Object.values(window.Alpine.raw(t.rete.nodes)).find(h=>h.name==="omni-core-formio:formio.auto_ui");o&&o.data.enableUI&&this.showExtension("omni-core-formio",{recipe:{id:t.id,version:void 0}},o.data.editMode?"edit":"render",{singletonHash:s,winbox:{title:""+t.meta.name,x:"center",y:"center",minheight:500,minwidth:600,autosize:!0},hideToolbar:!0}),this.showExtension("omni-core-viewers",{markdown:i},"markdown",{singletonHash:e,winbox:{title:" '"+t.meta.name+"' - Information",x:"right",y:"bottom",minheight:450,minwidth:400,autosize:!0},hideToolbar:!0})}}var Qd=Object.create,ro=Object.defineProperty,ef=Object.getOwnPropertyDescriptor,tf=Object.getOwnPropertyNames,nf=Object.getPrototypeOf,rf=Object.prototype.hasOwnProperty,sf=(n,e,t)=>e in n?ro(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Tn=(n=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(n,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):n)(function(n){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+n+'" is not supported')}),q=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),of=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of tf(e))!rf.call(n,i)&&i!==t&&ro(n,i,{get:()=>e[i],enumerable:!(r=ef(e,i))||r.enumerable});return n},af=(n,e,t)=>(t=n!=null?Qd(nf(n)):{},of(e||!n||!n.__esModule?ro(t,"default",{value:n,enumerable:!0}):t,n)),ae=(n,e,t)=>(sf(n,typeof e!="symbol"?e+"":e,t),t),lf=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},Ca=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},gs=(n,e,t)=>(lf(n,e,"access private method"),t),Ce=q(n=>{n.__esModule=!0,n.extend=s,n.indexOf=h,n.escapeExpression=u,n.isEmpty=p,n.createFrame=d,n.blockParams=c,n.appendContextPath=f;var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},t=/[&<>"'`=]/g,r=/[&<>"'`=]/;function i(g){return e[g]}function s(g){for(var m=1;m<arguments.length;m++)for(var y in arguments[m])Object.prototype.hasOwnProperty.call(arguments[m],y)&&(g[y]=arguments[m][y]);return g}var o=Object.prototype.toString;n.toString=o;var a=function(g){return typeof g=="function"};a(/x/)&&(n.isFunction=a=function(g){return typeof g=="function"&&o.call(g)==="[object Function]"}),n.isFunction=a;var l=Array.isArray||function(g){return g&&typeof g=="object"?o.call(g)==="[object Array]":!1};n.isArray=l;function h(g,m){for(var y=0,w=g.length;y<w;y++)if(g[y]===m)return y;return-1}function u(g){if(typeof g!="string"){if(g&&g.toHTML)return g.toHTML();if(g==null)return"";if(!g)return g+"";g=""+g}return r.test(g)?g.replace(t,i):g}function p(g){return!g&&g!==0?!0:!!(l(g)&&g.length===0)}function d(g){var m=s({},g);return m._parent=g,m}function c(g,m){return g.path=m,g}function f(g,m){return(g?g+".":"")+m}}),Ke=q((n,e)=>{n.__esModule=!0;var t=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function r(i,s){var o=s&&s.loc,a=void 0,l=void 0,h=void 0,u=void 0;o&&(a=o.start.line,l=o.end.line,h=o.start.column,u=o.end.column,i+=" - "+a+":"+h);for(var p=Error.prototype.constructor.call(this,i),d=0;d<t.length;d++)this[t[d]]=p[t[d]];Error.captureStackTrace&&Error.captureStackTrace(this,r);try{o&&(this.lineNumber=a,this.endLineNumber=l,Object.defineProperty?(Object.defineProperty(this,"column",{value:h,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:u,enumerable:!0})):(this.column=h,this.endColumn=u))}catch{}}r.prototype=new Error,n.default=r,e.exports=n.default}),cf=q((n,e)=>{n.__esModule=!0;var t=Ce();n.default=function(r){r.registerHelper("blockHelperMissing",function(i,s){var o=s.inverse,a=s.fn;if(i===!0)return a(this);if(i===!1||i==null)return o(this);if(t.isArray(i))return i.length>0?(s.ids&&(s.ids=[s.name]),r.helpers.each(i,s)):o(this);if(s.data&&s.ids){var l=t.createFrame(s.data);l.contextPath=t.appendContextPath(s.data.contextPath,s.name),s={data:l}}return a(i,s)})},e.exports=n.default}),uf=q((n,e)=>{n.__esModule=!0;function t(o){return o&&o.__esModule?o:{default:o}}var r=Ce(),i=Ke(),s=t(i);n.default=function(o){o.registerHelper("each",function(a,l){if(!l)throw new s.default("Must pass iterator to #each");var h=l.fn,u=l.inverse,p=0,d="",c=void 0,f=void 0;l.data&&l.ids&&(f=r.appendContextPath(l.data.contextPath,l.ids[0])+"."),r.isFunction(a)&&(a=a.call(this)),l.data&&(c=r.createFrame(l.data));function g(v,b,x){c&&(c.key=v,c.index=b,c.first=b===0,c.last=!!x,f&&(c.contextPath=f+v)),d=d+h(a[v],{data:c,blockParams:r.blockParams([a[v],v],[f+v,null])})}if(a&&typeof a=="object")if(r.isArray(a))for(var m=a.length;p<m;p++)p in a&&g(p,p,p===a.length-1);else if(typeof Symbol=="function"&&a[Symbol.iterator]){for(var y=[],w=a[Symbol.iterator](),_=w.next();!_.done;_=w.next())y.push(_.value);a=y;for(var m=a.length;p<m;p++)g(p,p,p===a.length-1)}else(function(){var v=void 0;Object.keys(a).forEach(function(b){v!==void 0&&g(v,p-1),v=b,p++}),v!==void 0&&g(v,p-1,!0)})();return p===0&&(d=u(this)),d})},e.exports=n.default}),hf=q((n,e)=>{n.__esModule=!0;function t(s){return s&&s.__esModule?s:{default:s}}var r=Ke(),i=t(r);n.default=function(s){s.registerHelper("helperMissing",function(){if(arguments.length!==1)throw new i.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})},e.exports=n.default}),pf=q((n,e)=>{n.__esModule=!0;function t(o){return o&&o.__esModule?o:{default:o}}var r=Ce(),i=Ke(),s=t(i);n.default=function(o){o.registerHelper("if",function(a,l){if(arguments.length!=2)throw new s.default("#if requires exactly one argument");return r.isFunction(a)&&(a=a.call(this)),!l.hash.includeZero&&!a||r.isEmpty(a)?l.inverse(this):l.fn(this)}),o.registerHelper("unless",function(a,l){if(arguments.length!=2)throw new s.default("#unless requires exactly one argument");return o.helpers.if.call(this,a,{fn:l.inverse,inverse:l.fn,hash:l.hash})})},e.exports=n.default}),df=q((n,e)=>{n.__esModule=!0,n.default=function(t){t.registerHelper("log",function(){for(var r=[void 0],i=arguments[arguments.length-1],s=0;s<arguments.length-1;s++)r.push(arguments[s]);var o=1;i.hash.level!=null?o=i.hash.level:i.data&&i.data.level!=null&&(o=i.data.level),r[0]=o,t.log.apply(t,r)})},e.exports=n.default}),ff=q((n,e)=>{n.__esModule=!0,n.default=function(t){t.registerHelper("lookup",function(r,i,s){return r&&s.lookupProperty(r,i)})},e.exports=n.default}),gf=q((n,e)=>{n.__esModule=!0;function t(o){return o&&o.__esModule?o:{default:o}}var r=Ce(),i=Ke(),s=t(i);n.default=function(o){o.registerHelper("with",function(a,l){if(arguments.length!=2)throw new s.default("#with requires exactly one argument");r.isFunction(a)&&(a=a.call(this));var h=l.fn;if(r.isEmpty(a))return l.inverse(this);var u=l.data;return l.data&&l.ids&&(u=r.createFrame(l.data),u.contextPath=r.appendContextPath(l.data.contextPath,l.ids[0])),h(a,{data:u,blockParams:r.blockParams([a],[u&&u.contextPath])})})},e.exports=n.default}),Ql=q(n=>{n.__esModule=!0,n.registerDefaultHelpers=m,n.moveHelperToHooks=y;function e(w){return w&&w.__esModule?w:{default:w}}var t=cf(),r=e(t),i=uf(),s=e(i),o=hf(),a=e(o),l=pf(),h=e(l),u=df(),p=e(u),d=ff(),c=e(d),f=gf(),g=e(f);function m(w){r.default(w),s.default(w),a.default(w),h.default(w),p.default(w),c.default(w),g.default(w)}function y(w,_,v){w.helpers[_]&&(w.hooks[_]=w.helpers[_],v||delete w.helpers[_])}}),mf=q((n,e)=>{n.__esModule=!0;var t=Ce();n.default=function(r){r.registerDecorator("inline",function(i,s,o,a){var l=i;return s.partials||(s.partials={},l=function(h,u){var p=o.partials;o.partials=t.extend({},p,s.partials);var d=i(h,u);return o.partials=p,d}),s.partials[a.args[0]]=a.fn,l})},e.exports=n.default}),yf=q(n=>{n.__esModule=!0,n.registerDefaultDecorators=i;function e(s){return s&&s.__esModule?s:{default:s}}var t=mf(),r=e(t);function i(s){r.default(s)}}),ec=q((n,e)=>{n.__esModule=!0;var t=Ce(),r={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(i){if(typeof i=="string"){var s=t.indexOf(r.methodMap,i.toLowerCase());s>=0?i=s:i=parseInt(i,10)}return i},log:function(i){if(i=r.lookupLevel(i),typeof console<"u"&&r.lookupLevel(r.level)<=i){var s=r.methodMap[i];console[s]||(s="log");for(var o=arguments.length,a=Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];console[s].apply(console,a)}}};n.default=r,e.exports=n.default}),wf=q(n=>{n.__esModule=!0,n.createNewLookupObject=t;var e=Ce();function t(){for(var r=arguments.length,i=Array(r),s=0;s<r;s++)i[s]=arguments[s];return e.extend.apply(void 0,[Object.create(null)].concat(i))}}),tc=q(n=>{n.__esModule=!0,n.createProtoAccessControl=o,n.resultIsAllowed=a,n.resetLoggedProperties=u;function e(p){return p&&p.__esModule?p:{default:p}}var t=wf(),r=ec(),i=e(r),s=Object.create(null);function o(p){var d=Object.create(null);d.constructor=!1,d.__defineGetter__=!1,d.__defineSetter__=!1,d.__lookupGetter__=!1;var c=Object.create(null);return c.__proto__=!1,{properties:{whitelist:t.createNewLookupObject(c,p.allowedProtoProperties),defaultValue:p.allowProtoPropertiesByDefault},methods:{whitelist:t.createNewLookupObject(d,p.allowedProtoMethods),defaultValue:p.allowProtoMethodsByDefault}}}function a(p,d,c){return l(typeof p=="function"?d.methods:d.properties,c)}function l(p,d){return p.whitelist[d]!==void 0?p.whitelist[d]===!0:p.defaultValue!==void 0?p.defaultValue:(h(d),!1)}function h(p){s[p]!==!0&&(s[p]=!0,i.default.log("error",'Handlebars: Access has been denied to resolve the property "'+p+`" because it is not an "own property" of its parent.
You can add a runtime option to disable the check or this warning:
See https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details`))}function u(){Object.keys(s).forEach(function(p){delete s[p]})}}),io=q(n=>{n.__esModule=!0,n.HandlebarsEnvironment=g;function e(y){return y&&y.__esModule?y:{default:y}}var t=Ce(),r=Ke(),i=e(r),s=Ql(),o=yf(),a=ec(),l=e(a),h=tc(),u="4.7.8";n.VERSION=u;var p=8;n.COMPILER_REVISION=p;var d=7;n.LAST_COMPATIBLE_COMPILER_REVISION=d;var c={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};n.REVISION_CHANGES=c;var f="[object Object]";function g(y,w,_){this.helpers=y||{},this.partials=w||{},this.decorators=_||{},s.registerDefaultHelpers(this),o.registerDefaultDecorators(this)}g.prototype={constructor:g,logger:l.default,log:l.default.log,registerHelper:function(y,w){if(t.toString.call(y)===f){if(w)throw new i.default("Arg not supported with multiple helpers");t.extend(this.helpers,y)}else this.helpers[y]=w},unregisterHelper:function(y){delete this.helpers[y]},registerPartial:function(y,w){if(t.toString.call(y)===f)t.extend(this.partials,y);else{if(typeof w>"u")throw new i.default('Attempting to register a partial called "'+y+'" as undefined');this.partials[y]=w}},unregisterPartial:function(y){delete this.partials[y]},registerDecorator:function(y,w){if(t.toString.call(y)===f){if(w)throw new i.default("Arg not supported with multiple decorators");t.extend(this.decorators,y)}else this.decorators[y]=w},unregisterDecorator:function(y){delete this.decorators[y]},resetLoggedPropertyAccesses:function(){h.resetLoggedProperties()}};var m=l.default.log;n.log=m,n.createFrame=t.createFrame,n.logger=l.default}),bf=q((n,e)=>{n.__esModule=!0;function t(r){this.string=r}t.prototype.toString=t.prototype.toHTML=function(){return""+this.string},n.default=t,e.exports=n.default}),vf=q(n=>{n.__esModule=!0,n.wrapHelper=e;function e(t,r){if(typeof t!="function")return t;var i=function(){var s=arguments[arguments.length-1];return arguments[arguments.length-1]=r(s),t.apply(this,arguments)};return i}}),_f=q(n=>{n.__esModule=!0,n.checkRevision=p,n.template=d,n.wrapProgram=c,n.resolvePartial=f,n.invokePartial=g,n.noop=m;function e(b){return b&&b.__esModule?b:{default:b}}function t(b){if(b&&b.__esModule)return b;var x={};if(b!=null)for(var E in b)Object.prototype.hasOwnProperty.call(b,E)&&(x[E]=b[E]);return x.default=b,x}var r=Ce(),i=t(r),s=Ke(),o=e(s),a=io(),l=Ql(),h=vf(),u=tc();function p(b){var x=b&&b[0]||1,E=a.COMPILER_REVISION;if(!(x>=a.LAST_COMPATIBLE_COMPILER_REVISION&&x<=a.COMPILER_REVISION))if(x<a.LAST_COMPATIBLE_COMPILER_REVISION){var N=a.REVISION_CHANGES[E],$=a.REVISION_CHANGES[x];throw new o.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+N+") or downgrade your runtime to an older version ("+$+").")}else throw new o.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+b[1]+").")}function d(b,x){if(!x)throw new o.default("No environment passed to template");if(!b||!b.main)throw new o.default("Unknown template object: "+typeof b);b.main.decorator=b.main_d,x.VM.checkRevision(b.compiler);var E=b.compiler&&b.compiler[0]===7;function N(k,O,T){T.hash&&(O=i.extend({},O,T.hash),T.ids&&(T.ids[0]=!0)),k=x.VM.resolvePartial.call(this,k,O,T);var I=i.extend({},T,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),U=x.VM.invokePartial.call(this,k,O,I);if(U==null&&x.compile&&(T.partials[T.name]=x.compile(k,b.compilerOptions,x),U=T.partials[T.name](O,I)),U!=null){if(T.indent){for(var J=U.split(`
`),X=0,fe=J.length;X<fe&&!(!J[X]&&X+1===fe);X++)J[X]=T.indent+J[X];U=J.join(`
`)}return U}else throw new o.default("The partial "+T.name+" could not be compiled when running in runtime-only mode")}var $={strict:function(k,O,T){if(!k||!(O in k))throw new o.default('"'+O+'" not defined in '+k,{loc:T});return $.lookupProperty(k,O)},lookupProperty:function(k,O){var T=k[O];if(T==null||Object.prototype.hasOwnProperty.call(k,O)||u.resultIsAllowed(T,$.protoAccessControl,O))return T},lookup:function(k,O){for(var T=k.length,I=0;I<T;I++){var U=k[I]&&$.lookupProperty(k[I],O);if(U!=null)return k[I][O]}},lambda:function(k,O){return typeof k=="function"?k.call(O):k},escapeExpression:i.escapeExpression,invokePartial:N,fn:function(k){var O=b[k];return O.decorator=b[k+"_d"],O},programs:[],program:function(k,O,T,I,U){var J=this.programs[k],X=this.fn(k);return O||U||I||T?J=c(this,k,X,O,T,I,U):J||(J=this.programs[k]=c(this,k,X)),J},data:function(k,O){for(;k&&O--;)k=k._parent;return k},mergeIfNeeded:function(k,O){var T=k||O;return k&&O&&k!==O&&(T=i.extend({},O,k)),T},nullContext:Object.seal({}),noop:x.VM.noop,compilerInfo:b.compiler};function A(k){var O=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],T=O.data;A._setup(O),!O.partial&&b.useData&&(T=y(k,T));var I=void 0,U=b.useBlockParams?[]:void 0;b.useDepths&&(O.depths?I=k!=O.depths[0]?[k].concat(O.depths):O.depths:I=[k]);function J(X){return""+b.main($,X,$.helpers,$.partials,T,U,I)}return J=w(b.main,J,$,O.depths||[],T,U),J(k,O)}return A.isTop=!0,A._setup=function(k){if(k.partial)$.protoAccessControl=k.protoAccessControl,$.helpers=k.helpers,$.partials=k.partials,$.decorators=k.decorators,$.hooks=k.hooks;else{var O=i.extend({},x.helpers,k.helpers);_(O,$),$.helpers=O,b.usePartial&&($.partials=$.mergeIfNeeded(k.partials,x.partials)),(b.usePartial||b.useDecorators)&&($.decorators=i.extend({},x.decorators,k.decorators)),$.hooks={},$.protoAccessControl=u.createProtoAccessControl(k);var T=k.allowCallsToHelperMissing||E;l.moveHelperToHooks($,"helperMissing",T),l.moveHelperToHooks($,"blockHelperMissing",T)}},A._child=function(k,O,T,I){if(b.useBlockParams&&!T)throw new o.default("must pass block params");if(b.useDepths&&!I)throw new o.default("must pass parent depths");return c($,k,b[k],O,0,T,I)},A}function c(b,x,E,N,$,A,k){function O(T){var I=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],U=k;return k&&T!=k[0]&&!(T===b.nullContext&&k[0]===null)&&(U=[T].concat(k)),E(b,T,b.helpers,b.partials,I.data||N,A&&[I.blockParams].concat(A),U)}return O=w(E,O,b,k,N,A),O.program=x,O.depth=k?k.length:0,O.blockParams=$||0,O}function f(b,x,E){return b?!b.call&&!E.name&&(E.name=b,b=E.partials[b]):E.name==="@partial-block"?b=E.data["partial-block"]:b=E.partials[E.name],b}function g(b,x,E){var N=E.data&&E.data["partial-block"];E.partial=!0,E.ids&&(E.data.contextPath=E.ids[0]||E.data.contextPath);var $=void 0;if(E.fn&&E.fn!==m&&function(){E.data=a.createFrame(E.data);var A=E.fn;$=E.data["partial-block"]=function(k){var O=arguments.length<=1||arguments[1]===void 0?{}:arguments[1];return O.data=a.createFrame(O.data),O.data["partial-block"]=N,A(k,O)},A.partials&&(E.partials=i.extend({},E.partials,A.partials))}(),b===void 0&&$&&(b=$),b===void 0)throw new o.default("The partial "+E.name+" could not be found");if(b instanceof Function)return b(x,E)}function m(){return""}function y(b,x){return(!x||!("root"in x))&&(x=x?a.createFrame(x):{},x.root=b),x}function w(b,x,E,N,$,A){if(b.decorator){var k={};x=b.decorator(x,k,E,N&&N[0],$,A,N),i.extend(x,k)}return x}function _(b,x){Object.keys(b).forEach(function(E){var N=b[E];b[E]=v(N,x)})}function v(b,x){var E=x.lookupProperty;return h.wrapHelper(b,function(N){return i.extend({lookupProperty:E},N)})}}),nc=q((n,e)=>{n.__esModule=!0,n.default=function(t){(function(){typeof globalThis!="object"&&(Object.prototype.__defineGetter__("__magic__",function(){return this}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__)})();var r=globalThis.Handlebars;t.noConflict=function(){return globalThis.Handlebars===t&&(globalThis.Handlebars=r),t}},e.exports=n.default}),kf=q((n,e)=>{n.__esModule=!0;function t(w){return w&&w.__esModule?w:{default:w}}function r(w){if(w&&w.__esModule)return w;var _={};if(w!=null)for(var v in w)Object.prototype.hasOwnProperty.call(w,v)&&(_[v]=w[v]);return _.default=w,_}var i=io(),s=r(i),o=bf(),a=t(o),l=Ke(),h=t(l),u=Ce(),p=r(u),d=_f(),c=r(d),f=nc(),g=t(f);function m(){var w=new s.HandlebarsEnvironment;return p.extend(w,s),w.SafeString=a.default,w.Exception=h.default,w.Utils=p,w.escapeExpression=p.escapeExpression,w.VM=c,w.template=function(_){return c.template(_,w)},w}var y=m();y.create=m,g.default(y),y.default=y,n.default=y,e.exports=n.default}),rc=q((n,e)=>{n.__esModule=!0;var t={helpers:{helperExpression:function(r){return r.type==="SubExpression"||(r.type==="MustacheStatement"||r.type==="BlockStatement")&&!!(r.params&&r.params.length||r.hash)},scopedId:function(r){return/^\.|this\b/.test(r.original)},simpleId:function(r){return r.parts.length===1&&!t.helpers.scopedId(r)&&!r.depth}}};n.default=t,e.exports=n.default}),xf=q((n,e)=>{n.__esModule=!0;var t=function(){var r={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,0],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function(o,a,l,h,u,p,d){var c=p.length-1;switch(u){case 1:return p[c-1];case 2:this.$=h.prepareProgram(p[c]);break;case 3:this.$=p[c];break;case 4:this.$=p[c];break;case 5:this.$=p[c];break;case 6:this.$=p[c];break;case 7:this.$=p[c];break;case 8:this.$=p[c];break;case 9:this.$={type:"CommentStatement",value:h.stripComment(p[c]),strip:h.stripFlags(p[c],p[c]),loc:h.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:p[c],value:p[c],loc:h.locInfo(this._$)};break;case 11:this.$=h.prepareRawBlock(p[c-2],p[c-1],p[c],this._$);break;case 12:this.$={path:p[c-3],params:p[c-2],hash:p[c-1]};break;case 13:this.$=h.prepareBlock(p[c-3],p[c-2],p[c-1],p[c],!1,this._$);break;case 14:this.$=h.prepareBlock(p[c-3],p[c-2],p[c-1],p[c],!0,this._$);break;case 15:this.$={open:p[c-5],path:p[c-4],params:p[c-3],hash:p[c-2],blockParams:p[c-1],strip:h.stripFlags(p[c-5],p[c])};break;case 16:this.$={path:p[c-4],params:p[c-3],hash:p[c-2],blockParams:p[c-1],strip:h.stripFlags(p[c-5],p[c])};break;case 17:this.$={path:p[c-4],params:p[c-3],hash:p[c-2],blockParams:p[c-1],strip:h.stripFlags(p[c-5],p[c])};break;case 18:this.$={strip:h.stripFlags(p[c-1],p[c-1]),program:p[c]};break;case 19:var f=h.prepareBlock(p[c-2],p[c-1],p[c],p[c],!1,this._$),g=h.prepareProgram([f],p[c-1].loc);g.chained=!0,this.$={strip:p[c-2].strip,program:g,chain:!0};break;case 20:this.$=p[c];break;case 21:this.$={path:p[c-1],strip:h.stripFlags(p[c-2],p[c])};break;case 22:this.$=h.prepareMustache(p[c-3],p[c-2],p[c-1],p[c-4],h.stripFlags(p[c-4],p[c]),this._$);break;case 23:this.$=h.prepareMustache(p[c-3],p[c-2],p[c-1],p[c-4],h.stripFlags(p[c-4],p[c]),this._$);break;case 24:this.$={type:"PartialStatement",name:p[c-3],params:p[c-2],hash:p[c-1],indent:"",strip:h.stripFlags(p[c-4],p[c]),loc:h.locInfo(this._$)};break;case 25:this.$=h.preparePartialBlock(p[c-2],p[c-1],p[c],this._$);break;case 26:this.$={path:p[c-3],params:p[c-2],hash:p[c-1],strip:h.stripFlags(p[c-4],p[c])};break;case 27:this.$=p[c];break;case 28:this.$=p[c];break;case 29:this.$={type:"SubExpression",path:p[c-3],params:p[c-2],hash:p[c-1],loc:h.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:p[c],loc:h.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:h.id(p[c-2]),value:p[c],loc:h.locInfo(this._$)};break;case 32:this.$=h.id(p[c-1]);break;case 33:this.$=p[c];break;case 34:this.$=p[c];break;case 35:this.$={type:"StringLiteral",value:p[c],original:p[c],loc:h.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(p[c]),original:Number(p[c]),loc:h.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:p[c]==="true",original:p[c]==="true",loc:h.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:void 0,value:void 0,loc:h.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:h.locInfo(this._$)};break;case 40:this.$=p[c];break;case 41:this.$=p[c];break;case 42:this.$=h.preparePath(!0,p[c],this._$);break;case 43:this.$=h.preparePath(!1,p[c],this._$);break;case 44:p[c-2].push({part:h.id(p[c]),original:p[c],separator:p[c-1]}),this.$=p[c-2];break;case 45:this.$=[{part:h.id(p[c]),original:p[c]}];break;case 46:this.$=[];break;case 47:p[c-1].push(p[c]);break;case 48:this.$=[];break;case 49:p[c-1].push(p[c]);break;case 50:this.$=[];break;case 51:p[c-1].push(p[c]);break;case 58:this.$=[];break;case 59:p[c-1].push(p[c]);break;case 64:this.$=[];break;case 65:p[c-1].push(p[c]);break;case 70:this.$=[];break;case 71:p[c-1].push(p[c]);break;case 78:this.$=[];break;case 79:p[c-1].push(p[c]);break;case 82:this.$=[];break;case 83:p[c-1].push(p[c]);break;case 86:this.$=[];break;case 87:p[c-1].push(p[c]);break;case 90:this.$=[];break;case 91:p[c-1].push(p[c]);break;case 94:this.$=[];break;case 95:p[c-1].push(p[c]);break;case 98:this.$=[p[c]];break;case 99:p[c-1].push(p[c]);break;case 100:this.$=[p[c]];break;case 101:p[c-1].push(p[c]);break}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{15:[2,48],17:39,18:[2,48]},{20:41,56:40,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:44,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:45,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:41,56:48,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:49,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,50]},{72:[1,35],86:51},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:52,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:53,38:55,39:[1,57],43:56,44:[1,58],45:54,47:[2,54]},{28:59,43:60,44:[1,58],47:[2,56]},{13:62,15:[1,20],18:[1,61]},{33:[2,86],57:63,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:64,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:65,47:[1,66]},{30:67,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:68,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:69,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:70,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:74,33:[2,80],50:71,63:72,64:75,65:[1,43],69:73,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,79]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,50]},{20:74,53:80,54:[2,84],63:81,64:75,65:[1,43],69:82,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:83,47:[1,66]},{47:[2,55]},{4:84,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:85,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:86,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:87,47:[1,66]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:74,33:[2,88],58:88,63:89,64:75,65:[1,43],69:90,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:91,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:92,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,31:93,33:[2,60],63:94,64:75,65:[1,43],69:95,70:76,71:77,72:[1,78],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,66],36:96,63:97,64:75,65:[1,43],69:98,70:76,71:77,72:[1,78],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,22:99,23:[2,52],63:100,64:75,65:[1,43],69:101,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,92],62:102,63:103,64:75,65:[1,43],69:104,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,105]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:106,72:[1,107],75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,108],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,109]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:55,39:[1,57],43:56,44:[1,58],45:111,46:110,47:[2,76]},{33:[2,70],40:112,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,113]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:74,63:115,64:75,65:[1,43],67:114,68:[2,96],69:116,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,117]},{32:118,33:[2,62],74:119,75:[1,120]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:121,74:122,75:[1,120]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,123]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,124]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,108]},{20:74,63:125,64:75,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:74,33:[2,72],41:126,63:127,64:75,65:[1,43],69:128,70:76,71:77,72:[1,78],75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,129]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,130]},{33:[2,63]},{72:[1,132],76:131},{33:[1,133]},{33:[2,69]},{15:[2,12],18:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:134,74:135,75:[1,120]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,137],77:[1,136]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,138]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],54:[2,55],56:[2,20],60:[2,57],73:[2,81],82:[2,85],86:[2,18],90:[2,89],101:[2,53],104:[2,93],110:[2,19],111:[2,77],116:[2,97],119:[2,63],122:[2,69],135:[2,75],136:[2,32]},parseError:function(o,a){throw new Error(o)},parse:function(o){var a=this,l=[0],h=[null],u=[],p=this.table,d="",c=0,f=0,g=0;this.lexer.setInput(o),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,typeof this.lexer.yylloc>"u"&&(this.lexer.yylloc={});var m=this.lexer.yylloc;u.push(m);var y=this.lexer.options&&this.lexer.options.ranges;typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);function w(){var U;return U=a.lexer.lex()||1,typeof U!="number"&&(U=a.symbols_[U]||U),U}for(var _,v,b,x,E,N,$={},A,k,O,T;;){if(b=l[l.length-1],this.defaultActions[b]?x=this.defaultActions[b]:((_===null||typeof _>"u")&&(_=w()),x=p[b]&&p[b][_]),typeof x>"u"||!x.length||!x[0]){var I="";{T=[];for(A in p[b])this.terminals_[A]&&A>2&&T.push("'"+this.terminals_[A]+"'");this.lexer.showPosition?I="Parse error on line "+(c+1)+`:
`+this.lexer.showPosition()+`
Expecting `+T.join(", ")+", got '"+(this.terminals_[_]||_)+"'":I="Parse error on line "+(c+1)+": Unexpected "+(_==1?"end of input":"'"+(this.terminals_[_]||_)+"'"),this.parseError(I,{text:this.lexer.match,token:this.terminals_[_]||_,line:this.lexer.yylineno,loc:m,expected:T})}}if(x[0]instanceof Array&&x.length>1)throw new Error("Parse Error: multiple actions possible at state: "+b+", token: "+_);switch(x[0]){case 1:l.push(_),h.push(this.lexer.yytext),u.push(this.lexer.yylloc),l.push(x[1]),_=null,v?(_=v,v=null):(f=this.lexer.yyleng,d=this.lexer.yytext,c=this.lexer.yylineno,m=this.lexer.yylloc,g>0);break;case 2:if(k=this.productions_[x[1]][1],$.$=h[h.length-k],$._$={first_line:u[u.length-(k||1)].first_line,last_line:u[u.length-1].last_line,first_column:u[u.length-(k||1)].first_column,last_column:u[u.length-1].last_column},y&&($._$.range=[u[u.length-(k||1)].range[0],u[u.length-1].range[1]]),N=this.performAction.call($,d,f,c,this.yy,x[1],h,u),typeof N<"u")return N;k&&(l=l.slice(0,-1*k*2),h=h.slice(0,-1*k),u=u.slice(0,-1*k)),l.push(this.productions_[x[1]][0]),h.push($.$),u.push($._$),O=p[l[l.length-2]][l[l.length-1]],l.push(O);break;case 3:return!0}}return!0}},i=function(){var o={EOF:1,parseError:function(a,l){if(this.yy.parser)this.yy.parser.parseError(a,l);else throw new Error(a)},setInput:function(a){return this._input=a,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var a=this._input[0];this.yytext+=a,this.yyleng++,this.offset++,this.match+=a,this.matched+=a;var l=a.match(/(?:\r\n?|\n).*/g);return l?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),a},unput:function(a){var l=a.length,h=a.split(/(?:\r\n?|\n)/g);this._input=a+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-l-1),this.offset-=l;var u=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),h.length-1&&(this.yylineno-=h.length-1);var p=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:h?(h.length===u.length?this.yylloc.first_column:0)+u[u.length-h.length].length-h[0].length:this.yylloc.first_column-l},this.options.ranges&&(this.yylloc.range=[p[0],p[0]+this.yyleng-l]),this},more:function(){return this._more=!0,this},less:function(a){this.unput(this.match.slice(a))},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(a.length>20?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;return a.length<20&&(a+=this._input.substr(0,20-a.length)),(a.substr(0,20)+(a.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),l=new Array(a.length+1).join("-");return a+this.upcomingInput()+`
`+l+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,l,h,u,p;this._more||(this.yytext="",this.match="");for(var d=this._currentRules(),c=0;c<d.length&&(h=this._input.match(this.rules[d[c]]),!(h&&(!l||h[0].length>l[0].length)&&(l=h,u=c,!this.options.flex)));c++);return l?(p=l[0].match(/(?:\r\n?|\n).*/g),p&&(this.yylineno+=p.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:p?p[p.length-1].length-p[p.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+l[0].length},this.yytext+=l[0],this.match+=l[0],this.matches=l,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(l[0].length),this.matched+=l[0],a=this.performAction.call(this,this.yy,this,d[u],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),a||void 0):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();return typeof a<"u"?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(a){this.begin(a)}};return o.options={},o.performAction=function(a,l,h,u){function p(d,c){return l.yytext=l.yytext.substring(d,l.yyleng-c+d)}switch(h){case 0:if(l.yytext.slice(-2)==="\\\\"?(p(0,1),this.begin("mu")):l.yytext.slice(-1)==="\\"?(p(0,1),this.begin("emu")):this.begin("mu"),l.yytext)return 15;break;case 1:return 15;case 2:return this.popState(),15;case 3:return this.begin("raw"),15;case 4:return this.popState(),this.conditionStack[this.conditionStack.length-1]==="raw"?15:(p(5,9),"END_RAW_BLOCK");case 5:return 15;case 6:return this.popState(),14;case 7:return 65;case 8:return 68;case 9:return 19;case 10:return this.popState(),this.begin("raw"),23;case 11:return 55;case 12:return 60;case 13:return 29;case 14:return 47;case 15:return this.popState(),44;case 16:return this.popState(),44;case 17:return 34;case 18:return 39;case 19:return 51;case 20:return 48;case 21:this.unput(l.yytext),this.popState(),this.begin("com");break;case 22:return this.popState(),14;case 23:return 48;case 24:return 73;case 25:return 72;case 26:return 72;case 27:return 87;case 28:break;case 29:return this.popState(),54;case 30:return this.popState(),33;case 31:return l.yytext=p(1,2).replace(/\\"/g,'"'),80;case 32:return l.yytext=p(1,2).replace(/\\'/g,"'"),80;case 33:return 85;case 34:return 82;case 35:return 82;case 36:return 83;case 37:return 84;case 38:return 81;case 39:return 75;case 40:return 77;case 41:return 72;case 42:return l.yytext=l.yytext.replace(/\\([\\\]])/g,"$1"),72;case 43:return"INVALID";case 44:return 5}},o.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]+?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[(\\\]|[^\]])*\])/,/^(?:.)/,/^(?:$)/],o.conditions={mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[6],inclusive:!1},raw:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,44],inclusive:!0}},o}();r.lexer=i;function s(){this.yy={}}return s.prototype=r,r.Parser=s,new s}();n.default=t,e.exports=n.default}),so=q((n,e)=>{n.__esModule=!0;function t(h){return h&&h.__esModule?h:{default:h}}var r=Ke(),i=t(r);function s(){this.parents=[]}s.prototype={constructor:s,mutating:!1,acceptKey:function(h,u){var p=this.accept(h[u]);if(this.mutating){if(p&&!s.prototype[p.type])throw new i.default('Unexpected node type "'+p.type+'" found when accepting '+u+" on "+h.type);h[u]=p}},acceptRequired:function(h,u){if(this.acceptKey(h,u),!h[u])throw new i.default(h.type+" requires "+u)},acceptArray:function(h){for(var u=0,p=h.length;u<p;u++)this.acceptKey(h,u),h[u]||(h.splice(u,1),u--,p--)},accept:function(h){if(h){if(!this[h.type])throw new i.default("Unknown type: "+h.type,h);this.current&&this.parents.unshift(this.current),this.current=h;var u=this[h.type](h);if(this.current=this.parents.shift(),!this.mutating||u)return u;if(u!==!1)return h}},Program:function(h){this.acceptArray(h.body)},MustacheStatement:o,Decorator:o,BlockStatement:a,DecoratorBlock:a,PartialStatement:l,PartialBlockStatement:function(h){l.call(this,h),this.acceptKey(h,"program")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:o,PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(h){this.acceptArray(h.pairs)},HashPair:function(h){this.acceptRequired(h,"value")}};function o(h){this.acceptRequired(h,"path"),this.acceptArray(h.params),this.acceptKey(h,"hash")}function a(h){o.call(this,h),this.acceptKey(h,"program"),this.acceptKey(h,"inverse")}function l(h){this.acceptRequired(h,"name"),this.acceptArray(h.params),this.acceptKey(h,"hash")}n.default=s,e.exports=n.default}),Sf=q((n,e)=>{n.__esModule=!0;function t(u){return u&&u.__esModule?u:{default:u}}var r=so(),i=t(r);function s(){var u=arguments.length<=0||arguments[0]===void 0?{}:arguments[0];this.options=u}s.prototype=new i.default,s.prototype.Program=function(u){var p=!this.options.ignoreStandalone,d=!this.isRootSeen;this.isRootSeen=!0;for(var c=u.body,f=0,g=c.length;f<g;f++){var m=c[f],y=this.accept(m);if(y){var w=o(c,f,d),_=a(c,f,d),v=y.openStandalone&&w,b=y.closeStandalone&&_,x=y.inlineStandalone&&w&&_;y.close&&l(c,f,!0),y.open&&h(c,f,!0),p&&x&&(l(c,f),h(c,f)&&m.type==="PartialStatement"&&(m.indent=/([ \t]+$)/.exec(c[f-1].original)[1])),p&&v&&(l((m.program||m.inverse).body),h(c,f)),p&&b&&(l(c,f),h((m.inverse||m.program).body))}}return u},s.prototype.BlockStatement=s.prototype.DecoratorBlock=s.prototype.PartialBlockStatement=function(u){this.accept(u.program),this.accept(u.inverse);var p=u.program||u.inverse,d=u.program&&u.inverse,c=d,f=d;if(d&&d.chained)for(c=d.body[0].program;f.chained;)f=f.body[f.body.length-1].program;var g={open:u.openStrip.open,close:u.closeStrip.close,openStandalone:a(p.body),closeStandalone:o((c||p).body)};if(u.openStrip.close&&l(p.body,null,!0),d){var m=u.inverseStrip;m.open&&h(p.body,null,!0),m.close&&l(c.body,null,!0),u.closeStrip.open&&h(f.body,null,!0),!this.options.ignoreStandalone&&o(p.body)&&a(c.body)&&(h(p.body),l(c.body))}else u.closeStrip.open&&h(p.body,null,!0);return g},s.prototype.Decorator=s.prototype.MustacheStatement=function(u){return u.strip},s.prototype.PartialStatement=s.prototype.CommentStatement=function(u){var p=u.strip||{};return{inlineStandalone:!0,open:p.open,close:p.close}};function o(u,p,d){p===void 0&&(p=u.length);var c=u[p-1],f=u[p-2];if(!c)return d;if(c.type==="ContentStatement")return(f||!d?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(c.original)}function a(u,p,d){p===void 0&&(p=-1);var c=u[p+1],f=u[p+2];if(!c)return d;if(c.type==="ContentStatement")return(f||!d?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(c.original)}function l(u,p,d){var c=u[p==null?0:p+1];if(!(!c||c.type!=="ContentStatement"||!d&&c.rightStripped)){var f=c.value;c.value=c.value.replace(d?/^\s+/:/^[ \t]*\r?\n?/,""),c.rightStripped=c.value!==f}}function h(u,p,d){var c=u[p==null?u.length-1:p-1];if(!(!c||c.type!=="ContentStatement"||!d&&c.leftStripped)){var f=c.value;return c.value=c.value.replace(d?/\s+$/:/[ \t]+$/,""),c.leftStripped=c.value!==f,c.leftStripped}}n.default=s,e.exports=n.default}),Ef=q(n=>{n.__esModule=!0,n.SourceLocation=s,n.id=o,n.stripFlags=a,n.stripComment=l,n.preparePath=h,n.prepareMustache=u,n.prepareRawBlock=p,n.prepareBlock=d,n.prepareProgram=c,n.preparePartialBlock=f;function e(g){return g&&g.__esModule?g:{default:g}}var t=Ke(),r=e(t);function i(g,m){if(m=m.path?m.path.original:m,g.path.original!==m){var y={loc:g.path.loc};throw new r.default(g.path.original+" doesn't match "+m,y)}}function s(g,m){this.source=g,this.start={line:m.first_line,column:m.first_column},this.end={line:m.last_line,column:m.last_column}}function o(g){return/^\[.*\]$/.test(g)?g.substring(1,g.length-1):g}function a(g,m){return{open:g.charAt(2)==="~",close:m.charAt(m.length-3)==="~"}}function l(g){return g.replace(/^\{\{~?!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function h(g,m,y){y=this.locInfo(y);for(var w=g?"@":"",_=[],v=0,b=0,x=m.length;b<x;b++){var E=m[b].part,N=m[b].original!==E;if(w+=(m[b].separator||"")+E,!N&&(E===".."||E==="."||E==="this")){if(_.length>0)throw new r.default("Invalid path: "+w,{loc:y});E===".."&&v++}else _.push(E)}return{type:"PathExpression",data:g,depth:v,parts:_,original:w,loc:y}}function u(g,m,y,w,_,v){var b=w.charAt(3)||w.charAt(2),x=b!=="{"&&b!=="&",E=/\*/.test(w);return{type:E?"Decorator":"MustacheStatement",path:g,params:m,hash:y,escaped:x,strip:_,loc:this.locInfo(v)}}function p(g,m,y,w){i(g,y),w=this.locInfo(w);var _={type:"Program",body:m,strip:{},loc:w};return{type:"BlockStatement",path:g.path,params:g.params,hash:g.hash,program:_,openStrip:{},inverseStrip:{},closeStrip:{},loc:w}}function d(g,m,y,w,_,v){w&&w.path&&i(g,w);var b=/\*/.test(g.open);m.blockParams=g.blockParams;var x=void 0,E=void 0;if(y){if(b)throw new r.default("Unexpected inverse block on decorator",y);y.chain&&(y.program.body[0].closeStrip=w.strip),E=y.strip,x=y.program}return _&&(_=x,x=m,m=_),{type:b?"DecoratorBlock":"BlockStatement",path:g.path,params:g.params,hash:g.hash,program:m,inverse:x,openStrip:g.strip,inverseStrip:E,closeStrip:w&&w.strip,loc:this.locInfo(v)}}function c(g,m){if(!m&&g.length){var y=g[0].loc,w=g[g.length-1].loc;y&&w&&(m={source:y.source,start:{line:y.start.line,column:y.start.column},end:{line:w.end.line,column:w.end.column}})}return{type:"Program",body:g,strip:{},loc:m}}function f(g,m,y,w){return i(g,y),{type:"PartialBlockStatement",name:g.path,params:g.params,hash:g.hash,program:m,openStrip:g.strip,closeStrip:y&&y.strip,loc:this.locInfo(w)}}}),Af=q(n=>{n.__esModule=!0,n.parseWithoutProcessing=p,n.parse=d;function e(c){if(c&&c.__esModule)return c;var f={};if(c!=null)for(var g in c)Object.prototype.hasOwnProperty.call(c,g)&&(f[g]=c[g]);return f.default=c,f}function t(c){return c&&c.__esModule?c:{default:c}}var r=xf(),i=t(r),s=Sf(),o=t(s),a=Ef(),l=e(a),h=Ce();n.parser=i.default;var u={};h.extend(u,l);function p(c,f){if(c.type==="Program")return c;i.default.yy=u,u.locInfo=function(m){return new u.SourceLocation(f&&f.srcName,m)};var g=i.default.parse(c);return g}function d(c,f){var g=p(c,f),m=new o.default(f);return m.accept(g)}}),Of=q(n=>{n.__esModule=!0,n.Compiler=l,n.precompile=h,n.compile=u;function e(c){return c&&c.__esModule?c:{default:c}}var t=Ke(),r=e(t),i=Ce(),s=rc(),o=e(s),a=[].slice;function l(){}l.prototype={compiler:l,equals:function(c){var f=this.opcodes.length;if(c.opcodes.length!==f)return!1;for(var g=0;g<f;g++){var m=this.opcodes[g],y=c.opcodes[g];if(m.opcode!==y.opcode||!p(m.args,y.args))return!1}f=this.children.length;for(var g=0;g<f;g++)if(!this.children[g].equals(c.children[g]))return!1;return!0},guid:0,compile:function(c,f){return this.sourceNode=[],this.opcodes=[],this.children=[],this.options=f,this.stringParams=f.stringParams,this.trackIds=f.trackIds,f.blockParams=f.blockParams||[],f.knownHelpers=i.extend(Object.create(null),{helperMissing:!0,blockHelperMissing:!0,each:!0,if:!0,unless:!0,with:!0,log:!0,lookup:!0},f.knownHelpers),this.accept(c)},compileProgram:function(c){var f=new this.compiler,g=f.compile(c,this.options),m=this.guid++;return this.usePartial=this.usePartial||g.usePartial,this.children[m]=g,this.useDepths=this.useDepths||g.useDepths,m},accept:function(c){if(!this[c.type])throw new r.default("Unknown type: "+c.type,c);this.sourceNode.unshift(c);var f=this[c.type](c);return this.sourceNode.shift(),f},Program:function(c){this.options.blockParams.unshift(c.blockParams);for(var f=c.body,g=f.length,m=0;m<g;m++)this.accept(f[m]);return this.options.blockParams.shift(),this.isSimple=g===1,this.blockParams=c.blockParams?c.blockParams.length:0,this},BlockStatement:function(c){d(c);var f=c.program,g=c.inverse;f=f&&this.compileProgram(f),g=g&&this.compileProgram(g);var m=this.classifySexpr(c);m==="helper"?this.helperSexpr(c,f,g):m==="simple"?(this.simpleSexpr(c),this.opcode("pushProgram",f),this.opcode("pushProgram",g),this.opcode("emptyHash"),this.opcode("blockValue",c.path.original)):(this.ambiguousSexpr(c,f,g),this.opcode("pushProgram",f),this.opcode("pushProgram",g),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},DecoratorBlock:function(c){var f=c.program&&this.compileProgram(c.program),g=this.setupFullMustacheParams(c,f,void 0),m=c.path;this.useDecorators=!0,this.opcode("registerDecorator",g.length,m.original)},PartialStatement:function(c){this.usePartial=!0;var f=c.program;f&&(f=this.compileProgram(c.program));var g=c.params;if(g.length>1)throw new r.default("Unsupported number of partial arguments: "+g.length,c);g.length||(this.options.explicitPartialContext?this.opcode("pushLiteral","undefined"):g.push({type:"PathExpression",parts:[],depth:0}));var m=c.name.original,y=c.name.type==="SubExpression";y&&this.accept(c.name),this.setupFullMustacheParams(c,f,void 0,!0);var w=c.indent||"";this.options.preventIndent&&w&&(this.opcode("appendContent",w),w=""),this.opcode("invokePartial",y,m,w),this.opcode("append")},PartialBlockStatement:function(c){this.PartialStatement(c)},MustacheStatement:function(c){this.SubExpression(c),c.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},Decorator:function(c){this.DecoratorBlock(c)},ContentStatement:function(c){c.value&&this.opcode("appendContent",c.value)},CommentStatement:function(){},SubExpression:function(c){d(c);var f=this.classifySexpr(c);f==="simple"?this.simpleSexpr(c):f==="helper"?this.helperSexpr(c):this.ambiguousSexpr(c)},ambiguousSexpr:function(c,f,g){var m=c.path,y=m.parts[0],w=f!=null||g!=null;this.opcode("getContext",m.depth),this.opcode("pushProgram",f),this.opcode("pushProgram",g),m.strict=!0,this.accept(m),this.opcode("invokeAmbiguous",y,w)},simpleSexpr:function(c){var f=c.path;f.strict=!0,this.accept(f),this.opcode("resolvePossibleLambda")},helperSexpr:function(c,f,g){var m=this.setupFullMustacheParams(c,f,g),y=c.path,w=y.parts[0];if(this.options.knownHelpers[w])this.opcode("invokeKnownHelper",m.length,w);else{if(this.options.knownHelpersOnly)throw new r.default("You specified knownHelpersOnly, but used the unknown helper "+w,c);y.strict=!0,y.falsy=!0,this.accept(y),this.opcode("invokeHelper",m.length,y.original,o.default.helpers.simpleId(y))}},PathExpression:function(c){this.addDepth(c.depth),this.opcode("getContext",c.depth);var f=c.parts[0],g=o.default.helpers.scopedId(c),m=!c.depth&&!g&&this.blockParamIndex(f);m?this.opcode("lookupBlockParam",m,c.parts):f?c.data?(this.options.data=!0,this.opcode("lookupData",c.depth,c.parts,c.strict)):this.opcode("lookupOnContext",c.parts,c.falsy,c.strict,g):this.opcode("pushContext")},StringLiteral:function(c){this.opcode("pushString",c.value)},NumberLiteral:function(c){this.opcode("pushLiteral",c.value)},BooleanLiteral:function(c){this.opcode("pushLiteral",c.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(c){var f=c.pairs,g=0,m=f.length;for(this.opcode("pushHash");g<m;g++)this.pushParam(f[g].value);for(;g--;)this.opcode("assignToHash",f[g].key);this.opcode("popHash")},opcode:function(c){this.opcodes.push({opcode:c,args:a.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(c){c&&(this.useDepths=!0)},classifySexpr:function(c){var f=o.default.helpers.simpleId(c.path),g=f&&!!this.blockParamIndex(c.path.parts[0]),m=!g&&o.default.helpers.helperExpression(c),y=!g&&(m||f);if(y&&!m){var w=c.path.parts[0],_=this.options;_.knownHelpers[w]?m=!0:_.knownHelpersOnly&&(y=!1)}return m?"helper":y?"ambiguous":"simple"},pushParams:function(c){for(var f=0,g=c.length;f<g;f++)this.pushParam(c[f])},pushParam:function(c){var f=c.value!=null?c.value:c.original||"";if(this.stringParams)f.replace&&(f=f.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),c.depth&&this.addDepth(c.depth),this.opcode("getContext",c.depth||0),this.opcode("pushStringParam",f,c.type),c.type==="SubExpression"&&this.accept(c);else{if(this.trackIds){var g=void 0;if(c.parts&&!o.default.helpers.scopedId(c)&&!c.depth&&(g=this.blockParamIndex(c.parts[0])),g){var m=c.parts.slice(1).join(".");this.opcode("pushId","BlockParam",g,m)}else f=c.original||f,f.replace&&(f=f.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")),this.opcode("pushId",c.type,f)}this.accept(c)}},setupFullMustacheParams:function(c,f,g,m){var y=c.params;return this.pushParams(y),this.opcode("pushProgram",f),this.opcode("pushProgram",g),c.hash?this.accept(c.hash):this.opcode("emptyHash",m),y},blockParamIndex:function(c){for(var f=0,g=this.options.blockParams.length;f<g;f++){var m=this.options.blockParams[f],y=m&&i.indexOf(m,c);if(m&&y>=0)return[f,y]}}};function h(c,f,g){if(c==null||typeof c!="string"&&c.type!=="Program")throw new r.default("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+c);f=f||{},"data"in f||(f.data=!0),f.compat&&(f.useDepths=!0);var m=g.parse(c,f),y=new g.Compiler().compile(m,f);return new g.JavaScriptCompiler().compile(y,f)}function u(c,f,g){if(f===void 0&&(f={}),c==null||typeof c!="string"&&c.type!=="Program")throw new r.default("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+c);f=i.extend({},f),"data"in f||(f.data=!0),f.compat&&(f.useDepths=!0);var m=void 0;function y(){var _=g.parse(c,f),v=new g.Compiler().compile(_,f),b=new g.JavaScriptCompiler().compile(v,f,void 0,!0);return g.template(b)}function w(_,v){return m||(m=y()),m.call(this,_,v)}return w._setup=function(_){return m||(m=y()),m._setup(_)},w._child=function(_,v,b,x){return m||(m=y()),m._child(_,v,b,x)},w}function p(c,f){if(c===f)return!0;if(i.isArray(c)&&i.isArray(f)&&c.length===f.length){for(var g=0;g<c.length;g++)if(!p(c[g],f[g]))return!1;return!0}}function d(c){if(!c.path.parts){var f=c.path;c.path={type:"PathExpression",data:!1,depth:0,parts:[f.original+""],original:f.original+"",loc:f.loc}}}}),Cf=q(n=>{var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");n.encode=function(t){if(0<=t&&t<e.length)return e[t];throw new TypeError("Must be between 0 and 63: "+t)},n.decode=function(t){var r=65,i=90,s=97,o=122,a=48,l=57,h=43,u=47,p=26,d=52;return r<=t&&t<=i?t-r:s<=t&&t<=o?t-s+p:a<=t&&t<=l?t-a+d:t==h?62:t==u?63:-1}}),ic=q(n=>{var e=Cf(),t=5,r=1<<t,i=r-1,s=r;function o(l){return l<0?(-l<<1)+1:(l<<1)+0}function a(l){var h=(l&1)===1,u=l>>1;return h?-u:u}n.encode=function(l){var h="",u,p=o(l);do u=p&i,p>>>=t,p>0&&(u|=s),h+=e.encode(u);while(p>0);return h},n.decode=function(l,h,u){var p=l.length,d=0,c=0,f,g;do{if(h>=p)throw new Error("Expected more digits in base 64 VLQ value.");if(g=e.decode(l.charCodeAt(h++)),g===-1)throw new Error("Invalid base64 digit: "+l.charAt(h-1));f=!!(g&s),g&=i,d=d+(g<<c),c+=t}while(f);u.value=a(d),u.rest=h}}),tr=q(n=>{function e(v,b,x){if(b in v)return v[b];if(arguments.length===3)return x;throw new Error('"'+b+'" is a required argument.')}n.getArg=e;var t=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,r=/^data:.+\,.+$/;function i(v){var b=v.match(t);return b?{scheme:b[1],auth:b[2],host:b[3],port:b[4],path:b[5]}:null}n.urlParse=i;function s(v){var b="";return v.scheme&&(b+=v.scheme+":"),b+="//",v.auth&&(b+=v.auth+"@"),v.host&&(b+=v.host),v.port&&(b+=":"+v.port),v.path&&(b+=v.path),b}n.urlGenerate=s;function o(v){var b=v,x=i(v);if(x){if(!x.path)return v;b=x.path}for(var E=n.isAbsolute(b),N=b.split(/\/+/),$,A=0,k=N.length-1;k>=0;k--)$=N[k],$==="."?N.splice(k,1):$===".."?A++:A>0&&($===""?(N.splice(k+1,A),A=0):(N.splice(k,2),A--));return b=N.join("/"),b===""&&(b=E?"/":"."),x?(x.path=b,s(x)):b}n.normalize=o;function a(v,b){v===""&&(v="."),b===""&&(b=".");var x=i(b),E=i(v);if(E&&(v=E.path||"/"),x&&!x.scheme)return E&&(x.scheme=E.scheme),s(x);if(x||b.match(r))return b;if(E&&!E.host&&!E.path)return E.host=b,s(E);var N=b.charAt(0)==="/"?b:o(v.replace(/\/+$/,"")+"/"+b);return E?(E.path=N,s(E)):N}n.join=a,n.isAbsolute=function(v){return v.charAt(0)==="/"||t.test(v)};function l(v,b){v===""&&(v="."),v=v.replace(/\/$/,"");for(var x=0;b.indexOf(v+"/")!==0;){var E=v.lastIndexOf("/");if(E<0||(v=v.slice(0,E),v.match(/^([^\/]+:\/)?\/*$/)))return b;++x}return Array(x+1).join("../")+b.substr(v.length+1)}n.relative=l;var h=function(){var v=Object.create(null);return!("__proto__"in v)}();function u(v){return v}function p(v){return c(v)?"$"+v:v}n.toSetString=h?u:p;function d(v){return c(v)?v.slice(1):v}n.fromSetString=h?u:d;function c(v){if(!v)return!1;var b=v.length;if(b<9||v.charCodeAt(b-1)!==95||v.charCodeAt(b-2)!==95||v.charCodeAt(b-3)!==111||v.charCodeAt(b-4)!==116||v.charCodeAt(b-5)!==111||v.charCodeAt(b-6)!==114||v.charCodeAt(b-7)!==112||v.charCodeAt(b-8)!==95||v.charCodeAt(b-9)!==95)return!1;for(var x=b-10;x>=0;x--)if(v.charCodeAt(x)!==36)return!1;return!0}function f(v,b,x){var E=m(v.source,b.source);return E!==0||(E=v.originalLine-b.originalLine,E!==0)||(E=v.originalColumn-b.originalColumn,E!==0||x)||(E=v.generatedColumn-b.generatedColumn,E!==0)||(E=v.generatedLine-b.generatedLine,E!==0)?E:m(v.name,b.name)}n.compareByOriginalPositions=f;function g(v,b,x){var E=v.generatedLine-b.generatedLine;return E!==0||(E=v.generatedColumn-b.generatedColumn,E!==0||x)||(E=m(v.source,b.source),E!==0)||(E=v.originalLine-b.originalLine,E!==0)||(E=v.originalColumn-b.originalColumn,E!==0)?E:m(v.name,b.name)}n.compareByGeneratedPositionsDeflated=g;function m(v,b){return v===b?0:v===null?1:b===null?-1:v>b?1:-1}function y(v,b){var x=v.generatedLine-b.generatedLine;return x!==0||(x=v.generatedColumn-b.generatedColumn,x!==0)||(x=m(v.source,b.source),x!==0)||(x=v.originalLine-b.originalLine,x!==0)||(x=v.originalColumn-b.originalColumn,x!==0)?x:m(v.name,b.name)}n.compareByGeneratedPositionsInflated=y;function w(v){return JSON.parse(v.replace(/^\)]}'[^\n]*\n/,""))}n.parseSourceMapInput=w;function _(v,b,x){if(b=b||"",v&&(v[v.length-1]!=="/"&&b[0]!=="/"&&(v+="/"),b=v+b),x){var E=i(x);if(!E)throw new Error("sourceMapURL could not be parsed");if(E.path){var N=E.path.lastIndexOf("/");N>=0&&(E.path=E.path.substring(0,N+1))}b=a(s(E),b)}return o(b)}n.computeSourceURL=_}),sc=q(n=>{var e=tr(),t=Object.prototype.hasOwnProperty,r=typeof Map<"u";function i(){this._array=[],this._set=r?new Map:Object.create(null)}i.fromArray=function(s,o){for(var a=new i,l=0,h=s.length;l<h;l++)a.add(s[l],o);return a},i.prototype.size=function(){return r?this._set.size:Object.getOwnPropertyNames(this._set).length},i.prototype.add=function(s,o){var a=r?s:e.toSetString(s),l=r?this.has(s):t.call(this._set,a),h=this._array.length;(!l||o)&&this._array.push(s),l||(r?this._set.set(s,h):this._set[a]=h)},i.prototype.has=function(s){if(r)return this._set.has(s);var o=e.toSetString(s);return t.call(this._set,o)},i.prototype.indexOf=function(s){if(r){var o=this._set.get(s);if(o>=0)return o}else{var a=e.toSetString(s);if(t.call(this._set,a))return this._set[a]}throw new Error('"'+s+'" is not in the set.')},i.prototype.at=function(s){if(s>=0&&s<this._array.length)return this._array[s];throw new Error("No element indexed by "+s)},i.prototype.toArray=function(){return this._array.slice()},n.ArraySet=i}),Tf=q(n=>{var e=tr();function t(i,s){var o=i.generatedLine,a=s.generatedLine,l=i.generatedColumn,h=s.generatedColumn;return a>o||a==o&&h>=l||e.compareByGeneratedPositionsInflated(i,s)<=0}function r(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}r.prototype.unsortedForEach=function(i,s){this._array.forEach(i,s)},r.prototype.add=function(i){t(this._last,i)?(this._last=i,this._array.push(i)):(this._sorted=!1,this._array.push(i))},r.prototype.toArray=function(){return this._sorted||(this._array.sort(e.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},n.MappingList=r}),oc=q(n=>{var e=ic(),t=tr(),r=sc().ArraySet,i=Tf().MappingList;function s(o){o||(o={}),this._file=t.getArg(o,"file",null),this._sourceRoot=t.getArg(o,"sourceRoot",null),this._skipValidation=t.getArg(o,"skipValidation",!1),this._sources=new r,this._names=new r,this._mappings=new i,this._sourcesContents=null}s.prototype._version=3,s.fromSourceMap=function(o){var a=o.sourceRoot,l=new s({file:o.file,sourceRoot:a});return o.eachMapping(function(h){var u={generated:{line:h.generatedLine,column:h.generatedColumn}};h.source!=null&&(u.source=h.source,a!=null&&(u.source=t.relative(a,u.source)),u.original={line:h.originalLine,column:h.originalColumn},h.name!=null&&(u.name=h.name)),l.addMapping(u)}),o.sources.forEach(function(h){var u=h;a!==null&&(u=t.relative(a,h)),l._sources.has(u)||l._sources.add(u);var p=o.sourceContentFor(h);p!=null&&l.setSourceContent(h,p)}),l},s.prototype.addMapping=function(o){var a=t.getArg(o,"generated"),l=t.getArg(o,"original",null),h=t.getArg(o,"source",null),u=t.getArg(o,"name",null);this._skipValidation||this._validateMapping(a,l,h,u),h!=null&&(h=String(h),this._sources.has(h)||this._sources.add(h)),u!=null&&(u=String(u),this._names.has(u)||this._names.add(u)),this._mappings.add({generatedLine:a.line,generatedColumn:a.column,originalLine:l!=null&&l.line,originalColumn:l!=null&&l.column,source:h,name:u})},s.prototype.setSourceContent=function(o,a){var l=o;this._sourceRoot!=null&&(l=t.relative(this._sourceRoot,l)),a!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[t.toSetString(l)]=a):this._sourcesContents&&(delete this._sourcesContents[t.toSetString(l)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))},s.prototype.applySourceMap=function(o,a,l){var h=a;if(a==null){if(o.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);h=o.file}var u=this._sourceRoot;u!=null&&(h=t.relative(u,h));var p=new r,d=new r;this._mappings.unsortedForEach(function(c){if(c.source===h&&c.originalLine!=null){var f=o.originalPositionFor({line:c.originalLine,column:c.originalColumn});f.source!=null&&(c.source=f.source,l!=null&&(c.source=t.join(l,c.source)),u!=null&&(c.source=t.relative(u,c.source)),c.originalLine=f.line,c.originalColumn=f.column,f.name!=null&&(c.name=f.name))}var g=c.source;g!=null&&!p.has(g)&&p.add(g);var m=c.name;m!=null&&!d.has(m)&&d.add(m)},this),this._sources=p,this._names=d,o.sources.forEach(function(c){var f=o.sourceContentFor(c);f!=null&&(l!=null&&(c=t.join(l,c)),u!=null&&(c=t.relative(u,c)),this.setSourceContent(c,f))},this)},s.prototype._validateMapping=function(o,a,l,h){if(a&&typeof a.line!="number"&&typeof a.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(o&&"line"in o&&"column"in o&&o.line>0&&o.column>=0&&!a&&!l&&!h)){if(o&&"line"in o&&"column"in o&&a&&"line"in a&&"column"in a&&o.line>0&&o.column>=0&&a.line>0&&a.column>=0&&l)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:o,source:l,original:a,name:h}))}},s.prototype._serializeMappings=function(){for(var o=0,a=1,l=0,h=0,u=0,p=0,d="",c,f,g,m,y=this._mappings.toArray(),w=0,_=y.length;w<_;w++){if(f=y[w],c="",f.generatedLine!==a)for(o=0;f.generatedLine!==a;)c+=";",a++;else if(w>0){if(!t.compareByGeneratedPositionsInflated(f,y[w-1]))continue;c+=","}c+=e.encode(f.generatedColumn-o),o=f.generatedColumn,f.source!=null&&(m=this._sources.indexOf(f.source),c+=e.encode(m-p),p=m,c+=e.encode(f.originalLine-1-h),h=f.originalLine-1,c+=e.encode(f.originalColumn-l),l=f.originalColumn,f.name!=null&&(g=this._names.indexOf(f.name),c+=e.encode(g-u),u=g)),d+=c}return d},s.prototype._generateSourcesContent=function(o,a){return o.map(function(l){if(!this._sourcesContents)return null;a!=null&&(l=t.relative(a,l));var h=t.toSetString(l);return Object.prototype.hasOwnProperty.call(this._sourcesContents,h)?this._sourcesContents[h]:null},this)},s.prototype.toJSON=function(){var o={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(o.file=this._file),this._sourceRoot!=null&&(o.sourceRoot=this._sourceRoot),this._sourcesContents&&(o.sourcesContent=this._generateSourcesContent(o.sources,o.sourceRoot)),o},s.prototype.toString=function(){return JSON.stringify(this.toJSON())},n.SourceMapGenerator=s}),Rf=q(n=>{n.GREATEST_LOWER_BOUND=1,n.LEAST_UPPER_BOUND=2;function e(t,r,i,s,o,a){var l=Math.floor((r-t)/2)+t,h=o(i,s[l],!0);return h===0?l:h>0?r-l>1?e(l,r,i,s,o,a):a==n.LEAST_UPPER_BOUND?r<s.length?r:-1:l:l-t>1?e(t,l,i,s,o,a):a==n.LEAST_UPPER_BOUND?l:t<0?-1:t}n.search=function(t,r,i,s){if(r.length===0)return-1;var o=e(-1,r.length,t,r,i,s||n.GREATEST_LOWER_BOUND);if(o<0)return-1;for(;o-1>=0&&i(r[o],r[o-1],!0)===0;)--o;return o}}),If=q(n=>{function e(i,s,o){var a=i[s];i[s]=i[o],i[o]=a}function t(i,s){return Math.round(i+Math.random()*(s-i))}function r(i,s,o,a){if(o<a){var l=t(o,a),h=o-1;e(i,l,a);for(var u=i[a],p=o;p<a;p++)s(i[p],u)<=0&&(h+=1,e(i,h,p));e(i,h+1,p);var d=h+1;r(i,s,o,d-1),r(i,s,d+1,a)}}n.quickSort=function(i,s){r(i,s,0,i.length-1)}}),Pf=q(n=>{var e=tr(),t=Rf(),r=sc().ArraySet,i=ic(),s=If().quickSort;function o(u,p){var d=u;return typeof u=="string"&&(d=e.parseSourceMapInput(u)),d.sections!=null?new h(d,p):new a(d,p)}o.fromSourceMap=function(u,p){return a.fromSourceMap(u,p)},o.prototype._version=3,o.prototype.__generatedMappings=null,Object.defineProperty(o.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),o.prototype.__originalMappings=null,Object.defineProperty(o.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),o.prototype._charIsMappingSeparator=function(u,p){var d=u.charAt(p);return d===";"||d===","},o.prototype._parseMappings=function(u,p){throw new Error("Subclasses must implement _parseMappings")},o.GENERATED_ORDER=1,o.ORIGINAL_ORDER=2,o.GREATEST_LOWER_BOUND=1,o.LEAST_UPPER_BOUND=2,o.prototype.eachMapping=function(u,p,d){var c=p||null,f=d||o.GENERATED_ORDER,g;switch(f){case o.GENERATED_ORDER:g=this._generatedMappings;break;case o.ORIGINAL_ORDER:g=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var m=this.sourceRoot;g.map(function(y){var w=y.source===null?null:this._sources.at(y.source);return w=e.computeSourceURL(m,w,this._sourceMapURL),{source:w,generatedLine:y.generatedLine,generatedColumn:y.generatedColumn,originalLine:y.originalLine,originalColumn:y.originalColumn,name:y.name===null?null:this._names.at(y.name)}},this).forEach(u,c)},o.prototype.allGeneratedPositionsFor=function(u){var p=e.getArg(u,"line"),d={source:e.getArg(u,"source"),originalLine:p,originalColumn:e.getArg(u,"column",0)};if(d.source=this._findSourceIndex(d.source),d.source<0)return[];var c=[],f=this._findMapping(d,this._originalMappings,"originalLine","originalColumn",e.compareByOriginalPositions,t.LEAST_UPPER_BOUND);if(f>=0){var g=this._originalMappings[f];if(u.column===void 0)for(var m=g.originalLine;g&&g.originalLine===m;)c.push({line:e.getArg(g,"generatedLine",null),column:e.getArg(g,"generatedColumn",null),lastColumn:e.getArg(g,"lastGeneratedColumn",null)}),g=this._originalMappings[++f];else for(var y=g.originalColumn;g&&g.originalLine===p&&g.originalColumn==y;)c.push({line:e.getArg(g,"generatedLine",null),column:e.getArg(g,"generatedColumn",null),lastColumn:e.getArg(g,"lastGeneratedColumn",null)}),g=this._originalMappings[++f]}return c},n.SourceMapConsumer=o;function a(u,p){var d=u;typeof u=="string"&&(d=e.parseSourceMapInput(u));var c=e.getArg(d,"version"),f=e.getArg(d,"sources"),g=e.getArg(d,"names",[]),m=e.getArg(d,"sourceRoot",null),y=e.getArg(d,"sourcesContent",null),w=e.getArg(d,"mappings"),_=e.getArg(d,"file",null);if(c!=this._version)throw new Error("Unsupported version: "+c);m&&(m=e.normalize(m)),f=f.map(String).map(e.normalize).map(function(v){return m&&e.isAbsolute(m)&&e.isAbsolute(v)?e.relative(m,v):v}),this._names=r.fromArray(g.map(String),!0),this._sources=r.fromArray(f,!0),this._absoluteSources=this._sources.toArray().map(function(v){return e.computeSourceURL(m,v,p)}),this.sourceRoot=m,this.sourcesContent=y,this._mappings=w,this._sourceMapURL=p,this.file=_}a.prototype=Object.create(o.prototype),a.prototype.consumer=o,a.prototype._findSourceIndex=function(u){var p=u;if(this.sourceRoot!=null&&(p=e.relative(this.sourceRoot,p)),this._sources.has(p))return this._sources.indexOf(p);var d;for(d=0;d<this._absoluteSources.length;++d)if(this._absoluteSources[d]==u)return d;return-1},a.fromSourceMap=function(u,p){var d=Object.create(a.prototype),c=d._names=r.fromArray(u._names.toArray(),!0),f=d._sources=r.fromArray(u._sources.toArray(),!0);d.sourceRoot=u._sourceRoot,d.sourcesContent=u._generateSourcesContent(d._sources.toArray(),d.sourceRoot),d.file=u._file,d._sourceMapURL=p,d._absoluteSources=d._sources.toArray().map(function(x){return e.computeSourceURL(d.sourceRoot,x,p)});for(var g=u._mappings.toArray().slice(),m=d.__generatedMappings=[],y=d.__originalMappings=[],w=0,_=g.length;w<_;w++){var v=g[w],b=new l;b.generatedLine=v.generatedLine,b.generatedColumn=v.generatedColumn,v.source&&(b.source=f.indexOf(v.source),b.originalLine=v.originalLine,b.originalColumn=v.originalColumn,v.name&&(b.name=c.indexOf(v.name)),y.push(b)),m.push(b)}return s(d.__originalMappings,e.compareByOriginalPositions),d},a.prototype._version=3,Object.defineProperty(a.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function l(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}a.prototype._parseMappings=function(u,p){for(var d=1,c=0,f=0,g=0,m=0,y=0,w=u.length,_=0,v={},b={},x=[],E=[],N,$,A,k,O;_<w;)if(u.charAt(_)===";")d++,_++,c=0;else if(u.charAt(_)===",")_++;else{for(N=new l,N.generatedLine=d,k=_;k<w&&!this._charIsMappingSeparator(u,k);k++);if($=u.slice(_,k),A=v[$],A)_+=$.length;else{for(A=[];_<k;)i.decode(u,_,b),O=b.value,_=b.rest,A.push(O);if(A.length===2)throw new Error("Found a source, but no line and column");if(A.length===3)throw new Error("Found a source and line, but no column");v[$]=A}N.generatedColumn=c+A[0],c=N.generatedColumn,A.length>1&&(N.source=m+A[1],m+=A[1],N.originalLine=f+A[2],f=N.originalLine,N.originalLine+=1,N.originalColumn=g+A[3],g=N.originalColumn,A.length>4&&(N.name=y+A[4],y+=A[4])),E.push(N),typeof N.originalLine=="number"&&x.push(N)}s(E,e.compareByGeneratedPositionsDeflated),this.__generatedMappings=E,s(x,e.compareByOriginalPositions),this.__originalMappings=x},a.prototype._findMapping=function(u,p,d,c,f,g){if(u[d]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+u[d]);if(u[c]<0)throw new TypeError("Column must be greater than or equal to 0, got "+u[c]);return t.search(u,p,f,g)},a.prototype.computeColumnSpans=function(){for(var u=0;u<this._generatedMappings.length;++u){var p=this._generatedMappings[u];if(u+1<this._generatedMappings.length){var d=this._generatedMappings[u+1];if(p.generatedLine===d.generatedLine){p.lastGeneratedColumn=d.generatedColumn-1;continue}}p.lastGeneratedColumn=1/0}},a.prototype.originalPositionFor=function(u){var p={generatedLine:e.getArg(u,"line"),generatedColumn:e.getArg(u,"column")},d=this._findMapping(p,this._generatedMappings,"generatedLine","generatedColumn",e.compareByGeneratedPositionsDeflated,e.getArg(u,"bias",o.GREATEST_LOWER_BOUND));if(d>=0){var c=this._generatedMappings[d];if(c.generatedLine===p.generatedLine){var f=e.getArg(c,"source",null);f!==null&&(f=this._sources.at(f),f=e.computeSourceURL(this.sourceRoot,f,this._sourceMapURL));var g=e.getArg(c,"name",null);return g!==null&&(g=this._names.at(g)),{source:f,line:e.getArg(c,"originalLine",null),column:e.getArg(c,"originalColumn",null),name:g}}}return{source:null,line:null,column:null,name:null}},a.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(u){return u==null}):!1},a.prototype.sourceContentFor=function(u,p){if(!this.sourcesContent)return null;var d=this._findSourceIndex(u);if(d>=0)return this.sourcesContent[d];var c=u;this.sourceRoot!=null&&(c=e.relative(this.sourceRoot,c));var f;if(this.sourceRoot!=null&&(f=e.urlParse(this.sourceRoot))){var g=c.replace(/^file:\/\//,"");if(f.scheme=="file"&&this._sources.has(g))return this.sourcesContent[this._sources.indexOf(g)];if((!f.path||f.path=="/")&&this._sources.has("/"+c))return this.sourcesContent[this._sources.indexOf("/"+c)]}if(p)return null;throw new Error('"'+c+'" is not in the SourceMap.')},a.prototype.generatedPositionFor=function(u){var p=e.getArg(u,"source");if(p=this._findSourceIndex(p),p<0)return{line:null,column:null,lastColumn:null};var d={source:p,originalLine:e.getArg(u,"line"),originalColumn:e.getArg(u,"column")},c=this._findMapping(d,this._originalMappings,"originalLine","originalColumn",e.compareByOriginalPositions,e.getArg(u,"bias",o.GREATEST_LOWER_BOUND));if(c>=0){var f=this._originalMappings[c];if(f.source===d.source)return{line:e.getArg(f,"generatedLine",null),column:e.getArg(f,"generatedColumn",null),lastColumn:e.getArg(f,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},n.BasicSourceMapConsumer=a;function h(u,p){var d=u;typeof u=="string"&&(d=e.parseSourceMapInput(u));var c=e.getArg(d,"version"),f=e.getArg(d,"sections");if(c!=this._version)throw new Error("Unsupported version: "+c);this._sources=new r,this._names=new r;var g={line:-1,column:0};this._sections=f.map(function(m){if(m.url)throw new Error("Support for url field in sections not implemented.");var y=e.getArg(m,"offset"),w=e.getArg(y,"line"),_=e.getArg(y,"column");if(w<g.line||w===g.line&&_<g.column)throw new Error("Section offsets must be ordered and non-overlapping.");return g=y,{generatedOffset:{generatedLine:w+1,generatedColumn:_+1},consumer:new o(e.getArg(m,"map"),p)}})}h.prototype=Object.create(o.prototype),h.prototype.constructor=o,h.prototype._version=3,Object.defineProperty(h.prototype,"sources",{get:function(){for(var u=[],p=0;p<this._sections.length;p++)for(var d=0;d<this._sections[p].consumer.sources.length;d++)u.push(this._sections[p].consumer.sources[d]);return u}}),h.prototype.originalPositionFor=function(u){var p={generatedLine:e.getArg(u,"line"),generatedColumn:e.getArg(u,"column")},d=t.search(p,this._sections,function(f,g){var m=f.generatedLine-g.generatedOffset.generatedLine;return m||f.generatedColumn-g.generatedOffset.generatedColumn}),c=this._sections[d];return c?c.consumer.originalPositionFor({line:p.generatedLine-(c.generatedOffset.generatedLine-1),column:p.generatedColumn-(c.generatedOffset.generatedLine===p.generatedLine?c.generatedOffset.generatedColumn-1:0),bias:u.bias}):{source:null,line:null,column:null,name:null}},h.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(u){return u.consumer.hasContentsOfAllSources()})},h.prototype.sourceContentFor=function(u,p){for(var d=0;d<this._sections.length;d++){var c=this._sections[d],f=c.consumer.sourceContentFor(u,!0);if(f)return f}if(p)return null;throw new Error('"'+u+'" is not in the SourceMap.')},h.prototype.generatedPositionFor=function(u){for(var p=0;p<this._sections.length;p++){var d=this._sections[p];if(d.consumer._findSourceIndex(e.getArg(u,"source"))!==-1){var c=d.consumer.generatedPositionFor(u);if(c){var f={line:c.line+(d.generatedOffset.generatedLine-1),column:c.column+(d.generatedOffset.generatedLine===c.line?d.generatedOffset.generatedColumn-1:0)};return f}}}return{line:null,column:null}},h.prototype._parseMappings=function(u,p){this.__generatedMappings=[],this.__originalMappings=[];for(var d=0;d<this._sections.length;d++)for(var c=this._sections[d],f=c.consumer._generatedMappings,g=0;g<f.length;g++){var m=f[g],y=c.consumer._sources.at(m.source);y=e.computeSourceURL(c.consumer.sourceRoot,y,this._sourceMapURL),this._sources.add(y),y=this._sources.indexOf(y);var w=null;m.name&&(w=c.consumer._names.at(m.name),this._names.add(w),w=this._names.indexOf(w));var _={source:y,generatedLine:m.generatedLine+(c.generatedOffset.generatedLine-1),generatedColumn:m.generatedColumn+(c.generatedOffset.generatedLine===m.generatedLine?c.generatedOffset.generatedColumn-1:0),originalLine:m.originalLine,originalColumn:m.originalColumn,name:w};this.__generatedMappings.push(_),typeof _.originalLine=="number"&&this.__originalMappings.push(_)}s(this.__generatedMappings,e.compareByGeneratedPositionsDeflated),s(this.__originalMappings,e.compareByOriginalPositions)},n.IndexedSourceMapConsumer=h}),Nf=q(n=>{var e=oc().SourceMapGenerator,t=tr(),r=/(\r?\n)/,i=10,s="$$$isSourceNode$$$";function o(a,l,h,u,p){this.children=[],this.sourceContents={},this.line=a??null,this.column=l??null,this.source=h??null,this.name=p??null,this[s]=!0,u!=null&&this.add(u)}o.fromStringWithSourceMap=function(a,l,h){var u=new o,p=a.split(r),d=0,c=function(){var w=v(),_=v()||"";return w+_;function v(){return d<p.length?p[d++]:void 0}},f=1,g=0,m=null;return l.eachMapping(function(w){if(m!==null)if(f<w.generatedLine)y(m,c()),f++,g=0;else{var _=p[d]||"",v=_.substr(0,w.generatedColumn-g);p[d]=_.substr(w.generatedColumn-g),g=w.generatedColumn,y(m,v),m=w;return}for(;f<w.generatedLine;)u.add(c()),f++;if(g<w.generatedColumn){var _=p[d]||"";u.add(_.substr(0,w.generatedColumn)),p[d]=_.substr(w.generatedColumn),g=w.generatedColumn}m=w},this),d<p.length&&(m&&y(m,c()),u.add(p.splice(d).join(""))),l.sources.forEach(function(w){var _=l.sourceContentFor(w);_!=null&&(h!=null&&(w=t.join(h,w)),u.setSourceContent(w,_))}),u;function y(w,_){if(w===null||w.source===void 0)u.add(_);else{var v=h?t.join(h,w.source):w.source;u.add(new o(w.originalLine,w.originalColumn,v,_,w.name))}}},o.prototype.add=function(a){if(Array.isArray(a))a.forEach(function(l){this.add(l)},this);else if(a[s]||typeof a=="string")a&&this.children.push(a);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+a);return this},o.prototype.prepend=function(a){if(Array.isArray(a))for(var l=a.length-1;l>=0;l--)this.prepend(a[l]);else if(a[s]||typeof a=="string")this.children.unshift(a);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+a);return this},o.prototype.walk=function(a){for(var l,h=0,u=this.children.length;h<u;h++)l=this.children[h],l[s]?l.walk(a):l!==""&&a(l,{source:this.source,line:this.line,column:this.column,name:this.name})},o.prototype.join=function(a){var l,h,u=this.children.length;if(u>0){for(l=[],h=0;h<u-1;h++)l.push(this.children[h]),l.push(a);l.push(this.children[h]),this.children=l}return this},o.prototype.replaceRight=function(a,l){var h=this.children[this.children.length-1];return h[s]?h.replaceRight(a,l):typeof h=="string"?this.children[this.children.length-1]=h.replace(a,l):this.children.push("".replace(a,l)),this},o.prototype.setSourceContent=function(a,l){this.sourceContents[t.toSetString(a)]=l},o.prototype.walkSourceContents=function(a){for(var l=0,h=this.children.length;l<h;l++)this.children[l][s]&&this.children[l].walkSourceContents(a);for(var u=Object.keys(this.sourceContents),l=0,h=u.length;l<h;l++)a(t.fromSetString(u[l]),this.sourceContents[u[l]])},o.prototype.toString=function(){var a="";return this.walk(function(l){a+=l}),a},o.prototype.toStringWithSourceMap=function(a){var l={code:"",line:1,column:0},h=new e(a),u=!1,p=null,d=null,c=null,f=null;return this.walk(function(g,m){l.code+=g,m.source!==null&&m.line!==null&&m.column!==null?((p!==m.source||d!==m.line||c!==m.column||f!==m.name)&&h.addMapping({source:m.source,original:{line:m.line,column:m.column},generated:{line:l.line,column:l.column},name:m.name}),p=m.source,d=m.line,c=m.column,f=m.name,u=!0):u&&(h.addMapping({generated:{line:l.line,column:l.column}}),p=null,u=!1);for(var y=0,w=g.length;y<w;y++)g.charCodeAt(y)===i?(l.line++,l.column=0,y+1===w?(p=null,u=!1):u&&h.addMapping({source:m.source,original:{line:m.line,column:m.column},generated:{line:l.line,column:l.column},name:m.name})):l.column++}),this.walkSourceContents(function(g,m){h.setSourceContent(g,m)}),{code:l.code,map:h}},n.SourceNode=o}),Lf=q(n=>{n.SourceMapGenerator=oc().SourceMapGenerator,n.SourceMapConsumer=Pf().SourceMapConsumer,n.SourceNode=Nf().SourceNode}),Mf=q((n,e)=>{n.__esModule=!0;var t=Ce(),r=void 0;try{(typeof define!="function"||!define.amd)&&(i=Lf(),r=i.SourceNode)}catch{}var i;r||(r=function(a,l,h,u){this.src="",u&&this.add(u)},r.prototype={add:function(a){t.isArray(a)&&(a=a.join("")),this.src+=a},prepend:function(a){t.isArray(a)&&(a=a.join("")),this.src=a+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}});function s(a,l,h){if(t.isArray(a)){for(var u=[],p=0,d=a.length;p<d;p++)u.push(l.wrap(a[p],h));return u}else if(typeof a=="boolean"||typeof a=="number")return a+"";return a}function o(a){this.srcFile=a,this.source=[]}o.prototype={isEmpty:function(){return!this.source.length},prepend:function(a,l){this.source.unshift(this.wrap(a,l))},push:function(a,l){this.source.push(this.wrap(a,l))},merge:function(){var a=this.empty();return this.each(function(l){a.add(["  ",l,`
`])}),a},each:function(a){for(var l=0,h=this.source.length;l<h;l++)a(this.source[l])},empty:function(){var a=this.currentLocation||{start:{}};return new r(a.start.line,a.start.column,this.srcFile)},wrap:function(a){var l=arguments.length<=1||arguments[1]===void 0?this.currentLocation||{start:{}}:arguments[1];return a instanceof r?a:(a=s(a,this,l),new r(l.start.line,l.start.column,this.srcFile,a))},functionCall:function(a,l,h){return h=this.generateList(h),this.wrap([a,l?"."+l+"(":"(",h,")"])},quotedString:function(a){return'"'+(a+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(a){var l=this,h=[];Object.keys(a).forEach(function(p){var d=s(a[p],l);d!=="undefined"&&h.push([l.quotedString(p),":",d])});var u=this.generateList(h);return u.prepend("{"),u.add("}"),u},generateList:function(a){for(var l=this.empty(),h=0,u=a.length;h<u;h++)h&&l.add(","),l.add(s(a[h],this));return l},generateArray:function(a){var l=this.generateList(a);return l.prepend("["),l.add("]"),l}},n.default=o,e.exports=n.default}),$f=q((n,e)=>{n.__esModule=!0;function t(d){return d&&d.__esModule?d:{default:d}}var r=io(),i=Ke(),s=t(i),o=Ce(),a=Mf(),l=t(a);function h(d){this.value=d}function u(){}u.prototype={nameLookup:function(d,c){return this.internalNameLookup(d,c)},depthedLookup:function(d){return[this.aliasable("container.lookup"),"(depths, ",JSON.stringify(d),")"]},compilerInfo:function(){var d=r.COMPILER_REVISION,c=r.REVISION_CHANGES[d];return[d,c]},appendToBuffer:function(d,c,f){return o.isArray(d)||(d=[d]),d=this.source.wrap(d,c),this.environment.isSimple?["return ",d,";"]:f?["buffer += ",d,";"]:(d.appendToBuffer=!0,d)},initializeBuffer:function(){return this.quotedString("")},internalNameLookup:function(d,c){return this.lookupPropertyFunctionIsUsed=!0,["lookupProperty(",d,",",JSON.stringify(c),")"]},lookupPropertyFunctionIsUsed:!1,compile:function(d,c,f,g){this.environment=d,this.options=c,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!g,this.name=this.environment.name,this.isChild=!!f,this.context=f||{decorators:[],programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(d,c),this.useDepths=this.useDepths||d.useDepths||d.useDecorators||this.options.compat,this.useBlockParams=this.useBlockParams||d.useBlockParams;var m=d.opcodes,y=void 0,w=void 0,_=void 0,v=void 0;for(_=0,v=m.length;_<v;_++)y=m[_],this.source.currentLocation=y.loc,w=w||y.loc,this[y.opcode].apply(this,y.args);if(this.source.currentLocation=w,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new s.default("Compile completed with content left on stack");this.decorators.isEmpty()?this.decorators=void 0:(this.useDecorators=!0,this.decorators.prepend(["var decorators = container.decorators, ",this.lookupPropertyFunctionVarDeclaration(),`;
`]),this.decorators.push("return fn;"),g?this.decorators=Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()]):(this.decorators.prepend(`function(fn, props, container, depth0, data, blockParams, depths) {
`),this.decorators.push(`}
`),this.decorators=this.decorators.merge()));var b=this.createFunctionContext(g);if(this.isChild)return b;var x={compiler:this.compilerInfo(),main:b};this.decorators&&(x.main_d=this.decorators,x.useDecorators=!0);var E=this.context,N=E.programs,$=E.decorators;for(_=0,v=N.length;_<v;_++)N[_]&&(x[_]=N[_],$[_]&&(x[_+"_d"]=$[_],x.useDecorators=!0));return this.environment.usePartial&&(x.usePartial=!0),this.options.data&&(x.useData=!0),this.useDepths&&(x.useDepths=!0),this.useBlockParams&&(x.useBlockParams=!0),this.options.compat&&(x.compat=!0),g?x.compilerOptions=this.options:(x.compiler=JSON.stringify(x.compiler),this.source.currentLocation={start:{line:1,column:0}},x=this.objectLiteral(x),c.srcName?(x=x.toStringWithSourceMap({file:c.destName}),x.map=x.map&&x.map.toString()):x=x.toString()),x},preamble:function(){this.lastContext=0,this.source=new l.default(this.options.srcName),this.decorators=new l.default(this.options.srcName)},createFunctionContext:function(d){var c=this,f="",g=this.stackVars.concat(this.registers.list);g.length>0&&(f+=", "+g.join(", "));var m=0;Object.keys(this.aliases).forEach(function(_){var v=c.aliases[_];v.children&&v.referenceCount>1&&(f+=", alias"+ ++m+"="+_,v.children[0]="alias"+m)}),this.lookupPropertyFunctionIsUsed&&(f+=", "+this.lookupPropertyFunctionVarDeclaration());var y=["container","depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&y.push("blockParams"),this.useDepths&&y.push("depths");var w=this.mergeSource(f);return d?(y.push(w),Function.apply(this,y)):this.source.wrap(["function(",y.join(","),`) {
  `,w,"}"])},mergeSource:function(d){var c=this.environment.isSimple,f=!this.forceBuffer,g=void 0,m=void 0,y=void 0,w=void 0;return this.source.each(function(_){_.appendToBuffer?(y?_.prepend("  + "):y=_,w=_):(y&&(m?y.prepend("buffer += "):g=!0,w.add(";"),y=w=void 0),m=!0,c||(f=!1))}),f?y?(y.prepend("return "),w.add(";")):m||this.source.push('return "";'):(d+=", buffer = "+(g?"":this.initializeBuffer()),y?(y.prepend("return buffer + "),w.add(";")):this.source.push("return buffer;")),d&&this.source.prepend("var "+d.substring(2)+(g?"":`;
`)),this.source.merge()},lookupPropertyFunctionVarDeclaration:function(){return`
      lookupProperty = container.lookupProperty || function(parent, propertyName) {
        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {
          return parent[propertyName];
        }
        return undefined
    }
    `.trim()},blockValue:function(d){var c=this.aliasable("container.hooks.blockHelperMissing"),f=[this.contextName(0)];this.setupHelperArgs(d,0,f);var g=this.popStack();f.splice(1,0,g),this.push(this.source.functionCall(c,"call",f))},ambiguousBlockValue:function(){var d=this.aliasable("container.hooks.blockHelperMissing"),c=[this.contextName(0)];this.setupHelperArgs("",0,c,!0),this.flushInline();var f=this.topStack();c.splice(1,0,f),this.pushSource(["if (!",this.lastHelper,") { ",f," = ",this.source.functionCall(d,"call",c),"}"])},appendContent:function(d){this.pendingContent?d=this.pendingContent+d:this.pendingLocation=this.source.currentLocation,this.pendingContent=d},append:function(){if(this.isInline())this.replaceStack(function(c){return[" != null ? ",c,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var d=this.popStack();this.pushSource(["if (",d," != null) { ",this.appendToBuffer(d,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(d){this.lastContext=d},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(d,c,f,g){var m=0;!g&&this.options.compat&&!this.lastContext?this.push(this.depthedLookup(d[m++])):this.pushContext(),this.resolvePath("context",d,m,c,f)},lookupBlockParam:function(d,c){this.useBlockParams=!0,this.push(["blockParams[",d[0],"][",d[1],"]"]),this.resolvePath("context",c,1)},lookupData:function(d,c,f){d?this.pushStackLiteral("container.data(data, "+d+")"):this.pushStackLiteral("data"),this.resolvePath("data",c,0,!0,f)},resolvePath:function(d,c,f,g,m){var y=this;if(this.options.strict||this.options.assumeObjects){this.push(p(this.options.strict&&m,this,c,f,d));return}for(var w=c.length;f<w;f++)this.replaceStack(function(_){var v=y.nameLookup(_,c[f],d);return g?[" && ",v]:[" != null ? ",v," : ",_]})},resolvePossibleLambda:function(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(d,c){this.pushContext(),this.pushString(c),c!=="SubExpression"&&(typeof d=="string"?this.pushString(d):this.pushStackLiteral(d))},emptyHash:function(d){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(d?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:{},types:[],contexts:[],ids:[]}},popHash:function(){var d=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(d.ids)),this.stringParams&&(this.push(this.objectLiteral(d.contexts)),this.push(this.objectLiteral(d.types))),this.push(this.objectLiteral(d.values))},pushString:function(d){this.pushStackLiteral(this.quotedString(d))},pushLiteral:function(d){this.pushStackLiteral(d)},pushProgram:function(d){d!=null?this.pushStackLiteral(this.programExpression(d)):this.pushStackLiteral(null)},registerDecorator:function(d,c){var f=this.nameLookup("decorators",c,"decorator"),g=this.setupHelperArgs(c,d);this.decorators.push(["fn = ",this.decorators.functionCall(f,"",["fn","props","container",g])," || fn;"])},invokeHelper:function(d,c,f){var g=this.popStack(),m=this.setupHelper(d,c),y=[];f&&y.push(m.name),y.push(g),this.options.strict||y.push(this.aliasable("container.hooks.helperMissing"));var w=["(",this.itemsSeparatedBy(y,"||"),")"],_=this.source.functionCall(w,"call",m.callParams);this.push(_)},itemsSeparatedBy:function(d,c){var f=[];f.push(d[0]);for(var g=1;g<d.length;g++)f.push(c,d[g]);return f},invokeKnownHelper:function(d,c){var f=this.setupHelper(d,c);this.push(this.source.functionCall(f.name,"call",f.callParams))},invokeAmbiguous:function(d,c){this.useRegister("helper");var f=this.popStack();this.emptyHash();var g=this.setupHelper(0,d,c),m=this.lastHelper=this.nameLookup("helpers",d,"helper"),y=["(","(helper = ",m," || ",f,")"];this.options.strict||(y[0]="(helper = ",y.push(" != null ? helper : ",this.aliasable("container.hooks.helperMissing"))),this.push(["(",y,g.paramsInit?["),(",g.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",g.callParams)," : helper))"])},invokePartial:function(d,c,f){var g=[],m=this.setupParams(c,1,g);d&&(c=this.popStack(),delete m.name),f&&(m.indent=JSON.stringify(f)),m.helpers="helpers",m.partials="partials",m.decorators="container.decorators",d?g.unshift(c):g.unshift(this.nameLookup("partials",c,"partial")),this.options.compat&&(m.depths="depths"),m=this.objectLiteral(m),g.push(m),this.push(this.source.functionCall("container.invokePartial","",g))},assignToHash:function(d){var c=this.popStack(),f=void 0,g=void 0,m=void 0;this.trackIds&&(m=this.popStack()),this.stringParams&&(g=this.popStack(),f=this.popStack());var y=this.hash;f&&(y.contexts[d]=f),g&&(y.types[d]=g),m&&(y.ids[d]=m),y.values[d]=c},pushId:function(d,c,f){d==="BlockParam"?this.pushStackLiteral("blockParams["+c[0]+"].path["+c[1]+"]"+(f?" + "+JSON.stringify("."+f):"")):d==="PathExpression"?this.pushString(c):d==="SubExpression"?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:u,compileChildren:function(d,c){for(var f=d.children,g=void 0,m=void 0,y=0,w=f.length;y<w;y++){g=f[y],m=new this.compiler;var _=this.matchExistingProgram(g);if(_==null){this.context.programs.push("");var v=this.context.programs.length;g.index=v,g.name="program"+v,this.context.programs[v]=m.compile(g,c,this.context,!this.precompile),this.context.decorators[v]=m.decorators,this.context.environments[v]=g,this.useDepths=this.useDepths||m.useDepths,this.useBlockParams=this.useBlockParams||m.useBlockParams,g.useDepths=this.useDepths,g.useBlockParams=this.useBlockParams}else g.index=_.index,g.name="program"+_.index,this.useDepths=this.useDepths||_.useDepths,this.useBlockParams=this.useBlockParams||_.useBlockParams}},matchExistingProgram:function(d){for(var c=0,f=this.context.environments.length;c<f;c++){var g=this.context.environments[c];if(g&&g.equals(d))return g}},programExpression:function(d){var c=this.environment.children[d],f=[c.index,"data",c.blockParams];return(this.useBlockParams||this.useDepths)&&f.push("blockParams"),this.useDepths&&f.push("depths"),"container.program("+f.join(", ")+")"},useRegister:function(d){this.registers[d]||(this.registers[d]=!0,this.registers.list.push(d))},push:function(d){return d instanceof h||(d=this.source.wrap(d)),this.inlineStack.push(d),d},pushStackLiteral:function(d){this.push(new h(d))},pushSource:function(d){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),d&&this.source.push(d)},replaceStack:function(d){var c=["("],f=void 0,g=void 0,m=void 0;if(!this.isInline())throw new s.default("replaceStack on non-inline");var y=this.popStack(!0);if(y instanceof h)f=[y.value],c=["(",f],m=!0;else{g=!0;var w=this.incrStack();c=["((",this.push(w)," = ",y,")"],f=this.topStack()}var _=d.call(this,f);m||this.popStack(),g&&this.stackSlot--,this.push(c.concat(_,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var d=this.inlineStack;this.inlineStack=[];for(var c=0,f=d.length;c<f;c++){var g=d[c];if(g instanceof h)this.compileStack.push(g);else{var m=this.incrStack();this.pushSource([m," = ",g,";"]),this.compileStack.push(m)}}},isInline:function(){return this.inlineStack.length},popStack:function(d){var c=this.isInline(),f=(c?this.inlineStack:this.compileStack).pop();if(!d&&f instanceof h)return f.value;if(!c){if(!this.stackSlot)throw new s.default("Invalid stack pop");this.stackSlot--}return f},topStack:function(){var d=this.isInline()?this.inlineStack:this.compileStack,c=d[d.length-1];return c instanceof h?c.value:c},contextName:function(d){return this.useDepths&&d?"depths["+d+"]":"depth"+d},quotedString:function(d){return this.source.quotedString(d)},objectLiteral:function(d){return this.source.objectLiteral(d)},aliasable:function(d){var c=this.aliases[d];return c?(c.referenceCount++,c):(c=this.aliases[d]=this.source.wrap(d),c.aliasable=!0,c.referenceCount=1,c)},setupHelper:function(d,c,f){var g=[],m=this.setupHelperArgs(c,d,g,f),y=this.nameLookup("helpers",c,"helper"),w=this.aliasable(this.contextName(0)+" != null ? "+this.contextName(0)+" : (container.nullContext || {})");return{params:g,paramsInit:m,name:y,callParams:[w].concat(g)}},setupParams:function(d,c,f){var g={},m=[],y=[],w=[],_=!f,v=void 0;_&&(f=[]),g.name=this.quotedString(d),g.hash=this.popStack(),this.trackIds&&(g.hashIds=this.popStack()),this.stringParams&&(g.hashTypes=this.popStack(),g.hashContexts=this.popStack());var b=this.popStack(),x=this.popStack();(x||b)&&(g.fn=x||"container.noop",g.inverse=b||"container.noop");for(var E=c;E--;)v=this.popStack(),f[E]=v,this.trackIds&&(w[E]=this.popStack()),this.stringParams&&(y[E]=this.popStack(),m[E]=this.popStack());return _&&(g.args=this.source.generateArray(f)),this.trackIds&&(g.ids=this.source.generateArray(w)),this.stringParams&&(g.types=this.source.generateArray(y),g.contexts=this.source.generateArray(m)),this.options.data&&(g.data="data"),this.useBlockParams&&(g.blockParams="blockParams"),g},setupHelperArgs:function(d,c,f,g){var m=this.setupParams(d,c,f);return m.loc=JSON.stringify(this.source.currentLocation),m=this.objectLiteral(m),g?(this.useRegister("options"),f.push("options"),["options=",m]):f?(f.push(m),""):m}},function(){for(var d="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),c=u.RESERVED_WORDS={},f=0,g=d.length;f<g;f++)c[d[f]]=!0}(),u.isValidJavaScriptVariableName=function(d){return!u.RESERVED_WORDS[d]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(d)};function p(d,c,f,g,m){var y=c.popStack(),w=f.length;for(d&&w--;g<w;g++)y=c.nameLookup(y,f[g],m);return d?[c.aliasable("container.strict"),"(",y,", ",c.quotedString(f[g]),", ",JSON.stringify(c.source.currentLocation)," )"]:y}n.default=u,e.exports=n.default}),Df=q((n,e)=>{n.__esModule=!0;function t(w){return w&&w.__esModule?w:{default:w}}var r=kf(),i=t(r),s=rc(),o=t(s),a=Af(),l=Of(),h=$f(),u=t(h),p=so(),d=t(p),c=nc(),f=t(c),g=i.default.create;function m(){var w=g();return w.compile=function(_,v){return l.compile(_,v,w)},w.precompile=function(_,v){return l.precompile(_,v,w)},w.AST=o.default,w.Compiler=l.Compiler,w.JavaScriptCompiler=u.default,w.Parser=a.parser,w.parse=a.parse,w.parseWithoutProcessing=a.parseWithoutProcessing,w}var y=m();y.create=m,f.default(y),y.Visitor=d.default,y.default=y,n.default=y,e.exports=n.default}),jf=q(n=>{n.__esModule=!0,n.print=i,n.PrintVisitor=s;function e(o){return o&&o.__esModule?o:{default:o}}var t=so(),r=e(t);function i(o){return new s().accept(o)}function s(){this.padding=0}s.prototype=new r.default,s.prototype.pad=function(o){for(var a="",l=0,h=this.padding;l<h;l++)a+="  ";return a+=o+`
`,a},s.prototype.Program=function(o){var a="",l=o.body,h=void 0,u=void 0;if(o.blockParams){var p="BLOCK PARAMS: [";for(h=0,u=o.blockParams.length;h<u;h++)p+=" "+o.blockParams[h];p+=" ]",a+=this.pad(p)}for(h=0,u=l.length;h<u;h++)a+=this.accept(l[h]);return this.padding--,a},s.prototype.MustacheStatement=function(o){return this.pad("{{ "+this.SubExpression(o)+" }}")},s.prototype.Decorator=function(o){return this.pad("{{ DIRECTIVE "+this.SubExpression(o)+" }}")},s.prototype.BlockStatement=s.prototype.DecoratorBlock=function(o){var a="";return a+=this.pad((o.type==="DecoratorBlock"?"DIRECTIVE ":"")+"BLOCK:"),this.padding++,a+=this.pad(this.SubExpression(o)),o.program&&(a+=this.pad("PROGRAM:"),this.padding++,a+=this.accept(o.program),this.padding--),o.inverse&&(o.program&&this.padding++,a+=this.pad("{{^}}"),this.padding++,a+=this.accept(o.inverse),this.padding--,o.program&&this.padding--),this.padding--,a},s.prototype.PartialStatement=function(o){var a="PARTIAL:"+o.name.original;return o.params[0]&&(a+=" "+this.accept(o.params[0])),o.hash&&(a+=" "+this.accept(o.hash)),this.pad("{{> "+a+" }}")},s.prototype.PartialBlockStatement=function(o){var a="PARTIAL BLOCK:"+o.name.original;return o.params[0]&&(a+=" "+this.accept(o.params[0])),o.hash&&(a+=" "+this.accept(o.hash)),a+=" "+this.pad("PROGRAM:"),this.padding++,a+=this.accept(o.program),this.padding--,this.pad("{{> "+a+" }}")},s.prototype.ContentStatement=function(o){return this.pad("CONTENT[ '"+o.value+"' ]")},s.prototype.CommentStatement=function(o){return this.pad("{{! '"+o.value+"' }}")},s.prototype.SubExpression=function(o){for(var a=o.params,l=[],h=void 0,u=0,p=a.length;u<p;u++)l.push(this.accept(a[u]));return a="["+l.join(", ")+"]",h=o.hash?" "+this.accept(o.hash):"",this.accept(o.path)+" "+a+h},s.prototype.PathExpression=function(o){var a=o.parts.join("/");return(o.data?"@":"")+"PATH:"+a},s.prototype.StringLiteral=function(o){return'"'+o.value+'"'},s.prototype.NumberLiteral=function(o){return"NUMBER{"+o.value+"}"},s.prototype.BooleanLiteral=function(o){return"BOOLEAN{"+o.value+"}"},s.prototype.UndefinedLiteral=function(){return"UNDEFINED"},s.prototype.NullLiteral=function(){return"NULL"},s.prototype.Hash=function(o){for(var a=o.pairs,l=[],h=0,u=a.length;h<u;h++)l.push(this.accept(a[h]));return"HASH{"+l.join(", ")+"}"},s.prototype.HashPair=function(o){return o.key+"="+this.accept(o.value)}}),Bf=q((n,e)=>{var t=Df().default,r=jf();t.PrintVisitor=r.PrintVisitor,t.print=r.print,e.exports=t;function i(s,o){var a=Tn("fs"),l=a.readFileSync(o,"utf8");s.exports=t.compile(l)}typeof Tn<"u"&&Tn.extensions&&(Tn.extensions[".handlebars"]=i,Tn.extensions[".hbs"]=i)}),ac=class Lr{static isPlaceholder(e){return(e==null?void 0:e.onclick)!=null}static isAudio(e){var t;return e&&!Lr.isPlaceholder(e)&&((t=e==null?void 0:e.mimeType)==null?void 0:t.startsWith("audio/"))||e.mimeType=="application/ogg"}static isImage(e){var t;return e&&!Lr.isPlaceholder(e)&&((t=e==null?void 0:e.mimeType)==null?void 0:t.startsWith("image/"))}static isDocument(e){var t,r;return e&&!Lr.isPlaceholder(e)&&(((t=e==null?void 0:e.mimeType)==null?void 0:t.startsWith("text/"))||((r=e==null?void 0:e.mimeType)==null?void 0:r.startsWith("application/pdf")))}},zf=(n=>(n.REGISTRATION="client_registration",n.DEREGISTRATION="client_deregistration",n.SEND_CHAT_MESSAGE="client_send_chat",n.RUN_CLIENT_SCRIPT="client_run_cscript",n.SIGNAL_INTENT="client_signal_intent",n.WINDOW_MESSAGE="client_window_message",n.SHOW_TOAST="client_show_toast",n.SHOW_EXTENSION="client_show_extension",n.LOAD_RECIPE="client_load_recipe",n.SHOW_TOP_BANNER="client_show_top_banner",n))(zf||{}),Ff=(n=>(n.INTENT_MAP="omni-intentMap",n))(Ff||{}),Uf=(n=>(n.DATA_UPDATED="data_updated",n.CUSTOM_EVENT="custom_event",n.CHAT_MESSAGE_RECEIVED="chat_message_received",n))(Uf||{}),Hf=(n=>(n.ACKNOWLEDGE="host_acknowledge",n.CLIENT_SCRIPT_RESPONSE="host_cscript_response",n.SYNC_DATA="host_sync_data",n.CHAT_COMMAND="host_chat_command",n.CHAT_MESSAGE_RECEIVED="host_chat_message_received",n.CUSTOM_EVENT="custom_extension_event",n))(Hf||{}),Wf=(n=>(n.image="image",n.audio="audio",n.document="document",n.video="video",n.file="file",n))(Wf||{}),qf=class lc{constructor(e){var r;if(this.fid=e.fid||((r=e.ticket)==null?void 0:r.fid),!this.fid)throw new Error("Invalid resource, fid missing");this.ticket=e.ticket,this.fileName=e.fileName,this.size=e.size,this.data=e.data,this.url=e.url,this.mimeType=e.mimeType,this.expires=e.expires,this.meta=e.meta||{},this.meta.created=this.meta.created||Date.now();let t=this.fileName.split(".").pop();this.furl=`fid://${this.fid}.${t}`,this.fileType=lc.determineFileTypeFromMimeType(this.mimeType)||e.fileType||"file"}static determineFileTypeFromMimeType(e){let t=["audio","document","image","video","file"];if(e){let r=e.split("/")[0];if(t.includes(r))return r;if(r.startsWith("text/"))return"document";if(r==="application/ogg")return"audio";if(r==="application/pdf")return"document";if(r==="video/")return"video"}}isAudio(){var e,t;return this.fileType==="audio"?!0:this.mimeType?((e=this.mimeType)==null?void 0:e.startsWith("audio/"))||((t=this.mimeType)==null?void 0:t.startsWith("application/ogg")):!1}isVideo(){var e;return this.fileType==="video"?!0:this.mimeType?(e=this.mimeType)==null?void 0:e.startsWith("video/"):!1}isImage(){var e;return this.fileType==="image"?!0:this.mimeType?(e=this.mimeType)==null?void 0:e.startsWith("image/"):!1}isDocument(){var e,t;return this.fileType==="document"?!0:this.mimeType?((e=this.mimeType)==null?void 0:e.startsWith("text/"))||((t=this.mimeType)==null?void 0:t.startsWith("application/pdf")):!1}asBase64(e){if(this.data instanceof Buffer)return e?`data:${this.mimeType};base64,${this.data.toString("base64")}`:this.data.toString("base64");if(typeof this.data=="string")return this.data}},Vf=class{constructor(n=(e,t)=>window.fetch(e,t)){this.fetch=n}async executeRequest(n,e){return await this.fetch(n,e)}},wt=new WeakMap,It=new WeakMap,ut=new WeakMap,Vr=Symbol("anyProducer"),Ta=Promise.resolve(),Jr=Symbol("listenerAdded"),Gr=Symbol("listenerRemoved"),Kr=!1,Ji=!1;function on(n){if(typeof n!="string"&&typeof n!="symbol"&&typeof n!="number")throw new TypeError("`eventName` must be a string, symbol, or number")}function yr(n){if(typeof n!="function")throw new TypeError("listener must be a function")}function an(n,e){let t=It.get(n);if(t.has(e))return t.get(e)}function Bn(n,e){let t=typeof e=="string"||typeof e=="symbol"||typeof e=="number"?e:Vr,r=ut.get(n);if(r.has(t))return r.get(t)}function Jf(n,e,t){let r=ut.get(n);if(r.has(e))for(let i of r.get(e))i.enqueue(t);if(r.has(Vr)){let i=Promise.all([e,t]);for(let s of r.get(Vr))s.enqueue(i)}}function Ra(n,e){e=Array.isArray(e)?e:[e];let t=!1,r=()=>{},i=[],s={enqueue(o){i.push(o),r()},finish(){t=!0,r()}};for(let o of e){let a=Bn(n,o);a||(a=new Set,ut.get(n).set(o,a)),a.add(s)}return{async next(){return i?i.length===0?t?(i=void 0,this.next()):(await new Promise(o=>{r=o}),this.next()):{done:!1,value:await i.shift()}:{done:!0}},async return(o){i=void 0;for(let a of e){let l=Bn(n,a);l&&(l.delete(s),l.size===0&&ut.get(n).delete(a))}return r(),arguments.length>0?{done:!0,value:await o}:{done:!0}},[Symbol.asyncIterator](){return this}}}function Ia(n){if(n===void 0)return Pa;if(!Array.isArray(n))throw new TypeError("`methodNames` must be an array of strings");for(let e of n)if(!Pa.includes(e))throw typeof e!="string"?new TypeError("`methodNames` element must be a string"):new Error(`${e} is not Emittery method`);return n}var un=n=>n===Jr||n===Gr;function wr(n,e,t){if(un(e))try{Kr=!0,n.emit(e,t)}finally{Kr=!1}}var mi=class ms{static mixin(e,t){return t=Ia(t),r=>{if(typeof r!="function")throw new TypeError("`target` must be function");for(let o of t)if(r.prototype[o]!==void 0)throw new Error(`The property \`${o}\` already exists on \`target\``);function i(){return Object.defineProperty(this,e,{enumerable:!1,value:new ms}),this[e]}Object.defineProperty(r.prototype,e,{enumerable:!1,get:i});let s=o=>function(...a){return this[e][o](...a)};for(let o of t)Object.defineProperty(r.prototype,o,{enumerable:!1,value:s(o)});return r}}static get isDebugEnabled(){var t;if(typeof((t=globalThis.process)==null?void 0:t.env)!="object")return Ji;let{env:e}=globalThis.process??{env:{}};return e.DEBUG==="emittery"||e.DEBUG==="*"||Ji}static set isDebugEnabled(e){Ji=e}constructor(e={}){wt.set(this,new Set),It.set(this,new Map),ut.set(this,new Map),ut.get(this).set(Vr,new Set),this.debug=e.debug??{},this.debug.enabled===void 0&&(this.debug.enabled=!1),this.debug.logger||(this.debug.logger=(t,r,i,s)=>{try{s=JSON.stringify(s)}catch{s=`Object with the following keys failed to stringify: ${Object.keys(s).join(",")}`}(typeof i=="symbol"||typeof i=="number")&&(i=i.toString());let o=new Date,a=`${o.getHours()}:${o.getMinutes()}:${o.getSeconds()}.${o.getMilliseconds()}`;console.log(`[${a}][emittery:${t}][${r}] Event Name: ${i}
	data: ${s}`)})}logIfDebugEnabled(e,t,r){(ms.isDebugEnabled||this.debug.enabled)&&this.debug.logger(e,this.debug.name,t,r)}on(e,t){yr(t),e=Array.isArray(e)?e:[e];for(let r of e){on(r);let i=an(this,r);i||(i=new Set,It.get(this).set(r,i)),i.add(t),this.logIfDebugEnabled("subscribe",r,void 0),un(r)||wr(this,Jr,{eventName:r,listener:t})}return this.off.bind(this,e,t)}off(e,t){yr(t),e=Array.isArray(e)?e:[e];for(let r of e){on(r);let i=an(this,r);i&&(i.delete(t),i.size===0&&It.get(this).delete(r)),this.logIfDebugEnabled("unsubscribe",r,void 0),un(r)||wr(this,Gr,{eventName:r,listener:t})}}once(e){let t,r=new Promise(i=>{t=this.on(e,s=>{t(),i(s)})});return r.off=t,r}events(e){e=Array.isArray(e)?e:[e];for(let t of e)on(t);return Ra(this,e)}async emit(e,t){if(on(e),un(e)&&!Kr)throw new TypeError("`eventName` cannot be meta event `listenerAdded` or `listenerRemoved`");this.logIfDebugEnabled("emit",e,t),Jf(this,e,t);let r=an(this,e)??new Set,i=wt.get(this),s=[...r],o=un(e)?[]:[...i];await Ta,await Promise.all([...s.map(async a=>{if(r.has(a))return a(t)}),...o.map(async a=>{if(i.has(a))return a(e,t)})])}async emitSerial(e,t){if(on(e),un(e)&&!Kr)throw new TypeError("`eventName` cannot be meta event `listenerAdded` or `listenerRemoved`");this.logIfDebugEnabled("emitSerial",e,t);let r=an(this,e)??new Set,i=wt.get(this),s=[...r],o=[...i];await Ta;for(let a of s)r.has(a)&&await a(t);for(let a of o)i.has(a)&&await a(e,t)}onAny(e){return yr(e),this.logIfDebugEnabled("subscribeAny",void 0,void 0),wt.get(this).add(e),wr(this,Jr,{listener:e}),this.offAny.bind(this,e)}anyEvent(){return Ra(this)}offAny(e){yr(e),this.logIfDebugEnabled("unsubscribeAny",void 0,void 0),wr(this,Gr,{listener:e}),wt.get(this).delete(e)}clearListeners(e){e=Array.isArray(e)?e:[e];for(let t of e)if(this.logIfDebugEnabled("clear",t,void 0),typeof t=="string"||typeof t=="symbol"||typeof t=="number"){let r=an(this,t);r&&r.clear();let i=Bn(this,t);if(i){for(let s of i)s.finish();i.clear()}}else{wt.get(this).clear();for(let[r,i]of It.get(this).entries())i.clear(),It.get(this).delete(r);for(let[r,i]of ut.get(this).entries()){for(let s of i)s.finish();i.clear(),ut.get(this).delete(r)}}}listenerCount(e){var r,i,s;e=Array.isArray(e)?e:[e];let t=0;for(let o of e){if(typeof o=="string"){t+=wt.get(this).size+(((r=an(this,o))==null?void 0:r.size)??0)+(((i=Bn(this,o))==null?void 0:i.size)??0)+(((s=Bn(this))==null?void 0:s.size)??0);continue}typeof o<"u"&&on(o),t+=wt.get(this).size;for(let a of It.get(this).values())t+=a.size;for(let a of ut.get(this).values())t+=a.size}return t}bindMethods(e,t){if(typeof e!="object"||e===null)throw new TypeError("`target` must be an object");t=Ia(t);for(let r of t){if(e[r]!==void 0)throw new Error(`The property \`${r}\` already exists on \`target\``);Object.defineProperty(e,r,{enumerable:!1,value:this[r].bind(this)})}}},Pa=Object.getOwnPropertyNames(mi.prototype).filter(n=>n!=="constructor");Object.defineProperty(mi,"listenerAdded",{value:Jr,writable:!1,enumerable:!0,configurable:!1});Object.defineProperty(mi,"listenerRemoved",{value:Gr,writable:!1,enumerable:!0,configurable:!1});var cc=class{constructor(){this.messageHandlers={},this._isClient=!1,this.Resource=ac,this.events=new mi,this.intentMap=new Map,this._messageListenerHandler=n=>{if(n.origin!==window.location.origin){console.warn(`Dropping Message received from an unknown origin: ${n.origin}`);return}try{let e=n.data,t=this.messageHandlers[e.type];t?t.call(this,e,n.source):console.warn(`No handler found for message type: ${e.type}`)}catch(e){console.error("Error processing the message:",e)}},this._initMessageListener(),this._httpClient=new Vf}unload(){window.removeEventListener("message",this._messageListenerHandler),console.log("Message listener removed.")}_initMessageListener(){window.addEventListener("message",this._messageListenerHandler,!1),console.log("Message listener initialized.")}addMessageHandler(n,e){this.messageHandlers[n]=e}getLocalValue(n,e){let t=n;this._isClient?t="omni/"+this._extensionId+"/"+n:t="omni/host/"+n;let r=globalThis.localStorage.getItem(t);if(r!==null){let i=JSON.parse(r),s=i.value;switch(i.type){case"boolean":s=s==="true";break;case"object":case"number":case"string":break;default:return console.warn("Unsupported value type",i.type,"on",n),null}return s}return null}setLocalValue(n,e){if(n==null||n.length==0)throw new Error("Invalid null Key passed into setLocalValue");let t=n;if(this._isClient?t="omni/"+this._extensionId+"/"+n:t="omni/host/"+n,e==null){globalThis.localStorage.removeItem(t);return}let r=typeof e;switch(r){case"number":case"string":case"object":break;case"boolean":break;default:console.warn("Unsupported value type",r,"on",n);return}globalThis.localStorage.setItem(t,JSON.stringify({type:r,value:e}))}send(n,e){this._isClient?(console.log("Sending message from client:",n),n.token=this.token,n=JSON.parse(JSON.stringify(n)),window.parent.postMessage(n,"*")):console.warn("Attempted to send a message from the host without specifying a target.")}async runServerScript(n,e){return await(await this._httpClient.executeRequest("/api/v1/mercenaries/runscript/"+n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json()}canEditFile(n){return n?this.intentMap.has(`file:edit:${n.mimeType}`):!1}canViewFile(n){return n?this.intentMap.has(`file:show:${n.mimeType}`):!1}async getFileObject(n){try{let e=await(await this._httpClient.executeRequest("/fid/"+n+"?obj=true",{method:"GET",headers:{"Content-Type":"application/json"}})).json();return e?(console.log("getFileObject",e),new qf(e)):(console.warn(`No valid file object found for fid ${n}`),null)}catch(e){return console.error(e),null}}async getFileBlob(n){try{return await(await this._httpClient.executeRequest("/fid/"+n+"?download=true")).blob()}catch(e){return console.error(e),null}}async uploadFiles(n,e="temporary"){if((n==null?void 0:n.length)>0){let t=await Promise.all(Array.from(n).map(async r=>{let i=new FormData;i.append("storageType",e),i.append("file",r,r.name||Date.now().toString());try{let s=await fetch("/fid",{method:"POST",body:i});if(s.ok){let o=await s.json();return o.length>0&&o[0].ticket&&o[0].fid?o[0]:(console.warn("Failed to upload file",{data:o,file:r}),null)}else return console.warn("Failed to upload file",{response:s,file:r}),null}catch(s){return console.error("Failed to upload file",{error:s,file:r}),null}}));return t=t.filter(r=>r),t}else return[]}async startRecipe(n,e){let t=await(await fetch("/api/v1/workflow/exec",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({workflow:n,args:e})})).json();if(t.status==="JOB_STARTED")return{...t}}async downloadFile(n,e){let t=n.fid,r=e||n.fileName;fetch("/fid/"+t+"?download=true").then(i=>i.blob()).then(i=>{let s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=r,document.body.appendChild(o),o.click(),document.body.removeChild(o)}).catch(i=>console.error(i))}};cc.Resource=ac;var Gf=class extends cc{constructor(n){super(),this.registeredFrames={},this._app=n}get app(){return this._app}init(){return console.log("OmniSDKHost initialized."),this.addMessageHandler("client_registration",this._handleRegistration),this.addMessageHandler("client_deregistration",this._handleDeregistration),this.addMessageHandler("client_send_chat",this._handleSendChatMessage),this.addMessageHandler("client_run_cscript",this._handleRunClientScript),this.addMessageHandler("client_signal_intent",this._handleSignalIntent),this.addMessageHandler("client_window_message",this._handleWindowMessage),this.addMessageHandler("client_show_toast",this._handleShowToast),this.addMessageHandler("client_show_extension",this._handleShowExtension),this.addMessageHandler("client_load_recipe",this._handleLoadRecipe),this.addMessageHandler("client_show_top_banner",this._handleShowTopBanner),this}registerFileIntent(n,e,t){let r=`file:${n}:${e}`;console.log(`Registering file intent ${r}, handler: `,t),this.intentMap.has(r)?this.intentMap.get(r).push(t):this.intentMap.set(r,[t]),window.localStorage.setItem("omni-intentMap",JSON.stringify(Array.from(this.intentMap.entries())))}signalFileIntent(n,e,t){var s;let r=(s=e.mimeType)==null?void 0:s.split(";")[0].trim(),i=this.intentMap.get(`file:${n}:${r}`)||[];if(i.length==0&&(i=Array.from(this.intentMap.entries()).map(([o,a])=>{let[l,h,u]=o.split(":");if(l==="file"&&h===n&&u.endsWith("*")&&(r!=null&&r.startsWith(u.substring(0,u.length-1))))return a[0]}).filter(o=>o!==void 0)),i.length>0){console.log(i[0]);let{extensionId:o,page:a,hOpts:l}=i[0];console.log(`Showing ${n} intent for ${r} with extension ${o} and page ${a}`),this.app.workbench.showExtension(o,{file:e},a,Object.assign({},t,l))}else console.warn(`No handler found for intent ${n} and mime type ${e.mimeType}`)}signalCustomEvent(n,e,t){let r={type:"custom_extension_event",extensionId:n,eventId:e,eventArgs:t};this.send(r)}signalChatMessageReceived(n){n.workflowId||(n.workflowId="System");let e={type:"host_chat_message_received",message:n};this.send(e,"*")}deregister(n){n&&this.registeredFrames[n]?(console.log(`Iframe with token ${n} deregistered!`),delete this.registeredFrames[n]):console.warn(`No registered frame with token ${n}`)}async _handleRunClientScript(n){if(n.type!=="client_run_cscript")return;let e=n,t=e.script,r=e.args,i=await this.app.runScript(t,r),s={type:"host_cscript_response",invokeId:e.invokeId,result:i};this.send(s,n.token)}_handleWindowMessage(n){if(n.type!=="client_window_message")return;let e=n,t=e.action;e.args;let r=e.token;t==="close"&&this.app.closeWindow(r)}sendChatMessage(n,e="text/markdown",t,r){let i={type:"client_send_chat",message:{content:n,type:e,attachments:t,flags:r}};this._handleSendChatMessage(i)}_handleSendChatMessage(n){if(n.type!=="client_send_chat")return;let e=n.message;this.app.sendSystemMessage(e.content,e.type,e.attachments,e.flags)}_handleShowExtension(n){if(n.type!=="client_show_extension")return;let e=n,{action:t,args:r,extensionId:i,page:s,opts:o}=e;t==="open"?this.app.workbench.showExtension(i,r,s,o):t==="close"&&alert("hideExtension Not implemented")}_handleRegistration(n,e){if(n.type!=="client_registration")return;let t=n;e&&t.token&&"postMessage"in e&&!this.registeredFrames[t.token]&&(this.registeredFrames[t.token]={contentWindow:e,registeredAt:new Date},console.log(`Iframe with token ${t.token} registered!`),this.send({type:"host_sync_data",packet:"intentMap",frame:Array.from(this.intentMap.entries())},t.token))}_handleShowToast(n){if(n.type!=="client_show_toast")return;let e=n,{message:t,options:r}=e;this.app.showToast(t,r)}_handleSignalIntent(n){var t,r,i;if(n.type!=="client_signal_intent")return;let e=n;if((t=e.payload)!=null&&t.fid||(i=(r=e.payload)==null?void 0:r.ticket)!=null&&i.fid){this.signalFileIntent(e.intent,e.payload,e.opts);return}e.intent==="show"||e.intent==="edit"?this.app.workbench.showExtension(e.target,e.payload,void 0,e.opts):e.intent==="hide"?this.app.workbench.hideExtension(e.target):console.warn(`Invalid intent ${e.intent}`,e)}_handleDeregistration(n){if(n.type!=="client_deregistration")return;let e=n;e.token&&this.registeredFrames[e.token]&&this.deregister(e.token)}_handleLoadRecipe(n){if(n.type!=="client_load_recipe")return;let e=n;this.app.workbench.loadRecipe(e.recipeId,e.recipeVersion)}_handleShowTopBanner(n){if(n.type!=="client_show_top_banner")return;let e=n,{bannerTitle:t,bannerDescription:r,options:i}=e;this.app.showTopBanner(t,r,i)}send(n,e="*"){if(n.token=e,n=JSON.parse(JSON.stringify(n)),e==="*")for(let t of Object.values(this.registeredFrames))t.contentWindow.postMessage(n,"*");else{let t=this.registeredFrames[e];t?t.contentWindow.postMessage(n,"*"):console.warn(`No registered frame with token ${e}`)}}},Gi=af(Bf(),1);function oo(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Vt=oo();function uc(n){Vt=n}var hc=/[&<>"']/,Kf=new RegExp(hc.source,"g"),pc=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,Yf=new RegExp(pc.source,"g"),Zf={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Na=n=>Zf[n];function Le(n,e){if(e){if(hc.test(n))return n.replace(Kf,Na)}else if(pc.test(n))return n.replace(Yf,Na);return n}var Xf=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function Qf(n){return n.replace(Xf,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}var eg=/(^|[^\[])\^/g;function ee(n,e){n=typeof n=="string"?n:n.source,e=e||"";let t={replace:(r,i)=>(i=typeof i=="object"&&"source"in i?i.source:i,i=i.replace(eg,"$1"),n=n.replace(r,i),t),getRegex:()=>new RegExp(n,e)};return t}function La(n){try{n=encodeURI(n).replace(/%25/g,"%")}catch{return null}return n}var Yr={exec:()=>null};function Ma(n,e){let t=n.replace(/\|/g,(s,o,a)=>{let l=!1,h=o;for(;--h>=0&&a[h]==="\\";)l=!l;return l?"|":" |"}),r=t.split(/ \|/),i=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(/\\\|/g,"|");return r}function br(n,e,t){let r=n.length;if(r===0)return"";let i=0;for(;i<r;){let s=n.charAt(r-i-1);if(s===e&&!t)i++;else if(s!==e&&t)i++;else break}return n.slice(0,r-i)}function tg(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let r=0;r<n.length;r++)if(n[r]==="\\")r++;else if(n[r]===e[0])t++;else if(n[r]===e[1]&&(t--,t<0))return r;return-1}function $a(n,e,t,r){let i=e.href,s=e.title?Le(e.title):null,o=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){r.state.inLink=!0;let a={type:"link",raw:t,href:i,title:s,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,a}return{type:"image",raw:t,href:i,title:s,text:Le(o)}}function ng(n,e){let t=n.match(/^(\s+)(?:```)/);if(t===null)return e;let r=t[1];return e.split(`
`).map(i=>{let s=i.match(/^\s+/);if(s===null)return i;let[o]=s;return o.length>=r.length?i.slice(r.length):i}).join(`
`)}var Zr=class{constructor(n){ae(this,"options"),ae(this,"rules"),ae(this,"lexer"),this.options=n||Vt}space(n){let e=this.rules.block.newline.exec(n);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(n){let e=this.rules.block.code.exec(n);if(e){let t=e[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:br(t,`
`)}}}fences(n){let e=this.rules.block.fences.exec(n);if(e){let t=e[0],r=ng(t,e[3]||"");return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline._escapes,"$1"):e[2],text:r}}}heading(n){let e=this.rules.block.heading.exec(n);if(e){let t=e[2].trim();if(/#$/.test(t)){let r=br(t,"#");(this.options.pedantic||!r||/ $/.test(r))&&(t=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(n){let e=this.rules.block.hr.exec(n);if(e)return{type:"hr",raw:e[0]}}blockquote(n){let e=this.rules.block.blockquote.exec(n);if(e){let t=br(e[0].replace(/^ *>[ \t]?/gm,""),`
`),r=this.lexer.state.top;this.lexer.state.top=!0;let i=this.lexer.blockTokens(t);return this.lexer.state.top=r,{type:"blockquote",raw:e[0],tokens:i,text:t}}}list(n){let e=this.rules.block.list.exec(n);if(e){let t=e[1].trim(),r=t.length>1,i={type:"list",raw:"",ordered:r,start:r?+t.slice(0,-1):"",loose:!1,items:[]};t=r?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=r?t:"[*+-]");let s=new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),o="",a="",l=!1;for(;n;){let h=!1;if(!(e=s.exec(n))||this.rules.block.hr.test(n))break;o=e[0],n=n.substring(o.length);let u=e[2].split(`
`,1)[0].replace(/^\t+/,m=>" ".repeat(3*m.length)),p=n.split(`
`,1)[0],d=0;this.options.pedantic?(d=2,a=u.trimStart()):(d=e[2].search(/[^ ]/),d=d>4?1:d,a=u.slice(d),d+=e[1].length);let c=!1;if(!u&&/^ *$/.test(p)&&(o+=p+`
`,n=n.substring(p.length+1),h=!0),!h){let m=new RegExp(`^ {0,${Math.min(3,d-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),y=new RegExp(`^ {0,${Math.min(3,d-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),w=new RegExp(`^ {0,${Math.min(3,d-1)}}(?:\`\`\`|~~~)`),_=new RegExp(`^ {0,${Math.min(3,d-1)}}#`);for(;n;){let v=n.split(`
`,1)[0];if(p=v,this.options.pedantic&&(p=p.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),w.test(p)||_.test(p)||m.test(p)||y.test(n))break;if(p.search(/[^ ]/)>=d||!p.trim())a+=`
`+p.slice(d);else{if(c||u.search(/[^ ]/)>=4||w.test(u)||_.test(u)||y.test(u))break;a+=`
`+p}!c&&!p.trim()&&(c=!0),o+=v+`
`,n=n.substring(v.length+1),u=p.slice(d)}}i.loose||(l?i.loose=!0:/\n *\n *$/.test(o)&&(l=!0));let f=null,g;this.options.gfm&&(f=/^\[[ xX]\] /.exec(a),f&&(g=f[0]!=="[ ] ",a=a.replace(/^\[[ xX]\] +/,""))),i.items.push({type:"list_item",raw:o,task:!!f,checked:g,loose:!1,text:a,tokens:[]}),i.raw+=o}i.items[i.items.length-1].raw=o.trimEnd(),i.items[i.items.length-1].text=a.trimEnd(),i.raw=i.raw.trimEnd();for(let h=0;h<i.items.length;h++)if(this.lexer.state.top=!1,i.items[h].tokens=this.lexer.blockTokens(i.items[h].text,[]),!i.loose){let u=i.items[h].tokens.filter(d=>d.type==="space"),p=u.length>0&&u.some(d=>/\n.*\n/.test(d.raw));i.loose=p}if(i.loose)for(let h=0;h<i.items.length;h++)i.items[h].loose=!0;return i}}html(n){let e=this.rules.block.html.exec(n);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(n){let e=this.rules.block.def.exec(n);if(e){let t=e[1].toLowerCase().replace(/\s+/g," "),r=e[2]?e[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline._escapes,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:r,title:i}}}table(n){let e=this.rules.block.table.exec(n);if(e){if(!/[:|]/.test(e[2]))return;let t={type:"table",raw:e[0],header:Ma(e[1]).map(r=>({text:r,tokens:[]})),align:e[2].replace(/^\||\| *$/g,"").split("|"),rows:e[3]&&e[3].trim()?e[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(t.header.length===t.align.length){let r=t.align.length,i,s,o,a;for(i=0;i<r;i++){let l=t.align[i];l&&(/^ *-+: *$/.test(l)?t.align[i]="right":/^ *:-+: *$/.test(l)?t.align[i]="center":/^ *:-+ *$/.test(l)?t.align[i]="left":t.align[i]=null)}for(r=t.rows.length,i=0;i<r;i++)t.rows[i]=Ma(t.rows[i],t.header.length).map(l=>({text:l,tokens:[]}));for(r=t.header.length,s=0;s<r;s++)t.header[s].tokens=this.lexer.inline(t.header[s].text);for(r=t.rows.length,s=0;s<r;s++)for(a=t.rows[s],o=0;o<a.length;o++)a[o].tokens=this.lexer.inline(a[o].text);return t}}}lheading(n){let e=this.rules.block.lheading.exec(n);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(n){let e=this.rules.block.paragraph.exec(n);if(e){let t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(n){let e=this.rules.block.text.exec(n);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(n){let e=this.rules.inline.escape.exec(n);if(e)return{type:"escape",raw:e[0],text:Le(e[1])}}tag(n){let e=this.rules.inline.tag.exec(n);if(e)return!this.lexer.state.inLink&&/^<a /i.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(n){let e=this.rules.inline.link.exec(n);if(e){let t=e[2].trim();if(!this.options.pedantic&&/^</.test(t)){if(!/>$/.test(t))return;let s=br(t.slice(0,-1),"\\");if((t.length-s.length)%2===0)return}else{let s=tg(e[2],"()");if(s>-1){let o=(e[0].indexOf("!")===0?5:4)+e[1].length+s;e[2]=e[2].substring(0,s),e[0]=e[0].substring(0,o).trim(),e[3]=""}}let r=e[2],i="";if(this.options.pedantic){let s=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r);s&&(r=s[1],i=s[3])}else i=e[3]?e[3].slice(1,-1):"";return r=r.trim(),/^</.test(r)&&(this.options.pedantic&&!/>$/.test(t)?r=r.slice(1):r=r.slice(1,-1)),$a(e,{href:r&&r.replace(this.rules.inline._escapes,"$1"),title:i&&i.replace(this.rules.inline._escapes,"$1")},e[0],this.lexer)}}reflink(n,e){let t;if((t=this.rules.inline.reflink.exec(n))||(t=this.rules.inline.nolink.exec(n))){let r=(t[2]||t[1]).replace(/\s+/g," ");if(r=e[r.toLowerCase()],!r){let i=t[0].charAt(0);return{type:"text",raw:i,text:i}}return $a(t,r,t[0],this.lexer)}}emStrong(n,e,t=""){let r=this.rules.inline.emStrong.lDelim.exec(n);if(!(!r||r[3]&&t.match(/[\p{L}\p{N}]/u))&&(!(r[1]||r[2])||!t||this.rules.inline.punctuation.exec(t))){let i=[...r[0]].length-1,s,o,a=i,l=0,h=r[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(h.lastIndex=0,e=e.slice(-1*n.length+i);(r=h.exec(e))!=null;){if(s=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!s)continue;if(o=[...s].length,r[3]||r[4]){a+=o;continue}else if((r[5]||r[6])&&i%3&&!((i+o)%3)){l+=o;continue}if(a-=o,a>0)continue;o=Math.min(o,o+a+l);let u=[...r[0]][0].length,p=n.slice(0,i+r.index+u+o);if(Math.min(i,o)%2){let c=p.slice(1,-1);return{type:"em",raw:p,text:c,tokens:this.lexer.inlineTokens(c)}}let d=p.slice(2,-2);return{type:"strong",raw:p,text:d,tokens:this.lexer.inlineTokens(d)}}}}codespan(n){let e=this.rules.inline.code.exec(n);if(e){let t=e[2].replace(/\n/g," "),r=/[^ ]/.test(t),i=/^ /.test(t)&&/ $/.test(t);return r&&i&&(t=t.substring(1,t.length-1)),t=Le(t,!0),{type:"codespan",raw:e[0],text:t}}}br(n){let e=this.rules.inline.br.exec(n);if(e)return{type:"br",raw:e[0]}}del(n){let e=this.rules.inline.del.exec(n);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(n){let e=this.rules.inline.autolink.exec(n);if(e){let t,r;return e[2]==="@"?(t=Le(e[1]),r="mailto:"+t):(t=Le(e[1]),r=t),{type:"link",raw:e[0],text:t,href:r,tokens:[{type:"text",raw:t,text:t}]}}}url(n){let e;if(e=this.rules.inline.url.exec(n)){let t,r;if(e[2]==="@")t=Le(e[0]),r="mailto:"+t;else{let i;do i=e[0],e[0]=this.rules.inline._backpedal.exec(e[0])[0];while(i!==e[0]);t=Le(e[0]),e[1]==="www."?r="http://"+e[0]:r=e[0]}return{type:"link",raw:e[0],text:t,href:r,tokens:[{type:"text",raw:t,text:t}]}}}inlineText(n){let e=this.rules.inline.text.exec(n);if(e){let t;return this.lexer.state.inRawBlock?t=e[0]:t=Le(e[0]),{type:"text",raw:e[0],text:t}}}},z={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:Yr,lheading:/^(?!bull )((?:.|\n(?!\s*?\n|bull ))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};z._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;z._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;z.def=ee(z.def).replace("label",z._label).replace("title",z._title).getRegex();z.bullet=/(?:[*+-]|\d{1,9}[.)])/;z.listItemStart=ee(/^( *)(bull) */).replace("bull",z.bullet).getRegex();z.list=ee(z.list).replace(/bull/g,z.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+z.def.source+")").getRegex();z._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";z._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;z.html=ee(z.html,"i").replace("comment",z._comment).replace("tag",z._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();z.lheading=ee(z.lheading).replace(/bull/g,z.bullet).getRegex();z.paragraph=ee(z._paragraph).replace("hr",z.hr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",z._tag).getRegex();z.blockquote=ee(z.blockquote).replace("paragraph",z.paragraph).getRegex();z.normal={...z};z.gfm={...z.normal,table:"^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"};z.gfm.table=ee(z.gfm.table).replace("hr",z.hr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",z._tag).getRegex();z.gfm.paragraph=ee(z._paragraph).replace("hr",z.hr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",z.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",z._tag).getRegex();z.pedantic={...z.normal,html:ee(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",z._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Yr,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:ee(z.normal._paragraph).replace("hr",z.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",z.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()};var L={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Yr,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,rDelimAst:/^[^_*]*?__[^_*]*?\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\*)[punct](\*+)(?=[\s]|$)|[^punct\s](\*+)(?!\*)(?=[punct\s]|$)|(?!\*)[punct\s](\*+)(?=[^punct\s])|[\s](\*+)(?!\*)(?=[punct])|(?!\*)[punct](\*+)(?!\*)(?=[punct])|[^punct\s](\*+)(?=[^punct\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\s]|$)|[^punct\s](_+)(?!_)(?=[punct\s]|$)|(?!_)[punct\s](_+)(?=[^punct\s])|[\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Yr,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^((?![*_])[\spunctuation])/};L._punctuation="\\p{P}$+<=>`^|~";L.punctuation=ee(L.punctuation,"u").replace(/punctuation/g,L._punctuation).getRegex();L.blockSkip=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g;L.anyPunctuation=/\\[punct]/g;L._escapes=/\\([punct])/g;L._comment=ee(z._comment).replace("(?:-->|$)","-->").getRegex();L.emStrong.lDelim=ee(L.emStrong.lDelim,"u").replace(/punct/g,L._punctuation).getRegex();L.emStrong.rDelimAst=ee(L.emStrong.rDelimAst,"gu").replace(/punct/g,L._punctuation).getRegex();L.emStrong.rDelimUnd=ee(L.emStrong.rDelimUnd,"gu").replace(/punct/g,L._punctuation).getRegex();L.anyPunctuation=ee(L.anyPunctuation,"gu").replace(/punct/g,L._punctuation).getRegex();L._escapes=ee(L._escapes,"gu").replace(/punct/g,L._punctuation).getRegex();L._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;L._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;L.autolink=ee(L.autolink).replace("scheme",L._scheme).replace("email",L._email).getRegex();L._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;L.tag=ee(L.tag).replace("comment",L._comment).replace("attribute",L._attribute).getRegex();L._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;L._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;L._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;L.link=ee(L.link).replace("label",L._label).replace("href",L._href).replace("title",L._title).getRegex();L.reflink=ee(L.reflink).replace("label",L._label).replace("ref",z._label).getRegex();L.nolink=ee(L.nolink).replace("ref",z._label).getRegex();L.reflinkSearch=ee(L.reflinkSearch,"g").replace("reflink",L.reflink).replace("nolink",L.nolink).getRegex();L.normal={...L};L.pedantic={...L.normal,strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:ee(/^!?\[(label)\]\((.*?)\)/).replace("label",L._label).getRegex(),reflink:ee(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",L._label).getRegex()};L.gfm={...L.normal,escape:ee(L.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/};L.gfm.url=ee(L.gfm.url,"i").replace("email",L.gfm._extended_email).getRegex();L.breaks={...L.gfm,br:ee(L.br).replace("{2,}","*").getRegex(),text:ee(L.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};var Lt=class ys{constructor(e){ae(this,"tokens"),ae(this,"options"),ae(this,"state"),ae(this,"tokenizer"),ae(this,"inlineQueue"),this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Vt,this.options.tokenizer=this.options.tokenizer||new Zr,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={block:z.normal,inline:L.normal};this.options.pedantic?(t.block=z.pedantic,t.inline=L.pedantic):this.options.gfm&&(t.block=z.gfm,this.options.breaks?t.inline=L.breaks:t.inline=L.gfm),this.tokenizer.rules=t}static get rules(){return{block:z,inline:L}}static lex(e,t){return new ys(t).lex(e)}static lexInline(e,t){return new ys(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);let t;for(;t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(a,l,h)=>l+"    ".repeat(h.length));let r,i,s,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(r=a.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))){if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length),r.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+r.raw,i.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(s=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0,l=e.slice(1),h;this.options.extensions.startBlock.forEach(u=>{h=u.call({lexer:this},l),typeof h=="number"&&h>=0&&(a=Math.min(a,h))}),a<1/0&&a>=0&&(s=e.substring(0,a+1))}if(this.state.top&&(r=this.tokenizer.paragraph(s))){i=t[t.length-1],o&&i.type==="paragraph"?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r),o=s.length!==e.length,e=e.substring(r.raw.length);continue}if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&i.type==="text"?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r);continue}if(e){let a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let r,i,s,o=e,a,l,h;if(this.tokens.links){let u=Object.keys(this.tokens.links);if(u.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null;)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(l||(h=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(r=u.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))){if(r=this.tokenizer.escape(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.tag(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&r.type==="text"&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):t.push(r);continue}if(r=this.tokenizer.link(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(r.raw.length),i=t[t.length-1],i&&r.type==="text"&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):t.push(r);continue}if(r=this.tokenizer.emStrong(e,o,h)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.codespan(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.br(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.del(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.autolink(e)){e=e.substring(r.raw.length),t.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(e))){e=e.substring(r.raw.length),t.push(r);continue}if(s=e,this.options.extensions&&this.options.extensions.startInline){let u=1/0,p=e.slice(1),d;this.options.extensions.startInline.forEach(c=>{d=c.call({lexer:this},p),typeof d=="number"&&d>=0&&(u=Math.min(u,d))}),u<1/0&&u>=0&&(s=e.substring(0,u+1))}if(r=this.tokenizer.inlineText(s)){e=e.substring(r.raw.length),r.raw.slice(-1)!=="_"&&(h=r.raw.slice(-1)),l=!0,i=t[t.length-1],i&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):t.push(r);continue}if(e){let u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return t}},Xr=class{constructor(n){ae(this,"options"),this.options=n||Vt}code(n,e,t){var i;let r=(i=(e||"").match(/^\S*/))==null?void 0:i[0];return n=n.replace(/\n$/,"")+`
`,r?'<pre><code class="language-'+Le(r)+'">'+(t?n:Le(n,!0))+`</code></pre>
`:"<pre><code>"+(t?n:Le(n,!0))+`</code></pre>
`}blockquote(n){return`<blockquote>
${n}</blockquote>
`}html(n,e){return n}heading(n,e,t){return`<h${e}>${n}</h${e}>
`}hr(){return`<hr>
`}list(n,e,t){let r=e?"ol":"ul",i=e&&t!==1?' start="'+t+'"':"";return"<"+r+i+`>
`+n+"</"+r+`>
`}listitem(n,e,t){return`<li>${n}</li>
`}checkbox(n){return"<input "+(n?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(n){return`<p>${n}</p>
`}table(n,e){return e&&(e=`<tbody>${e}</tbody>`),`<table>
<thead>
`+n+`</thead>
`+e+`</table>
`}tablerow(n){return`<tr>
${n}</tr>
`}tablecell(n,e){let t=e.header?"th":"td";return(e.align?`<${t} align="${e.align}">`:`<${t}>`)+n+`</${t}>
`}strong(n){return`<strong>${n}</strong>`}em(n){return`<em>${n}</em>`}codespan(n){return`<code>${n}</code>`}br(){return"<br>"}del(n){return`<del>${n}</del>`}link(n,e,t){let r=La(n);if(r===null)return t;n=r;let i='<a href="'+n+'"';return e&&(i+=' title="'+e+'"'),i+=">"+t+"</a>",i}image(n,e,t){let r=La(n);if(r===null)return t;n=r;let i=`<img src="${n}" alt="${t}"`;return e&&(i+=` title="${e}"`),i+=">",i}text(n){return n}},ao=class{strong(n){return n}em(n){return n}codespan(n){return n}del(n){return n}html(n){return n}text(n){return n}link(n,e,t){return""+t}image(n,e,t){return""+t}br(){return""}},Mt=class ws{constructor(e){ae(this,"options"),ae(this,"renderer"),ae(this,"textRenderer"),this.options=e||Vt,this.options.renderer=this.options.renderer||new Xr,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new ao}static parse(e,t){return new ws(t).parse(e)}static parseInline(e,t){return new ws(t).parseInline(e)}parse(e,t=!0){let r="";for(let i=0;i<e.length;i++){let s=e[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){let o=s,a=this.options.extensions.renderers[o.type].call({parser:this},o);if(a!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(o.type)){r+=a||"";continue}}switch(s.type){case"space":continue;case"hr":{r+=this.renderer.hr();continue}case"heading":{let o=s;r+=this.renderer.heading(this.parseInline(o.tokens),o.depth,Qf(this.parseInline(o.tokens,this.textRenderer)));continue}case"code":{let o=s;r+=this.renderer.code(o.text,o.lang,!!o.escaped);continue}case"table":{let o=s,a="",l="";for(let u=0;u<o.header.length;u++)l+=this.renderer.tablecell(this.parseInline(o.header[u].tokens),{header:!0,align:o.align[u]});a+=this.renderer.tablerow(l);let h="";for(let u=0;u<o.rows.length;u++){let p=o.rows[u];l="";for(let d=0;d<p.length;d++)l+=this.renderer.tablecell(this.parseInline(p[d].tokens),{header:!1,align:o.align[d]});h+=this.renderer.tablerow(l)}r+=this.renderer.table(a,h);continue}case"blockquote":{let o=s,a=this.parse(o.tokens);r+=this.renderer.blockquote(a);continue}case"list":{let o=s,a=o.ordered,l=o.start,h=o.loose,u="";for(let p=0;p<o.items.length;p++){let d=o.items[p],c=d.checked,f=d.task,g="";if(d.task){let m=this.renderer.checkbox(!!c);h?d.tokens.length>0&&d.tokens[0].type==="paragraph"?(d.tokens[0].text=m+" "+d.tokens[0].text,d.tokens[0].tokens&&d.tokens[0].tokens.length>0&&d.tokens[0].tokens[0].type==="text"&&(d.tokens[0].tokens[0].text=m+" "+d.tokens[0].tokens[0].text)):d.tokens.unshift({type:"text",text:m+" "}):g+=m+" "}g+=this.parse(d.tokens,h),u+=this.renderer.listitem(g,f,!!c)}r+=this.renderer.list(u,a,l);continue}case"html":{let o=s;r+=this.renderer.html(o.text,o.block);continue}case"paragraph":{let o=s;r+=this.renderer.paragraph(this.parseInline(o.tokens));continue}case"text":{let o=s,a=o.tokens?this.parseInline(o.tokens):o.text;for(;i+1<e.length&&e[i+1].type==="text";)o=e[++i],a+=`
`+(o.tokens?this.parseInline(o.tokens):o.text);r+=t?this.renderer.paragraph(a):a;continue}default:{let o='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}parseInline(e,t){t=t||this.renderer;let r="";for(let i=0;i<e.length;i++){let s=e[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){let o=this.options.extensions.renderers[s.type].call({parser:this},s);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){r+=o||"";continue}}switch(s.type){case"escape":{let o=s;r+=t.text(o.text);break}case"html":{let o=s;r+=t.html(o.text);break}case"link":{let o=s;r+=t.link(o.href,o.title,this.parseInline(o.tokens,t));break}case"image":{let o=s;r+=t.image(o.href,o.title,o.text);break}case"strong":{let o=s;r+=t.strong(this.parseInline(o.tokens,t));break}case"em":{let o=s;r+=t.em(this.parseInline(o.tokens,t));break}case"codespan":{let o=s;r+=t.codespan(o.text);break}case"br":{r+=t.br();break}case"del":{let o=s;r+=t.del(this.parseInline(o.tokens,t));break}case"text":{let o=s;r+=t.text(o.text);break}default:{let o='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}},zn=class{constructor(n){ae(this,"options"),this.options=n||Vt}preprocess(n){return n}postprocess(n){return n}};ae(zn,"passThroughHooks",new Set(["preprocess","postprocess"]));var Mr,bs,vs,Da,rg=class{constructor(...n){Ca(this,Mr),Ca(this,vs),ae(this,"defaults",oo()),ae(this,"options",this.setOptions),ae(this,"parse",gs(this,Mr,bs).call(this,Lt.lex,Mt.parse)),ae(this,"parseInline",gs(this,Mr,bs).call(this,Lt.lexInline,Mt.parseInline)),ae(this,"Parser",Mt),ae(this,"parser",Mt.parse),ae(this,"Renderer",Xr),ae(this,"TextRenderer",ao),ae(this,"Lexer",Lt),ae(this,"lexer",Lt.lex),ae(this,"Tokenizer",Zr),ae(this,"Hooks",zn),this.use(...n)}walkTokens(n,e){var r,i;let t=[];for(let s of n)switch(t=t.concat(e.call(this,s)),s.type){case"table":{let o=s;for(let a of o.header)t=t.concat(this.walkTokens(a.tokens,e));for(let a of o.rows)for(let l of a)t=t.concat(this.walkTokens(l.tokens,e));break}case"list":{let o=s;t=t.concat(this.walkTokens(o.items,e));break}default:{let o=s;(i=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&i[o.type]?this.defaults.extensions.childTokens[o.type].forEach(a=>{t=t.concat(this.walkTokens(o[a],e))}):o.tokens&&(t=t.concat(this.walkTokens(o.tokens,e)))}}return t}use(...n){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return n.forEach(t=>{let r={...t};if(r.async=this.defaults.async||r.async||!1,t.extensions&&(t.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let s=e.renderers[i.name];s?e.renderers[i.name]=function(...o){let a=i.renderer.apply(this,o);return a===!1&&(a=s.apply(this,o)),a}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let s=e[i.level];s?s.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),r.extensions=e),t.renderer){let i=this.defaults.renderer||new Xr(this.defaults);for(let s in t.renderer){let o=t.renderer[s],a=s,l=i[a];i[a]=(...h)=>{let u=o.apply(i,h);return u===!1&&(u=l.apply(i,h)),u||""}}r.renderer=i}if(t.tokenizer){let i=this.defaults.tokenizer||new Zr(this.defaults);for(let s in t.tokenizer){let o=t.tokenizer[s],a=s,l=i[a];i[a]=(...h)=>{let u=o.apply(i,h);return u===!1&&(u=l.apply(i,h)),u}}r.tokenizer=i}if(t.hooks){let i=this.defaults.hooks||new zn;for(let s in t.hooks){let o=t.hooks[s],a=s,l=i[a];zn.passThroughHooks.has(s)?i[a]=h=>{if(this.defaults.async)return Promise.resolve(o.call(i,h)).then(p=>l.call(i,p));let u=o.call(i,h);return l.call(i,u)}:i[a]=(...h)=>{let u=o.apply(i,h);return u===!1&&(u=l.apply(i,h)),u}}r.hooks=i}if(t.walkTokens){let i=this.defaults.walkTokens,s=t.walkTokens;r.walkTokens=function(o){let a=[];return a.push(s.call(this,o)),i&&(a=a.concat(i.call(this,o))),a}}this.defaults={...this.defaults,...r}}),this}setOptions(n){return this.defaults={...this.defaults,...n},this}};Mr=new WeakSet,bs=function(n,e){return(t,r)=>{let i={...r},s={...this.defaults,...i};this.defaults.async===!0&&i.async===!1&&(s.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),s.async=!0);let o=gs(this,vs,Da).call(this,!!s.silent,!!s.async);if(typeof t>"u"||t===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(s.hooks&&(s.hooks.options=s),s.async)return Promise.resolve(s.hooks?s.hooks.preprocess(t):t).then(a=>n(a,s)).then(a=>s.walkTokens?Promise.all(this.walkTokens(a,s.walkTokens)).then(()=>a):a).then(a=>e(a,s)).then(a=>s.hooks?s.hooks.postprocess(a):a).catch(o);try{s.hooks&&(t=s.hooks.preprocess(t));let a=n(t,s);s.walkTokens&&this.walkTokens(a,s.walkTokens);let l=e(a,s);return s.hooks&&(l=s.hooks.postprocess(l)),l}catch(a){return o(a)}}},vs=new WeakSet,Da=function(n,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,n){let r="<p>An error occurred:</p><pre>"+Le(t.message+"",!0)+"</pre>";return e?Promise.resolve(r):r}if(e)return Promise.reject(t);throw t}};var Wt=new rg;function Z(n,e){return Wt.parse(n,e)}Z.options=Z.setOptions=function(n){return Wt.setOptions(n),Z.defaults=Wt.defaults,uc(Z.defaults),Z};Z.getDefaults=oo;Z.defaults=Vt;Z.use=function(...n){return Wt.use(...n),Z.defaults=Wt.defaults,uc(Z.defaults),Z};Z.walkTokens=function(n,e){return Wt.walkTokens(n,e)};Z.parseInline=Wt.parseInline;Z.Parser=Mt;Z.parser=Mt.parse;Z.Renderer=Xr;Z.TextRenderer=ao;Z.Lexer=Lt;Z.lexer=Lt.lex;Z.Tokenizer=Zr;Z.Hooks=zn;Z.parse=Z;Z.options;Z.setOptions;Z.use;Z.walkTokens;Z.parseInline;Mt.parse;Lt.lex;var dc=new Z.Renderer;dc.link=function(n,e,t){return Z.Renderer.prototype.link.apply(this,arguments).replace("<a","<a target='_blank'")};var ig=class{constructor(){this.SafeString=Gi.default.SafeString,this.asyncResolvers={},this.handlebars=Gi.default.create()}registerAsyncResolver(n,e){this.asyncResolvers[n]=e}registerToken(n,e){this.handlebars.registerHelper(n,e)}async getAsyncDataForDirective(n,e){let t=await this.asyncResolvers[n];if(!t)throw new Error(`No resolver registered for directive: ${n}`);return await t(e)}extractDirectiveData(n){var e,t,r;if(n.type==="MustacheStatement"||n.type==="BlockStatement"){let i=(e=n.path)==null?void 0:e.original,s=(r=(t=n.params)==null?void 0:t[0])==null?void 0:r.original;return{name:i,param:s}}return{}}async preprocessData(n,e){let t={};for(let[r,i]of e.entries()){let s=Gi.default.parse(i),o=this.extractDirectiveData(s.body[0]),a=o==null?void 0:o.name,l=o==null?void 0:o.param;a&&l&&(n=n.replace(r,i))}return{content:n,data:t}}extractTokens(n){let e=/{{\s*([a-zA-Z0-9_-]+)\s*([^}]*)\s*}}/g,t=new Map,r=0;return{modifiedContent:n.replace(e,i=>{let s=`TOKEN_${++r}`;return t.set(s,i),s}),tokens:t}}injectTokens(n,e){let t=n;return e.forEach((r,i)=>{t=t.replace(i,r)}),t}async render(n,e={}){let{modifiedContent:t,tokens:r}=this.extractTokens(n),i=Z.parse(t,{renderer:dc}),{content:s,data:o}=await this.preprocessData(i,r);return s=this.injectTokens(s,r),this.handlebars.compile(s)(Object.assign({},o,e))}};/*! @license DOMPurify 3.0.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.0.6/LICENSE */const{entries:fc,setPrototypeOf:ja,isFrozen:sg,getPrototypeOf:og,getOwnPropertyDescriptor:gc}=Object;let{freeze:xe,seal:Je,create:mc}=Object,{apply:_s,construct:ks}=typeof Reflect<"u"&&Reflect;xe||(xe=function(e){return e});Je||(Je=function(e){return e});_s||(_s=function(e,t,r){return e.apply(t,r)});ks||(ks=function(e,t){return new e(...t)});const vr=Fe(Array.prototype.forEach),Ba=Fe(Array.prototype.pop),Rn=Fe(Array.prototype.push),$r=Fe(String.prototype.toLowerCase),Ki=Fe(String.prototype.toString),ag=Fe(String.prototype.match),In=Fe(String.prototype.replace),lg=Fe(String.prototype.indexOf),cg=Fe(String.prototype.trim),Ne=Fe(RegExp.prototype.test),Pn=ug(TypeError);function Fe(n){return function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return _s(n,e,r)}}function ug(n){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return ks(n,t)}}function V(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$r;ja&&ja(n,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const s=t(i);s!==i&&(sg(e)||(e[r]=s),i=s)}n[i]=!0}return n}function ln(n){const e=mc(null);for(const[t,r]of fc(n))gc(n,t)!==void 0&&(e[t]=r);return e}function _r(n,e){for(;n!==null;){const r=gc(n,e);if(r){if(r.get)return Fe(r.get);if(typeof r.value=="function")return Fe(r.value)}n=og(n)}function t(r){return console.warn("fallback value for",r),null}return t}const za=xe(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Yi=xe(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Zi=xe(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),hg=xe(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Xi=xe(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),pg=xe(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Fa=xe(["#text"]),Ua=xe(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Qi=xe(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Ha=xe(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),kr=xe(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),dg=Je(/\{\{[\w\W]*|[\w\W]*\}\}/gm),fg=Je(/<%[\w\W]*|[\w\W]*%>/gm),gg=Je(/\${[\w\W]*}/gm),mg=Je(/^data-[\-\w.\u00B7-\uFFFF]/),yg=Je(/^aria-[\-\w]+$/),yc=Je(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),wg=Je(/^(?:\w+script|data):/i),bg=Je(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),wc=Je(/^html$/i);var Wa=Object.freeze({__proto__:null,MUSTACHE_EXPR:dg,ERB_EXPR:fg,TMPLIT_EXPR:gg,DATA_ATTR:mg,ARIA_ATTR:yg,IS_ALLOWED_URI:yc,IS_SCRIPT_OR_DATA:wg,ATTR_WHITESPACE:bg,DOCTYPE_NAME:wc});const vg=function(){return typeof window>"u"?null:window},_g=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(r=t.getAttribute(i));const s="dompurify"+(r?"#"+r:"");try{return e.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}};function bc(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vg();const e=j=>bc(j);if(e.version="3.0.6",e.removed=[],!n||!n.document||n.document.nodeType!==9)return e.isSupported=!1,e;let{document:t}=n;const r=t,i=r.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:a,Element:l,NodeFilter:h,NamedNodeMap:u=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:p,DOMParser:d,trustedTypes:c}=n,f=l.prototype,g=_r(f,"cloneNode"),m=_r(f,"nextSibling"),y=_r(f,"childNodes"),w=_r(f,"parentNode");if(typeof o=="function"){const j=t.createElement("template");j.content&&j.content.ownerDocument&&(t=j.content.ownerDocument)}let _,v="";const{implementation:b,createNodeIterator:x,createDocumentFragment:E,getElementsByTagName:N}=t,{importNode:$}=r;let A={};e.isSupported=typeof fc=="function"&&typeof w=="function"&&b&&b.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:k,ERB_EXPR:O,TMPLIT_EXPR:T,DATA_ATTR:I,ARIA_ATTR:U,IS_SCRIPT_OR_DATA:J,ATTR_WHITESPACE:X}=Wa;let{IS_ALLOWED_URI:fe}=Wa,H=null;const pe=V({},[...za,...Yi,...Zi,...Xi,...Fa]);let Y=null;const gt=V({},[...Ua,...Qi,...Ha,...kr]);let re=Object.seal(mc(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),De=null,je=null,kn=!0,Kt=!0,xn=!1,Sn=!0,Ze=!1,Ue=!1,Yt=!1,Ti=!1,Zt=!1,ar=!1,lr=!1,Fo=!0,Uo=!1;const Xu="user-content-";let Ri=!0,En=!1,Xt={},Qt=null;const Ho=V({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Wo=null;const qo=V({},["audio","video","img","source","image","track"]);let Ii=null;const Vo=V({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),cr="http://www.w3.org/1998/Math/MathML",ur="http://www.w3.org/2000/svg",st="http://www.w3.org/1999/xhtml";let en=st,Pi=!1,Ni=null;const Qu=V({},[cr,ur,st],Ki);let Ot=null;const eh=["application/xhtml+xml","text/html"],th="text/html";let ge=null,tn=null;const nh=t.createElement("form"),Jo=function(S){return S instanceof RegExp||S instanceof Function},Li=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(tn&&tn===S)){if((!S||typeof S!="object")&&(S={}),S=ln(S),Ot=eh.indexOf(S.PARSER_MEDIA_TYPE)===-1?Ot=th:Ot=S.PARSER_MEDIA_TYPE,ge=Ot==="application/xhtml+xml"?Ki:$r,H="ALLOWED_TAGS"in S?V({},S.ALLOWED_TAGS,ge):pe,Y="ALLOWED_ATTR"in S?V({},S.ALLOWED_ATTR,ge):gt,Ni="ALLOWED_NAMESPACES"in S?V({},S.ALLOWED_NAMESPACES,Ki):Qu,Ii="ADD_URI_SAFE_ATTR"in S?V(ln(Vo),S.ADD_URI_SAFE_ATTR,ge):Vo,Wo="ADD_DATA_URI_TAGS"in S?V(ln(qo),S.ADD_DATA_URI_TAGS,ge):qo,Qt="FORBID_CONTENTS"in S?V({},S.FORBID_CONTENTS,ge):Ho,De="FORBID_TAGS"in S?V({},S.FORBID_TAGS,ge):{},je="FORBID_ATTR"in S?V({},S.FORBID_ATTR,ge):{},Xt="USE_PROFILES"in S?S.USE_PROFILES:!1,kn=S.ALLOW_ARIA_ATTR!==!1,Kt=S.ALLOW_DATA_ATTR!==!1,xn=S.ALLOW_UNKNOWN_PROTOCOLS||!1,Sn=S.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ze=S.SAFE_FOR_TEMPLATES||!1,Ue=S.WHOLE_DOCUMENT||!1,Zt=S.RETURN_DOM||!1,ar=S.RETURN_DOM_FRAGMENT||!1,lr=S.RETURN_TRUSTED_TYPE||!1,Ti=S.FORCE_BODY||!1,Fo=S.SANITIZE_DOM!==!1,Uo=S.SANITIZE_NAMED_PROPS||!1,Ri=S.KEEP_CONTENT!==!1,En=S.IN_PLACE||!1,fe=S.ALLOWED_URI_REGEXP||yc,en=S.NAMESPACE||st,re=S.CUSTOM_ELEMENT_HANDLING||{},S.CUSTOM_ELEMENT_HANDLING&&Jo(S.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(re.tagNameCheck=S.CUSTOM_ELEMENT_HANDLING.tagNameCheck),S.CUSTOM_ELEMENT_HANDLING&&Jo(S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(re.attributeNameCheck=S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),S.CUSTOM_ELEMENT_HANDLING&&typeof S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(re.allowCustomizedBuiltInElements=S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ze&&(Kt=!1),ar&&(Zt=!0),Xt&&(H=V({},[...Fa]),Y=[],Xt.html===!0&&(V(H,za),V(Y,Ua)),Xt.svg===!0&&(V(H,Yi),V(Y,Qi),V(Y,kr)),Xt.svgFilters===!0&&(V(H,Zi),V(Y,Qi),V(Y,kr)),Xt.mathMl===!0&&(V(H,Xi),V(Y,Ha),V(Y,kr))),S.ADD_TAGS&&(H===pe&&(H=ln(H)),V(H,S.ADD_TAGS,ge)),S.ADD_ATTR&&(Y===gt&&(Y=ln(Y)),V(Y,S.ADD_ATTR,ge)),S.ADD_URI_SAFE_ATTR&&V(Ii,S.ADD_URI_SAFE_ATTR,ge),S.FORBID_CONTENTS&&(Qt===Ho&&(Qt=ln(Qt)),V(Qt,S.FORBID_CONTENTS,ge)),Ri&&(H["#text"]=!0),Ue&&V(H,["html","head","body"]),H.table&&(V(H,["tbody"]),delete De.tbody),S.TRUSTED_TYPES_POLICY){if(typeof S.TRUSTED_TYPES_POLICY.createHTML!="function")throw Pn('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof S.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Pn('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');_=S.TRUSTED_TYPES_POLICY,v=_.createHTML("")}else _===void 0&&(_=_g(c,i)),_!==null&&typeof v=="string"&&(v=_.createHTML(""));xe&&xe(S),tn=S}},Go=V({},["mi","mo","mn","ms","mtext"]),Ko=V({},["foreignobject","desc","title","annotation-xml"]),rh=V({},["title","style","font","a","script"]),hr=V({},Yi);V(hr,Zi),V(hr,hg);const Mi=V({},Xi);V(Mi,pg);const ih=function(S){let R=w(S);(!R||!R.tagName)&&(R={namespaceURI:en,tagName:"template"});const D=$r(S.tagName),oe=$r(R.tagName);return Ni[S.namespaceURI]?S.namespaceURI===ur?R.namespaceURI===st?D==="svg":R.namespaceURI===cr?D==="svg"&&(oe==="annotation-xml"||Go[oe]):!!hr[D]:S.namespaceURI===cr?R.namespaceURI===st?D==="math":R.namespaceURI===ur?D==="math"&&Ko[oe]:!!Mi[D]:S.namespaceURI===st?R.namespaceURI===ur&&!Ko[oe]||R.namespaceURI===cr&&!Go[oe]?!1:!Mi[D]&&(rh[D]||!hr[D]):!!(Ot==="application/xhtml+xml"&&Ni[S.namespaceURI]):!1},Ct=function(S){Rn(e.removed,{element:S});try{S.parentNode.removeChild(S)}catch{S.remove()}},$i=function(S,R){try{Rn(e.removed,{attribute:R.getAttributeNode(S),from:R})}catch{Rn(e.removed,{attribute:null,from:R})}if(R.removeAttribute(S),S==="is"&&!Y[S])if(Zt||ar)try{Ct(R)}catch{}else try{R.setAttribute(S,"")}catch{}},Yo=function(S){let R=null,D=null;if(Ti)S="<remove></remove>"+S;else{const ve=ag(S,/^[\r\n\t ]+/);D=ve&&ve[0]}Ot==="application/xhtml+xml"&&en===st&&(S='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+S+"</body></html>");const oe=_?_.createHTML(S):S;if(en===st)try{R=new d().parseFromString(oe,Ot)}catch{}if(!R||!R.documentElement){R=b.createDocument(en,"template",null);try{R.documentElement.innerHTML=Pi?v:oe}catch{}}const be=R.body||R.documentElement;return S&&D&&be.insertBefore(t.createTextNode(D),be.childNodes[0]||null),en===st?N.call(R,Ue?"html":"body")[0]:Ue?R.documentElement:be},Zo=function(S){return x.call(S.ownerDocument||S,S,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT,null)},sh=function(S){return S instanceof p&&(typeof S.nodeName!="string"||typeof S.textContent!="string"||typeof S.removeChild!="function"||!(S.attributes instanceof u)||typeof S.removeAttribute!="function"||typeof S.setAttribute!="function"||typeof S.namespaceURI!="string"||typeof S.insertBefore!="function"||typeof S.hasChildNodes!="function")},Xo=function(S){return typeof a=="function"&&S instanceof a},ot=function(S,R,D){A[S]&&vr(A[S],oe=>{oe.call(e,R,D,tn)})},Qo=function(S){let R=null;if(ot("beforeSanitizeElements",S,null),sh(S))return Ct(S),!0;const D=ge(S.nodeName);if(ot("uponSanitizeElement",S,{tagName:D,allowedTags:H}),S.hasChildNodes()&&!Xo(S.firstElementChild)&&Ne(/<[/\w]/g,S.innerHTML)&&Ne(/<[/\w]/g,S.textContent))return Ct(S),!0;if(!H[D]||De[D]){if(!De[D]&&ta(D)&&(re.tagNameCheck instanceof RegExp&&Ne(re.tagNameCheck,D)||re.tagNameCheck instanceof Function&&re.tagNameCheck(D)))return!1;if(Ri&&!Qt[D]){const oe=w(S)||S.parentNode,be=y(S)||S.childNodes;if(be&&oe){const ve=be.length;for(let Se=ve-1;Se>=0;--Se)oe.insertBefore(g(be[Se],!0),m(S))}}return Ct(S),!0}return S instanceof l&&!ih(S)||(D==="noscript"||D==="noembed"||D==="noframes")&&Ne(/<\/no(script|embed|frames)/i,S.innerHTML)?(Ct(S),!0):(Ze&&S.nodeType===3&&(R=S.textContent,vr([k,O,T],oe=>{R=In(R,oe," ")}),S.textContent!==R&&(Rn(e.removed,{element:S.cloneNode()}),S.textContent=R)),ot("afterSanitizeElements",S,null),!1)},ea=function(S,R,D){if(Fo&&(R==="id"||R==="name")&&(D in t||D in nh))return!1;if(!(Kt&&!je[R]&&Ne(I,R))){if(!(kn&&Ne(U,R))){if(!Y[R]||je[R]){if(!(ta(S)&&(re.tagNameCheck instanceof RegExp&&Ne(re.tagNameCheck,S)||re.tagNameCheck instanceof Function&&re.tagNameCheck(S))&&(re.attributeNameCheck instanceof RegExp&&Ne(re.attributeNameCheck,R)||re.attributeNameCheck instanceof Function&&re.attributeNameCheck(R))||R==="is"&&re.allowCustomizedBuiltInElements&&(re.tagNameCheck instanceof RegExp&&Ne(re.tagNameCheck,D)||re.tagNameCheck instanceof Function&&re.tagNameCheck(D))))return!1}else if(!Ii[R]){if(!Ne(fe,In(D,X,""))){if(!((R==="src"||R==="xlink:href"||R==="href")&&S!=="script"&&lg(D,"data:")===0&&Wo[S])){if(!(xn&&!Ne(J,In(D,X,"")))){if(D)return!1}}}}}}return!0},ta=function(S){return S.indexOf("-")>0},na=function(S){ot("beforeSanitizeAttributes",S,null);const{attributes:R}=S;if(!R)return;const D={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Y};let oe=R.length;for(;oe--;){const be=R[oe],{name:ve,namespaceURI:Se,value:Tt}=be,An=ge(ve);let Ee=ve==="value"?Tt:cg(Tt);if(D.attrName=An,D.attrValue=Ee,D.keepAttr=!0,D.forceKeepAttr=void 0,ot("uponSanitizeAttribute",S,D),Ee=D.attrValue,D.forceKeepAttr||($i(ve,S),!D.keepAttr))continue;if(!Sn&&Ne(/\/>/i,Ee)){$i(ve,S);continue}Ze&&vr([k,O,T],ia=>{Ee=In(Ee,ia," ")});const ra=ge(S.nodeName);if(ea(ra,An,Ee)){if(Uo&&(An==="id"||An==="name")&&($i(ve,S),Ee=Xu+Ee),_&&typeof c=="object"&&typeof c.getAttributeType=="function"&&!Se)switch(c.getAttributeType(ra,An)){case"TrustedHTML":{Ee=_.createHTML(Ee);break}case"TrustedScriptURL":{Ee=_.createScriptURL(Ee);break}}try{Se?S.setAttributeNS(Se,ve,Ee):S.setAttribute(ve,Ee),Ba(e.removed)}catch{}}}ot("afterSanitizeAttributes",S,null)},oh=function j(S){let R=null;const D=Zo(S);for(ot("beforeSanitizeShadowDOM",S,null);R=D.nextNode();)ot("uponSanitizeShadowNode",R,null),!Qo(R)&&(R.content instanceof s&&j(R.content),na(R));ot("afterSanitizeShadowDOM",S,null)};return e.sanitize=function(j){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},R=null,D=null,oe=null,be=null;if(Pi=!j,Pi&&(j="<!-->"),typeof j!="string"&&!Xo(j))if(typeof j.toString=="function"){if(j=j.toString(),typeof j!="string")throw Pn("dirty is not a string, aborting")}else throw Pn("toString is not a function");if(!e.isSupported)return j;if(Yt||Li(S),e.removed=[],typeof j=="string"&&(En=!1),En){if(j.nodeName){const Tt=ge(j.nodeName);if(!H[Tt]||De[Tt])throw Pn("root node is forbidden and cannot be sanitized in-place")}}else if(j instanceof a)R=Yo("<!---->"),D=R.ownerDocument.importNode(j,!0),D.nodeType===1&&D.nodeName==="BODY"||D.nodeName==="HTML"?R=D:R.appendChild(D);else{if(!Zt&&!Ze&&!Ue&&j.indexOf("<")===-1)return _&&lr?_.createHTML(j):j;if(R=Yo(j),!R)return Zt?null:lr?v:""}R&&Ti&&Ct(R.firstChild);const ve=Zo(En?j:R);for(;oe=ve.nextNode();)Qo(oe)||(oe.content instanceof s&&oh(oe.content),na(oe));if(En)return j;if(Zt){if(ar)for(be=E.call(R.ownerDocument);R.firstChild;)be.appendChild(R.firstChild);else be=R;return(Y.shadowroot||Y.shadowrootmode)&&(be=$.call(r,be,!0)),be}let Se=Ue?R.outerHTML:R.innerHTML;return Ue&&H["!doctype"]&&R.ownerDocument&&R.ownerDocument.doctype&&R.ownerDocument.doctype.name&&Ne(wc,R.ownerDocument.doctype.name)&&(Se="<!DOCTYPE "+R.ownerDocument.doctype.name+`>
`+Se),Ze&&vr([k,O,T],Tt=>{Se=In(Se,Tt," ")}),_&&lr?_.createHTML(Se):Se},e.setConfig=function(){let j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Li(j),Yt=!0},e.clearConfig=function(){tn=null,Yt=!1},e.isValidAttribute=function(j,S,R){tn||Li({});const D=ge(j),oe=ge(S);return ea(D,oe,R)},e.addHook=function(j,S){typeof S=="function"&&(A[j]=A[j]||[],Rn(A[j],S))},e.removeHook=function(j){if(A[j])return Ba(A[j])},e.removeHooks=function(j){A[j]&&(A[j]=[])},e.removeAllHooks=function(){A={}},e}var Fn=bc();function lo(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Jt=lo();function vc(n){Jt=n}const _c=/[&<>"']/,kg=new RegExp(_c.source,"g"),kc=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,xg=new RegExp(kc.source,"g"),Sg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},qa=n=>Sg[n];function Me(n,e){if(e){if(_c.test(n))return n.replace(kg,qa)}else if(kc.test(n))return n.replace(xg,qa);return n}const Eg=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function Ag(n){return n.replace(Eg,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const Og=/(^|[^\[])\^/g;function te(n,e){n=typeof n=="string"?n:n.source,e=e||"";const t={replace:(r,i)=>(i=typeof i=="object"&&"source"in i?i.source:i,i=i.replace(Og,"$1"),n=n.replace(r,i),t),getRegex:()=>new RegExp(n,e)};return t}function Va(n){try{n=encodeURI(n).replace(/%25/g,"%")}catch{return null}return n}const Qr={exec:()=>null};function Ja(n,e){const t=n.replace(/\|/g,(s,o,a)=>{let l=!1,h=o;for(;--h>=0&&a[h]==="\\";)l=!l;return l?"|":" |"}),r=t.split(/ \|/);let i=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(/\\\|/g,"|");return r}function xr(n,e,t){const r=n.length;if(r===0)return"";let i=0;for(;i<r;){const s=n.charAt(r-i-1);if(s===e&&!t)i++;else if(s!==e&&t)i++;else break}return n.slice(0,r-i)}function Cg(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let r=0;r<n.length;r++)if(n[r]==="\\")r++;else if(n[r]===e[0])t++;else if(n[r]===e[1]&&(t--,t<0))return r;return-1}function Ga(n,e,t,r){const i=e.href,s=e.title?Me(e.title):null,o=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){r.state.inLink=!0;const a={type:"link",raw:t,href:i,title:s,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,a}return{type:"image",raw:t,href:i,title:s,text:Me(o)}}function Tg(n,e){const t=n.match(/^(\s+)(?:```)/);if(t===null)return e;const r=t[1];return e.split(`
`).map(i=>{const s=i.match(/^\s+/);if(s===null)return i;const[o]=s;return o.length>=r.length?i.slice(r.length):i}).join(`
`)}class ei{constructor(e){W(this,"options");W(this,"rules");W(this,"lexer");this.options=e||Jt}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const r=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?r:xr(r,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const r=t[0],i=Tg(r,t[3]||"");return{type:"code",raw:r,lang:t[2]?t[2].trim().replace(this.rules.inline._escapes,"$1"):t[2],text:i}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let r=t[2].trim();if(/#$/.test(r)){const i=xr(r,"#");(this.options.pedantic||!i||/ $/.test(i))&&(r=i.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const r=xr(t[0].replace(/^ *>[ \t]?/gm,""),`
`),i=this.lexer.state.top;this.lexer.state.top=!0;const s=this.lexer.blockTokens(r);return this.lexer.state.top=i,{type:"blockquote",raw:t[0],tokens:s,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let r=t[1].trim();const i=r.length>1,s={type:"list",raw:"",ordered:i,start:i?+r.slice(0,-1):"",loose:!1,items:[]};r=i?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=i?r:"[*+-]");const o=new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`);let a="",l="",h=!1;for(;e;){let u=!1;if(!(t=o.exec(e))||this.rules.block.hr.test(e))break;a=t[0],e=e.substring(a.length);let p=t[2].split(`
`,1)[0].replace(/^\t+/,y=>" ".repeat(3*y.length)),d=e.split(`
`,1)[0],c=0;this.options.pedantic?(c=2,l=p.trimStart()):(c=t[2].search(/[^ ]/),c=c>4?1:c,l=p.slice(c),c+=t[1].length);let f=!1;if(!p&&/^ *$/.test(d)&&(a+=d+`
`,e=e.substring(d.length+1),u=!0),!u){const y=new RegExp(`^ {0,${Math.min(3,c-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),w=new RegExp(`^ {0,${Math.min(3,c-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),_=new RegExp(`^ {0,${Math.min(3,c-1)}}(?:\`\`\`|~~~)`),v=new RegExp(`^ {0,${Math.min(3,c-1)}}#`);for(;e;){const b=e.split(`
`,1)[0];if(d=b,this.options.pedantic&&(d=d.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),_.test(d)||v.test(d)||y.test(d)||w.test(e))break;if(d.search(/[^ ]/)>=c||!d.trim())l+=`
`+d.slice(c);else{if(f||p.search(/[^ ]/)>=4||_.test(p)||v.test(p)||w.test(p))break;l+=`
`+d}!f&&!d.trim()&&(f=!0),a+=b+`
`,e=e.substring(b.length+1),p=d.slice(c)}}s.loose||(h?s.loose=!0:/\n *\n *$/.test(a)&&(h=!0));let g=null,m;this.options.gfm&&(g=/^\[[ xX]\] /.exec(l),g&&(m=g[0]!=="[ ] ",l=l.replace(/^\[[ xX]\] +/,""))),s.items.push({type:"list_item",raw:a,task:!!g,checked:m,loose:!1,text:l,tokens:[]}),s.raw+=a}s.items[s.items.length-1].raw=a.trimEnd(),s.items[s.items.length-1].text=l.trimEnd(),s.raw=s.raw.trimEnd();for(let u=0;u<s.items.length;u++)if(this.lexer.state.top=!1,s.items[u].tokens=this.lexer.blockTokens(s.items[u].text,[]),!s.loose){const p=s.items[u].tokens.filter(c=>c.type==="space"),d=p.length>0&&p.some(c=>/\n.*\n/.test(c.raw));s.loose=d}if(s.loose)for(let u=0;u<s.items.length;u++)s.items[u].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const r=t[1].toLowerCase().replace(/\s+/g," "),i=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline._escapes,"$1"):t[3];return{type:"def",tag:r,raw:t[0],href:i,title:s}}}table(e){const t=this.rules.block.table.exec(e);if(t){if(!/[:|]/.test(t[2]))return;const r={type:"table",raw:t[0],header:Ja(t[1]).map(i=>({text:i,tokens:[]})),align:t[2].replace(/^\||\| *$/g,"").split("|"),rows:t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(r.header.length===r.align.length){let i=r.align.length,s,o,a,l;for(s=0;s<i;s++){const h=r.align[s];h&&(/^ *-+: *$/.test(h)?r.align[s]="right":/^ *:-+: *$/.test(h)?r.align[s]="center":/^ *:-+ *$/.test(h)?r.align[s]="left":r.align[s]=null)}for(i=r.rows.length,s=0;s<i;s++)r.rows[s]=Ja(r.rows[s],r.header.length).map(h=>({text:h,tokens:[]}));for(i=r.header.length,o=0;o<i;o++)r.header[o].tokens=this.lexer.inline(r.header[o].text);for(i=r.rows.length,o=0;o<i;o++)for(l=r.rows[o],a=0;a<l.length;a++)l[a].tokens=this.lexer.inline(l[a].text);return r}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const r=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:r,tokens:this.lexer.inline(r)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:Me(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const r=t[2].trim();if(!this.options.pedantic&&/^</.test(r)){if(!/>$/.test(r))return;const o=xr(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{const o=Cg(t[2],"()");if(o>-1){const l=(t[0].indexOf("!")===0?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,l).trim(),t[3]=""}}let i=t[2],s="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i);o&&(i=o[1],s=o[3])}else s=t[3]?t[3].slice(1,-1):"";return i=i.trim(),/^</.test(i)&&(this.options.pedantic&&!/>$/.test(r)?i=i.slice(1):i=i.slice(1,-1)),Ga(t,{href:i&&i.replace(this.rules.inline._escapes,"$1"),title:s&&s.replace(this.rules.inline._escapes,"$1")},t[0],this.lexer)}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){let i=(r[2]||r[1]).replace(/\s+/g," ");if(i=t[i.toLowerCase()],!i){const s=r[0].charAt(0);return{type:"text",raw:s,text:s}}return Ga(r,i,r[0],this.lexer)}}emStrong(e,t,r=""){let i=this.rules.inline.emStrong.lDelim.exec(e);if(!i||i[3]&&r.match(/[\p{L}\p{N}]/u))return;if(!(i[1]||i[2]||"")||!r||this.rules.inline.punctuation.exec(r)){const o=[...i[0]].length-1;let a,l,h=o,u=0;const p=i[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(p.lastIndex=0,t=t.slice(-1*e.length+o);(i=p.exec(t))!=null;){if(a=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!a)continue;if(l=[...a].length,i[3]||i[4]){h+=l;continue}else if((i[5]||i[6])&&o%3&&!((o+l)%3)){u+=l;continue}if(h-=l,h>0)continue;l=Math.min(l,l+h+u);const d=[...i[0]][0].length,c=e.slice(0,o+i.index+d+l);if(Math.min(o,l)%2){const g=c.slice(1,-1);return{type:"em",raw:c,text:g,tokens:this.lexer.inlineTokens(g)}}const f=c.slice(2,-2);return{type:"strong",raw:c,text:f,tokens:this.lexer.inlineTokens(f)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let r=t[2].replace(/\n/g," ");const i=/[^ ]/.test(r),s=/^ /.test(r)&&/ $/.test(r);return i&&s&&(r=r.substring(1,r.length-1)),r=Me(r,!0),{type:"codespan",raw:t[0],text:r}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let r,i;return t[2]==="@"?(r=Me(t[1]),i="mailto:"+r):(r=Me(t[1]),i=r),{type:"link",raw:t[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let r,i;if(t[2]==="@")r=Me(t[0]),i="mailto:"+r;else{let s;do s=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])[0];while(s!==t[0]);r=Me(t[0]),t[1]==="www."?i="http://"+t[0]:i=t[0]}return{type:"link",raw:t[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let r;return this.lexer.state.inRawBlock?r=t[0]:r=Me(t[0]),{type:"text",raw:t[0],text:r}}}}const F={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:Qr,lheading:/^(?!bull )((?:.|\n(?!\s*?\n|bull ))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};F._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;F._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;F.def=te(F.def).replace("label",F._label).replace("title",F._title).getRegex();F.bullet=/(?:[*+-]|\d{1,9}[.)])/;F.listItemStart=te(/^( *)(bull) */).replace("bull",F.bullet).getRegex();F.list=te(F.list).replace(/bull/g,F.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+F.def.source+")").getRegex();F._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";F._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;F.html=te(F.html,"i").replace("comment",F._comment).replace("tag",F._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();F.lheading=te(F.lheading).replace(/bull/g,F.bullet).getRegex();F.paragraph=te(F._paragraph).replace("hr",F.hr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",F._tag).getRegex();F.blockquote=te(F.blockquote).replace("paragraph",F.paragraph).getRegex();F.normal={...F};F.gfm={...F.normal,table:"^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"};F.gfm.table=te(F.gfm.table).replace("hr",F.hr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",F._tag).getRegex();F.gfm.paragraph=te(F._paragraph).replace("hr",F.hr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",F.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",F._tag).getRegex();F.pedantic={...F.normal,html:te(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",F._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Qr,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:te(F.normal._paragraph).replace("hr",F.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",F.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()};const M={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Qr,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,rDelimAst:/^[^_*]*?__[^_*]*?\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\*)[punct](\*+)(?=[\s]|$)|[^punct\s](\*+)(?!\*)(?=[punct\s]|$)|(?!\*)[punct\s](\*+)(?=[^punct\s])|[\s](\*+)(?!\*)(?=[punct])|(?!\*)[punct](\*+)(?!\*)(?=[punct])|[^punct\s](\*+)(?=[^punct\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\s]|$)|[^punct\s](_+)(?!_)(?=[punct\s]|$)|(?!_)[punct\s](_+)(?=[^punct\s])|[\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Qr,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^((?![*_])[\spunctuation])/};M._punctuation="\\p{P}$+<=>`^|~";M.punctuation=te(M.punctuation,"u").replace(/punctuation/g,M._punctuation).getRegex();M.blockSkip=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g;M.anyPunctuation=/\\[punct]/g;M._escapes=/\\([punct])/g;M._comment=te(F._comment).replace("(?:-->|$)","-->").getRegex();M.emStrong.lDelim=te(M.emStrong.lDelim,"u").replace(/punct/g,M._punctuation).getRegex();M.emStrong.rDelimAst=te(M.emStrong.rDelimAst,"gu").replace(/punct/g,M._punctuation).getRegex();M.emStrong.rDelimUnd=te(M.emStrong.rDelimUnd,"gu").replace(/punct/g,M._punctuation).getRegex();M.anyPunctuation=te(M.anyPunctuation,"gu").replace(/punct/g,M._punctuation).getRegex();M._escapes=te(M._escapes,"gu").replace(/punct/g,M._punctuation).getRegex();M._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;M._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;M.autolink=te(M.autolink).replace("scheme",M._scheme).replace("email",M._email).getRegex();M._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;M.tag=te(M.tag).replace("comment",M._comment).replace("attribute",M._attribute).getRegex();M._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;M._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;M._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;M.link=te(M.link).replace("label",M._label).replace("href",M._href).replace("title",M._title).getRegex();M.reflink=te(M.reflink).replace("label",M._label).replace("ref",F._label).getRegex();M.nolink=te(M.nolink).replace("ref",F._label).getRegex();M.reflinkSearch=te(M.reflinkSearch,"g").replace("reflink",M.reflink).replace("nolink",M.nolink).getRegex();M.normal={...M};M.pedantic={...M.normal,strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:te(/^!?\[(label)\]\((.*?)\)/).replace("label",M._label).getRegex(),reflink:te(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",M._label).getRegex()};M.gfm={...M.normal,escape:te(M.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/};M.gfm.url=te(M.gfm.url,"i").replace("email",M.gfm._extended_email).getRegex();M.breaks={...M.gfm,br:te(M.br).replace("{2,}","*").getRegex(),text:te(M.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};class tt{constructor(e){W(this,"tokens");W(this,"options");W(this,"state");W(this,"tokenizer");W(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Jt,this.options.tokenizer=this.options.tokenizer||new ei,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:F.normal,inline:M.normal};this.options.pedantic?(t.block=F.pedantic,t.inline=M.pedantic):this.options.gfm&&(t.block=F.gfm,this.options.breaks?t.inline=M.breaks:t.inline=M.gfm),this.tokenizer.rules=t}static get rules(){return{block:F,inline:M}}static lex(e,t){return new tt(t).lex(e)}static lexInline(e,t){return new tt(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);let t;for(;t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(a,l,h)=>l+"    ".repeat(h.length));let r,i,s,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(r=a.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))){if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length),r.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+r.raw,i.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(s=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const l=e.slice(1);let h;this.options.extensions.startBlock.forEach(u=>{h=u.call({lexer:this},l),typeof h=="number"&&h>=0&&(a=Math.min(a,h))}),a<1/0&&a>=0&&(s=e.substring(0,a+1))}if(this.state.top&&(r=this.tokenizer.paragraph(s))){i=t[t.length-1],o&&i.type==="paragraph"?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r),o=s.length!==e.length,e=e.substring(r.raw.length);continue}if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&i.type==="text"?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let r,i,s,o=e,a,l,h;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null;)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(l||(h=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(r=u.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))){if(r=this.tokenizer.escape(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.tag(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&r.type==="text"&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):t.push(r);continue}if(r=this.tokenizer.link(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(r.raw.length),i=t[t.length-1],i&&r.type==="text"&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):t.push(r);continue}if(r=this.tokenizer.emStrong(e,o,h)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.codespan(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.br(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.del(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.autolink(e)){e=e.substring(r.raw.length),t.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(e))){e=e.substring(r.raw.length),t.push(r);continue}if(s=e,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const p=e.slice(1);let d;this.options.extensions.startInline.forEach(c=>{d=c.call({lexer:this},p),typeof d=="number"&&d>=0&&(u=Math.min(u,d))}),u<1/0&&u>=0&&(s=e.substring(0,u+1))}if(r=this.tokenizer.inlineText(s)){e=e.substring(r.raw.length),r.raw.slice(-1)!=="_"&&(h=r.raw.slice(-1)),l=!0,i=t[t.length-1],i&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):t.push(r);continue}if(e){const u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return t}}class ti{constructor(e){W(this,"options");this.options=e||Jt}code(e,t,r){var s;const i=(s=(t||"").match(/^\S*/))==null?void 0:s[0];return e=e.replace(/\n$/,"")+`
`,i?'<pre><code class="language-'+Me(i)+'">'+(r?e:Me(e,!0))+`</code></pre>
`:"<pre><code>"+(r?e:Me(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e,t){return e}heading(e,t,r){return`<h${t}>${e}</h${t}>
`}hr(){return`<hr>
`}list(e,t,r){const i=t?"ol":"ul",s=t&&r!==1?' start="'+r+'"':"";return"<"+i+s+`>
`+e+"</"+i+`>
`}listitem(e,t,r){return`<li>${e}</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(e){return`<p>${e}</p>
`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
${e}</tr>
`}tablecell(e,t){const r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return"<br>"}del(e){return`<del>${e}</del>`}link(e,t,r){const i=Va(e);if(i===null)return r;e=i;let s='<a href="'+e+'"';return t&&(s+=' title="'+t+'"'),s+=">"+r+"</a>",s}image(e,t,r){const i=Va(e);if(i===null)return r;e=i;let s=`<img src="${e}" alt="${r}"`;return t&&(s+=` title="${t}"`),s+=">",s}text(e){return e}}class co{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,r){return""+r}image(e,t,r){return""+r}br(){return""}}class nt{constructor(e){W(this,"options");W(this,"renderer");W(this,"textRenderer");this.options=e||Jt,this.options.renderer=this.options.renderer||new ti,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new co}static parse(e,t){return new nt(t).parse(e)}static parseInline(e,t){return new nt(t).parseInline(e)}parse(e,t=!0){let r="";for(let i=0;i<e.length;i++){const s=e[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const o=s,a=this.options.extensions.renderers[o.type].call({parser:this},o);if(a!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(o.type)){r+=a||"";continue}}switch(s.type){case"space":continue;case"hr":{r+=this.renderer.hr();continue}case"heading":{const o=s;r+=this.renderer.heading(this.parseInline(o.tokens),o.depth,Ag(this.parseInline(o.tokens,this.textRenderer)));continue}case"code":{const o=s;r+=this.renderer.code(o.text,o.lang,!!o.escaped);continue}case"table":{const o=s;let a="",l="";for(let u=0;u<o.header.length;u++)l+=this.renderer.tablecell(this.parseInline(o.header[u].tokens),{header:!0,align:o.align[u]});a+=this.renderer.tablerow(l);let h="";for(let u=0;u<o.rows.length;u++){const p=o.rows[u];l="";for(let d=0;d<p.length;d++)l+=this.renderer.tablecell(this.parseInline(p[d].tokens),{header:!1,align:o.align[d]});h+=this.renderer.tablerow(l)}r+=this.renderer.table(a,h);continue}case"blockquote":{const o=s,a=this.parse(o.tokens);r+=this.renderer.blockquote(a);continue}case"list":{const o=s,a=o.ordered,l=o.start,h=o.loose;let u="";for(let p=0;p<o.items.length;p++){const d=o.items[p],c=d.checked,f=d.task;let g="";if(d.task){const m=this.renderer.checkbox(!!c);h?d.tokens.length>0&&d.tokens[0].type==="paragraph"?(d.tokens[0].text=m+" "+d.tokens[0].text,d.tokens[0].tokens&&d.tokens[0].tokens.length>0&&d.tokens[0].tokens[0].type==="text"&&(d.tokens[0].tokens[0].text=m+" "+d.tokens[0].tokens[0].text)):d.tokens.unshift({type:"text",text:m+" "}):g+=m+" "}g+=this.parse(d.tokens,h),u+=this.renderer.listitem(g,f,!!c)}r+=this.renderer.list(u,a,l);continue}case"html":{const o=s;r+=this.renderer.html(o.text,o.block);continue}case"paragraph":{const o=s;r+=this.renderer.paragraph(this.parseInline(o.tokens));continue}case"text":{let o=s,a=o.tokens?this.parseInline(o.tokens):o.text;for(;i+1<e.length&&e[i+1].type==="text";)o=e[++i],a+=`
`+(o.tokens?this.parseInline(o.tokens):o.text);r+=t?this.renderer.paragraph(a):a;continue}default:{const o='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}parseInline(e,t){t=t||this.renderer;let r="";for(let i=0;i<e.length;i++){const s=e[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const o=this.options.extensions.renderers[s.type].call({parser:this},s);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){r+=o||"";continue}}switch(s.type){case"escape":{const o=s;r+=t.text(o.text);break}case"html":{const o=s;r+=t.html(o.text);break}case"link":{const o=s;r+=t.link(o.href,o.title,this.parseInline(o.tokens,t));break}case"image":{const o=s;r+=t.image(o.href,o.title,o.text);break}case"strong":{const o=s;r+=t.strong(this.parseInline(o.tokens,t));break}case"em":{const o=s;r+=t.em(this.parseInline(o.tokens,t));break}case"codespan":{const o=s;r+=t.codespan(o.text);break}case"br":{r+=t.br();break}case"del":{const o=s;r+=t.del(this.parseInline(o.tokens,t));break}case"text":{const o=s;r+=t.text(o.text);break}default:{const o='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}}class Un{constructor(e){W(this,"options");this.options=e||Jt}preprocess(e){return e}postprocess(e){return e}}W(Un,"passThroughHooks",new Set(["preprocess","postprocess"]));var Xn,xs,ai,xc;class Rg{constructor(...e){Di(this,Xn);Di(this,ai);W(this,"defaults",lo());W(this,"options",this.setOptions);W(this,"parse",pr(this,Xn,xs).call(this,tt.lex,nt.parse));W(this,"parseInline",pr(this,Xn,xs).call(this,tt.lexInline,nt.parseInline));W(this,"Parser",nt);W(this,"parser",nt.parse);W(this,"Renderer",ti);W(this,"TextRenderer",co);W(this,"Lexer",tt);W(this,"lexer",tt.lex);W(this,"Tokenizer",ei);W(this,"Hooks",Un);this.use(...e)}walkTokens(e,t){var i,s;let r=[];for(const o of e)switch(r=r.concat(t.call(this,o)),o.type){case"table":{const a=o;for(const l of a.header)r=r.concat(this.walkTokens(l.tokens,t));for(const l of a.rows)for(const h of l)r=r.concat(this.walkTokens(h.tokens,t));break}case"list":{const a=o;r=r.concat(this.walkTokens(a.items,t));break}default:{const a=o;(s=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&s[a.type]?this.defaults.extensions.childTokens[a.type].forEach(l=>{r=r.concat(this.walkTokens(a[l],t))}):a.tokens&&(r=r.concat(this.walkTokens(a.tokens,t)))}}return r}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(r=>{const i={...r};if(i.async=this.defaults.async||i.async||!1,r.extensions&&(r.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const o=t.renderers[s.name];o?t.renderers[s.name]=function(...a){let l=s.renderer.apply(this,a);return l===!1&&(l=o.apply(this,a)),l}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=t[s.level];o?o.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),i.extensions=t),r.renderer){const s=this.defaults.renderer||new ti(this.defaults);for(const o in r.renderer){const a=r.renderer[o],l=o,h=s[l];s[l]=(...u)=>{let p=a.apply(s,u);return p===!1&&(p=h.apply(s,u)),p||""}}i.renderer=s}if(r.tokenizer){const s=this.defaults.tokenizer||new ei(this.defaults);for(const o in r.tokenizer){const a=r.tokenizer[o],l=o,h=s[l];s[l]=(...u)=>{let p=a.apply(s,u);return p===!1&&(p=h.apply(s,u)),p}}i.tokenizer=s}if(r.hooks){const s=this.defaults.hooks||new Un;for(const o in r.hooks){const a=r.hooks[o],l=o,h=s[l];Un.passThroughHooks.has(o)?s[l]=u=>{if(this.defaults.async)return Promise.resolve(a.call(s,u)).then(d=>h.call(s,d));const p=a.call(s,u);return h.call(s,p)}:s[l]=(...u)=>{let p=a.apply(s,u);return p===!1&&(p=h.apply(s,u)),p}}i.hooks=s}if(r.walkTokens){const s=this.defaults.walkTokens,o=r.walkTokens;i.walkTokens=function(a){let l=[];return l.push(o.call(this,a)),s&&(l=l.concat(s.call(this,a))),l}}this.defaults={...this.defaults,...i}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}}Xn=new WeakSet,xs=function(e,t){return(r,i)=>{const s={...i},o={...this.defaults,...s};this.defaults.async===!0&&s.async===!1&&(o.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),o.async=!0);const a=pr(this,ai,xc).call(this,!!o.silent,!!o.async);if(typeof r>"u"||r===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));if(o.hooks&&(o.hooks.options=o),o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(r):r).then(l=>e(l,o)).then(l=>o.walkTokens?Promise.all(this.walkTokens(l,o.walkTokens)).then(()=>l):l).then(l=>t(l,o)).then(l=>o.hooks?o.hooks.postprocess(l):l).catch(a);try{o.hooks&&(r=o.hooks.preprocess(r));const l=e(r,o);o.walkTokens&&this.walkTokens(l,o.walkTokens);let h=t(l,o);return o.hooks&&(h=o.hooks.postprocess(h)),h}catch(l){return a(l)}}},ai=new WeakSet,xc=function(e,t){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const i="<p>An error occurred:</p><pre>"+Me(r.message+"",!0)+"</pre>";return t?Promise.resolve(i):i}if(t)return Promise.reject(r);throw r}};const qt=new Rg;function Q(n,e){return qt.parse(n,e)}Q.options=Q.setOptions=function(n){return qt.setOptions(n),Q.defaults=qt.defaults,vc(Q.defaults),Q};Q.getDefaults=lo;Q.defaults=Jt;Q.use=function(...n){return qt.use(...n),Q.defaults=qt.defaults,vc(Q.defaults),Q};Q.walkTokens=function(n,e){return qt.walkTokens(n,e)};Q.parseInline=qt.parseInline;Q.Parser=nt;Q.parser=nt.parse;Q.Renderer=ti;Q.TextRenderer=co;Q.Lexer=tt;Q.lexer=tt.lex;Q.Tokenizer=ei;Q.Hooks=Un;Q.parse=Q;Q.options;Q.setOptions;Q.use;Q.walkTokens;Q.parseInline;nt.parse;tt.lex;const Ig={unicode:!1};function Pg(n){if(n={...Ig,...n},!n.emojis)throw new Error("Must provide emojis to markedEmoji");const e=Object.keys(n.emojis).map(i=>i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("|"),t=new RegExp(`:(${e}):`),r=new RegExp(`^${t.source}`);return{extensions:[{name:"emoji",level:"inline",start(i){var s;return(s=i.match(t))==null?void 0:s.index},tokenizer(i,s){const o=r.exec(i);if(!o)return;const a=o[1];let l=n.emojis[a],h=n.unicode;if(typeof l!="string")if(typeof l.char=="string")l=l.char,h=!0;else if(typeof l.url=="string")l=l.url,h=!1;else return;return{type:"emoji",raw:o[0],name:a,emoji:l,unicode:h}},renderer(i){return i.unicode?i.emoji:`<img alt="${i.name}" src="${i.emoji}">`}}]}}class Sc extends ft{constructor(e,t){t??(t={}),t.marked??(t.marked={mangle:!1,gfm:!0,breaks:!0,headerIds:!1,headerPrefix:void 0}),t.markedEmoji??(t.markedEmoji={unicode:!0,emojis:{emojis:{fire:"",heart:"",thumbsup:""}}}),super({id:e??"text/markdown"},t)}async load(){Q.use(Pg(this.opts.markedEmoji))}render(e){var s;const t=Array.isArray(e.value)?e.value.join(`

`):(s=e.value)==null?void 0:s.toString(),r=Q.parse(t,{mangle:!1,headerIds:!1});return Fn.sanitize(r,{ALLOWED_TAGS:["h1","h2","h3","h4","h5","h6","blockquote","p","a","ul","ol","nl","li","b","i","strong","em","strike","code","hr","br","div","table","thead","caption","tbody","tr","th","td","pre","img"],ALLOWED_ATTR:["href","alt","src","title"]})}}class Ng extends Sc{constructor(e,t){e??(e="text/markdown-code"),super(e,t)}render(e){var i;const t=s=>`<pre><code>${s}</code></pre>`,r=Array.isArray(e.value)?e.value.map(t).join(""):t(((i=e.value)==null?void 0:i.toString())||"");return super.render({type:"text/markdown",value:r})}}class $t{constructor(){this.controls=new Map}add(e,t){this.controls.set(e,t)}get(e){return this.controls.get(e)}has(e){return this.controls.has(e)}static getInstance(){return $t.instance==null&&($t.instance=new $t),$t.instance}}var Lg=function(e){return Mg(e)&&!$g(e)};function Mg(n){return!!n&&typeof n=="object"}function $g(n){var e=Object.prototype.toString.call(n);return e==="[object RegExp]"||e==="[object Date]"||Bg(n)}var Dg=typeof Symbol=="function"&&Symbol.for,jg=Dg?Symbol.for("react.element"):60103;function Bg(n){return n.$$typeof===jg}function zg(n){return Array.isArray(n)?[]:{}}function Kn(n,e){return e.clone!==!1&&e.isMergeableObject(n)?dn(zg(n),n,e):n}function Fg(n,e,t){return n.concat(e).map(function(r){return Kn(r,t)})}function Ug(n,e){if(!e.customMerge)return dn;var t=e.customMerge(n);return typeof t=="function"?t:dn}function Hg(n){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(n).filter(function(e){return Object.propertyIsEnumerable.call(n,e)}):[]}function Ka(n){return Object.keys(n).concat(Hg(n))}function Ec(n,e){try{return e in n}catch{return!1}}function Wg(n,e){return Ec(n,e)&&!(Object.hasOwnProperty.call(n,e)&&Object.propertyIsEnumerable.call(n,e))}function qg(n,e,t){var r={};return t.isMergeableObject(n)&&Ka(n).forEach(function(i){r[i]=Kn(n[i],t)}),Ka(e).forEach(function(i){Wg(n,i)||(Ec(n,i)&&t.isMergeableObject(e[i])?r[i]=Ug(i,t)(n[i],e[i],t):r[i]=Kn(e[i],t))}),r}function dn(n,e,t){t=t||{},t.arrayMerge=t.arrayMerge||Fg,t.isMergeableObject=t.isMergeableObject||Lg,t.cloneUnlessOtherwiseSpecified=Kn;var r=Array.isArray(e),i=Array.isArray(n),s=r===i;return s?r?t.arrayMerge(n,e,t):qg(n,e,t):Kn(e,t)}dn.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(r,i){return dn(r,i,t)},{})};var Vg=dn,Jg=Vg;const Gg=qs(Jg);/*!
* rete v1.5.2 
* (c) 2023 Vitaliy Stoliarov 
* Released under the MIT license.
*/function Ya(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function Ss(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ya(Object(t),!0).forEach(function(r){P(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ya(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function G(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */G=function(){return n};var n={},e=Object.prototype,t=e.hasOwnProperty,r=typeof Symbol=="function"?Symbol:{},i=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function a(A,k,O){return Object.defineProperty(A,k,{value:O,enumerable:!0,configurable:!0,writable:!0}),A[k]}try{a({},"")}catch{a=function(k,O,T){return k[O]=T}}function l(A,k,O,T){var I=k&&k.prototype instanceof p?k:p,U=Object.create(I.prototype),J=new E(T||[]);return U._invoke=function(X,fe,H){var pe="suspendedStart";return function(Y,gt){if(pe==="executing")throw new Error("Generator is already running");if(pe==="completed"){if(Y==="throw")throw gt;return $()}for(H.method=Y,H.arg=gt;;){var re=H.delegate;if(re){var De=v(re,H);if(De){if(De===u)continue;return De}}if(H.method==="next")H.sent=H._sent=H.arg;else if(H.method==="throw"){if(pe==="suspendedStart")throw pe="completed",H.arg;H.dispatchException(H.arg)}else H.method==="return"&&H.abrupt("return",H.arg);pe="executing";var je=h(X,fe,H);if(je.type==="normal"){if(pe=H.done?"completed":"suspendedYield",je.arg===u)continue;return{value:je.arg,done:H.done}}je.type==="throw"&&(pe="completed",H.method="throw",H.arg=je.arg)}}}(A,O,J),U}function h(A,k,O){try{return{type:"normal",arg:A.call(k,O)}}catch(T){return{type:"throw",arg:T}}}n.wrap=l;var u={};function p(){}function d(){}function c(){}var f={};a(f,i,function(){return this});var g=Object.getPrototypeOf,m=g&&g(g(N([])));m&&m!==e&&t.call(m,i)&&(f=m);var y=c.prototype=p.prototype=Object.create(f);function w(A){["next","throw","return"].forEach(function(k){a(A,k,function(O){return this._invoke(k,O)})})}function _(A,k){function O(I,U,J,X){var fe=h(A[I],A,U);if(fe.type!=="throw"){var H=fe.arg,pe=H.value;return pe&&typeof pe=="object"&&t.call(pe,"__await")?k.resolve(pe.__await).then(function(Y){O("next",Y,J,X)},function(Y){O("throw",Y,J,X)}):k.resolve(pe).then(function(Y){H.value=Y,J(H)},function(Y){return O("throw",Y,J,X)})}X(fe.arg)}var T;this._invoke=function(I,U){function J(){return new k(function(X,fe){O(I,U,X,fe)})}return T=T?T.then(J,J):J()}}function v(A,k){var O=A.iterator[k.method];if(O===void 0){if(k.delegate=null,k.method==="throw"){if(A.iterator.return&&(k.method="return",k.arg=void 0,v(A,k),k.method==="throw"))return u;k.method="throw",k.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var T=h(O,A.iterator,k.arg);if(T.type==="throw")return k.method="throw",k.arg=T.arg,k.delegate=null,u;var I=T.arg;return I?I.done?(k[A.resultName]=I.value,k.next=A.nextLoc,k.method!=="return"&&(k.method="next",k.arg=void 0),k.delegate=null,u):I:(k.method="throw",k.arg=new TypeError("iterator result is not an object"),k.delegate=null,u)}function b(A){var k={tryLoc:A[0]};1 in A&&(k.catchLoc=A[1]),2 in A&&(k.finallyLoc=A[2],k.afterLoc=A[3]),this.tryEntries.push(k)}function x(A){var k=A.completion||{};k.type="normal",delete k.arg,A.completion=k}function E(A){this.tryEntries=[{tryLoc:"root"}],A.forEach(b,this),this.reset(!0)}function N(A){if(A){var k=A[i];if(k)return k.call(A);if(typeof A.next=="function")return A;if(!isNaN(A.length)){var O=-1,T=function I(){for(;++O<A.length;)if(t.call(A,O))return I.value=A[O],I.done=!1,I;return I.value=void 0,I.done=!0,I};return T.next=T}}return{next:$}}function $(){return{value:void 0,done:!0}}return d.prototype=c,a(y,"constructor",c),a(c,"constructor",d),d.displayName=a(c,o,"GeneratorFunction"),n.isGeneratorFunction=function(A){var k=typeof A=="function"&&A.constructor;return!!k&&(k===d||(k.displayName||k.name)==="GeneratorFunction")},n.mark=function(A){return Object.setPrototypeOf?Object.setPrototypeOf(A,c):(A.__proto__=c,a(A,o,"GeneratorFunction")),A.prototype=Object.create(y),A},n.awrap=function(A){return{__await:A}},w(_.prototype),a(_.prototype,s,function(){return this}),n.AsyncIterator=_,n.async=function(A,k,O,T,I){I===void 0&&(I=Promise);var U=new _(l(A,k,O,T),I);return n.isGeneratorFunction(k)?U:U.next().then(function(J){return J.done?J.value:U.next()})},w(y),a(y,o,"Generator"),a(y,i,function(){return this}),a(y,"toString",function(){return"[object Generator]"}),n.keys=function(A){var k=[];for(var O in A)k.push(O);return k.reverse(),function T(){for(;k.length;){var I=k.pop();if(I in A)return T.value=I,T.done=!1,T}return T.done=!0,T}},n.values=N,E.prototype={constructor:E,reset:function(A){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!A)for(var k in this)k.charAt(0)==="t"&&t.call(this,k)&&!isNaN(+k.slice(1))&&(this[k]=void 0)},stop:function(){this.done=!0;var A=this.tryEntries[0].completion;if(A.type==="throw")throw A.arg;return this.rval},dispatchException:function(A){if(this.done)throw A;var k=this;function O(fe,H){return U.type="throw",U.arg=A,k.next=fe,H&&(k.method="next",k.arg=void 0),!!H}for(var T=this.tryEntries.length-1;T>=0;--T){var I=this.tryEntries[T],U=I.completion;if(I.tryLoc==="root")return O("end");if(I.tryLoc<=this.prev){var J=t.call(I,"catchLoc"),X=t.call(I,"finallyLoc");if(J&&X){if(this.prev<I.catchLoc)return O(I.catchLoc,!0);if(this.prev<I.finallyLoc)return O(I.finallyLoc)}else if(J){if(this.prev<I.catchLoc)return O(I.catchLoc,!0)}else{if(!X)throw new Error("try statement without catch or finally");if(this.prev<I.finallyLoc)return O(I.finallyLoc)}}}},abrupt:function(A,k){for(var O=this.tryEntries.length-1;O>=0;--O){var T=this.tryEntries[O];if(T.tryLoc<=this.prev&&t.call(T,"finallyLoc")&&this.prev<T.finallyLoc){var I=T;break}}I&&(A==="break"||A==="continue")&&I.tryLoc<=k&&k<=I.finallyLoc&&(I=null);var U=I?I.completion:{};return U.type=A,U.arg=k,I?(this.method="next",this.next=I.finallyLoc,u):this.complete(U)},complete:function(A,k){if(A.type==="throw")throw A.arg;return A.type==="break"||A.type==="continue"?this.next=A.arg:A.type==="return"?(this.rval=this.arg=A.arg,this.method="return",this.next="end"):A.type==="normal"&&k&&(this.next=k),u},finish:function(A){for(var k=this.tryEntries.length-1;k>=0;--k){var O=this.tryEntries[k];if(O.finallyLoc===A)return this.complete(O.completion,O.afterLoc),x(O),u}},catch:function(A){for(var k=this.tryEntries.length-1;k>=0;--k){var O=this.tryEntries[k];if(O.tryLoc===A){var T=O.completion;if(T.type==="throw"){var I=T.arg;x(O)}return I}}throw new Error("illegal catch attempt")},delegateYield:function(A,k,O){return this.delegate={iterator:N(A),resultName:k,nextLoc:O},this.method==="next"&&(this.arg=void 0),u}},n}function Za(n,e,t,r,i,s,o){try{var a=n[s](o),l=a.value}catch(h){t(h);return}a.done?e(l):Promise.resolve(l).then(r,i)}function ye(n){return function(){var e=this,t=arguments;return new Promise(function(r,i){var s=n.apply(e,t);function o(l){Za(s,r,i,o,a,"next",l)}function a(l){Za(s,r,i,o,a,"throw",l)}o(void 0)})}}function ie(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Xa(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function se(n,e,t){return e&&Xa(n.prototype,e),t&&Xa(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function P(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Te(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&Es(n,e)}function fn(n){return fn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fn(n)}function Es(n,e){return Es=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Es(n,e)}function Kg(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function B(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Yg(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return B(n)}function Re(n){var e=Kg();return function(){var r=fn(n),i;if(e){var s=fn(this).constructor;i=Reflect.construct(r,arguments,s)}else i=r.apply(this,arguments);return Yg(this,i)}}function Zg(n,e){for(;!Object.prototype.hasOwnProperty.call(n,e)&&(n=fn(n),n!==null););return n}function Dr(){return typeof Reflect<"u"&&Reflect.get?Dr=Reflect.get.bind():Dr=function(e,t,r){var i=Zg(e,t);if(i){var s=Object.getOwnPropertyDescriptor(i,t);return s.get?s.get.call(arguments.length<3?e:r):s.value}},Dr.apply(this,arguments)}function _t(n,e){return Qg(n)||tm(n,e)||uo(n,e)||rm()}function $e(n){return Xg(n)||em(n)||uo(n)||nm()}function Xg(n){if(Array.isArray(n))return As(n)}function Qg(n){if(Array.isArray(n))return n}function em(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function tm(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r=[],i=!0,s=!1,o,a;try{for(t=t.call(n);!(i=(o=t.next()).done)&&(r.push(o.value),!(e&&r.length===e));i=!0);}catch(l){s=!0,a=l}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw a}}return r}}function uo(n,e){if(n){if(typeof n=="string")return As(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return As(n,e)}}function As(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function nm(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rm(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qa(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=uo(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,i=function(){};return{s:i,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,o=!1,a;return{s:function(){t=t.call(n)},n:function(){var l=t.next();return s=l.done,l},e:function(l){o=!0,a=l},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(o)throw a}}}}var im=se(function n(e){ie(this,n),P(this,"name",void 0),P(this,"data",{}),P(this,"engine",null),this.name=e}),nr=function(){function n(e){ie(this,n),P(this,"name",void 0),P(this,"id",void 0),P(this,"position",[0,0]),P(this,"inputs",new Map),P(this,"outputs",new Map),P(this,"controls",new Map),P(this,"data",{}),P(this,"meta",{}),this.name=e,this.id=n.incrementId()}return se(n,[{key:"_add",value:function(t,r,i){if(t.has(r.key))throw new Error("Item with key '".concat(r.key,"' already been added to the node"));if(r[i]!==null)throw new Error("Item has already been added to some node");r[i]=this,t.set(r.key,r)}},{key:"addControl",value:function(t){return this._add(this.controls,t,"parent"),this}},{key:"removeControl",value:function(t){t.parent=null,this.controls.delete(t.key)}},{key:"addInput",value:function(t){return this._add(this.inputs,t,"node"),this}},{key:"removeInput",value:function(t){t.removeConnections(),t.node=null,this.inputs.delete(t.key)}},{key:"addOutput",value:function(t){return this._add(this.outputs,t,"node"),this}},{key:"removeOutput",value:function(t){t.removeConnections(),t.node=null,this.outputs.delete(t.key)}},{key:"setMeta",value:function(t){return this.meta=t,this}},{key:"getConnections",value:function(){var t=[].concat($e(this.inputs.values()),$e(this.outputs.values())),r=t.reduce(function(i,s){return[].concat($e(i),$e(s.connections))},[]);return r}},{key:"update",value:function(){}},{key:"toJSON",value:function(){var t=function(i){return Array.from(i).reduce(function(s,o){var a=_t(o,2),l=a[0],h=a[1];return s[l]=h.toJSON(),s},{})};return{id:this.id,data:this.data,inputs:t(this.inputs),outputs:t(this.outputs),position:this.position,name:this.name}}}],[{key:"incrementId",value:function(){return this.latestId?this.latestId++:this.latestId=1,this.latestId}},{key:"resetId",value:function(){this.latestId=0}},{key:"fromJSON",value:function(t){var r=new n(t.name),i=_t(t.position,2),s=i[0],o=i[1];return r.id=t.id,r.data=t.data,r.position=[s,o],r.name=t.name,n.latestId=Math.max(r.id,n.latestId),r}}]),n}();P(nr,"latestId",0);var Ac=function(n){Te(t,n);var e=Re(t);function t(r){var i;return ie(this,t),i=e.call(this,r),P(B(i),"editor",null),P(B(i),"data",{}),i}return se(t,[{key:"build",value:function(){var r=ye(G().mark(function s(o){return G().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.builder(o);case 2:return l.abrupt("return",o);case 3:case"end":return l.stop()}},s,this)}));function i(s){return r.apply(this,arguments)}return i}()},{key:"createNode",value:function(){var r=ye(G().mark(function s(){var o,a,l=arguments;return G().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return o=l.length>0&&l[0]!==void 0?l[0]:{},a=new nr(this.name),a.data=o,u.next=5,this.build(a);case 5:return u.abrupt("return",a);case 6:case"end":return u.stop()}},s,this)}));function i(){return r.apply(this,arguments)}return i}()}]),t}(im),Oc=function(){function n(e,t){ie(this,n),P(this,"output",void 0),P(this,"input",void 0),P(this,"data",{}),this.output=e,this.input=t,this.data={},this.input.addConnection(this)}return se(n,[{key:"remove",value:function(){this.input.removeConnection(this),this.output.removeConnection(this)}}]),n}(),sm=function(){function n(e){if(ie(this,n),P(this,"key",void 0),P(this,"data",{}),P(this,"parent",null),this.constructor===n)throw new TypeError("Can not construct abstract class");if(!e)throw new Error("The key parameter is missing in super() of Control ");this.key=e}return se(n,[{key:"getNode",value:function(){if(this.parent===null)throw new Error("Control isn't added to Node/Input");if(this.parent instanceof nr)return this.parent;if(!this.parent.node)throw new Error("Control hasn't be added to Input or Node");return this.parent.node}},{key:"getData",value:function(t){return this.getNode().data[t]}},{key:"putData",value:function(t,r){this.getNode().data[t]=r}}]),n}(),At=function(){function n(e){ie(this,n),P(this,"events",{}),P(this,"silent",!1),this.events=e instanceof n?e.events:e.handlers}return se(n,[{key:"on",value:function(t,r){var i=this,s=t instanceof Array?t:t.split(" ");return s.forEach(function(o){if(!i.events[o])throw new Error("The event ".concat(o," does not exist"));i.events[o].push(r)}),this}},{key:"trigger",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!(t in this.events))throw new Error("The event ".concat(String(t)," cannot be triggered"));return this.events[t].reduce(function(i,s){return s(r)!==!1&&i},!0)}},{key:"bind",value:function(t){if(this.events[t])throw new Error("The event ".concat(t," is already bound"));this.events[t]=[]}},{key:"exist",value:function(t){return Array.isArray(this.events[t])}}]),n}(),ho=function(){function n(e,t,r,i){ie(this,n),P(this,"node",null),P(this,"multipleConnections",void 0),P(this,"connections",[]),P(this,"key",void 0),P(this,"name",void 0),P(this,"socket",void 0),this.node=null,this.multipleConnections=i,this.connections=[],this.key=e,this.name=t,this.socket=r}return se(n,[{key:"removeConnection",value:function(t){this.connections.splice(this.connections.indexOf(t),1)}},{key:"removeConnections",value:function(){var t=this;this.connections.forEach(function(r){return t.removeConnection(r)})}}]),n}(),Cc=function(n){Te(t,n);var e=Re(t);function t(r,i,s){var o,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return ie(this,t),o=e.call(this,r,i,s,a),P(B(o),"control",null),o}return se(t,[{key:"hasConnection",value:function(){return this.connections.length>0}},{key:"addConnection",value:function(i){if(!this.multipleConnections&&this.hasConnection())throw new Error("Multiple connections not allowed");this.connections.push(i)}},{key:"addControl",value:function(i){this.control=i,i.parent=this}},{key:"showControl",value:function(){return!this.hasConnection()&&this.control!==null}},{key:"toJSON",value:function(){return{connections:this.connections.map(function(i){if(!i.output.node)throw new Error("Node not added to Output");return{node:i.output.node.id,output:i.output.key,data:i.data}})}}}]),t}(ho),po=function(){function n(){ie(this,n)}return se(n,null,[{key:"isValidData",value:function(t){return typeof t.id=="string"&&this.isValidId(t.id)&&t.nodes instanceof Object&&!(t.nodes instanceof Array)}},{key:"isValidId",value:function(t){return/^[\w-]{3,}@[0-9]+\.[0-9]+\.[0-9]+$/.test(t)}},{key:"validate",value:function(t,r){var i=t.split("@"),s=r.id.split("@"),o=[];return this.isValidData(r)||o.push("Data is not suitable"),t!==r.id&&o.push("IDs not equal"),i[0]!==s[0]&&o.push("Names don't match"),i[1]!==s[1]&&o.push("Versions don't match"),{success:!o.length,msg:o.join(". ")}}}]),n}(),Tc=function(n){Te(t,n);var e=Re(t);function t(r,i){var s;if(ie(this,t),s=e.call(this,i),P(B(s),"id",void 0),P(B(s),"plugins",void 0),P(B(s),"components",void 0),!po.isValidId(r))throw new Error("ID should be valid to name@0.1.0 format");return s.id=r,s.plugins=new Map,s.components=new Map,s}return se(t,[{key:"use",value:function(i,s){if(i.name&&this.plugins.has(i.name))throw new Error("Plugin ".concat(i.name," already in use"));i.install(this,s||{}),this.plugins.set(i.name,s)}},{key:"register",value:function(i){if(this.components.has(i.name))throw new Error("Component ".concat(i.name," already registered"));this.components.set(i.name,i),this.trigger("componentregister",i)}},{key:"destroy",value:function(){this.trigger("destroy")}}]),t}(At);function vt(n,e){return window.addEventListener(n,e),function(){window.removeEventListener(n,e)}}function om(n,e){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8,r=n.offsetLeft,i=n.offsetTop,s=n.offsetParent;s&&s!==e&&t>0;)t--,r+=s.offsetLeft,i+=s.offsetTop,s=s.offsetParent;return{x:r,y:i}}var Rc=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(a,l,h){},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(a){},i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:function(a){};ie(this,n),this.onTranslate=t,this.onStart=r,this.onDrag=i,P(this,"pointerStart",void 0),P(this,"el",void 0),P(this,"destroy",void 0),this.pointerStart=null,this.el=e,this.el.style.touchAction="none",this.el.addEventListener("pointerdown",this.down.bind(this));var s=vt("pointermove",this.move.bind(this)),o=vt("pointerup",this.up.bind(this));this.destroy=function(){s(),o()}}return se(n,[{key:"down",value:function(t){t.pointerType==="mouse"&&t.button!==0||(t.stopPropagation(),this.pointerStart=[t.pageX,t.pageY],this.onStart(t))}},{key:"move",value:function(t){if(this.pointerStart){t.preventDefault();var r=[t.pageX,t.pageY],i=r[0],s=r[1],o=[i-this.pointerStart[0],s-this.pointerStart[1]],a=this.el.getBoundingClientRect().width/this.el.offsetWidth;this.onTranslate(o[0]/a,o[1]/a,t)}}},{key:"up",value:function(t){this.pointerStart&&(this.pointerStart=null,this.onDrag(t))}}]),n}(),am=function(){function n(e,t,r,i){ie(this,n),P(this,"el",void 0),P(this,"intensity",void 0),P(this,"onzoom",void 0),P(this,"previous",null),P(this,"pointers",[]),P(this,"destroy",void 0),this.el=t,this.intensity=r,this.onzoom=i,e.addEventListener("wheel",this.wheel.bind(this)),e.addEventListener("pointerdown",this.down.bind(this)),e.addEventListener("dblclick",this.dblclick.bind(this));var s=vt("pointermove",this.move.bind(this)),o=vt("pointerup",this.end.bind(this)),a=vt("pointercancel",this.end.bind(this));this.destroy=function(){s(),o(),a()}}return se(n,[{key:"translating",get:function(){return this.pointers.length>=2}},{key:"wheel",value:function(t){t.preventDefault();var r=this.el.getBoundingClientRect(),i=t.deltaY<0,s=i?this.intensity:-this.intensity,o=(r.left-t.clientX)*s,a=(r.top-t.clientY)*s;this.onzoom(s,o,a,"wheel")}},{key:"touches",value:function(){var t={touches:this.pointers},r=[t.touches[0].clientX,t.touches[0].clientY],i=r[0],s=r[1],o=[t.touches[1].clientX,t.touches[1].clientY],a=o[0],l=o[1],h=Math.sqrt(Math.pow(i-a,2)+Math.pow(s-l,2));return{cx:(i+a)/2,cy:(s+l)/2,distance:h}}},{key:"down",value:function(t){this.pointers.push(t)}},{key:"move",value:function(t){if(this.pointers=this.pointers.map(function(p){return p.pointerId===t.pointerId?t:p}),!!this.translating){var r=this.el.getBoundingClientRect(),i=this.touches(),s=i.cx,o=i.cy,a=i.distance;if(this.previous!==null){var l=a/this.previous.distance-1,h=(r.left-s)*l,u=(r.top-o)*l;this.onzoom(l,h-(this.previous.cx-s),u-(this.previous.cy-o),"touch")}this.previous={cx:s,cy:o,distance:a}}}},{key:"end",value:function(t){this.previous=null,this.pointers=this.pointers.filter(function(r){return r.pointerId!==t.pointerId})}},{key:"dblclick",value:function(t){t.preventDefault();var r=this.el.getBoundingClientRect(),i=4*this.intensity,s=(r.left-t.clientX)*i,o=(r.top-t.clientY)*i;this.onzoom(i,s,o,"dblclick")}}]),n}(),lm=function(n){Te(t,n);var e=Re(t);function t(r,i){var s;ie(this,t),s=e.call(this,i),P(B(s),"el",void 0),P(B(s),"container",void 0),P(B(s),"transform",{k:1,x:0,y:0}),P(B(s),"mouse",{x:0,y:0}),P(B(s),"_startPosition",null),P(B(s),"_zoom",void 0),P(B(s),"_drag",void 0);var o=s.el=document.createElement("div");return s.container=r,o.style.transformOrigin="0 0",s._zoom=new am(r,o,.1,s.onZoom.bind(B(s))),s._drag=new Rc(r,s.onTranslate.bind(B(s)),s.onStart.bind(B(s))),i.on("destroy",function(){s._zoom.destroy(),s._drag.destroy()}),s.container.addEventListener("pointermove",s.pointermove.bind(B(s))),s.update(),s}return se(t,[{key:"update",value:function(){var i=this.transform;this.el.style.transform="translate(".concat(i.x,"px, ").concat(i.y,"px) scale(").concat(i.k,")")}},{key:"pointermove",value:function(i){var s=i.clientX,o=i.clientY,a=this.el.getBoundingClientRect(),l=s-a.left,h=o-a.top,u=this.transform.k;this.mouse={x:l/u,y:h/u},this.trigger("mousemove",Ss({},this.mouse))}},{key:"onStart",value:function(){this._startPosition=Ss({},this.transform)}},{key:"onTranslate",value:function(i,s){this._zoom.translating||this._startPosition&&this.translate(this._startPosition.x+i,this._startPosition.y+s)}},{key:"onZoom",value:function(i,s,o,a){this.zoom(this.transform.k*(1+i),s,o,a),this.update()}},{key:"translate",value:function(i,s){var o={transform:this.transform,x:i,y:s};this.trigger("translate",o)&&(this.transform.x=o.x,this.transform.y=o.y,this.update(),this.trigger("translated"))}},{key:"zoom",value:function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,l=this.transform.k,h={transform:this.transform,zoom:i,source:a};if(this.trigger("zoom",h)){var u=(l-h.zoom)/(l-i||1);this.transform.k=h.zoom||1,this.transform.x+=s*u,this.transform.y+=o*u,this.update(),this.trigger("zoomed",{source:a})}}},{key:"appendChild",value:function(i){this.el.appendChild(i)}},{key:"removeChild",value:function(i){this.el.removeChild(i)}}]),t}(At),cm=function(n){Te(t,n);var e=Re(t);function t(r,i,s,o){var a;return ie(this,t),a=e.call(this,o),P(B(a),"connection",void 0),P(B(a),"inputNode",void 0),P(B(a),"outputNode",void 0),P(B(a),"el",void 0),a.connection=r,a.inputNode=i,a.outputNode=s,a.el=document.createElement("div"),a.el.style.position="absolute",a.el.style.zIndex="-1",a.trigger("renderconnection",{el:a.el,connection:a.connection,points:a.getPoints()}),a}return se(t,[{key:"getPoints",value:function(){var i=this.connection,s=i.input,o=i.output;if(this.inputNode.hasSocket(s)&&this.outputNode.hasSocket(o)){var a=this.outputNode.getSocketPosition(o),l=_t(a,2),h=l[0],u=l[1],p=this.inputNode.getSocketPosition(s),d=_t(p,2),c=d[0],f=d[1];return[h,u,c,f]}return[0,0,0,0]}},{key:"update",value:function(){this.trigger("updateconnection",{el:this.el,connection:this.connection,points:this.getPoints()})}}]),t}(At),um=function(n){Te(t,n);var e=Re(t);function t(r,i,s){var o;return ie(this,t),o=e.call(this,s),o.trigger("rendercontrol",{el:r,control:i}),o}return se(t)}(At),hm=function(n){Te(t,n);var e=Re(t);function t(r,i,s,o,a){var l,h;return ie(this,t),h=e.call(this,a),P(B(h),"el",void 0),P(B(h),"type",void 0),P(B(h),"io",void 0),P(B(h),"node",void 0),h.el=r,h.type=i,h.io=s,h.node=o,h.trigger("rendersocket",(l={el:r},P(l,i,h.io),P(l,"socket",s.socket),l)),h}return se(t,[{key:"getPosition",value:function(i,s){var o=i.position,a=this.el,l=om(a,s),h=l.x,u=l.y;return[o[0]+h+a.offsetWidth/2,o[1]+u+a.offsetHeight/2]}}]),t}(At),pm=function(n){Te(t,n);var e=Re(t);function t(r,i,s){var o;return ie(this,t),o=e.call(this,s),P(B(o),"node",void 0),P(B(o),"component",void 0),P(B(o),"sockets",new Map),P(B(o),"controls",new Map),P(B(o),"el",void 0),P(B(o),"_startPosition",[]),P(B(o),"_drag",void 0),o.node=r,o.component=i,o.el=document.createElement("div"),o.el.style.position="absolute",o.el.addEventListener("contextmenu",function(a){return o.trigger("contextmenu",{e:a,node:o.node})}),o._drag=new Rc(o.el,o.onTranslate.bind(B(o)),o.onSelect.bind(B(o)),function(){o.trigger("nodedraged",r),o.trigger("nodedragged",r)}),o.trigger("rendernode",{el:o.el,node:r,component:i.data,bindSocket:o.bindSocket.bind(B(o)),bindControl:o.bindControl.bind(B(o))}),o.update(),o}return se(t,[{key:"clearSockets",value:function(){var i=this,s=[].concat($e(this.node.inputs.values()),$e(this.node.outputs.values()));this.sockets.forEach(function(o){s.includes(o.io)||i.sockets.delete(o.io)})}},{key:"bindSocket",value:function(i,s,o){this.clearSockets(),this.sockets.set(o,new hm(i,s,o,this.node,this))}},{key:"bindControl",value:function(i,s){this.controls.set(s,new um(i,s,this))}},{key:"hasSocket",value:function(i){return this.sockets.has(i)}},{key:"getSocketPosition",value:function(i){var s=this.sockets.get(i);if(!s)throw new Error("Socket not found for ".concat(i.name," with key ").concat(i.key));return s.getPosition(this.node,this.el)}},{key:"onSelect",value:function(i){var s={node:this.node,accumulate:i.ctrlKey,e:i};this.onStart(),this.trigger("multiselectnode",s),this.trigger("selectnode",s)}},{key:"onStart",value:function(){this._startPosition=$e(this.node.position)}},{key:"onTranslate",value:function(i,s){this.trigger("translatenode",{node:this.node,dx:i,dy:s})}},{key:"onDrag",value:function(i,s){var o=this._startPosition[0]+i,a=this._startPosition[1]+s;this.translate(o,a)}},{key:"translate",value:function(i,s){var o=this.node,a={node:o,x:i,y:s};if(this.trigger("nodetranslate",a)){var l=_t(o.position,2),h=l[0],u=l[1],p=[h,u];o.position[0]=a.x,o.position[1]=a.y,this.update(),this.trigger("nodetranslated",{node:o,prev:p})}}},{key:"update",value:function(){var i=_t(this.node.position,2),s=i[0],o=i[1];this.el.style.transform="translate(".concat(s,"px, ").concat(o,"px)")}},{key:"remove",value:function(){}},{key:"destroy",value:function(){this._drag.destroy()}}]),t}(At),dm=function(n){Te(t,n);var e=Re(t);function t(r,i,s){var o;return ie(this,t),o=e.call(this,s),P(B(o),"container",void 0),P(B(o),"components",void 0),P(B(o),"nodes",new Map),P(B(o),"connections",new Map),P(B(o),"area",void 0),o.container=r,o.components=i,o.container.style.overflow="hidden",o.container.addEventListener("click",o.click.bind(B(o))),o.container.addEventListener("contextmenu",function(a){return o.trigger("contextmenu",{e:a,view:B(o)})}),s.on("destroy",vt("resize",o.resize.bind(B(o)))),s.on("destroy",function(){return o.nodes.forEach(function(a){return a.destroy()})}),o.on("nodetranslated",o.updateConnections.bind(B(o))),o.on("rendersocket",function(a){var l=a.input,h=a.output,u=Array.from(o.connections.entries()),p=u.filter(function(d){var c=_t(d,1),f=c[0];return f.input===l||f.output===h});p.forEach(function(d){var c=_t(d,2);c[0];var f=c[1];return requestAnimationFrame(function(){return f.update()})})}),o.area=new lm(r,B(o)),o.container.appendChild(o.area.el),o}return se(t,[{key:"addNode",value:function(i){var s=this.components.get(i.name);if(!s)throw new Error("Component ".concat(i.name," not found"));var o=new pm(i,s,this);this.nodes.set(i,o),this.area.appendChild(o.el)}},{key:"removeNode",value:function(i){var s=this.nodes.get(i);this.nodes.delete(i),s&&(this.area.removeChild(s.el),s.destroy())}},{key:"addConnection",value:function(i){if(!i.input.node||!i.output.node)throw new Error("Connection input or output not added to node");var s=this.nodes.get(i.input.node),o=this.nodes.get(i.output.node);if(!s||!o)throw new Error("View node not found for input or output");var a=new cm(i,s,o,this);this.connections.set(i,a),this.area.appendChild(a.el)}},{key:"removeConnection",value:function(i){var s=this.connections.get(i);this.connections.delete(i),s&&this.area.removeChild(s.el)}},{key:"updateConnections",value:function(i){var s=this,o=i.node;o.getConnections().forEach(function(a){var l=s.connections.get(a);if(!l)throw new Error("Connection view not found");l.update()})}},{key:"resize",value:function(){var i=this.container;if(!i.parentElement)throw new Error("Container doesn't have parent element");var s=i.parentElement.clientWidth,o=i.parentElement.clientHeight;i.style.width=s+"px",i.style.height=o+"px"}},{key:"click",value:function(i){var s=this.container;s===i.target&&this.trigger("click",{e:i,container:s})}}]),t}(At),fm=function(){function n(){ie(this,n),P(this,"list",[])}return se(n,[{key:"add",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r?this.contains(t)||this.list.push(t):this.list=[t]}},{key:"clear",value:function(){this.list=[]}},{key:"remove",value:function(t){this.list.splice(this.list.indexOf(t),1)}},{key:"contains",value:function(t){return this.list.indexOf(t)!==-1}},{key:"each",value:function(t){this.list.forEach(t)}}]),n}(),Ic=se(function n(e){ie(this,n),P(this,"handlers",void 0),this.handlers=Ss({warn:[console.warn],error:[console.error],componentregister:[],destroy:[]},e)}),gm=function(n){Te(t,n);var e=Re(t);function t(){return ie(this,t),e.call(this,{nodecreate:[],nodecreated:[],noderemove:[],noderemoved:[],connectioncreate:[],connectioncreated:[],connectionremove:[],connectionremoved:[],translatenode:[],nodetranslate:[],nodetranslated:[],nodedraged:[],nodedragged:[],selectnode:[],multiselectnode:[],nodeselect:[],nodeselected:[],rendernode:[],rendersocket:[],rendercontrol:[],renderconnection:[],updateconnection:[],keydown:[],keyup:[],translate:[],translated:[],zoom:[],zoomed:[],click:[],mousemove:[],contextmenu:[],import:[],export:[],process:[],clear:[]})}return se(t)}(Ic),mm=function(n){Te(t,n);var e=Re(t);function t(r,i){var s;return ie(this,t),s=e.call(this,r,new gm),P(B(s),"nodes",[]),P(B(s),"selected",new fm),P(B(s),"view",void 0),s.view=new dm(i,s.components,B(s)),s.on("destroy",vt("keydown",function(o){return s.trigger("keydown",o)})),s.on("destroy",vt("keyup",function(o){return s.trigger("keyup",o)})),s.on("selectnode",function(o){var a=o.node,l=o.accumulate;return s.selectNode(a,l)}),s.on("nodeselected",function(){return s.selected.each(function(o){var a=s.view.nodes.get(o);a&&a.onStart()})}),s.on("translatenode",function(o){var a=o.dx,l=o.dy;return s.selected.each(function(h){var u=s.view.nodes.get(h);u&&u.onDrag(a,l)})}),s}return se(t,[{key:"addNode",value:function(i){this.trigger("nodecreate",i)&&(this.nodes.push(i),this.view.addNode(i),this.trigger("nodecreated",i))}},{key:"removeNode",value:function(i){var s=this;this.trigger("noderemove",i)&&(i.getConnections().forEach(function(o){return s.removeConnection(o)}),this.nodes.splice(this.nodes.indexOf(i),1),this.view.removeNode(i),this.trigger("noderemoved",i))}},{key:"connect",value:function(i,s){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.trigger("connectioncreate",{output:i,input:s}))try{var a=i.connectTo(s);a.data=o,this.view.addConnection(a),this.trigger("connectioncreated",a)}catch(l){this.trigger("warn",l)}}},{key:"removeConnection",value:function(i){this.trigger("connectionremove",i)&&(this.view.removeConnection(i),i.remove(),this.trigger("connectionremoved",i))}},{key:"selectNode",value:function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.nodes.indexOf(i)===-1)throw new Error("Node not exist in list");this.trigger("nodeselect",i)&&(this.selected.add(i,s),this.trigger("nodeselected",i))}},{key:"getComponent",value:function(i){var s=this.components.get(i);if(!s)throw"Component ".concat(i," not found");return s}},{key:"register",value:function(i){Dr(fn(t.prototype),"register",this).call(this,i),i.editor=this}},{key:"clear",value:function(){var i=this;$e(this.nodes).forEach(function(s){return i.removeNode(s)}),this.trigger("clear")}},{key:"toJSON",value:function(){var i={id:this.id,nodes:{}};return this.nodes.forEach(function(s){return i.nodes[s.id]=s.toJSON()}),this.trigger("export",i),i}},{key:"beforeImport",value:function(i){var s=po.validate(this.id,i);return s.success?(this.silent=!0,this.clear(),this.trigger("import",i),!0):(this.trigger("warn",s.msg),!1)}},{key:"afterImport",value:function(){return this.silent=!1,!0}},{key:"fromJSON",value:function(){var r=ye(G().mark(function s(o){var a=this,l;return G().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.beforeImport(o)){u.next=2;break}return u.abrupt("return",!1);case 2:return l={},u.prev=3,u.next=6,Promise.all(Object.keys(o.nodes).map(function(){var p=ye(G().mark(function d(c){var f,g;return G().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return f=o.nodes[c],g=a.getComponent(f.name),y.next=4,g.build(nr.fromJSON(f));case 4:l[c]=y.sent,a.addNode(l[c]);case 6:case"end":return y.stop()}},d)}));return function(d){return p.apply(this,arguments)}}()));case 6:Object.keys(o.nodes).forEach(function(p){var d=o.nodes[p],c=l[p];Object.keys(d.outputs).forEach(function(f){var g=d.outputs[f];g.connections.forEach(function(m){var y=m.node,w=m.data,_=c.outputs.get(f),v=l[y].inputs.get(m.input);if(!_||!v)return a.trigger("error","IO not found for node ".concat(c.id));a.connect(_,v,w)})})}),u.next=13;break;case 9:return u.prev=9,u.t0=u.catch(3),this.trigger("warn",u.t0),u.abrupt("return",!this.afterImport());case 13:return u.abrupt("return",this.afterImport());case 14:case"end":return u.stop()}},s,this,[[3,9]])}));function i(s){return r.apply(this,arguments)}return i}()}]),t}(Tc),Pc=function(n){Te(t,n);var e=Re(t);function t(r,i,s){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return ie(this,t),e.call(this,r,i,s,o)}return se(t,[{key:"hasConnection",value:function(){return this.connections.length>0}},{key:"connectTo",value:function(i){if(!this.socket.compatibleWith(i.socket))throw new Error("Sockets not compatible");if(!i.multipleConnections&&i.hasConnection())throw new Error("Input already has one connection");if(!this.multipleConnections&&this.hasConnection())throw new Error("Output already has one connection");var s=new Oc(this,i);return this.connections.push(s),s}},{key:"connectedTo",value:function(i){return this.connections.some(function(s){return s.input===i})}},{key:"toJSON",value:function(){return{connections:this.connections.map(function(i){if(!i.input.node)throw new Error("Node not added to Input");return{node:i.input.node.id,input:i.input.key,data:i.data}})}}}]),t}(ho),Nc=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ie(this,n),P(this,"name",void 0),P(this,"data",void 0),P(this,"compatible",[]),this.name=e,this.data=t,this.compatible=[]}return se(n,[{key:"combineWith",value:function(t){this.compatible.push(t)}},{key:"compatibleWith",value:function(t){return this===t||this.compatible.includes(t)}}]),n}();function ym(n,e){return n.filter(function(t){return e.indexOf(t)!==-1})}var Lc=function(){function n(e){ie(this,n),P(this,"nodes",void 0),this.nodes=e}return se(n,[{key:"extractInputNodes",value:function(t){var r=this;return Object.keys(t.inputs).reduce(function(i,s){var o=t.inputs[s].connections,a=(o||[]).reduce(function(l,h){return[].concat($e(l),[r.nodes[h.node]])},[]);return[].concat($e(i),$e(a))},[])}},{key:"findSelf",value:function(t,r){var i=ym(t,r);if(i.length)return i[0];var s=Qa(r),o;try{for(s.s();!(o=s.n()).done;){var a=o.value,l=[a].concat($e(t)),h=this.findSelf(l,this.extractInputNodes(a));if(h)return h}}catch(u){s.e(u)}finally{s.f()}return null}},{key:"detect",value:function(){var t=this,r=Object.keys(this.nodes).map(function(l){return t.nodes[l]}),i=Qa(r),s;try{for(i.s();!(s=i.n()).done;){var o=s.value,a=this.findSelf([o],this.extractInputNodes(o));if(a)return a}}catch(l){i.e(l)}finally{i.f()}return null}}]),n}(),He={AVAILABLE:0,PROCESSED:1,ABORT:2},wm=function(n){Te(t,n);var e=Re(t);function t(){return ie(this,t),e.call(this,{})}return se(t)}(Ic),bm=function(n){Te(t,n);var e=Re(t);function t(r){var i;return ie(this,t),i=e.call(this,r,new wm),P(B(i),"args",[]),P(B(i),"data",null),P(B(i),"state",He.AVAILABLE),P(B(i),"forwarded",new Set),P(B(i),"onAbort",function(){}),i}return se(t,[{key:"clone",value:function(){var i=new t(this.id);return this.components.forEach(function(s){return i.register(s)}),i}},{key:"throwError",value:function(){var r=ye(G().mark(function s(o){var a,l=arguments;return G().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return a=l.length>1&&l[1]!==void 0?l[1]:null,u.next=3,this.abort();case 3:return this.trigger("error",{message:o,data:a}),this.processDone(),u.abrupt("return","error");case 6:case"end":return u.stop()}},s,this)}));function i(s){return r.apply(this,arguments)}return i}()},{key:"processStart",value:function(){return this.state===He.AVAILABLE?(this.state=He.PROCESSED,!0):(this.state===He.ABORT||console.warn(`The process is busy and has not been restarted.
                Use abort() to force it to complete`),!1)}},{key:"processDone",value:function(){var i=this.state!==He.ABORT;return this.state=He.AVAILABLE,i||(this.onAbort(),this.onAbort=function(){}),i}},{key:"abort",value:function(){var r=ye(G().mark(function s(){var o=this;return G().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",new Promise(function(h){o.state===He.PROCESSED?(o.state=He.ABORT,o.onAbort=h):o.state===He.ABORT?(o.onAbort(),o.onAbort=h):h()}));case 1:case"end":return l.stop()}},s)}));function i(){return r.apply(this,arguments)}return i}()},{key:"lock",value:function(){var r=ye(G().mark(function s(o){return G().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",new Promise(function(h){o.unlockPool=o.unlockPool||[],o.busy&&!o.outputData?o.unlockPool.push(h):h(),o.busy=!0}));case 1:case"end":return l.stop()}},s)}));function i(s){return r.apply(this,arguments)}return i}()},{key:"unlock",value:function(i){i.unlockPool.forEach(function(s){return s()}),i.unlockPool=[],i.busy=!1}},{key:"extractInputData",value:function(){var r=ye(G().mark(function s(o){var a=this,l,h,u,p,d,c,f;return G().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:l={},h=0,u=Object.keys(o.inputs);case 2:if(!(h<u.length)){m.next=13;break}return p=u[h],d=o.inputs[p],c=d.connections,m.next=8,Promise.all(c.map(function(){var y=ye(G().mark(function w(_){var v,b;return G().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return v=a.data.nodes[_.node],E.next=3,a.processNode(v);case 3:if(b=E.sent,b){E.next=8;break}a.abort(),E.next=9;break;case 8:return E.abrupt("return",b[_.output]);case 9:case"end":return E.stop()}},w)}));return function(w){return y.apply(this,arguments)}}()));case 8:f=m.sent,l[p]=f;case 10:h++,m.next=2;break;case 13:return m.abrupt("return",l);case 14:case"end":return m.stop()}},s)}));function i(s){return r.apply(this,arguments)}return i}()},{key:"processWorker",value:function(){var r=ye(G().mark(function s(o){var a,l,h;return G().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.extractInputData(o);case 2:return a=p.sent,l=this.components.get(o.name),h={},p.prev=5,p.next=8,l.worker.apply(l,[o,a,h].concat($e(this.args)));case 8:p.next=14;break;case 10:p.prev=10,p.t0=p.catch(5),this.abort(),this.trigger("warn",p.t0);case 14:return p.abrupt("return",h);case 15:case"end":return p.stop()}},s,this,[[5,10]])}));function i(s){return r.apply(this,arguments)}return i}()},{key:"processNode",value:function(){var r=ye(G().mark(function s(o){return G().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(this.state===He.ABORT||!o)){l.next=2;break}return l.abrupt("return",null);case 2:return l.next=4,this.lock(o);case 4:if(o.outputData){l.next=8;break}return l.next=7,this.processWorker(o);case 7:o.outputData=l.sent;case 8:return this.unlock(o),l.abrupt("return",o.outputData);case 10:case"end":return l.stop()}},s,this)}));function i(s){return r.apply(this,arguments)}return i}()},{key:"forwardProcess",value:function(){var r=ye(G().mark(function s(o){var a=this;return G().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.state!==He.ABORT){h.next=2;break}return h.abrupt("return",null);case 2:return h.next=4,Promise.all(Object.keys(o.outputs).map(function(){var u=ye(G().mark(function p(d){var c;return G().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return c=o.outputs[d],g.next=3,Promise.all(c.connections.map(function(){var m=ye(G().mark(function y(w){var _;return G().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(_=a.data.nodes[w.node],a.forwarded.has(_)){b.next=7;break}return a.forwarded.add(_),b.next=5,a.processNode(_);case 5:return b.next=7,a.forwardProcess(_);case 7:case"end":return b.stop()}},y)}));return function(y){return m.apply(this,arguments)}}()));case 3:return g.abrupt("return",g.sent);case 4:case"end":return g.stop()}},p)}));return function(p){return u.apply(this,arguments)}}()));case 4:return h.abrupt("return",h.sent);case 5:case"end":return h.stop()}},s,this)}));function i(s){return r.apply(this,arguments)}return i}()},{key:"copy",value:function(i){return i=Object.assign({},i),i.nodes=Object.assign({},i.nodes),Object.keys(i.nodes).forEach(function(s){i.nodes[s]=Object.assign({},i.nodes[s])}),i}},{key:"validate",value:function(){var r=ye(G().mark(function s(o){var a,l,h;return G().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(a=po.validate(this.id,o),l=new Lc(o.nodes),a.success){p.next=6;break}return p.next=5,this.throwError(a.msg);case 5:return p.abrupt("return",p.sent);case 6:if(h=l.detect(),!h){p.next=11;break}return p.next=10,this.throwError("Recursion detected",h);case 10:return p.abrupt("return",p.sent);case 11:return p.abrupt("return",!0);case 12:case"end":return p.stop()}},s,this)}));function i(s){return r.apply(this,arguments)}return i}()},{key:"processStartNode",value:function(){var r=ye(G().mark(function s(o){var a;return G().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(o){h.next=2;break}return h.abrupt("return");case 2:if(a=this.data.nodes[o],a){h.next=7;break}return h.next=6,this.throwError("Node with such id not found");case 6:return h.abrupt("return",h.sent);case 7:return h.next=9,this.processNode(a);case 9:return h.next=11,this.forwardProcess(a);case 11:case"end":return h.stop()}},s,this)}));function i(s){return r.apply(this,arguments)}return i}()},{key:"processUnreachable",value:function(){var r=ye(G().mark(function s(){var o,a,l;return G().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:o=this.data,u.t0=G().keys(o.nodes);case 2:if((u.t1=u.t0()).done){u.next=12;break}if(a=u.t1.value,l=o.nodes[a],!(typeof l.outputData>"u")){u.next=10;break}return u.next=8,this.processNode(l);case 8:return u.next=10,this.forwardProcess(l);case 10:u.next=2;break;case 12:case"end":return u.stop()}},s,this)}));function i(){return r.apply(this,arguments)}return i}()},{key:"process",value:function(){var r=ye(G().mark(function s(o){var a,l,h,u,p=arguments;return G().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(a=p.length>1&&p[1]!==void 0?p[1]:null,this.processStart()){c.next=3;break}return c.abrupt("return");case 3:if(this.validate(o)){c.next=5;break}return c.abrupt("return");case 5:for(this.data=this.copy(o),l=p.length,h=new Array(l>2?l-2:0),u=2;u<l;u++)h[u-2]=p[u];return this.args=h,this.forwarded=new Set,c.next=11,this.processStartNode(a);case 11:return c.next=13,this.processUnreachable();case 13:return c.abrupt("return",this.processDone()?"success":"aborted");case 14:case"end":return c.stop()}},s,this)}));function i(s){return r.apply(this,arguments)}return i}()}]),t}(Tc),vm={Engine:bm,Recursion:Lc,Component:Ac,Control:sm,Connection:Oc,Emitter:At,Input:Cc,IO:ho,Node:nr,NodeEditor:mm,Output:Pc,Socket:Nc};class kt extends Nc{constructor(e,t,r){super(e,r),this.customActions=new Map,this.opts=r||{},this.type=t}get format(){return this.opts.format}get array(){return this.opts.array||!1}get customAction(){return this.opts.customAction}get customSettings(){return this.opts.customSettings}compatibleWith(e,t=!1){return t?super.compatibleWith(e):e.compatibleWith(this,!0)}isValidUrl(e){let t;if(!(typeof e=="string"&&e.length>0))return!1;try{t=new URL(e)}catch{return!1}return t.protocol==="http:"||t.protocol==="https:"}}class Gt extends kt{compatibleWith(e,t){const r=this;return r.type?["string","image","audio","document","file"].includes(r.type):e instanceof Gt}detectMimeType(e,t){}async persistObject(e,t,r){var s;if((t.ticket||t.fid)&&t.url&&!t.data)return await Promise.resolve(t);r??(r={}),r.mimeType??(r.mimeType=(s=this.detectMimeType)==null?void 0:s.call(this,e,t));const i={userId:e.userId,jobId:e.jobId,...r};return e.app.cdn.putTemp(t,i)}async persistObjects(e,t,r){return await Promise.all(t.map(async i=>await this.persistObject(e,i,r)))}async _inputFromString(e,t){if(typeof t!="string")return t;const i=t.split(`
`).map(s=>s.trim()).filter(s=>s.length);return await Promise.all(i.map(async s=>await this.persistObject(e,s)))}async _handleSingleObject(e,t,r=!1){var l,h,u,p;if(!t)return null;let i=null;const s=(l=this.format)!=null&&l.includes("base64")?"base64":void 0,o=s&&((h=this.format)==null?void 0:h.includes("withHeader"));if(t.fid)!r&&s!=="base64"?i=await e.app.cdn.find(t.fid):i=await e.app.cdn.get(t,null,s);else if(t instanceof Buffer)i=await this.persistObject(e,t);else if(typeof t=="string"){if(this.isValidUrl(t))i=await this.persistObject(e,t.trim());else if((u=t==null?void 0:t.startsWith)!=null&&u.call(t,"fid://")){const[d,c]=t.split("://")[1].split(".");i=await e.app.cdn.get({fid:d},null,s)}else t.length>0;i=await this.persistObject(e,t)}let a=null;return i&&i.fid?s==="base64"?a=i.asBase64(o):a=i:console.error("File socket: Failure to process value",t),a!==null&&((p=this.customSettings)!=null&&p.do_no_return_data)&&s!=="base64"&&delete a.data,a}async _handleObjectArray(e,t,r=!1){return t?(Array.isArray(t)||(t=[t]),t=t.filter(i=>i!==null),await Promise.all(t.map(async i=>await this._handleSingleObject(e,i,r)))):null}async _handlePort(e,t,r){return t=await this._inputFromString(e,t),Array.isArray(t)||(t=[t]),this.array?await this._handleObjectArray(e,t,r):await this._handleSingleObject(e,t[0],r)}async handleInput(e,t){return await this._handlePort(e,t,!0)}async handleOutput(e,t){return await this._handlePort(e,t,!1)}}class fo extends Gt{mightBeUtf8PlainText(e){const r=e.length*.05;let i=0;for(const s of e){const o=s.charCodeAt(0);if((o>=0&&o<=31||o>=127&&o<=159)&&(i++,i>r))return!1}return!0}detectMimeType(e,t){if(t&&typeof t=="string"&&this.mightBeUtf8PlainText(t))return"text/plain"}compatibleWith(e,t){const r=this;return r.type?["string","text","document"].includes(r.type):e instanceof fo}}class _m extends kt{async handleInput(e,t){return Array.isArray(t)&&(t=t[0]),t}async handleOutput(e,t){return await this.handleInput(e,t)}}class km extends kt{async handleSingleValue(e,t){if(t==null)return null;if(typeof t=="object")return t;if(typeof t=="string")try{return JSON.parse(t)}catch(r){return console.error("Error parsing object socket",r),null}return t}async _handlePort(e,t){const r=Array.isArray(t);let i=t;if(r&&!this.array?i=t.length>0?t[0]:[]:!r&&this.array&&(i=[t]),Array.isArray(i)){let s=await Promise.all(i.map(async o=>await this.handleSingleValue(e,o)));return s=s.filter(o=>o!=null),s.length>0?s:null}else{const s=await this.handleSingleValue(e,i);return s??null}}async handleInput(e,t){return await this._handlePort(e,t)}async handleOutput(e,t){return await this._handlePort(e,t)}}class go extends Gt{compatibleWith(e,t){const r=this;return r.type?["string","file","image"].includes(r.type):e instanceof go}}class mo extends Gt{compatibleWith(e,t){const r=this;return r.type?["string","file","video"].includes(r.type):e instanceof mo}}class yo extends Gt{compatibleWith(e,t){const r=this;return r.type?["string","file","audio"].includes(r.type):e instanceof yo}}class wo extends kt{compatibleWith(e,t){const r=this;return r.type?["integer","number","float"].includes(r.type):e instanceof kt}async handleInput(e,t){return Array.isArray(t)&&(t=t[0]),t?t==="inf"?1/0:t==="-inf"?-1/0:t==="nan"?NaN:typeof t!="number"?Number(t):t:0}async handleOutput(e,t){return await this.handleInput(e,t)}}class yi extends kt{compatibleWith(e,t){const r=this;return r.type?["string","object","number","integer","float","file","image","audio","document","text"].includes(r.type):e instanceof yi}convertSingleValue(e){var t;return e==null||e===void 0?((t=this.customSettings)==null?void 0:t.null_value)||"":typeof e=="object"?e instanceof Date?e.toISOString():e.fid&&e.furl?e.furl:JSON.stringify(e,null,2):typeof e=="string"?e:typeof e=="number"?e.toString():typeof e=="boolean"?e?"true":"false":JSON.stringify(e,null,2)}async handleInput(e,t){var i,s;const r=((i=this.customSettings)==null?void 0:i.array_separator)??`
`;return this.array&&typeof t=="string"&&(t=t.split(r)),Array.isArray(t)||(t=[t]),t=t.map(this.convertSingleValue.bind(this)),(s=this.customSettings)!=null&&s.filter_empty&&(t=t.filter(o=>o)),this.array?t:t.join(r)}async handleOutput(e,t){return await this.handleInput(e,t)}}class xm extends kt{async handleInput(e,t){return Array.isArray(t)&&(t=t[0]),!!t}async handleOutput(e,t){return await this.handleInput(e,t)}}class Sm extends kt{compatibleWith(e,t){return!0}async handleInput(e,t){return t}async handleOutput(e,t){return t}}const Ie=new Map;Ie.set("boolean",xm);Ie.set("number",wo);Ie.set("integer",wo);Ie.set("float",wo);Ie.set("string",yi);Ie.set("text",yi);Ie.set("json",km);Ie.set("file",Gt);Ie.set("image",go);Ie.set("audio",yo);Ie.set("document",fo);Ie.set("video",mo);Ie.set("any",Sm);const el=function(n,e){let t=n;return e.array==!0&&(t+="Array"),e.format!==void 0&&(t+=`_${e.format}`),t};class Nt{constructor(){this.isSchemaObject=e=>"type"in e||"$ref"in e,this.sockets=new Map}static getSingleton(){return Nt.instance??(Nt.instance=new Nt),Nt.instance}constructSocket(e,t){let r=Ie.get(e);r===void 0&&(console.warn(`Unknown socketType: ${e}, creating primimtive`),r=_m);const i=el(e,t),s=new r(i,e,{...t});return this.sockets.forEach(o=>{o.type===e&&(o.combineWith(s),s.combineWith(o))}),this.sockets.set(s.name,s),s}getOrCreateSocket(e,t){["image","audio","document","cdnObject","object","video"].forEach(s=>{e.startsWith(s)&&(e=s)}),e==="object"&&(e="json"),e.startsWith("cdnObject")&&(e="file"),e.includes("Array")&&(t.array=!0),e.includes("B64")&&(t.format="base64");const r=el(e,t);return this.has(r)?this.get(r):this.constructSocket(e,t)}add(e,t){this.sockets.set(e,t)}get(e){return this.sockets.get(e)}has(e){return this.sockets.has(e)}}var Mc=(n=>(n[n.NO_EXECUTE=1]="NO_EXECUTE",n[n.HAS_NATIVE_CODE=2]="HAS_NATIVE_CODE",n[n.UNIQUE_PER_WORKFLOW=3]="UNIQUE_PER_WORKFLOW",n))(Mc||{});function $c(n){if(Array.isArray(n)){if(n.length===0)return[];if(typeof n[0]=="string")return n.map(e=>({title:e,value:e}));if(typeof n[0]=="object"&&"title"in n[0]&&"value"in n[0])return n}return typeof n=="object"&&"block"in n&&"map"in n,n}class ni{constructor(){this.data={}}create(e,t,r,i,s){return this.data.name=e,this.data.customSocket=i,this.data.socketOpts={...s},r==="array"&&(r="object",this.data.socketOpts.array=!0),this.data.type=r,this.data.dataTypes=[r],this.data.customData={},this.data.title=e,this.data.source={sourceType:t==="input"?"requestBody":"responseBody"},this}setRequired(e){return this.data.required=e,this}setHidden(e){return this.data.hidden=e,this}set(e,t){return this.data[e]=t,this}setDefault(e){return this.data.default=e,this}setControl(e){return e.dataType=this.data.type,this.data.control=e,this}allowMultiple(e=!0){return this.data.allowMultiple=e,this.data.socketOpts.array=!0,this}setConstraints(e,t,r){return this.data.minimum=e,this.data.maximum=t,this.data.step=r,this}setChoices(e,t){return t!=null&&(this.data.default=t),e!=null&&(this.data.choices=$c(e),this.data.choices||(this.data.choices=[{title:"(default)",value:t??""}])),this}setCustom(e,t){return this.data.customData[e]=t,this}toOmniIO(){var e;return(e=this.data).title??(e.title=this.data.name),this.data}}class Dc{constructor(e){this.data={name:e},this.data.customData={}}create(e,t){return this.data.name=e,this.data.dataType=t,this}setRequired(e){return this.data.required=e,this}setHidden(e){return this.data.hidden=e,this}setCustom(e,t){return this.data.customData[e]=t,this}setControlType(e){return this.data.controlType=e,this}set(e,t){return this.data[e]=t,this}setChoices(e,t){return this.data.default=t,this.data.choices=$c(e),this.data.choices||(this.data.choices=[{title:"(default)",value:t??""}]),this}setReadonly(e){return this.data.readonly=e,this}setConstraints(e,t,r){return e!=null&&(this.data.minimum=e),t!=null&&(this.data.maximum=t),r!=null&&(this.data.step=r),this}setDefault(e){return this.data.default=e,this}toOmniControl(){var e;return(e=this.data).title??(e.title=this.data.name),this.data}}class jc{constructor(){this.data={}}fromJSON(e){return this.data=JSON.parse(JSON.stringify(e)),this}}class Em extends jc{constructor(){super(),this.data.type="OAIComponent31",this.data.flags=0,this.data.macros={},this.data.origin="omnitool:Composer",this.data.customData={}}dependsOn(e){return this.data.dependsOn=e,this}fromScratch(){return this.data.apiNamespace=this.data.displayNamespace,this.data.apiOperationId=this.data.displayOperationId,this.data.responseContentType="application/json",this.data.category="Utilities",this.data.tags=["default"],this}createInput(e,t,r,i){return new ni().create(e,"input",t,r,i||{})}addInput(e){return this.data.inputs=this.data.inputs??{},this.data.inputs[e.name]=e,this}createOutput(e,t,r,i){return new ni().create(e,"output",t,r,i||{})}addOutput(e){return this.data.outputs=this.data.outputs??{},this.data.outputs[e.name]=e,this}setTags(e){return this.data.tags=e,this}setRenderTemplate(e){return this.data.renderTemplate=e,this}create(e,t){return this.data.displayNamespace=e,this.data.displayOperationId=t,this}set(e,t){return this.data[e]=t,this}setMethod(e){return this.data.method=e,this}useAPI(e,t){return this.data.apiNamespace=e,this.data.apiOperationId=t,this}setMeta(e){return this.data.meta=e,this}setFlags(e){return this.data.flags=e,this}setFlag(e,t=!0){const r=1<<e;return t?this.data.flags=this.data.flags|r:this.data.flags=this.data.flags&~r,this}setMacro(e,t){return this.data.macros[e]=t,t instanceof Function&&this.setFlag(Mc.HAS_NATIVE_CODE),this}createControl(e,t){return new Dc(e).create(e,t)}setCustom(e,t){var r;return(r=this.data).customData??(r.customData={}),this.data.customData[e]=t,this}addControl(e){return this.data.controls=this.data.controls??{},this.data.controls[e.name]=e,this}toJSON(){return this.data}}class Am extends jc{constructor(){super(),this.data.macros={},this.data.origin="omnitool:Composer",this.data.customData={}}fromComponent(e,t){return this.data.apiNamespace=e,this.data.apiOperationId=t,this}createInput(e,t,r){return new ni().create(e,"input",t,r)}addInput(e){return this.data.inputs=this.data.inputs??{},this.data.inputs[e.name]=e,this}createOutput(e,t,r){return new ni().create(e,"output",t,r)}addOutput(e){return this.data.outputs=this.data.outputs??{},this.data.outputs[e.name]=e,this}create(e,t){return this.data.displayNamespace=e,this.data.displayOperationId=t,this}set(e,t){return this.data[e]=t,this}useAPI(e,t){return this.data.apiNamespace=e,this.data.apiOperationId=t,this}setMeta(e){return this.data.meta=e,this}setCustom(e,t){var r;return(r=this.data).customData??(r.customData={}),this.data.customData[e]=t,this}createControl(e){return new Dc(e).create(e)}addControl(e){return this.data.controls=this.data.controls??{},this.data.controls[e.name]=e,this}hideExcept(e,t){(e==null?void 0:e.length)>0&&(this.data.scripts=this.data.scripts??{},this.data.scripts["hideExcept:inputs"]=e),(t==null?void 0:t.length)>0&&(this.data.scripts=this.data.scripts??{},this.data.scripts["hideExcept:outputs"]=t)}toJSON(){return this.data}}class Yn extends vm.Control{constructor(e,t,r){super(e.name),this.data=JSON.parse(JSON.stringify(e)),this.emitter=r,this.props={ikey:e.name},this.component=t,t||console.error("Could not find component for "+e.controlType)}async initChoices(){var e,t,r;if(this.data.choices){const i=this.data.choices;if(Array.isArray(i)&&(this.data.choices=i.map(function(s){return typeof s=="object"?s:{value:s,title:s}})),typeof this.data.choices=="object"){const s=this.data.choices;if(s.block){let o=["Internal Error Fetching choices"];try{o=await globalThis.client.runBlock({block:s.block,args:s.args||{},cache:s.cache??s.map.cache??"none"})}catch(h){console.error("Could not load choices for "+this.data.name+": "+h.message),o=["ERROR: "+h.message,this.data.default]}o.error&&(console.error("Could not load choices for "+this.data.name+": "+o.error.message),o=["ERROR: "+o.error,this.data.default]);const a=(e=s.map)==null?void 0:e.root;a&&o[a]!=null&&Array.isArray(o[a])&&(o=o[a]),Array.isArray(o)||(o=Array.from(Object.values(o)));const l=new RegExp((r=(t=s.map)==null?void 0:t.filter)==null?void 0:r.value);this.data.choices=o.map(h=>{var p,d;let u={value:h,title:h,description:""};return(p=s.map)!=null&&p.value&&((d=s.map)!=null&&d.title)&&(u={value:h[s.map.value],title:h[s.map.title],description:h[s.map.description]||""}),u}).filter(h=>h.value&&l.test(h.title)).sort((h,u)=>u.title.localeCompare(h.title))}}}}get dataType(){return this.data.dataType??"string"}get controlType(){return console.log("Access to field controlType on control"),this.data.controlType}get type(){return console.trace(),console.log("Access to deprecated field type on control"),this.data.dataType}get opts(){return this.data}get displays(){return this.data.displays??null}get minimum(){return this.data.minimum}get description(){return this.data.description}get title(){return this.data.title??this.data.name}get maximum(){return this.data.maximum}get customData(){return this.data.customData??{}}custom(e){var t;return((t=this.data.customData)==null?void 0:t[e])??null}get choices(){return this.data.choices??["(default)"]}get readonly(){return this.data.readonly??!1}_formatValue(e){return e&&((this.dataType==="number"||this.dataType=="float")&&typeof e=="string"||this.dataType==="integer"&&typeof e=="string"?e=parseFloat(e):this.dataType==="boolean"&&typeof e=="number"?e=e!=0:this.dataType==="boolean"&&typeof e=="string"&&(e=[!0,"true","1","on","active"].includes(e.toLowerCase()))),e}setValue(e){this.displays||this.readonly||(e=this._formatValue(e),this.putData(this.props.ikey,e),this.update())}static async fromControl(e,t){const r=$t.getInstance().get(e.controlType),i=new Yn(e,r,t);return await i.initChoices(),i}static async fromIO(e,t,r){const i={dataType:t.type,controlType:e,name:t.name,title:t.title,choices:t.choices,description:t.description,step:t.step,default:t.default,minimum:t.minimum,maximum:t.maximum,required:t.required,...t.control||{}},s=$t.getInstance().get(e),o=new Yn(i,s,r);return await o.initChoices(),o}}class Om extends Ac{constructor(e,t){var i,s,o,a,l,h;const r=Gg(e,t??{});super(`${r.displayNamespace}.${r.displayOperationId}`),this.data=r,(i=this.data).macros??(i.macros={}),(s=this.data).flags??(s.flags=0),(o=this.data).errors??(o.errors=[]),(a=this.data).xOmniEnabled??(a.xOmniEnabled=!0);for(const u in this.data.inputs)(l=this.data.inputs[u]).source??(l.source={sourceType:"requestBody"});for(const u in this.data.outputs)(h=this.data.outputs[u]).source??(h.source={sourceType:"responseBody"})}static create(e,t){return new Em().create(e,t)}static createPatch(e,t){return new Am().create(e,t)}get validator(){return this._validator??null}get title(){return this.data.title}get description(){return this.data.description}get scripts(){return this.data.scripts}get flags(){return this.data.flags??0}get summary(){var e;return this.data.description??((e=this.meta.source)==null?void 0:e.summary)}get category(){return this.data.category??"Base API"}get custom(){return this.data.customData||{}}get tags(){return this.data.tags}get apiKey(){return`${this.data.apiNamespace}.${this.data.apiOperationId}`}get apiNamespace(){return this.data.apiNamespace}get renderTemplate(){return this.data.renderTemplate||"default"}get type(){return this.data.type??"OAIComponent31"}get method(){return this.data.method}get inputs(){return this.data.inputs}get meta(){return this.data.meta??{}}get outputs(){return this.data.outputs}get macros(){return this.data.macros}get hash(){return this.data.hash}get controls(){return this.data.controls}get xOmniEnabled(){return this.data.xOmniEnabled??!0}set xOmniEnabled(e){this.data.xOmniEnabled=e}setType(e){return this.data.type=e,this}setApiOperationId(e){return this.data.apiOperationId=e,this}setApiNamespace(e){return this.data.apiNamespace=e,this}setDisplayNamespace(e){return this.data.displayNamespace=e,this}setDisplayOperationId(e){return this.data.displayOperationId=e,this}setTitle(e){return this.data.title=e,this}setMethod(e){return this.data.method=e,this}setDescription(e){return this.data.description=e,this}setUrlPath(e){return this.data.urlPath=e,this}setMeta(e){return this.data.meta=e,this}addInput(e,t){return this.data.inputs[e]=t,this}addControl(e,t){return this.data.controls[e]=t,this}addOutput(e,t){return this.data.outputs[e]=t,this}addTag(e){return this.data.tags.push(e),this}setCategory(e){return this.data.category=e,this}setRequestContentType(e){return this.data.requestContentType=e,this}setResponseContentType(e){return this.data.responseContentType=e,this}setCredentials(e){return this.data.credentials=e,this}setValidator(e){return this.data.validator=e,this}addSecurity(e){return this.data.security=this.data.security??[],this.data.security.push(e),this}setMacro(e,t){return this.data.macros[e]=t,this}pickDefaultControl(e){var i,s;if(e.choices!=null)return"AlpineSelectComponent";if(((i=e.control)==null?void 0:i.controlType)!=null)return(s=e.control)==null?void 0:s.controlType;if(e.controlType!=null)return e.controlType;if(e.step!=null||e.minimum!=null&&e.maximum!=null&&Math.abs(e.maximum-e.minimum)<=100)return e.type==="float"&&(e.step??(e.step=.1)),"AlpineNumWithSliderComponent";const t=e.type;t===null&&omnilog.warn("Null Object Type");const r=e.customSocket;return r&&["imageArray","image","document","documentArray","audio","file","audioArray","fileArray"].includes(r)?"AlpineLabelComponent":t==="number"||t==="integer"||t==="float"?"AlpineNumComponent":t==="boolean"?"AlpineToggleComponent":t==="error"?"AlpineTextComponent":t==="object"?"AlpineCodeMirrorComponent":t==="string"||r==="text"?"AlpineTextComponent":"AlpineLabelComponent"}async builder(e){var t;e.title=this.title,e.description=this.description,await((t=this._builder)==null?void 0:t.call(this,e))}async workerStart(e,t){}async setControlValue(e,t,r){var i;if(this.data.controls[e]==null){omnilog.warn(this.name,"tried to update non existing control",e,` - suppressed.
Please check your component for a setComponentValue call that passes in a non existing control key.`);return}if(this.editor!=null){const s=((i=this.editor)==null?void 0:i.nodes.find(o=>o.id===r.node.id).controls.get(e))??null;s!=null&&s.setValue(t)}}async sendStatusUpdate(e,t,r){}}class wi extends Om{constructor(e,t,r){r&&omnilog.warn("fns not implemented"),super(e,t)}getSocketForIO(e){var r;let t="object";return e.customSocket?t=e.customSocket:e.type!=null&&typeof e.type=="string"?t=e.type:((r=e.dataTypes)==null?void 0:r.length)>0?t=e.dataTypes[0]:(e.step!=null||e.maximum!=null||e.minimum!=null)&&(t="number"),Nt.getSingleton().getOrCreateSocket(t,e.socketOpts||{})}async _redraw(e){}enumerateInputs(e){return Object.assign({},e.data["x-omni-dynamicInputs"]||{},this.data.inputs)}enumerateOutputs(e){return Object.assign({},e.data["x-omni-dynamicOutputs"]||{},this.data.outputs)}async _builder(e){e.category=this.category,e.renderTemplate=this.renderTemplate,e.title=e.data["x-omni-title"]||this.title,e.summary=e.data["x-omni-summary"]||this.summary,e.namespace=this.data.displayNamespace??this.data.apiNamespace,e.meta=this.meta,e.meta.title=this.title??this.summary,e.errors=this.data.errors;const t=this.enumerateInputs(e);for(const i in t){const s=t[i];s.name??(s.name=i),s.title??(s.title=i);const o=this.pickDefaultControl(s),a=await Yn.fromIO(o,s,this.editor);if(!s.hidden)if(s.readonly)e.addControl(a);else{const l=new Cc(i,s.title||s.name,this.getSocketForIO(s),s.allowMultiple);l.name??(l.name=i),l.addControl(a),e.addInput(l)}}for(const i in this.controls){const s=this.controls[i];if(!s.hidden){s.name??(s.name=i),s.controlType??(s.controlType=this.pickDefaultControl(s));const o=await Yn.fromControl(s,this.editor);e.addControl(o)}}const r=this.enumerateOutputs(e);for(const i in r){const s={...r[i],name:i,title:r[i].title??i};if(!s.hidden){const o=new Pc(i,s.title||s.name,this.getSocketForIO(s));o.name??(o.name=i),e.addOutput(o)}}}async runXFunction(e,t,r){return null}async _workerStart(e,t){}async runInputScripts(e,t){return e}async runOutputScripts(e,t){return e}getRequestComponents(e,t){return{requestBody:{},parameters:[]}}prunePayload(e,t,r){}async getPayload(e){return JSON.parse(JSON.stringify({}))}worker(){throw new Error("This should never be called")}static fromJSON(e,t){const r=new wi(e,t);if(!r.name)throw new Error;return r}toJSON(){return JSON.parse(JSON.stringify({...this.data,name:this.name}))}}class Cm extends ft{constructor(e,t){super({id:e??"omni/component"},t)}render(e){const t=JSON.parse(e.value);let r;return t.type==="OAIComponent31"&&(r=wi.fromJSON(t)),r?`
      <div class='component block rounded-lg px-4 py-2 text-sm w-full text-gray-500 hover:bg-gray-50 hover:text-gray-700  cursor-pointer'
        x-data='{}' x-tooltip='${r==null?void 0:r.name}'
        x-on:click="window.client.runScript('add',['${Fn.sanitize(r.name)}'])">
        <div

          class='font-semibold max-w-md'>${Fn.sanitize(r==null?void 0:r.title)}
        </div>

        <div>
        ${Fn.sanitize(r==null?void 0:r.description)}</div>

      </div>`:`Can not render missing component ${e.value}`}}class Tm extends ft{constructor(e){e??(e={}),super({id:"omni/component-meta"},e)}async load(){}render(e){var r;let t="";return(r=e.value)!=null&&r.source?t=`
        <div x-data='${JSON.stringify(e.value)}'>
          <div x-show='title' class="font-bold text-center bg-gray-700 mb-2 text-gray-100" >
            <span x-text='title' ></span>
          </div>
          <div x-show='source' class=' bg-gray-300 m-1 pb-1 font-mono'>
            <div class="font-bold text-center bg-gray-700 mb-2 text-gray-100" >
              <span x-text='source?.title' ></span>
            </div>

            <div class='text-xs pl-2'>
              <div x-show='source?.authors'>
                <span class='font-semibold'>Authors: </span>
                <span  x-text='source?.authors?.join?.(", ")||source?.authors'></span>
              </div>
            </div>
            <p class='text-xs mt-1 mb-2 pl-2' x-text='source?.summary || "No Summary Available"'></p>
            <template x-for='(linkUrl,linkName) in source?.links' :key="linkName">
                <div class='text-xs  pl-1'><a class='text-blue-600  font-semibold cursor-pointer hover:text-blue-800'' :href='linkUrl' x-text='linkName' target='_blank' ></a></div>
            </template>
          </div>
        </div>`:t=`
        <div x-data='${JSON.stringify(e.value)}'>
          <div x-show='title' class="font-bold text-center bg-gray-700 mb-2 text-gray-100" >
            <span x-text='title'></span>
          </div>
          <div class=' bg-gray-300 m-1 pb-1 font-mono'>
            <p class='text-xs mt-1 mb-2  pl-2 ' x-text='"No meta info available"'></p>
          </div>
        </div>
      `,t}}class Rm extends ft{constructor(e,t){super({id:e??"omni/job"},t)}render(e){return`<div class='flex flex-col flex-wrap gap-1' x-data="{job: client.jobs.jobStorage['${e.value}']}"
            :class='{"text-gray-800": job.state == "running", "text-green-800": job.state === "success", "text-red-800": job.state == "error"}'
            x-effect="() => {
              if (job.state === 'success' || job.state === 'error') { $nextTick(() => onAsyncJobStatusEffectHandler($el, job)) }
            }"
      >
      <div class="flex">
      <span x-text="workbench.getNickname(job.workflowId) || job.meta?.name || job.id">:</span>
      &nbsp; (<span class="flex" x-text="job.activity"></span>)
      </div>
      <template x-for="(nodeId, idx) in job.activeNode" :key='idx'>
        <div class="text-blue-500" x-text="job.nodeDescriptionFromId(nodeId)"></div>
      </template>
      <template x-for="(error, idx) in job.errors" :key='idx'>
        <div class="text-red-500" x-text="error.nodeName +': '+ error.message"></div>
      </template>
      </div>`}}class Im extends ft{constructor(e,t){super({id:e??"omni/rest-error"},t)}render(e){const t=e.value,r=function(i){let s=i;if(typeof i=="string")try{s=JSON.parse(i)}catch{}else typeof t=="object"&&(s=i);return JSON.stringify(s,null,2)};return"<div class='w-full text-red-500 font-semibold'> Error</div><div>Component Key: <span class='font-mono text-red-500'>"+(t.component||"")+"</div><div>Error Details: <pre class='font-mono text-red-500' style='white-space: pre-wrap;'>"+r(t.message)+"</pre></div>"}}function Pm(n){if(!n||n.length===0)return console.warn("null text passed into escapeHtmlSpecialChars"),"";const e={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#039;"};return n.replace(/[<>&"']/g,t=>e[t])}class Nm extends ft{constructor(e,t){super({id:e??"text/plain"},t)}render(e){var r;const t=Array.isArray(e.value)?e.value.join(`
`):(r=e.value)==null?void 0:r.toString();return Fn.sanitize(Pm(t)).replace(/\n/g,"<br/>")}}class Lm extends ft{constructor(e){e??(e={}),super({id:"omni-pro-billing/tab"},e)}async load(){}render(e){return`<div x-data='${JSON.stringify(e.value)}'>
      <div x-show='true' class=' bg-gray-300 m-1 pb-1 font-mono'>
        <div class="font-bold text-center bg-gray-700 mb-2 text-gray-100" >
        <span> </span><span x-text='jobId' >          </span>
        </div>
        <div class="flex-row w-full flex-wrap">
        <template x-for='(record,idx) in tab' :key="idx">
            <div class=' flex-row gap-1 w-full flex text-xs  pl-1'> <span x-text="idx+1"></span>.<span x-text="record.api?.toUpperCase()"></span> (<span x-text="record.model"></span>)<span class="flex-grow"></span> <span x-text="record.resource"></span>&nbsp; <span class='text-right' x-text="record.cost?.toFixed(5)"></span>  </div>
        </template>
        <div class='text-xs  pl-1 text-right'> TOTAL: <span x-text="total.toFixed(5)"></span></div>
        </div>
      </div> `}}class Mm extends ft{constructor(e){e??(e={}),super({id:"omni/settings"},e)}async load(){}render(e){return`
    <div>

        <div class="flex-row w-full flex-wrap">
          <template x-for='(value,key) of window.client.${e.value}' :key="key">
            <div class=' flex-row gap-1 w-full flex text-xs  pl-1'> <span x-text="key"></span>: <span x-text="value"></span></div>
           </template>

    </div> `}}class $m extends ft{constructor(e){e??(e={}),super({id:"omni/extension-list"},e)}async load(){}render(e){const t=e.value;return`<div x-data='{extensionList: ${JSON.stringify(t)}}'><ul><b>Core Extensions</b>:<template x-for="(extension, idx) in extensionList['core']" :key='idx'>"<li x-text="extension.title + ' (' + extension.id + ')'"></li>"</template></ul>
    <ul><b>Premium Extensions</b>:<template x-for="(extension, idx) in extensionList['premium']" :key='idx'>"<li x-text="extension.title + ' (' + extension.id + ')'"></li>"</template></ul>
    <ul><b>Known Extensions</b>:<template x-for="(extension, idx) in extensionList['known']" :key='idx'>"<li x-text="extension.title + ' (' + extension.id + ')'"></li>"</template></ul>
    <ul><b>Available Extensions</b>:<template x-for="(extension, idx) in extensionList['available']" :key='idx'>"<li x-text="extension.title + ' (' + extension.id + ')'"></li>"</template></ul></div>`}}const Bc=document.createElement("div");Bc.innerHTML="<div class=wb-header><div class=wb-control><span class=wb-min></span><span class=wb-max></span><span class=wb-full></span><span class=wb-close></span></div><div class=wb-drag><div class=wb-icon></div><div class=wb-title></div></div></div><div class=wb-body></div><div class=wb-n></div><div class=wb-s></div><div class=wb-w></div><div class=wb-e></div><div class=wb-nw></div><div class=wb-ne></div><div class=wb-se></div><div class=wb-sw></div>";function Dm(n){return(n||Bc).cloneNode(!0)}function Be(n,e,t,r){n&&n.addEventListener(e,t,r||!1)}function Sr(n,e,t,r){n&&n.removeEventListener(e,t,r||!1)}function Hn(n,e){n.stopPropagation(),e&&n.preventDefault()}function Ve(n,e){return n.getElementsByClassName(e)[0]}function zc(n,e){n.classList.add(e)}function jm(n,e){return n.classList.contains(e)}function Fc(n,e){n.classList.remove(e)}function Oe(n,e,t){t=""+t,n["_s_"+e]!==t&&(n.style.setProperty(e,t),n["_s_"+e]=t)}function Bm(n,e){const t=n.firstChild;t?t.nodeValue=e:n.textContent=e}const hn=[],qe=[],Nn={capture:!0,passive:!0};let Qe,zm=0,ri=10,gn,lt,Uc,Ae,rt;function ne(n,e){if(!(this instanceof ne))return new ne(n);Qe||Fm();let t,r,i,s,o,a,l,h,u,p,d,c,f,g,m,y,w,_,v,b,x,E,N,$,A,k,O,T,I,U,J,X,fe,H,pe,Y,gt,re,De,je,kn,Kt,xn,Sn;if(n&&(e&&(o=n,n=e),typeof n=="string"?o=n:(t=n.id,r=n.index,i=n.root,s=n.template,o=o||n.title,a=n.icon,l=n.mount,h=n.html,u=n.url,p=n.width,d=n.height,c=n.minwidth,f=n.minheight,g=n.maxwidth,m=n.maxheight,y=n.autosize,w=n.overflow,$=n.min,A=n.max,k=n.hidden,O=n.modal,_=n.x||(O?"center":0),v=n.y||(O?"center":0),b=n.top,x=n.left,E=n.bottom,N=n.right,T=n.background,I=n.border,U=n.header,J=n.class,X=n.oncreate,fe=n.onclose,H=n.onfocus,pe=n.onblur,Y=n.onmove,gt=n.onresize,re=n.onfullscreen,De=n.onmaximize,je=n.onminimize,kn=n.onrestore,Kt=n.onhide,xn=n.onshow,Sn=n.onload)),this.dom=Dm(s),this.dom.id=this.id=t||"winbox-"+ ++zm,this.dom.className="winbox"+(J?" "+(typeof J=="string"?J:J.join(" ")):"")+(O?" modal":""),this.dom.winbox=this,this.window=this.dom,this.body=Ve(this.dom,"wb-body"),this.header=U||35,qe.push(this),T&&this.setBackground(T),I?Oe(this.body,"margin",I+(isNaN(I)?"":"px")):I=0,U){const Yt=Ve(this.dom,"wb-header");Oe(Yt,"height",U+"px"),Oe(Yt,"line-height",U+"px"),Oe(this.body,"top",U+"px")}o&&this.setTitle(o),a&&this.setIcon(a),l?this.mount(l):h?this.body.innerHTML=h:u&&this.setUrl(u,Sn),b=b?_e(b,rt):0,E=E?_e(E,rt):0,x=x?_e(x,Ae):0,N=N?_e(N,Ae):0;const Ze=Ae-x-N,Ue=rt-b-E;g=g?_e(g,Ze):Ze,m=m?_e(m,Ue):Ue,c=c?_e(c,g):150,f=f?_e(f,m):this.header,y?((i||Qe).appendChild(this.body),p=Math.max(Math.min(this.body.clientWidth+I*2+1,g),c),d=Math.max(Math.min(this.body.clientHeight+this.header+I+1,m),f),this.dom.appendChild(this.body)):(p=p?_e(p,g):Math.max(g/2,c)|0,d=d?_e(d,m):Math.max(m/2,f)|0),_=_?_e(_,Ze,p):x,v=v?_e(v,Ue,d):b,this.x=_,this.y=v,this.width=p,this.height=d,this.minwidth=c,this.minheight=f,this.maxwidth=g,this.maxheight=m,this.top=b,this.right=N,this.bottom=E,this.left=x,this.index=r,this.overflow=w,this.min=!1,this.max=!1,this.full=!1,this.hidden=!1,this.focused=!1,this.onclose=fe,this.onfocus=H,this.onblur=pe,this.onmove=Y,this.onresize=gt,this.onfullscreen=re,this.onmaximize=De,this.onminimize=je,this.onrestore=kn,this.onhide=Kt,this.onshow=xn,A?this.maximize():$?this.minimize():this.resize().move(),k?this.hide():(this.focus(),(r||r===0)&&(this.index=r,Oe(this.dom,"z-index",r),r>ri&&(ri=r))),Um(this),(i||Qe).appendChild(this.dom),X&&X.call(this,n)}ne.new=function(n){return new ne(n)};ne.stack=function(){return qe};function _e(n,e,t){if(typeof n=="string")if(n==="center")n=(e-t)/2|0;else if(n==="right"||n==="bottom")n=e-t;else{const r=parseFloat(n);(""+r!==n&&n.substring((""+r).length))==="%"?n=e/100*r|0:n=r}return n}function Fm(){Qe=document.body,Qe[lt="requestFullscreen"]||Qe[lt="msRequestFullscreen"]||Qe[lt="webkitRequestFullscreen"]||Qe[lt="mozRequestFullscreen"]||(lt=""),Uc=lt&&lt.replace("request","exit").replace("mozRequest","mozCancel").replace("Request","Exit"),Be(window,"resize",function(){tl(),bo()}),tl()}function Um(n){at(n,"drag"),at(n,"n"),at(n,"s"),at(n,"w"),at(n,"e"),at(n,"nw"),at(n,"ne"),at(n,"se"),at(n,"sw"),Be(Ve(n.dom,"wb-min"),"click",function(e){Hn(e),n.min?n.restore().focus():n.minimize()}),Be(Ve(n.dom,"wb-max"),"click",function(e){n.max?n.restore().focus():n.maximize().focus()}),lt?Be(Ve(n.dom,"wb-full"),"click",function(e){n.fullscreen()}):n.addClass("no-full"),Be(Ve(n.dom,"wb-close"),"click",function(e){Hn(e),n.close()||(n=null)}),Be(n.dom,"click",function(e){n.focus()})}function bi(n){hn.splice(hn.indexOf(n),1),bo(),n.removeClass("min"),n.min=!1,n.dom.title=""}function bo(){const n=hn.length,e={},t={};for(let r=0,i,s;r<n;r++)i=hn[r],s=(i.left||i.right)+":"+(i.top||i.bottom),t[s]?t[s]++:(e[s]=0,t[s]=1);for(let r=0,i,s,o;r<n;r++)i=hn[r],s=(i.left||i.right)+":"+(i.top||i.bottom),o=Math.min((Ae-i.left-i.right)/t[s],250),i.resize(o+1|0,i.header,!0).move(i.left+e[s]*o|0,rt-i.bottom-i.header,!0),e[s]++}function at(n,e){const t=Ve(n.dom,"wb-"+e);if(!t)return;let r,i,s,o=0;Be(t,"mousedown",a),Be(t,"touchstart",a,Nn);function a(u){if(Hn(u),n.focus(),e==="drag"){if(n.min){n.restore();return}const p=Date.now(),d=p-o;if(o=p,d<300){n.max?n.restore():n.maximize();return}}n.min||(zc(Qe,"wb-lock"),(r=u.touches)&&(r=r[0])?(u=r,Be(window,"touchmove",l,Nn),Be(window,"touchend",h,Nn)):(Be(window,"mousemove",l),Be(window,"mouseup",h)),i=u.pageX,s=u.pageY)}function l(u){Hn(u,!r),r&&(u=u.touches[0]);const p=u.pageX,d=u.pageY,c=p-i,f=d-s,g=n.width,m=n.height,y=n.x,w=n.y;let _,v,b,x;e==="drag"?(n.x+=c,n.y+=f,b=x=1):(e==="e"||e==="se"||e==="ne"?(n.width+=c,_=1):(e==="w"||e==="sw"||e==="nw")&&(n.x+=c,n.width-=c,_=1,b=1),e==="s"||e==="se"||e==="sw"?(n.height+=f,v=1):(e==="n"||e==="ne"||e==="nw")&&(n.y+=f,n.height-=f,v=1,x=1)),_&&(n.width=Math.max(Math.min(n.width,n.maxwidth,Ae-n.x-n.right),n.minwidth),_=n.width!==g),v&&(n.height=Math.max(Math.min(n.height,n.maxheight,rt-n.y-n.bottom),n.minheight),v=n.height!==m),(_||v)&&n.resize(),b&&(n.max&&(n.x=(p<Ae/3?n.left:p>Ae/3*2?Ae-n.width-n.right:Ae/2-n.width/2)+c),n.x=Math.max(Math.min(n.x,n.overflow?Ae-30:Ae-n.width-n.right),n.overflow?30-n.width:n.left),b=n.x!==y),x&&(n.max&&(n.y=n.top+f),n.y=Math.max(Math.min(n.y,n.overflow?rt-n.header:rt-n.height-n.bottom),n.top),x=n.y!==w),(b||x)&&(n.max&&n.restore(),n.move()),(_||b)&&(i=p),(v||x)&&(s=d)}function h(u){Hn(u),Fc(Qe,"wb-lock"),r?(Sr(window,"touchmove",l,Nn),Sr(window,"touchend",h,Nn)):(Sr(window,"mousemove",l),Sr(window,"mouseup",h))}}function tl(){const n=document.documentElement;Ae=n.clientWidth,rt=n.clientHeight}ne.prototype.mount=function(n){return this.unmount(),n._backstore||(n._backstore=n.parentNode),this.body.textContent="",this.body.appendChild(n),this};ne.prototype.unmount=function(n){const e=this.body.firstChild;if(e){const t=n||e._backstore;t&&t.appendChild(e),e._backstore=n}return this};ne.prototype.setTitle=function(n){const e=Ve(this.dom,"wb-title");return Bm(e,this.title=n),this};ne.prototype.setIcon=function(n){const e=Ve(this.dom,"wb-icon");return Oe(e,"background-image","url("+n+")"),Oe(e,"display","inline-block"),this};ne.prototype.setBackground=function(n){return Oe(this.dom,"background",n),this};ne.prototype.setUrl=function(n,e){const t=this.body.firstChild;return t&&t.tagName.toLowerCase()==="iframe"?t.src=n:(this.body.innerHTML='<iframe src="'+n+'"></iframe>',e&&(this.body.firstChild.onload=e)),this};ne.prototype.focus=function(n){if(n===!1)return this.blur();if(!this.focused){const e=qe.length;if(e>1)for(let t=1;t<=e;t++){const r=qe[e-t];if(r.focused){r.blur(),qe.push(qe.splice(qe.indexOf(this),1)[0]);break}}Oe(this.dom,"z-index",++ri),this.index=ri,this.addClass("focus"),this.focused=!0,this.onfocus&&this.onfocus()}return this};ne.prototype.blur=function(n){return n===!1?this.focus():(this.focused&&(this.removeClass("focus"),this.focused=!1,this.onblur&&this.onblur()),this)};ne.prototype.hide=function(n){if(n===!1)return this.show();if(!this.hidden)return this.onhide&&this.onhide(),this.hidden=!0,this.addClass("hide")};ne.prototype.show=function(n){if(n===!1)return this.hide();if(this.hidden)return this.onshow&&this.onshow(),this.hidden=!1,this.removeClass("hide")};ne.prototype.minimize=function(n){if(n===!1)return this.restore();if(gn&&vi(),this.max&&(this.removeClass("max"),this.max=!1),!this.min){hn.push(this),bo(),this.dom.title=this.title,this.addClass("min"),this.blur(),this.min=!0;const e=qe.length;if(e>1)for(let t=1;t<=e;t++){const r=qe[e-t];if(!r.min){r.focus();break}}this.onminimize&&this.onminimize()}return this};ne.prototype.restore=function(){return gn&&vi(),this.min&&(bi(this),this.resize().move(),this.onrestore&&this.onrestore()),this.max&&(this.max=!1,this.removeClass("max").resize().move(),this.onrestore&&this.onrestore()),this};ne.prototype.maximize=function(n){return n===!1?this.restore():(gn&&vi(),this.min&&bi(this),this.max||(this.addClass("max").resize(Ae-this.left-this.right,rt-this.top-this.bottom,!0).move(this.left,this.top,!0),this.max=!0,this.onmaximize&&this.onmaximize()),this)};ne.prototype.fullscreen=function(n){if(this.min&&(bi(this),this.resize().move()),!gn||!vi())this.body[lt](),gn=this,this.full=!0,this.onfullscreen&&this.onfullscreen();else if(n===!1)return this.restore();return this};function Hm(){return document.fullscreen||document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement}function vi(){if(gn.full=!1,Hm())return document[Uc](),!0}ne.prototype.close=function(n){if(this.onclose&&this.onclose(n))return!0;this.min&&bi(this),qe.splice(qe.indexOf(this),1),this.unmount(),this.dom.remove(),this.dom.textContent="",this.dom.winbox=null,this.body=null,this.dom=null};ne.prototype.move=function(n,e,t){return!n&&n!==0?(n=this.x,e=this.y):t||(this.x=n?n=_e(n,Ae-this.left-this.right,this.width):0,this.y=e?e=_e(e,rt-this.top-this.bottom,this.height):0),Oe(this.dom,"left",n+"px"),Oe(this.dom,"top",e+"px"),this.onmove&&this.onmove(n,e),this};ne.prototype.resize=function(n,e,t){return!n&&n!==0?(n=this.width,e=this.height):t||(this.width=n?n=_e(n,this.maxwidth):0,this.height=e?e=_e(e,this.maxheight):0,n=Math.max(n,this.minwidth),e=Math.max(e,this.minheight)),Oe(this.dom,"width",n+"px"),Oe(this.dom,"height",e+"px"),this.onresize&&this.onresize(n,e),this};ne.prototype.addControl=function(n){const e=n.class,t=n.image,r=n.click,i=n.index,s=document.createElement("span"),o=Ve(this.dom,"wb-control"),a=this;return e&&(s.className=e),t&&Oe(s,"background-image","url("+t+")"),r&&(s.onclick=function(l){r.call(this,l,a)}),o.insertBefore(s,o.childNodes[i||0]),this};ne.prototype.removeControl=function(n){return n=Ve(this.dom,n),n&&n.remove(),this};ne.prototype.addClass=function(n){return zc(this.dom,n),this};ne.prototype.removeClass=function(n){return Fc(this.dom,n),this};ne.prototype.hasClass=function(n){return jm(this.dom,n)};ne.prototype.toggleClass=function(n){return this.hasClass(n)?this.removeClass(n):this.addClass(n)};var Hc=(n=>(n.curve="curve",n))(Hc||{});class Wm extends li{constructor(t){super(t);W(this,"factories");W(this,"componentCache");this.factories=new Map,this.componentCache=new Map,this.registerType("OAIComponent31",wi.fromJSON)}registerType(t,r){if(!t)throw new Error("registerType(): key cannot be undefined");if(!r||typeof r!="function")throw new Error(`Factory ${t} must be a function`);if(this.factories.has(t))throw new Error(`Block type ${t} already registered`);this.factories.set(t,r)}get client(){return this.app}async _rpc(t,r){return await this.client.runScript("blockManager",{command:t,args:r},{fromChatWindow:!1})}async getInstance(t){const r=await this.getInstances([t]);return r?r[0]:void 0}async getInstances(t){if(!t)throw new Error("getInstances(): key cannot be undefined");let r=t.map(s=>this.componentCache.get(s))||[];const i=t.filter(s=>!this.componentCache.has(s));if(i.length>0){const o=await this._rpc("getInstances",[i,void 0,"missing_block"]),a=await Promise.all(o.map(async l=>{const h=this.factories.get(l.type||"OAIComponent31");if(!h)throw new Error(`Internal error, Block type ${l.type} not registered`);const u=h(l);return this.componentCache.set(u.name,u),u}));r.push(...a)}return r=r.filter(s=>s!==void 0),r}}class sb extends Xl{constructor(t,r){super(t,r);W(this,"clipboard",{});W(this,"workbench");W(this,"uiSettings",{});W(this,"reteSettings");W(this,"windows");W(this,"sdkHost");W(this,"markdownEngine");W(this,"_blocks");this.markdownEngine=new ig,this.windows=new Map,this.sdkHost=new Gf(this).init(),this.workbench=new window.Alpine.reactive(new Xd(this));const i=this;this._blocks=new Wm(this),this.reteSettings=new window.Alpine.reactive({curve:window.localStorage.getItem("settings.rete.curve")??"curveBasis",arrow:window.localStorage.getItem("settings.rete.arrow")==="true",curvature:parseFloat(window.localStorage.getItem("settings.rete.curvature")??"0.3")});for(const s in Hc){const o=window.localStorage.getItem(`settings.rete.${s}`);o&&(this.reteSettings[s]=o)}this.uiSettings=new window.Alpine.reactive({minimalChat:window.localStorage.getItem("settings.minimalChat")==="true",chatSide:window.localStorage.getItem("settings.chatSide")??"left",tabBarStyle:window.localStorage.getItem("settings.tabBarStyle")??"tabs",chatMinimized:window.localStorage.getItem("settings.chatMinimized")==="true",async toggleMinimal(){this.minimalChat=!this.minimalChat,window.localStorage.setItem("settings.minimalChat",this.minimalChat),await i.emit("request_editor_resize",{})},async toggleSide(){this.chatSide=this.chatSide==="left"?"right":"left",window.localStorage.setItem("settings.chatSide",this.chatSide),await i.emit("request_editor_resize",{})},async toggleMinimized(s){this.chatMinimized=s!==void 0?s:!this.chatMinimized,window.localStorage.setItem("settings.chatMinimized",this.chatMinimized?"true":"false"),await i.emit("request_editor_resize",{})}}),this.extensions=new window.Alpine.reactive(new Zl(this))}showToast(t,r={description:"",type:"default",position:"top-right",html:""}){const i=r.description||"",s=r.type||"default",o=r.position||"top-right",a=r.html||"";window.dispatchEvent(new CustomEvent("toast-show",{detail:{type:s,message:t,description:i,position:o,html:a}}))}showTopBanner(t,r,i){const s=i.link??"";window.dispatchEvent(new CustomEvent("top-banner-show",{detail:{bannerTitle:t,bannerDescription:r,link:s}}))}closeWindow(t){const r=this.getWindow(t);return r&&r.close(),!!r}getWindow(t){return t?this.windows.get(t):void 0}toggleWindow(t,r,i){i??(i={}),i.minwidth??(i.minwidth="600px"),i.minheight??(i.minheight="500px"),i.x??(i.x="center"),i.y??(i.y="center"),r&&(this.closeWindow(r),t+=`&omniHash=${r}`);const s=document.createElement("div");s.innerHTML=`
        <div class="wb-header">
            <div class="wb-control">
                <span class="wb-custom"></span>
                <span class="wb-close"></span>
            </div>
            <div class="wb-drag">
                <div class="wb-title">
                </div>
            </div>
        </div>
        <div class="wb-body"></div>
    `;const o=new ne(Object.assign({},{title:i.title,url:t,class:[],autosize:!0},i,{onclose:()=>{r&&(this.windows.delete(r),this.sdkHost.deregister(r)),this.workbench.refreshUI()}}));return r&&this.windows.set(r,o),this.workbench.refreshUI(),o}get blocks(){return this._blocks}async onConfigure(){return this.success("onConfigure"),!0}async onLoad(){return this.success("onLoad"),!0}async onStart(){const t=[];return t.push(this.chat.registerRenderer(new Nm)),t.push(this.chat.registerRenderer(new Sc)),t.push(this.chat.registerRenderer(new Rm)),t.push(this.chat.registerRenderer(new Cm)),t.push(this.chat.registerRenderer(new Tm)),t.push(this.chat.registerRenderer(new Im)),t.push(this.chat.registerRenderer(new Lm)),t.push(this.chat.registerRenderer(new Mm)),t.push(this.chat.registerRenderer(new $m)),t.push(this.chat.registerRenderer(new Ng)),await Promise.all(t),this.io.registerMessageHandler({type:"chat",handler:this.chat.onChatMessage.bind(this.chat)}),this.io.registerMessageHandler({type:Nr.CLIENT_TOAST,handler:r=>{this.showToast(r.body.message,r.body.options)}}),this.io.registerMessageHandler({type:"chat:system",handler:this.chat.onChatMessage.bind(this.chat)}),this.io.registerMessageHandler({type:Nr.SHOW_EXTENSION,handler:r=>{this.workbench.showExtension(r.body.extensionId,r.body.args,r.body.page,r.body.opts)}}),this.io.registerMessageHandler({type:Nr.CUSTOM_EXTENSION_EVENT,handler:r=>{const{extensionId:i,eventId:s,eventArgs:o}=r.body;this.sdkHost.signalCustomEvent(i,s,o)}}),this.io.registerMessageHandler({type:"job:status",handler:this.jobs.handleMessages.bind(this.jobs)}),this.io.registerMessageHandler({type:"job:error",handler:this.jobs.handleMessages.bind(this.jobs)}),this.io.registerMessageHandler({type:"job:update",handler:this.jobs.handleMessages.bind(this.jobs)}),this.events.on("chat_message_added",async r=>{const[i]=r;console.log(i),this.sdkHost.signalChatMessageReceived(i)}),await this.io.startSSE(""),await this.workbench.load(),!0}get io(){return this.services.get("messaging")}get jobs(){return this.services.get("jobs")}get chat(){return this.services.get("chat")}addImageToClipboard(t){var r;t&&(Array.isArray(t)||(t=[t]),this.clipboard??(this.clipboard={}),(r=this.clipboard).images??(r.images=[]),this.clipboard.images=this.clipboard.images.concat(t))}}var Os=!1,Cs=!1,Bt=[],Ts=-1;function qm(n){Vm(n)}function Vm(n){Bt.includes(n)||Bt.push(n),Jm()}function Wc(n){let e=Bt.indexOf(n);e!==-1&&e>Ts&&Bt.splice(e,1)}function Jm(){!Cs&&!Os&&(Os=!0,queueMicrotask(Gm))}function Gm(){Os=!1,Cs=!0;for(let n=0;n<Bt.length;n++)Bt[n](),Ts=n;Bt.length=0,Ts=-1,Cs=!1}var bn,vn,rr,qc,Rs=!0;function Km(n){Rs=!1,n(),Rs=!0}function Ym(n){bn=n.reactive,rr=n.release,vn=e=>n.effect(e,{scheduler:t=>{Rs?qm(t):t()}}),qc=n.raw}function nl(n){vn=n}function Zm(n){let e=()=>{};return[r=>{let i=vn(r);return n._x_effects||(n._x_effects=new Set,n._x_runEffects=()=>{n._x_effects.forEach(s=>s())}),n._x_effects.add(i),e=()=>{i!==void 0&&(n._x_effects.delete(i),rr(i))},i},()=>{e()}]}function Wn(n,e,t={}){n.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0,composed:!0,cancelable:!0}))}function xt(n,e){if(typeof ShadowRoot=="function"&&n instanceof ShadowRoot){Array.from(n.children).forEach(i=>xt(i,e));return}let t=!1;if(e(n,()=>t=!0),t)return;let r=n.firstElementChild;for(;r;)xt(r,e),r=r.nextElementSibling}function pt(n,...e){console.warn(`Alpine Warning: ${n}`,...e)}var rl=!1;function Xm(){rl&&pt("Alpine has already been initialized on this page. Calling Alpine.start() more than once can cause problems."),rl=!0,document.body||pt("Unable to initialize. Trying to load Alpine before `<body>` is available. Did you forget to add `defer` in Alpine's `<script>` tag?"),Wn(document,"alpine:init"),Wn(document,"alpine:initializing"),Eo(),ty(e=>dt(e,xt)),ko(e=>_o(e)),tu((e,t)=>{To(e,t).forEach(r=>r())});let n=e=>!_i(e.parentElement,!0);Array.from(document.querySelectorAll(Gc())).filter(n).forEach(e=>{dt(e)}),Wn(document,"alpine:initialized")}var vo=[],Vc=[];function Jc(){return vo.map(n=>n())}function Gc(){return vo.concat(Vc).map(n=>n())}function Kc(n){vo.push(n)}function Yc(n){Vc.push(n)}function _i(n,e=!1){return ki(n,t=>{if((e?Gc():Jc()).some(i=>t.matches(i)))return!0})}function ki(n,e){if(n){if(e(n))return n;if(n._x_teleportBack&&(n=n._x_teleportBack),!!n.parentElement)return ki(n.parentElement,e)}}function Qm(n){return Jc().some(e=>n.matches(e))}var Zc=[];function ey(n){Zc.push(n)}function dt(n,e=xt,t=()=>{}){my(()=>{e(n,(r,i)=>{t(r,i),Zc.forEach(s=>s(r,i)),To(r,r.attributes).forEach(s=>s()),r._x_ignore&&i()})})}function _o(n){xt(n,e=>{ru(e),ny(e)})}var Xc=[],Qc=[],eu=[];function ty(n){eu.push(n)}function ko(n,e){typeof e=="function"?(n._x_cleanups||(n._x_cleanups=[]),n._x_cleanups.push(e)):(e=n,Qc.push(e))}function tu(n){Xc.push(n)}function nu(n,e,t){n._x_attributeCleanups||(n._x_attributeCleanups={}),n._x_attributeCleanups[e]||(n._x_attributeCleanups[e]=[]),n._x_attributeCleanups[e].push(t)}function ru(n,e){n._x_attributeCleanups&&Object.entries(n._x_attributeCleanups).forEach(([t,r])=>{(e===void 0||e.includes(t))&&(r.forEach(i=>i()),delete n._x_attributeCleanups[t])})}function ny(n){if(n._x_cleanups)for(;n._x_cleanups.length;)n._x_cleanups.pop()()}var xo=new MutationObserver(Oo),So=!1;function Eo(){xo.observe(document,{subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0}),So=!0}function iu(){ry(),xo.disconnect(),So=!1}var qn=[],es=!1;function ry(){qn=qn.concat(xo.takeRecords()),qn.length&&!es&&(es=!0,queueMicrotask(()=>{iy(),es=!1}))}function iy(){Oo(qn),qn.length=0}function de(n){if(!So)return n();iu();let e=n();return Eo(),e}var Ao=!1,ii=[];function sy(){Ao=!0}function oy(){Ao=!1,Oo(ii),ii=[]}function Oo(n){if(Ao){ii=ii.concat(n);return}let e=[],t=[],r=new Map,i=new Map;for(let s=0;s<n.length;s++)if(!n[s].target._x_ignoreMutationObserver&&(n[s].type==="childList"&&(n[s].addedNodes.forEach(o=>o.nodeType===1&&e.push(o)),n[s].removedNodes.forEach(o=>o.nodeType===1&&t.push(o))),n[s].type==="attributes")){let o=n[s].target,a=n[s].attributeName,l=n[s].oldValue,h=()=>{r.has(o)||r.set(o,[]),r.get(o).push({name:a,value:o.getAttribute(a)})},u=()=>{i.has(o)||i.set(o,[]),i.get(o).push(a)};o.hasAttribute(a)&&l===null?h():o.hasAttribute(a)?(u(),h()):u()}i.forEach((s,o)=>{ru(o,s)}),r.forEach((s,o)=>{Xc.forEach(a=>a(o,s))});for(let s of t)e.includes(s)||(Qc.forEach(o=>o(s)),_o(s));e.forEach(s=>{s._x_ignoreSelf=!0,s._x_ignore=!0});for(let s of e)t.includes(s)||s.isConnected&&(delete s._x_ignoreSelf,delete s._x_ignore,eu.forEach(o=>o(s)),s._x_ignore=!0,s._x_ignoreSelf=!0);e.forEach(s=>{delete s._x_ignoreSelf,delete s._x_ignore}),e=null,t=null,r=null,i=null}function su(n){return sr(mn(n))}function ir(n,e,t){return n._x_dataStack=[e,...mn(t||n)],()=>{n._x_dataStack=n._x_dataStack.filter(r=>r!==e)}}function mn(n){return n._x_dataStack?n._x_dataStack:typeof ShadowRoot=="function"&&n instanceof ShadowRoot?mn(n.host):n.parentNode?mn(n.parentNode):[]}function sr(n){return new Proxy({objects:n},ay)}var ay={ownKeys({objects:n}){return Array.from(new Set(n.flatMap(e=>Object.keys(e))))},has({objects:n},e){return e==Symbol.unscopables?!1:n.some(t=>Object.prototype.hasOwnProperty.call(t,e))},get({objects:n},e,t){return e=="toJSON"?ly:Reflect.get(n.find(r=>Object.prototype.hasOwnProperty.call(r,e))||{},e,t)},set({objects:n},e,t,r){const i=n.find(o=>Object.prototype.hasOwnProperty.call(o,e))||n[n.length-1],s=Object.getOwnPropertyDescriptor(i,e);return s!=null&&s.set&&(s!=null&&s.get)?Reflect.set(i,e,t,r):Reflect.set(i,e,t)}};function ly(){return Reflect.ownKeys(this).reduce((e,t)=>(e[t]=Reflect.get(this,t),e),{})}function ou(n){let e=r=>typeof r=="object"&&!Array.isArray(r)&&r!==null,t=(r,i="")=>{Object.entries(Object.getOwnPropertyDescriptors(r)).forEach(([s,{value:o,enumerable:a}])=>{if(a===!1||o===void 0)return;let l=i===""?s:`${i}.${s}`;typeof o=="object"&&o!==null&&o._x_interceptor?r[s]=o.initialize(n,l,s):e(o)&&o!==r&&!(o instanceof Element)&&t(o,l)})};return t(n)}function au(n,e=()=>{}){let t={initialValue:void 0,_x_interceptor:!0,initialize(r,i,s){return n(this.initialValue,()=>cy(r,i),o=>Is(r,i,o),i,s)}};return e(t),r=>{if(typeof r=="object"&&r!==null&&r._x_interceptor){let i=t.initialize.bind(t);t.initialize=(s,o,a)=>{let l=r.initialize(s,o,a);return t.initialValue=l,i(s,o,a)}}else t.initialValue=r;return t}}function cy(n,e){return e.split(".").reduce((t,r)=>t[r],n)}function Is(n,e,t){if(typeof e=="string"&&(e=e.split(".")),e.length===1)n[e[0]]=t;else{if(e.length===0)throw error;return n[e[0]]||(n[e[0]]={}),Is(n[e[0]],e.slice(1),t)}}var lu={};function Ye(n,e){lu[n]=e}function Ps(n,e){return Object.entries(lu).forEach(([t,r])=>{let i=null;function s(){if(i)return i;{let[o,a]=fu(e);return i={interceptor:au,...o},ko(e,a),i}}Object.defineProperty(n,`$${t}`,{get(){return r(e,s())},enumerable:!1})}),n}function uy(n,e,t,...r){try{return t(...r)}catch(i){Zn(i,n,e)}}function Zn(n,e,t=void 0){Object.assign(n,{el:e,expression:t}),console.warn(`Alpine Expression Error: ${n.message}

${t?'Expression: "'+t+`"

`:""}`,e),setTimeout(()=>{throw n},0)}var jr=!0;function cu(n){let e=jr;jr=!1;let t=n();return jr=e,t}function zt(n,e,t={}){let r;return ke(n,e)(i=>r=i,t),r}function ke(...n){return uu(...n)}var uu=hu;function hy(n){uu=n}function hu(n,e){let t={};Ps(t,n);let r=[t,...mn(n)],i=typeof e=="function"?py(r,e):fy(r,e,n);return uy.bind(null,n,e,i)}function py(n,e){return(t=()=>{},{scope:r={},params:i=[]}={})=>{let s=e.apply(sr([r,...n]),i);si(t,s)}}var ts={};function dy(n,e){if(ts[n])return ts[n];let t=Object.getPrototypeOf(async function(){}).constructor,r=/^[\n\s]*if.*\(.*\)/.test(n.trim())||/^(let|const)\s/.test(n.trim())?`(async()=>{ ${n} })()`:n,s=(()=>{try{let o=new t(["__self","scope"],`with (scope) { __self.result = ${r} }; __self.finished = true; return __self.result;`);return Object.defineProperty(o,"name",{value:`[Alpine] ${n}`}),o}catch(o){return Zn(o,e,n),Promise.resolve()}})();return ts[n]=s,s}function fy(n,e,t){let r=dy(e,t);return(i=()=>{},{scope:s={},params:o=[]}={})=>{r.result=void 0,r.finished=!1;let a=sr([s,...n]);if(typeof r=="function"){let l=r(r,a).catch(h=>Zn(h,t,e));r.finished?(si(i,r.result,a,o,t),r.result=void 0):l.then(h=>{si(i,h,a,o,t)}).catch(h=>Zn(h,t,e)).finally(()=>r.result=void 0)}}}function si(n,e,t,r,i){if(jr&&typeof e=="function"){let s=e.apply(t,r);s instanceof Promise?s.then(o=>si(n,o,t,r)).catch(o=>Zn(o,i,e)):n(s)}else typeof e=="object"&&e instanceof Promise?e.then(s=>n(s)):n(e)}var Co="x-";function _n(n=""){return Co+n}function gy(n){Co=n}var Ns={};function he(n,e){return Ns[n]=e,{before(t){if(!Ns[t]){console.warn("Cannot find directive `${directive}`. `${name}` will use the default order of execution");return}const r=Dt.indexOf(t);Dt.splice(r>=0?r:Dt.indexOf("DEFAULT"),0,n)}}}function To(n,e,t){if(e=Array.from(e),n._x_virtualDirectives){let s=Object.entries(n._x_virtualDirectives).map(([a,l])=>({name:a,value:l})),o=pu(s);s=s.map(a=>o.find(l=>l.name===a.name)?{name:`x-bind:${a.name}`,value:`"${a.value}"`}:a),e=e.concat(s)}let r={};return e.map(yu((s,o)=>r[s]=o)).filter(bu).map(wy(r,t)).sort(by).map(s=>yy(n,s))}function pu(n){return Array.from(n).map(yu()).filter(e=>!bu(e))}var Ls=!1,$n=new Map,du=Symbol();function my(n){Ls=!0;let e=Symbol();du=e,$n.set(e,[]);let t=()=>{for(;$n.get(e).length;)$n.get(e).shift()();$n.delete(e)},r=()=>{Ls=!1,t()};n(t),r()}function fu(n){let e=[],t=a=>e.push(a),[r,i]=Zm(n);return e.push(i),[{Alpine:or,effect:r,cleanup:t,evaluateLater:ke.bind(ke,n),evaluate:zt.bind(zt,n)},()=>e.forEach(a=>a())]}function yy(n,e){let t=()=>{},r=Ns[e.type]||t,[i,s]=fu(n);nu(n,e.original,s);let o=()=>{n._x_ignore||n._x_ignoreSelf||(r.inline&&r.inline(n,e,i),r=r.bind(r,n,e,i),Ls?$n.get(du).push(r):r())};return o.runCleanups=s,o}var gu=(n,e)=>({name:t,value:r})=>(t.startsWith(n)&&(t=t.replace(n,e)),{name:t,value:r}),mu=n=>n;function yu(n=()=>{}){return({name:e,value:t})=>{let{name:r,value:i}=wu.reduce((s,o)=>o(s),{name:e,value:t});return r!==e&&n(r,e),{name:r,value:i}}}var wu=[];function Ro(n){wu.push(n)}function bu({name:n}){return vu().test(n)}var vu=()=>new RegExp(`^${Co}([^:^.]+)\\b`);function wy(n,e){return({name:t,value:r})=>{let i=t.match(vu()),s=t.match(/:([a-zA-Z0-9\-_:]+)/),o=t.match(/\.[^.\]]+(?=[^\]]*$)/g)||[],a=e||n[t]||t;return{type:i?i[1]:null,value:s?s[1]:null,modifiers:o.map(l=>l.replace(".","")),expression:r,original:a}}}var Ms="DEFAULT",Dt=["ignore","ref","data","id","bind","init","for","model","modelable","transition","show","if",Ms,"teleport"];function by(n,e){let t=Dt.indexOf(n.type)===-1?Ms:n.type,r=Dt.indexOf(e.type)===-1?Ms:e.type;return Dt.indexOf(t)-Dt.indexOf(r)}var $s=[],Io=!1;function Po(n=()=>{}){return queueMicrotask(()=>{Io||setTimeout(()=>{Ds()})}),new Promise(e=>{$s.push(()=>{n(),e()})})}function Ds(){for(Io=!1;$s.length;)$s.shift()()}function vy(){Io=!0}function No(n,e){return Array.isArray(e)?il(n,e.join(" ")):typeof e=="object"&&e!==null?_y(n,e):typeof e=="function"?No(n,e()):il(n,e)}function il(n,e){let t=i=>i.split(" ").filter(s=>!n.classList.contains(s)).filter(Boolean),r=i=>(n.classList.add(...i),()=>{n.classList.remove(...i)});return e=e===!0?e="":e||"",r(t(e))}function _y(n,e){let t=a=>a.split(" ").filter(Boolean),r=Object.entries(e).flatMap(([a,l])=>l?t(a):!1).filter(Boolean),i=Object.entries(e).flatMap(([a,l])=>l?!1:t(a)).filter(Boolean),s=[],o=[];return i.forEach(a=>{n.classList.contains(a)&&(n.classList.remove(a),o.push(a))}),r.forEach(a=>{n.classList.contains(a)||(n.classList.add(a),s.push(a))}),()=>{o.forEach(a=>n.classList.add(a)),s.forEach(a=>n.classList.remove(a))}}function xi(n,e){return typeof e=="object"&&e!==null?ky(n,e):xy(n,e)}function ky(n,e){let t={};return Object.entries(e).forEach(([r,i])=>{t[r]=n.style[r],r.startsWith("--")||(r=Sy(r)),n.style.setProperty(r,i)}),setTimeout(()=>{n.style.length===0&&n.removeAttribute("style")}),()=>{xi(n,t)}}function xy(n,e){let t=n.getAttribute("style",e);return n.setAttribute("style",e),()=>{n.setAttribute("style",t||"")}}function Sy(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function js(n,e=()=>{}){let t=!1;return function(){t?e.apply(this,arguments):(t=!0,n.apply(this,arguments))}}he("transition",(n,{value:e,modifiers:t,expression:r},{evaluate:i})=>{typeof r=="function"&&(r=i(r)),r!==!1&&(!r||typeof r=="boolean"?Ay(n,t,e):Ey(n,r,e))});function Ey(n,e,t){_u(n,No,""),{enter:i=>{n._x_transition.enter.during=i},"enter-start":i=>{n._x_transition.enter.start=i},"enter-end":i=>{n._x_transition.enter.end=i},leave:i=>{n._x_transition.leave.during=i},"leave-start":i=>{n._x_transition.leave.start=i},"leave-end":i=>{n._x_transition.leave.end=i}}[t](e)}function Ay(n,e,t){_u(n,xi);let r=!e.includes("in")&&!e.includes("out")&&!t,i=r||e.includes("in")||["enter"].includes(t),s=r||e.includes("out")||["leave"].includes(t);e.includes("in")&&!r&&(e=e.filter((y,w)=>w<e.indexOf("out"))),e.includes("out")&&!r&&(e=e.filter((y,w)=>w>e.indexOf("out")));let o=!e.includes("opacity")&&!e.includes("scale"),a=o||e.includes("opacity"),l=o||e.includes("scale"),h=a?0:1,u=l?Ln(e,"scale",95)/100:1,p=Ln(e,"delay",0)/1e3,d=Ln(e,"origin","center"),c="opacity, transform",f=Ln(e,"duration",150)/1e3,g=Ln(e,"duration",75)/1e3,m="cubic-bezier(0.4, 0.0, 0.2, 1)";i&&(n._x_transition.enter.during={transformOrigin:d,transitionDelay:`${p}s`,transitionProperty:c,transitionDuration:`${f}s`,transitionTimingFunction:m},n._x_transition.enter.start={opacity:h,transform:`scale(${u})`},n._x_transition.enter.end={opacity:1,transform:"scale(1)"}),s&&(n._x_transition.leave.during={transformOrigin:d,transitionDelay:`${p}s`,transitionProperty:c,transitionDuration:`${g}s`,transitionTimingFunction:m},n._x_transition.leave.start={opacity:1,transform:"scale(1)"},n._x_transition.leave.end={opacity:h,transform:`scale(${u})`})}function _u(n,e,t={}){n._x_transition||(n._x_transition={enter:{during:t,start:t,end:t},leave:{during:t,start:t,end:t},in(r=()=>{},i=()=>{}){Bs(n,e,{during:this.enter.during,start:this.enter.start,end:this.enter.end},r,i)},out(r=()=>{},i=()=>{}){Bs(n,e,{during:this.leave.during,start:this.leave.start,end:this.leave.end},r,i)}})}window.Element.prototype._x_toggleAndCascadeWithTransitions=function(n,e,t,r){const i=document.visibilityState==="visible"?requestAnimationFrame:setTimeout;let s=()=>i(t);if(e){n._x_transition&&(n._x_transition.enter||n._x_transition.leave)?n._x_transition.enter&&(Object.entries(n._x_transition.enter.during).length||Object.entries(n._x_transition.enter.start).length||Object.entries(n._x_transition.enter.end).length)?n._x_transition.in(t):s():n._x_transition?n._x_transition.in(t):s();return}n._x_hidePromise=n._x_transition?new Promise((o,a)=>{n._x_transition.out(()=>{},()=>o(r)),n._x_transitioning.beforeCancel(()=>a({isFromCancelledTransition:!0}))}):Promise.resolve(r),queueMicrotask(()=>{let o=ku(n);o?(o._x_hideChildren||(o._x_hideChildren=[]),o._x_hideChildren.push(n)):i(()=>{let a=l=>{let h=Promise.all([l._x_hidePromise,...(l._x_hideChildren||[]).map(a)]).then(([u])=>u());return delete l._x_hidePromise,delete l._x_hideChildren,h};a(n).catch(l=>{if(!l.isFromCancelledTransition)throw l})})})};function ku(n){let e=n.parentNode;if(e)return e._x_hidePromise?e:ku(e)}function Bs(n,e,{during:t,start:r,end:i}={},s=()=>{},o=()=>{}){if(n._x_transitioning&&n._x_transitioning.cancel(),Object.keys(t).length===0&&Object.keys(r).length===0&&Object.keys(i).length===0){s(),o();return}let a,l,h;Oy(n,{start(){a=e(n,r)},during(){l=e(n,t)},before:s,end(){a(),h=e(n,i)},after:o,cleanup(){l(),h()}})}function Oy(n,e){let t,r,i,s=js(()=>{de(()=>{t=!0,r||e.before(),i||(e.end(),Ds()),e.after(),n.isConnected&&e.cleanup(),delete n._x_transitioning})});n._x_transitioning={beforeCancels:[],beforeCancel(o){this.beforeCancels.push(o)},cancel:js(function(){for(;this.beforeCancels.length;)this.beforeCancels.shift()();s()}),finish:s},de(()=>{e.start(),e.during()}),vy(),requestAnimationFrame(()=>{if(t)return;let o=Number(getComputedStyle(n).transitionDuration.replace(/,.*/,"").replace("s",""))*1e3,a=Number(getComputedStyle(n).transitionDelay.replace(/,.*/,"").replace("s",""))*1e3;o===0&&(o=Number(getComputedStyle(n).animationDuration.replace("s",""))*1e3),de(()=>{e.before()}),r=!0,requestAnimationFrame(()=>{t||(de(()=>{e.end()}),Ds(),setTimeout(n._x_transitioning.finish,o+a),i=!0)})})}function Ln(n,e,t){if(n.indexOf(e)===-1)return t;const r=n[n.indexOf(e)+1];if(!r||e==="scale"&&isNaN(r))return t;if(e==="duration"||e==="delay"){let i=r.match(/([0-9]+)ms/);if(i)return i[1]}return e==="origin"&&["top","right","left","center","bottom"].includes(n[n.indexOf(e)+2])?[r,n[n.indexOf(e)+2]].join(" "):r}var St=!1;function Si(n,e=()=>{}){return(...t)=>St?e(...t):n(...t)}function Cy(n){return(...e)=>St&&n(...e)}function Ty(n,e){n._x_dataStack&&(e._x_dataStack=n._x_dataStack,e.setAttribute("data-has-alpine-state",!0)),St=!0,xu(()=>{dt(e,(t,r)=>{r(t,()=>{})})}),St=!1}var zs=!1;function Ry(n,e){e._x_dataStack||(e._x_dataStack=n._x_dataStack),St=!0,zs=!0,xu(()=>{Iy(e)}),St=!1,zs=!1}function Iy(n){let e=!1;dt(n,(r,i)=>{xt(r,(s,o)=>{if(e&&Qm(s))return o();e=!0,i(s,o)})})}function xu(n){let e=vn;nl((t,r)=>{let i=e(t);return rr(i),()=>{}}),n(),nl(e)}function Py(n){return St?zs?!0:n.hasAttribute("data-has-alpine-state"):!1}function Su(n,e,t,r=[]){switch(n._x_bindings||(n._x_bindings=bn({})),n._x_bindings[e]=t,e=r.includes("camel")?zy(e):e,e){case"value":Ny(n,t);break;case"style":My(n,t);break;case"class":Ly(n,t);break;case"selected":case"checked":$y(n,e,t);break;default:Eu(n,e,t);break}}function Ny(n,e){if(n.type==="radio")n.attributes.value===void 0&&(n.value=e),window.fromModel&&(n.checked=sl(n.value,e));else if(n.type==="checkbox")Number.isInteger(e)?n.value=e:!Array.isArray(e)&&typeof e!="boolean"&&![null,void 0].includes(e)?n.value=String(e):Array.isArray(e)?n.checked=e.some(t=>sl(t,n.value)):n.checked=!!e;else if(n.tagName==="SELECT")By(n,e);else{if(n.value===e)return;n.value=e===void 0?"":e}}function Ly(n,e){n._x_undoAddedClasses&&n._x_undoAddedClasses(),n._x_undoAddedClasses=No(n,e)}function My(n,e){n._x_undoAddedStyles&&n._x_undoAddedStyles(),n._x_undoAddedStyles=xi(n,e)}function $y(n,e,t){Eu(n,e,t),jy(n,e,t)}function Eu(n,e,t){[null,void 0,!1].includes(t)&&Fy(e)?n.removeAttribute(e):(Au(e)&&(t=e),Dy(n,e,t))}function Dy(n,e,t){n.getAttribute(e)!=t&&n.setAttribute(e,t)}function jy(n,e,t){n[e]!==t&&(n[e]=t)}function By(n,e){const t=[].concat(e).map(r=>r+"");Array.from(n.options).forEach(r=>{r.selected=t.includes(r.value)})}function zy(n){return n.toLowerCase().replace(/-(\w)/g,(e,t)=>t.toUpperCase())}function sl(n,e){return n==e}function Au(n){return["disabled","checked","required","readonly","hidden","open","selected","autofocus","itemscope","multiple","novalidate","allowfullscreen","allowpaymentrequest","formnovalidate","autoplay","controls","loop","muted","playsinline","default","ismap","reversed","async","defer","nomodule"].includes(n)}function Fy(n){return!["aria-pressed","aria-checked","aria-expanded","aria-selected"].includes(n)}function Uy(n,e,t){return n._x_bindings&&n._x_bindings[e]!==void 0?n._x_bindings[e]:Ou(n,e,t)}function Hy(n,e,t,r=!0){if(n._x_bindings&&n._x_bindings[e]!==void 0)return n._x_bindings[e];if(n._x_inlineBindings&&n._x_inlineBindings[e]!==void 0){let i=n._x_inlineBindings[e];return i.extract=r,cu(()=>zt(n,i.expression))}return Ou(n,e,t)}function Ou(n,e,t){let r=n.getAttribute(e);return r===null?typeof t=="function"?t():t:r===""?!0:Au(e)?!![e,"true"].includes(r):r}function Cu(n,e){var t;return function(){var r=this,i=arguments,s=function(){t=null,n.apply(r,i)};clearTimeout(t),t=setTimeout(s,e)}}function Tu(n,e){let t;return function(){let r=this,i=arguments;t||(n.apply(r,i),t=!0,setTimeout(()=>t=!1,e))}}function Ru({get:n,set:e},{get:t,set:r}){let i=!0,s,o=vn(()=>{const a=n(),l=t();if(i)r(ns(a)),i=!1,s=JSON.stringify(a);else{const h=JSON.stringify(a);h!==s?(r(ns(a)),s=h):(e(ns(l)),s=JSON.stringify(l))}JSON.stringify(t()),JSON.stringify(n())});return()=>{rr(o)}}function ns(n){return typeof n=="object"?JSON.parse(JSON.stringify(n)):n}function Wy(n){(Array.isArray(n)?n:[n]).forEach(t=>t(or))}var Pt={},ol=!1;function qy(n,e){if(ol||(Pt=bn(Pt),ol=!0),e===void 0)return Pt[n];Pt[n]=e,typeof e=="object"&&e!==null&&e.hasOwnProperty("init")&&typeof e.init=="function"&&Pt[n].init(),ou(Pt[n])}function Vy(){return Pt}var Iu={};function Jy(n,e){let t=typeof e!="function"?()=>e:e;return n instanceof Element?Pu(n,t()):(Iu[n]=t,()=>{})}function Gy(n){return Object.entries(Iu).forEach(([e,t])=>{Object.defineProperty(n,e,{get(){return(...r)=>t(...r)}})}),n}function Pu(n,e,t){let r=[];for(;r.length;)r.pop()();let i=Object.entries(e).map(([o,a])=>({name:o,value:a})),s=pu(i);return i=i.map(o=>s.find(a=>a.name===o.name)?{name:`x-bind:${o.name}`,value:`"${o.value}"`}:o),To(n,i,t).map(o=>{r.push(o.runCleanups),o()}),()=>{for(;r.length;)r.pop()()}}var Nu={};function Ky(n,e){Nu[n]=e}function Yy(n,e){return Object.entries(Nu).forEach(([t,r])=>{Object.defineProperty(n,t,{get(){return(...i)=>r.bind(e)(...i)},enumerable:!1})}),n}var Zy={get reactive(){return bn},get release(){return rr},get effect(){return vn},get raw(){return qc},version:"3.13.2",flushAndStopDeferringMutations:oy,dontAutoEvaluateFunctions:cu,disableEffectScheduling:Km,startObservingMutations:Eo,stopObservingMutations:iu,setReactivityEngine:Ym,onAttributeRemoved:nu,onAttributesAdded:tu,closestDataStack:mn,skipDuringClone:Si,onlyDuringClone:Cy,addRootSelector:Kc,addInitSelector:Yc,addScopeToNode:ir,deferMutations:sy,mapAttributes:Ro,evaluateLater:ke,interceptInit:ey,setEvaluator:hy,mergeProxies:sr,extractProp:Hy,findClosest:ki,onElRemoved:ko,closestRoot:_i,destroyTree:_o,interceptor:au,transition:Bs,setStyles:xi,mutateDom:de,directive:he,entangle:Ru,throttle:Tu,debounce:Cu,evaluate:zt,initTree:dt,nextTick:Po,prefixed:_n,prefix:gy,plugin:Wy,magic:Ye,store:qy,start:Xm,clone:Ry,cloneNode:Ty,bound:Uy,$data:su,walk:xt,data:Ky,bind:Jy},or=Zy;function Xy(n,e){const t=Object.create(null),r=n.split(",");for(let i=0;i<r.length;i++)t[r[i]]=!0;return e?i=>!!t[i.toLowerCase()]:i=>!!t[i]}var Qy=Object.freeze({}),ew=Object.prototype.hasOwnProperty,Ei=(n,e)=>ew.call(n,e),Ft=Array.isArray,Vn=n=>Lu(n)==="[object Map]",tw=n=>typeof n=="string",Lo=n=>typeof n=="symbol",Ai=n=>n!==null&&typeof n=="object",nw=Object.prototype.toString,Lu=n=>nw.call(n),Mu=n=>Lu(n).slice(8,-1),Mo=n=>tw(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,rw=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},iw=rw(n=>n.charAt(0).toUpperCase()+n.slice(1)),$u=(n,e)=>n!==e&&(n===n||e===e),Fs=new WeakMap,Mn=[],Xe,Ut=Symbol("iterate"),Us=Symbol("Map key iterate");function sw(n){return n&&n._isEffect===!0}function ow(n,e=Qy){sw(n)&&(n=n.raw);const t=cw(n,e);return e.lazy||t(),t}function aw(n){n.active&&(Du(n),n.options.onStop&&n.options.onStop(),n.active=!1)}var lw=0;function cw(n,e){const t=function(){if(!t.active)return n();if(!Mn.includes(t)){Du(t);try{return hw(),Mn.push(t),Xe=t,n()}finally{Mn.pop(),ju(),Xe=Mn[Mn.length-1]}}};return t.id=lw++,t.allowRecurse=!!e.allowRecurse,t._isEffect=!0,t.active=!0,t.raw=n,t.deps=[],t.options=e,t}function Du(n){const{deps:e}=n;if(e.length){for(let t=0;t<e.length;t++)e[t].delete(n);e.length=0}}var yn=!0,$o=[];function uw(){$o.push(yn),yn=!1}function hw(){$o.push(yn),yn=!0}function ju(){const n=$o.pop();yn=n===void 0?!0:n}function Ge(n,e,t){if(!yn||Xe===void 0)return;let r=Fs.get(n);r||Fs.set(n,r=new Map);let i=r.get(t);i||r.set(t,i=new Set),i.has(Xe)||(i.add(Xe),Xe.deps.push(i),Xe.options.onTrack&&Xe.options.onTrack({effect:Xe,target:n,type:e,key:t}))}function Et(n,e,t,r,i,s){const o=Fs.get(n);if(!o)return;const a=new Set,l=u=>{u&&u.forEach(p=>{(p!==Xe||p.allowRecurse)&&a.add(p)})};if(e==="clear")o.forEach(l);else if(t==="length"&&Ft(n))o.forEach((u,p)=>{(p==="length"||p>=r)&&l(u)});else switch(t!==void 0&&l(o.get(t)),e){case"add":Ft(n)?Mo(t)&&l(o.get("length")):(l(o.get(Ut)),Vn(n)&&l(o.get(Us)));break;case"delete":Ft(n)||(l(o.get(Ut)),Vn(n)&&l(o.get(Us)));break;case"set":Vn(n)&&l(o.get(Ut));break}const h=u=>{u.options.onTrigger&&u.options.onTrigger({effect:u,target:n,key:t,type:e,newValue:r,oldValue:i,oldTarget:s}),u.options.scheduler?u.options.scheduler(u):u()};a.forEach(h)}var pw=Xy("__proto__,__v_isRef,__isVue"),Bu=new Set(Object.getOwnPropertyNames(Symbol).map(n=>Symbol[n]).filter(Lo)),dw=zu(),fw=zu(!0),al=gw();function gw(){const n={};return["includes","indexOf","lastIndexOf"].forEach(e=>{n[e]=function(...t){const r=le(this);for(let s=0,o=this.length;s<o;s++)Ge(r,"get",s+"");const i=r[e](...t);return i===-1||i===!1?r[e](...t.map(le)):i}}),["push","pop","shift","unshift","splice"].forEach(e=>{n[e]=function(...t){uw();const r=le(this)[e].apply(this,t);return ju(),r}}),n}function zu(n=!1,e=!1){return function(r,i,s){if(i==="__v_isReactive")return!n;if(i==="__v_isReadonly")return n;if(i==="__v_raw"&&s===(n?e?Iw:Wu:e?Rw:Hu).get(r))return r;const o=Ft(r);if(!n&&o&&Ei(al,i))return Reflect.get(al,i,s);const a=Reflect.get(r,i,s);return(Lo(i)?Bu.has(i):pw(i))||(n||Ge(r,"get",i),e)?a:Hs(a)?!o||!Mo(i)?a.value:a:Ai(a)?n?qu(a):zo(a):a}}var mw=yw();function yw(n=!1){return function(t,r,i,s){let o=t[r];if(!n&&(i=le(i),o=le(o),!Ft(t)&&Hs(o)&&!Hs(i)))return o.value=i,!0;const a=Ft(t)&&Mo(r)?Number(r)<t.length:Ei(t,r),l=Reflect.set(t,r,i,s);return t===le(s)&&(a?$u(i,o)&&Et(t,"set",r,i,o):Et(t,"add",r,i)),l}}function ww(n,e){const t=Ei(n,e),r=n[e],i=Reflect.deleteProperty(n,e);return i&&t&&Et(n,"delete",e,void 0,r),i}function bw(n,e){const t=Reflect.has(n,e);return(!Lo(e)||!Bu.has(e))&&Ge(n,"has",e),t}function vw(n){return Ge(n,"iterate",Ft(n)?"length":Ut),Reflect.ownKeys(n)}var _w={get:dw,set:mw,deleteProperty:ww,has:bw,ownKeys:vw},kw={get:fw,set(n,e){return console.warn(`Set operation on key "${String(e)}" failed: target is readonly.`,n),!0},deleteProperty(n,e){return console.warn(`Delete operation on key "${String(e)}" failed: target is readonly.`,n),!0}},Do=n=>Ai(n)?zo(n):n,jo=n=>Ai(n)?qu(n):n,Bo=n=>n,Oi=n=>Reflect.getPrototypeOf(n);function Er(n,e,t=!1,r=!1){n=n.__v_raw;const i=le(n),s=le(e);e!==s&&!t&&Ge(i,"get",e),!t&&Ge(i,"get",s);const{has:o}=Oi(i),a=r?Bo:t?jo:Do;if(o.call(i,e))return a(n.get(e));if(o.call(i,s))return a(n.get(s));n!==i&&n.get(e)}function Ar(n,e=!1){const t=this.__v_raw,r=le(t),i=le(n);return n!==i&&!e&&Ge(r,"has",n),!e&&Ge(r,"has",i),n===i?t.has(n):t.has(n)||t.has(i)}function Or(n,e=!1){return n=n.__v_raw,!e&&Ge(le(n),"iterate",Ut),Reflect.get(n,"size",n)}function ll(n){n=le(n);const e=le(this);return Oi(e).has.call(e,n)||(e.add(n),Et(e,"add",n,n)),this}function cl(n,e){e=le(e);const t=le(this),{has:r,get:i}=Oi(t);let s=r.call(t,n);s?Uu(t,r,n):(n=le(n),s=r.call(t,n));const o=i.call(t,n);return t.set(n,e),s?$u(e,o)&&Et(t,"set",n,e,o):Et(t,"add",n,e),this}function ul(n){const e=le(this),{has:t,get:r}=Oi(e);let i=t.call(e,n);i?Uu(e,t,n):(n=le(n),i=t.call(e,n));const s=r?r.call(e,n):void 0,o=e.delete(n);return i&&Et(e,"delete",n,void 0,s),o}function hl(){const n=le(this),e=n.size!==0,t=Vn(n)?new Map(n):new Set(n),r=n.clear();return e&&Et(n,"clear",void 0,void 0,t),r}function Cr(n,e){return function(r,i){const s=this,o=s.__v_raw,a=le(o),l=e?Bo:n?jo:Do;return!n&&Ge(a,"iterate",Ut),o.forEach((h,u)=>r.call(i,l(h),l(u),s))}}function Tr(n,e,t){return function(...r){const i=this.__v_raw,s=le(i),o=Vn(s),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,h=i[n](...r),u=t?Bo:e?jo:Do;return!e&&Ge(s,"iterate",l?Us:Ut),{next(){const{value:p,done:d}=h.next();return d?{value:p,done:d}:{value:a?[u(p[0]),u(p[1])]:u(p),done:d}},[Symbol.iterator](){return this}}}}function bt(n){return function(...e){{const t=e[0]?`on key "${e[0]}" `:"";console.warn(`${iw(n)} operation ${t}failed: target is readonly.`,le(this))}return n==="delete"?!1:this}}function xw(){const n={get(s){return Er(this,s)},get size(){return Or(this)},has:Ar,add:ll,set:cl,delete:ul,clear:hl,forEach:Cr(!1,!1)},e={get(s){return Er(this,s,!1,!0)},get size(){return Or(this)},has:Ar,add:ll,set:cl,delete:ul,clear:hl,forEach:Cr(!1,!0)},t={get(s){return Er(this,s,!0)},get size(){return Or(this,!0)},has(s){return Ar.call(this,s,!0)},add:bt("add"),set:bt("set"),delete:bt("delete"),clear:bt("clear"),forEach:Cr(!0,!1)},r={get(s){return Er(this,s,!0,!0)},get size(){return Or(this,!0)},has(s){return Ar.call(this,s,!0)},add:bt("add"),set:bt("set"),delete:bt("delete"),clear:bt("clear"),forEach:Cr(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{n[s]=Tr(s,!1,!1),t[s]=Tr(s,!0,!1),e[s]=Tr(s,!1,!0),r[s]=Tr(s,!0,!0)}),[n,t,e,r]}var[Sw,Ew,Aw,Ow]=xw();function Fu(n,e){const t=e?n?Ow:Aw:n?Ew:Sw;return(r,i,s)=>i==="__v_isReactive"?!n:i==="__v_isReadonly"?n:i==="__v_raw"?r:Reflect.get(Ei(t,i)&&i in r?t:r,i,s)}var Cw={get:Fu(!1,!1)},Tw={get:Fu(!0,!1)};function Uu(n,e,t){const r=le(t);if(r!==t&&e.call(n,r)){const i=Mu(n);console.warn(`Reactive ${i} contains both the raw and reactive versions of the same object${i==="Map"?" as keys":""}, which can lead to inconsistencies. Avoid differentiating between the raw and reactive versions of an object and only use the reactive version if possible.`)}}var Hu=new WeakMap,Rw=new WeakMap,Wu=new WeakMap,Iw=new WeakMap;function Pw(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Nw(n){return n.__v_skip||!Object.isExtensible(n)?0:Pw(Mu(n))}function zo(n){return n&&n.__v_isReadonly?n:Vu(n,!1,_w,Cw,Hu)}function qu(n){return Vu(n,!0,kw,Tw,Wu)}function Vu(n,e,t,r,i){if(!Ai(n))return console.warn(`value cannot be made reactive: ${String(n)}`),n;if(n.__v_raw&&!(e&&n.__v_isReactive))return n;const s=i.get(n);if(s)return s;const o=Nw(n);if(o===0)return n;const a=new Proxy(n,o===2?r:t);return i.set(n,a),a}function le(n){return n&&le(n.__v_raw)||n}function Hs(n){return!!(n&&n.__v_isRef===!0)}Ye("nextTick",()=>Po);Ye("dispatch",n=>Wn.bind(Wn,n));Ye("watch",(n,{evaluateLater:e,effect:t})=>(r,i)=>{let s=e(r),o=!0,a,l=t(()=>s(h=>{JSON.stringify(h),o?a=h:queueMicrotask(()=>{i(h,a),a=h}),o=!1}));n._x_effects.delete(l)});Ye("store",Vy);Ye("data",n=>su(n));Ye("root",n=>_i(n));Ye("refs",n=>(n._x_refs_proxy||(n._x_refs_proxy=sr(Lw(n))),n._x_refs_proxy));function Lw(n){let e=[],t=n;for(;t;)t._x_refs&&e.push(t._x_refs),t=t.parentNode;return e}var rs={};function Ju(n){return rs[n]||(rs[n]=0),++rs[n]}function Mw(n,e){return ki(n,t=>{if(t._x_ids&&t._x_ids[e])return!0})}function $w(n,e){n._x_ids||(n._x_ids={}),n._x_ids[e]||(n._x_ids[e]=Ju(e))}Ye("id",n=>(e,t=null)=>{let r=Mw(n,e),i=r?r._x_ids[e]:Ju(e);return t?`${e}-${i}-${t}`:`${e}-${i}`});Ye("el",n=>n);Gu("Focus","focus","focus");Gu("Persist","persist","persist");function Gu(n,e,t){Ye(e,r=>pt(`You can't use [$${e}] without first installing the "${n}" plugin here: https://alpinejs.dev/plugins/${t}`,r))}he("modelable",(n,{expression:e},{effect:t,evaluateLater:r,cleanup:i})=>{let s=r(e),o=()=>{let u;return s(p=>u=p),u},a=r(`${e} = __placeholder`),l=u=>a(()=>{},{scope:{__placeholder:u}}),h=o();l(h),queueMicrotask(()=>{if(!n._x_model)return;n._x_removeModelListeners.default();let u=n._x_model.get,p=n._x_model.set,d=Ru({get(){return u()},set(c){p(c)}},{get(){return o()},set(c){l(c)}});i(d)})});he("teleport",(n,{modifiers:e,expression:t},{cleanup:r})=>{n.tagName.toLowerCase()!=="template"&&pt("x-teleport can only be used on a <template> tag",n);let i=pl(t),s=n.content.cloneNode(!0).firstElementChild;n._x_teleport=s,s._x_teleportBack=n,n.setAttribute("data-teleport-template",!0),s.setAttribute("data-teleport-target",!0),n._x_forwardEvents&&n._x_forwardEvents.forEach(a=>{s.addEventListener(a,l=>{l.stopPropagation(),n.dispatchEvent(new l.constructor(l.type,l))})}),ir(s,{},n);let o=(a,l,h)=>{h.includes("prepend")?l.parentNode.insertBefore(a,l):h.includes("append")?l.parentNode.insertBefore(a,l.nextSibling):l.appendChild(a)};de(()=>{o(s,i,e),dt(s),s._x_ignore=!0}),n._x_teleportPutBack=()=>{let a=pl(t);de(()=>{o(n._x_teleport,a,e)})},r(()=>s.remove())});var Dw=document.createElement("div");function pl(n){let e=Si(()=>document.querySelector(n),()=>Dw)();return e||pt(`Cannot find x-teleport element for selector: "${n}"`),e}var Ku=()=>{};Ku.inline=(n,{modifiers:e},{cleanup:t})=>{e.includes("self")?n._x_ignoreSelf=!0:n._x_ignore=!0,t(()=>{e.includes("self")?delete n._x_ignoreSelf:delete n._x_ignore})};he("ignore",Ku);he("effect",(n,{expression:e},{effect:t})=>t(ke(n,e)));function Ws(n,e,t,r){let i=n,s=l=>r(l),o={},a=(l,h)=>u=>h(l,u);if(t.includes("dot")&&(e=jw(e)),t.includes("camel")&&(e=Bw(e)),t.includes("passive")&&(o.passive=!0),t.includes("capture")&&(o.capture=!0),t.includes("window")&&(i=window),t.includes("document")&&(i=document),t.includes("debounce")){let l=t[t.indexOf("debounce")+1]||"invalid-wait",h=oi(l.split("ms")[0])?Number(l.split("ms")[0]):250;s=Cu(s,h)}if(t.includes("throttle")){let l=t[t.indexOf("throttle")+1]||"invalid-wait",h=oi(l.split("ms")[0])?Number(l.split("ms")[0]):250;s=Tu(s,h)}return t.includes("prevent")&&(s=a(s,(l,h)=>{h.preventDefault(),l(h)})),t.includes("stop")&&(s=a(s,(l,h)=>{h.stopPropagation(),l(h)})),t.includes("self")&&(s=a(s,(l,h)=>{h.target===n&&l(h)})),(t.includes("away")||t.includes("outside"))&&(i=document,s=a(s,(l,h)=>{n.contains(h.target)||h.target.isConnected!==!1&&(n.offsetWidth<1&&n.offsetHeight<1||n._x_isShown!==!1&&l(h))})),t.includes("once")&&(s=a(s,(l,h)=>{l(h),i.removeEventListener(e,s,o)})),s=a(s,(l,h)=>{Fw(e)&&Uw(h,t)||l(h)}),i.addEventListener(e,s,o),()=>{i.removeEventListener(e,s,o)}}function jw(n){return n.replace(/-/g,".")}function Bw(n){return n.toLowerCase().replace(/-(\w)/g,(e,t)=>t.toUpperCase())}function oi(n){return!Array.isArray(n)&&!isNaN(n)}function zw(n){return[" ","_"].includes(n)?n:n.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[_\s]/,"-").toLowerCase()}function Fw(n){return["keydown","keyup"].includes(n)}function Uw(n,e){let t=e.filter(s=>!["window","document","prevent","stop","once","capture"].includes(s));if(t.includes("debounce")){let s=t.indexOf("debounce");t.splice(s,oi((t[s+1]||"invalid-wait").split("ms")[0])?2:1)}if(t.includes("throttle")){let s=t.indexOf("throttle");t.splice(s,oi((t[s+1]||"invalid-wait").split("ms")[0])?2:1)}if(t.length===0||t.length===1&&dl(n.key).includes(t[0]))return!1;const i=["ctrl","shift","alt","meta","cmd","super"].filter(s=>t.includes(s));return t=t.filter(s=>!i.includes(s)),!(i.length>0&&i.filter(o=>((o==="cmd"||o==="super")&&(o="meta"),n[`${o}Key`])).length===i.length&&dl(n.key).includes(t[0]))}function dl(n){if(!n)return[];n=zw(n);let e={ctrl:"control",slash:"/",space:" ",spacebar:" ",cmd:"meta",esc:"escape",up:"arrow-up",down:"arrow-down",left:"arrow-left",right:"arrow-right",period:".",equal:"=",minus:"-",underscore:"_"};return e[n]=n,Object.keys(e).map(t=>{if(e[t]===n)return t}).filter(t=>t)}he("model",(n,{modifiers:e,expression:t},{effect:r,cleanup:i})=>{let s=n;e.includes("parent")&&(s=n.parentNode);let o=ke(s,t),a;typeof t=="string"?a=ke(s,`${t} = __placeholder`):typeof t=="function"&&typeof t()=="string"?a=ke(s,`${t()} = __placeholder`):a=()=>{};let l=()=>{let d;return o(c=>d=c),fl(d)?d.get():d},h=d=>{let c;o(f=>c=f),fl(c)?c.set(d):a(()=>{},{scope:{__placeholder:d}})};typeof t=="string"&&n.type==="radio"&&de(()=>{n.hasAttribute("name")||n.setAttribute("name",t)});var u=n.tagName.toLowerCase()==="select"||["checkbox","radio"].includes(n.type)||e.includes("lazy")?"change":"input";let p=St?()=>{}:Ws(n,u,e,d=>{h(Hw(n,e,d,l()))});if(e.includes("fill")&&([null,""].includes(l())||n.type==="checkbox"&&Array.isArray(l()))&&n.dispatchEvent(new Event(u,{})),n._x_removeModelListeners||(n._x_removeModelListeners={}),n._x_removeModelListeners.default=p,i(()=>n._x_removeModelListeners.default()),n.form){let d=Ws(n.form,"reset",[],c=>{Po(()=>n._x_model&&n._x_model.set(n.value))});i(()=>d())}n._x_model={get(){return l()},set(d){h(d)}},n._x_forceModelUpdate=d=>{d===void 0&&typeof t=="string"&&t.match(/\./)&&(d=""),window.fromModel=!0,de(()=>Su(n,"value",d)),delete window.fromModel},r(()=>{let d=l();e.includes("unintrusive")&&document.activeElement.isSameNode(n)||n._x_forceModelUpdate(d)})});function Hw(n,e,t,r){return de(()=>{if(t instanceof CustomEvent&&t.detail!==void 0)return t.detail!==null&&t.detail!==void 0?t.detail:t.target.value;if(n.type==="checkbox")if(Array.isArray(r)){let i=e.includes("number")?is(t.target.value):t.target.value;return t.target.checked?r.concat([i]):r.filter(s=>!Ww(s,i))}else return t.target.checked;else{if(n.tagName.toLowerCase()==="select"&&n.multiple)return e.includes("number")?Array.from(t.target.selectedOptions).map(i=>{let s=i.value||i.text;return is(s)}):Array.from(t.target.selectedOptions).map(i=>i.value||i.text);{let i=t.target.value;return e.includes("number")?is(i):e.includes("trim")?i.trim():i}}})}function is(n){let e=n?parseFloat(n):null;return qw(e)?e:n}function Ww(n,e){return n==e}function qw(n){return!Array.isArray(n)&&!isNaN(n)}function fl(n){return n!==null&&typeof n=="object"&&typeof n.get=="function"&&typeof n.set=="function"}he("cloak",n=>queueMicrotask(()=>de(()=>n.removeAttribute(_n("cloak")))));Yc(()=>`[${_n("init")}]`);he("init",Si((n,{expression:e},{evaluate:t})=>typeof e=="string"?!!e.trim()&&t(e,{},!1):t(e,{},!1)));he("text",(n,{expression:e},{effect:t,evaluateLater:r})=>{let i=r(e);t(()=>{i(s=>{de(()=>{n.textContent=s})})})});he("html",(n,{expression:e},{effect:t,evaluateLater:r})=>{let i=r(e);t(()=>{i(s=>{de(()=>{n.innerHTML=s,n._x_ignoreSelf=!0,dt(n),delete n._x_ignoreSelf})})})});Ro(gu(":",mu(_n("bind:"))));var Yu=(n,{value:e,modifiers:t,expression:r,original:i},{effect:s})=>{if(!e){let a={};Gy(a),ke(n,r)(h=>{Pu(n,h,i)},{scope:a});return}if(e==="key")return Vw(n,r);if(n._x_inlineBindings&&n._x_inlineBindings[e]&&n._x_inlineBindings[e].extract)return;let o=ke(n,r);s(()=>o(a=>{a===void 0&&typeof r=="string"&&r.match(/\./)&&(a=""),de(()=>Su(n,e,a,t))}))};Yu.inline=(n,{value:e,modifiers:t,expression:r})=>{e&&(n._x_inlineBindings||(n._x_inlineBindings={}),n._x_inlineBindings[e]={expression:r,extract:!1})};he("bind",Yu);function Vw(n,e){n._x_keyExpression=e}Kc(()=>`[${_n("data")}]`);he("data",(n,{expression:e},{cleanup:t})=>{if(Py(n))return;e=e===""?"{}":e;let r={};Ps(r,n);let i={};Yy(i,r);let s=zt(n,e,{scope:i});(s===void 0||s===!0)&&(s={}),Ps(s,n);let o=bn(s);ou(o);let a=ir(n,o);o.init&&zt(n,o.init),t(()=>{o.destroy&&zt(n,o.destroy),a()})});he("show",(n,{modifiers:e,expression:t},{effect:r})=>{let i=ke(n,t);n._x_doHide||(n._x_doHide=()=>{de(()=>{n.style.setProperty("display","none",e.includes("important")?"important":void 0)})}),n._x_doShow||(n._x_doShow=()=>{de(()=>{n.style.length===1&&n.style.display==="none"?n.removeAttribute("style"):n.style.removeProperty("display")})});let s=()=>{n._x_doHide(),n._x_isShown=!1},o=()=>{n._x_doShow(),n._x_isShown=!0},a=()=>setTimeout(o),l=js(p=>p?o():s(),p=>{typeof n._x_toggleAndCascadeWithTransitions=="function"?n._x_toggleAndCascadeWithTransitions(n,p,o,s):p?a():s()}),h,u=!0;r(()=>i(p=>{!u&&p===h||(e.includes("immediate")&&(p?a():s()),l(p),h=p,u=!1)}))});he("for",(n,{expression:e},{effect:t,cleanup:r})=>{let i=Gw(e),s=ke(n,i.items),o=ke(n,n._x_keyExpression||"index");n._x_prevKeys=[],n._x_lookup={},t(()=>Jw(n,i,s,o)),r(()=>{Object.values(n._x_lookup).forEach(a=>a.remove()),delete n._x_prevKeys,delete n._x_lookup})});function Jw(n,e,t,r){let i=o=>typeof o=="object"&&!Array.isArray(o),s=n;t(o=>{Kw(o)&&o>=0&&(o=Array.from(Array(o).keys(),m=>m+1)),o===void 0&&(o=[]);let a=n._x_lookup,l=n._x_prevKeys,h=[],u=[];if(i(o))o=Object.entries(o).map(([m,y])=>{let w=gl(e,y,m,o);r(_=>u.push(_),{scope:{index:m,...w}}),h.push(w)});else for(let m=0;m<o.length;m++){let y=gl(e,o[m],m,o);r(w=>u.push(w),{scope:{index:m,...y}}),h.push(y)}let p=[],d=[],c=[],f=[];for(let m=0;m<l.length;m++){let y=l[m];u.indexOf(y)===-1&&c.push(y)}l=l.filter(m=>!c.includes(m));let g="template";for(let m=0;m<u.length;m++){let y=u[m],w=l.indexOf(y);if(w===-1)l.splice(m,0,y),p.push([g,m]);else if(w!==m){let _=l.splice(m,1)[0],v=l.splice(w-1,1)[0];l.splice(m,0,v),l.splice(w,0,_),d.push([_,v])}else f.push(y);g=y}for(let m=0;m<c.length;m++){let y=c[m];a[y]._x_effects&&a[y]._x_effects.forEach(Wc),a[y].remove(),a[y]=null,delete a[y]}for(let m=0;m<d.length;m++){let[y,w]=d[m],_=a[y],v=a[w],b=document.createElement("div");de(()=>{v||pt('x-for ":key" is undefined or invalid',s),v.after(b),_.after(v),v._x_currentIfEl&&v.after(v._x_currentIfEl),b.before(_),_._x_currentIfEl&&_.after(_._x_currentIfEl),b.remove()}),v._x_refreshXForScope(h[u.indexOf(w)])}for(let m=0;m<p.length;m++){let[y,w]=p[m],_=y==="template"?s:a[y];_._x_currentIfEl&&(_=_._x_currentIfEl);let v=h[w],b=u[w],x=document.importNode(s.content,!0).firstElementChild,E=bn(v);ir(x,E,s),x._x_refreshXForScope=N=>{Object.entries(N).forEach(([$,A])=>{E[$]=A})},de(()=>{_.after(x),dt(x)}),typeof b=="object"&&pt("x-for key cannot be an object, it must be a string or an integer",s),a[b]=x}for(let m=0;m<f.length;m++)a[f[m]]._x_refreshXForScope(h[u.indexOf(f[m])]);s._x_prevKeys=u})}function Gw(n){let e=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,t=/^\s*\(|\)\s*$/g,r=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,i=n.match(r);if(!i)return;let s={};s.items=i[2].trim();let o=i[1].replace(t,"").trim(),a=o.match(e);return a?(s.item=o.replace(e,"").trim(),s.index=a[1].trim(),a[2]&&(s.collection=a[2].trim())):s.item=o,s}function gl(n,e,t,r){let i={};return/^\[.*\]$/.test(n.item)&&Array.isArray(e)?n.item.replace("[","").replace("]","").split(",").map(o=>o.trim()).forEach((o,a)=>{i[o]=e[a]}):/^\{.*\}$/.test(n.item)&&!Array.isArray(e)&&typeof e=="object"?n.item.replace("{","").replace("}","").split(",").map(o=>o.trim()).forEach(o=>{i[o]=e[o]}):i[n.item]=e,n.index&&(i[n.index]=t),n.collection&&(i[n.collection]=r),i}function Kw(n){return!Array.isArray(n)&&!isNaN(n)}function Zu(){}Zu.inline=(n,{expression:e},{cleanup:t})=>{let r=_i(n);r._x_refs||(r._x_refs={}),r._x_refs[e]=n,t(()=>delete r._x_refs[e])};he("ref",Zu);he("if",(n,{expression:e},{effect:t,cleanup:r})=>{n.tagName.toLowerCase()!=="template"&&pt("x-if can only be used on a <template> tag",n);let i=ke(n,e),s=()=>{if(n._x_currentIfEl)return n._x_currentIfEl;let a=n.content.cloneNode(!0).firstElementChild;return ir(a,{},n),de(()=>{n.after(a),dt(a)}),n._x_currentIfEl=a,n._x_undoIf=()=>{xt(a,l=>{l._x_effects&&l._x_effects.forEach(Wc)}),a.remove(),delete n._x_currentIfEl},a},o=()=>{n._x_undoIf&&(n._x_undoIf(),delete n._x_undoIf)};t(()=>i(a=>{a?s():o()})),r(()=>n._x_undoIf&&n._x_undoIf())});he("id",(n,{expression:e},{evaluate:t})=>{t(e).forEach(i=>$w(n,i))});Ro(gu("@",mu(_n("on:"))));he("on",Si((n,{value:e,modifiers:t,expression:r},{cleanup:i})=>{let s=r?ke(n,r):()=>{};n.tagName.toLowerCase()==="template"&&(n._x_forwardEvents||(n._x_forwardEvents=[]),n._x_forwardEvents.includes(e)||n._x_forwardEvents.push(e));let o=Ws(n,e,t,a=>{s(()=>{},{scope:{$event:a},params:[a]})});i(()=>o())}));Ci("Collapse","collapse","collapse");Ci("Intersect","intersect","intersect");Ci("Focus","trap","focus");Ci("Mask","mask","mask");function Ci(n,e,t){he(e,r=>pt(`You can't use [x-${e}] without first installing the "${n}" plugin here: https://alpinejs.dev/plugins/${t}`,r))}or.setEvaluator(hu);or.setReactivityEngine({reactive:zo,effect:ow,release:aw,raw:le});var Yw=or,ob=Yw;const ab=async function(n){const{username:e,password:t}=n,r=window.client.services.get("auth");r.info("Attempt login",e||"[AuthenticatedUser]");let i=null;if(!e&&!t)i=await r.getAuthenticatedUser(),i||(i=await r.tryAutoLogin());else if(i=await r.login(e,t),!i)throw new Error("Login failed! Please check your username and password.");return i?r.success("LoginSuccess",e||i.username):r.warn("LoginFailure",e),i?window.sessionStorage.setItem("uid",i.username):window.sessionStorage.removeItem("uid"),i},lb=function(n){return n!=null&&n!==""&&typeof n=="object"&&Object.keys(n).length>0},cb=function(){return{open:(window.sessionStorage.getItem("uid")??"").length===0,input:{username:"",password:""},newUserRegistration:!1,error:{},async login(){this.error={},this.newUserRegistration?(/^[a-zA-Z0-9]+$/.test(this.input.username)||(this.error.username="Username must be alphanumeric"),this.input.password.length>=8||(this.error.password="Password must be at least 8 characters long")):(this.input.username===""&&(this.error.username="Username is required"),this.input.password===""&&(this.error.password="Password is required")),Object.keys(this.error).length===0?(await this.$dispatch("login",{username:this.input.username,password:this.input.password,newUser:this.newUserRegistration}),console.log("Login event emitted:",this.input.username,this.newUserRegistration)):window.Alpine.store("toasts").createToast("Login Failed! Please try again","login","error")},toggleHeader(){this.newUserRegistration=!this.newUserRegistration}}};export{nb as A,jt as C,bm as E,Cc as I,tb as J,eb as M,mm as N,Om as O,Ys as S,Aa as U,$t as W,Wf as Y,Yl as a,We as b,Pd as c,Pc as d,Xw as e,ob as f,qs as g,jn as h,ib as i,rb as j,lb as k,ab as l,Q as m,sb as n,ce as o,Fn as p,cb as q,Qw as r};
